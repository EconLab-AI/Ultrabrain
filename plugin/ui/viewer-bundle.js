"use strict";(()=>{var gH=Object.create;var zy=Object.defineProperty;var vH=Object.getOwnPropertyDescriptor;var _H=Object.getOwnPropertyNames;var yH=Object.getPrototypeOf,xH=Object.prototype.hasOwnProperty;var SH=(t,e,n)=>e in t?zy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Hl=(t,e)=>()=>(t&&(e=t(t=0)),e);var Kn=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),KP=(t,e)=>{for(var n in e)zy(t,n,{get:e[n],enumerable:!0})},bH=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of _H(e))!xH.call(t,r)&&r!==n&&zy(t,r,{get:()=>e[r],enumerable:!(i=vH(e,r))||i.enumerable});return t};var mt=(t,e,n)=>(n=t!=null?gH(yH(t)):{},bH(e||!t||!t.__esModule?zy(n,"default",{value:t,enumerable:!0}):n,t));var $P=(t,e,n)=>SH(t,typeof e!="symbol"?e+"":e,n);var lD=Kn(gn=>{"use strict";var Rm=Symbol.for("react.element"),wH=Symbol.for("react.portal"),EH=Symbol.for("react.fragment"),CH=Symbol.for("react.strict_mode"),TH=Symbol.for("react.profiler"),MH=Symbol.for("react.provider"),AH=Symbol.for("react.context"),kH=Symbol.for("react.forward_ref"),LH=Symbol.for("react.suspense"),PH=Symbol.for("react.memo"),DH=Symbol.for("react.lazy"),JP=Symbol.iterator;function IH(t){return t===null||typeof t!="object"?null:(t=JP&&t[JP]||t["@@iterator"],typeof t=="function"?t:null)}var eD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tD=Object.assign,nD={};function Kd(t,e,n){this.props=t,this.context=e,this.refs=nD,this.updater=n||eD}Kd.prototype.isReactComponent={};Kd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Kd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iD(){}iD.prototype=Kd.prototype;function eC(t,e,n){this.props=t,this.context=e,this.refs=nD,this.updater=n||eD}var tC=eC.prototype=new iD;tC.constructor=eC;tD(tC,Kd.prototype);tC.isPureReactComponent=!0;var ZP=Array.isArray,rD=Object.prototype.hasOwnProperty,nC={current:null},sD={key:!0,ref:!0,__self:!0,__source:!0};function oD(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)rD.call(e,i)&&!sD.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Rm,type:t,key:s,ref:o,props:r,_owner:nC.current}}function RH(t,e){return{$$typeof:Rm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function iC(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rm}function NH(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var QP=/\/+/g;function QE(t,e){return typeof t=="object"&&t!==null&&t.key!=null?NH(""+t.key):e.toString(36)}function Wy(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Rm:case wH:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+QE(o,0):i,ZP(r)?(n="",t!=null&&(n=t.replace(QP,"$&/")+"/"),Wy(r,e,n,"",function(c){return c})):r!=null&&(iC(r)&&(r=RH(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(QP,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",ZP(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+QE(s,a);o+=Wy(s,e,n,l,r)}else if(l=IH(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+QE(s,a++),o+=Wy(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Hy(t,e,n){if(t==null)return t;var i=[],r=0;return Wy(t,i,"","",function(s){return e.call(n,s,r++)}),i}function OH(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fs={current:null},Vy={transition:null},BH={ReactCurrentDispatcher:fs,ReactCurrentBatchConfig:Vy,ReactCurrentOwner:nC};function aD(){throw Error("act(...) is not supported in production builds of React.")}gn.Children={map:Hy,forEach:function(t,e,n){Hy(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Hy(t,function(){e++}),e},toArray:function(t){return Hy(t,function(e){return e})||[]},only:function(t){if(!iC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};gn.Component=Kd;gn.Fragment=EH;gn.Profiler=TH;gn.PureComponent=eC;gn.StrictMode=CH;gn.Suspense=LH;gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BH;gn.act=aD;gn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=tD({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=nC.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)rD.call(e,l)&&!sD.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:Rm,type:t.type,key:r,ref:s,props:i,_owner:o}};gn.createContext=function(t){return t={$$typeof:AH,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:MH,_context:t},t.Consumer=t};gn.createElement=oD;gn.createFactory=function(t){var e=oD.bind(null,t);return e.type=t,e};gn.createRef=function(){return{current:null}};gn.forwardRef=function(t){return{$$typeof:kH,render:t}};gn.isValidElement=iC;gn.lazy=function(t){return{$$typeof:DH,_payload:{_status:-1,_result:t},_init:OH}};gn.memo=function(t,e){return{$$typeof:PH,type:t,compare:e===void 0?null:e}};gn.startTransition=function(t){var e=Vy.transition;Vy.transition={};try{t()}finally{Vy.transition=e}};gn.unstable_act=aD;gn.useCallback=function(t,e){return fs.current.useCallback(t,e)};gn.useContext=function(t){return fs.current.useContext(t)};gn.useDebugValue=function(){};gn.useDeferredValue=function(t){return fs.current.useDeferredValue(t)};gn.useEffect=function(t,e){return fs.current.useEffect(t,e)};gn.useId=function(){return fs.current.useId()};gn.useImperativeHandle=function(t,e,n){return fs.current.useImperativeHandle(t,e,n)};gn.useInsertionEffect=function(t,e){return fs.current.useInsertionEffect(t,e)};gn.useLayoutEffect=function(t,e){return fs.current.useLayoutEffect(t,e)};gn.useMemo=function(t,e){return fs.current.useMemo(t,e)};gn.useReducer=function(t,e,n){return fs.current.useReducer(t,e,n)};gn.useRef=function(t){return fs.current.useRef(t)};gn.useState=function(t){return fs.current.useState(t)};gn.useSyncExternalStore=function(t,e,n){return fs.current.useSyncExternalStore(t,e,n)};gn.useTransition=function(){return fs.current.useTransition()};gn.version="18.3.1"});var Ct=Kn((vie,cD)=>{"use strict";cD.exports=lD()});var yD=Kn($n=>{"use strict";function aC(t,e){var n=t.length;t.push(e);e:for(;0<n;){var i=n-1>>>1,r=t[i];if(0<Gy(r,e))t[i]=e,t[n]=r,n=i;else break e}}function ga(t){return t.length===0?null:t[0]}function Xy(t){if(t.length===0)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;e:for(var i=0,r=t.length,s=r>>>1;i<s;){var o=2*(i+1)-1,a=t[o],l=o+1,c=t[l];if(0>Gy(a,n))l<r&&0>Gy(c,a)?(t[i]=c,t[l]=n,i=l):(t[i]=a,t[o]=n,i=o);else if(l<r&&0>Gy(c,n))t[i]=c,t[l]=n,i=l;else break e}}return e}function Gy(t,e){var n=t.sortIndex-e.sortIndex;return n!==0?n:t.id-e.id}typeof performance=="object"&&typeof performance.now=="function"?(uD=performance,$n.unstable_now=function(){return uD.now()}):(rC=Date,hD=rC.now(),$n.unstable_now=function(){return rC.now()-hD});var uD,rC,hD,nl=[],zc=[],UH=1,Go=null,jr=3,qy=!1,fh=!1,Om=!1,pD=typeof setTimeout=="function"?setTimeout:null,mD=typeof clearTimeout=="function"?clearTimeout:null,dD=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function lC(t){for(var e=ga(zc);e!==null;){if(e.callback===null)Xy(zc);else if(e.startTime<=t)Xy(zc),e.sortIndex=e.expirationTime,aC(nl,e);else break;e=ga(zc)}}function cC(t){if(Om=!1,lC(t),!fh)if(ga(nl)!==null)fh=!0,hC(uC);else{var e=ga(zc);e!==null&&dC(cC,e.startTime-t)}}function uC(t,e){fh=!1,Om&&(Om=!1,mD(Bm),Bm=-1),qy=!0;var n=jr;try{for(lC(e),Go=ga(nl);Go!==null&&(!(Go.expirationTime>e)||t&&!_D());){var i=Go.callback;if(typeof i=="function"){Go.callback=null,jr=Go.priorityLevel;var r=i(Go.expirationTime<=e);e=$n.unstable_now(),typeof r=="function"?Go.callback=r:Go===ga(nl)&&Xy(nl),lC(e)}else Xy(nl);Go=ga(nl)}if(Go!==null)var s=!0;else{var o=ga(zc);o!==null&&dC(cC,o.startTime-e),s=!1}return s}finally{Go=null,jr=n,qy=!1}}var Yy=!1,jy=null,Bm=-1,gD=5,vD=-1;function _D(){return!($n.unstable_now()-vD<gD)}function sC(){if(jy!==null){var t=$n.unstable_now();vD=t;var e=!0;try{e=jy(!0,t)}finally{e?Nm():(Yy=!1,jy=null)}}else Yy=!1}var Nm;typeof dD=="function"?Nm=function(){dD(sC)}:typeof MessageChannel<"u"?(oC=new MessageChannel,fD=oC.port2,oC.port1.onmessage=sC,Nm=function(){fD.postMessage(null)}):Nm=function(){pD(sC,0)};var oC,fD;function hC(t){jy=t,Yy||(Yy=!0,Nm())}function dC(t,e){Bm=pD(function(){t($n.unstable_now())},e)}$n.unstable_IdlePriority=5;$n.unstable_ImmediatePriority=1;$n.unstable_LowPriority=4;$n.unstable_NormalPriority=3;$n.unstable_Profiling=null;$n.unstable_UserBlockingPriority=2;$n.unstable_cancelCallback=function(t){t.callback=null};$n.unstable_continueExecution=function(){fh||qy||(fh=!0,hC(uC))};$n.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):gD=0<t?Math.floor(1e3/t):5};$n.unstable_getCurrentPriorityLevel=function(){return jr};$n.unstable_getFirstCallbackNode=function(){return ga(nl)};$n.unstable_next=function(t){switch(jr){case 1:case 2:case 3:var e=3;break;default:e=jr}var n=jr;jr=e;try{return t()}finally{jr=n}};$n.unstable_pauseExecution=function(){};$n.unstable_requestPaint=function(){};$n.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=jr;jr=t;try{return e()}finally{jr=n}};$n.unstable_scheduleCallback=function(t,e,n){var i=$n.unstable_now();switch(typeof n=="object"&&n!==null?(n=n.delay,n=typeof n=="number"&&0<n?i+n:i):n=i,t){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return r=n+r,t={id:UH++,callback:e,priorityLevel:t,startTime:n,expirationTime:r,sortIndex:-1},n>i?(t.sortIndex=n,aC(zc,t),ga(nl)===null&&t===ga(zc)&&(Om?(mD(Bm),Bm=-1):Om=!0,dC(cC,n-i))):(t.sortIndex=r,aC(nl,t),fh||qy||(fh=!0,hC(uC))),t};$n.unstable_shouldYield=_D;$n.unstable_wrapCallback=function(t){var e=jr;return function(){var n=jr;jr=e;try{return t.apply(this,arguments)}finally{jr=n}}}});var SD=Kn((yie,xD)=>{"use strict";xD.exports=yD()});var CN=Kn(mo=>{"use strict";var FH=Ct(),fo=SD();function nt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var AI=new Set,sg={};function Th(t,e){vf(t,e),vf(t+"Capture",e)}function vf(t,e){for(sg[t]=e,t=0;t<e.length;t++)AI.add(e[t])}var ql=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),NC=Object.prototype.hasOwnProperty,zH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bD={},wD={};function HH(t){return NC.call(wD,t)?!0:NC.call(bD,t)?!1:zH.test(t)?wD[t]=!0:(bD[t]=!0,!1)}function WH(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function VH(t,e,n,i){if(e===null||typeof e>"u"||WH(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gs(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ir={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ir[t]=new gs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ir[e]=new gs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ir[t]=new gs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ir[t]=new gs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ir[t]=new gs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ir[t]=new gs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ir[t]=new gs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ir[t]=new gs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ir[t]=new gs(t,5,!1,t.toLowerCase(),null,!1,!1)});var MT=/[\-:]([a-z])/g;function AT(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(MT,AT);Ir[e]=new gs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(MT,AT);Ir[e]=new gs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(MT,AT);Ir[e]=new gs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ir[t]=new gs(t,1,!1,t.toLowerCase(),null,!1,!1)});Ir.xlinkHref=new gs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ir[t]=new gs(t,1,!1,t.toLowerCase(),null,!0,!0)});function kT(t,e,n,i){var r=Ir.hasOwnProperty(e)?Ir[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(VH(e,n,r,i)&&(n=null),i||r===null?HH(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Jl=FH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ky=Symbol.for("react.element"),Zd=Symbol.for("react.portal"),Qd=Symbol.for("react.fragment"),LT=Symbol.for("react.strict_mode"),OC=Symbol.for("react.profiler"),kI=Symbol.for("react.provider"),LI=Symbol.for("react.context"),PT=Symbol.for("react.forward_ref"),BC=Symbol.for("react.suspense"),UC=Symbol.for("react.suspense_list"),DT=Symbol.for("react.memo"),Wc=Symbol.for("react.lazy"),PI=Symbol.for("react.offscreen"),ED=Symbol.iterator;function Um(t){return t===null||typeof t!="object"?null:(t=ED&&t[ED]||t["@@iterator"],typeof t=="function"?t:null)}var xi=Object.assign,fC;function Xm(t){if(fC===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fC=e&&e[1]||""}return`
`+fC+t}var pC=!1;function mC(t,e){if(!t||pC)return"";pC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{pC=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xm(t):""}function GH(t){switch(t.tag){case 5:return Xm(t.type);case 16:return Xm("Lazy");case 13:return Xm("Suspense");case 19:return Xm("SuspenseList");case 0:case 2:case 15:return t=mC(t.type,!1),t;case 11:return t=mC(t.type.render,!1),t;case 1:return t=mC(t.type,!0),t;default:return""}}function FC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qd:return"Fragment";case Zd:return"Portal";case OC:return"Profiler";case LT:return"StrictMode";case BC:return"Suspense";case UC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case LI:return(t.displayName||"Context")+".Consumer";case kI:return(t._context.displayName||"Context")+".Provider";case PT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case DT:return e=t.displayName||null,e!==null?e:FC(t.type)||"Memo";case Wc:e=t._payload,t=t._init;try{return FC(t(e))}catch{}}return null}function jH(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return FC(e);case 8:return e===LT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function nu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function DI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XH(t){var e=DI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function $y(t){t._valueTracker||(t._valueTracker=XH(t))}function II(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=DI(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function E1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zC(t,e){var n=e.checked;return xi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function CD(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=nu(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function RI(t,e){e=e.checked,e!=null&&kT(t,"checked",e,!1)}function HC(t,e){RI(t,e);var n=nu(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?WC(t,e.type,n):e.hasOwnProperty("defaultValue")&&WC(t,e.type,nu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function TD(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function WC(t,e,n){(e!=="number"||E1(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qm=Array.isArray;function hf(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+nu(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function VC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(nt(91));return xi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function MD(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(nt(92));if(qm(n)){if(1<n.length)throw Error(nt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:nu(n)}}function NI(t,e){var n=nu(e.value),i=nu(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function AD(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function OI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function GC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?OI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Jy,BI=(function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t})(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Jy=Jy||document.createElement("div"),Jy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Jy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function og(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $m={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qH=["Webkit","ms","Moz","O"];Object.keys($m).forEach(function(t){qH.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$m[e]=$m[t]})});function UI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$m.hasOwnProperty(t)&&$m[t]?(""+e).trim():e+"px"}function FI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=UI(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var YH=xi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jC(t,e){if(e){if(YH[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(nt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(nt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(nt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(nt(62))}}function XC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qC=null;function IT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var YC=null,df=null,ff=null;function kD(t){if(t=Eg(t)){if(typeof YC!="function")throw Error(nt(280));var e=t.stateNode;e&&(e=Z1(e),YC(t.stateNode,t.type,e))}}function zI(t){df?ff?ff.push(t):ff=[t]:df=t}function HI(){if(df){var t=df,e=ff;if(ff=df=null,kD(t),e)for(t=0;t<e.length;t++)kD(e[t])}}function WI(t,e){return t(e)}function VI(){}var gC=!1;function GI(t,e,n){if(gC)return t(e,n);gC=!0;try{return WI(t,e,n)}finally{gC=!1,(df!==null||ff!==null)&&(VI(),HI())}}function ag(t,e){var n=t.stateNode;if(n===null)return null;var i=Z1(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(nt(231,e,typeof n));return n}var KC=!1;if(ql)try{$d={},Object.defineProperty($d,"passive",{get:function(){KC=!0}}),window.addEventListener("test",$d,$d),window.removeEventListener("test",$d,$d)}catch{KC=!1}var $d;function KH(t,e,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Jm=!1,C1=null,T1=!1,$C=null,$H={onError:function(t){Jm=!0,C1=t}};function JH(t,e,n,i,r,s,o,a,l){Jm=!1,C1=null,KH.apply($H,arguments)}function ZH(t,e,n,i,r,s,o,a,l){if(JH.apply(this,arguments),Jm){if(Jm){var c=C1;Jm=!1,C1=null}else throw Error(nt(198));T1||(T1=!0,$C=c)}}function Mh(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function jI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function LD(t){if(Mh(t)!==t)throw Error(nt(188))}function QH(t){var e=t.alternate;if(!e){if(e=Mh(t),e===null)throw Error(nt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return LD(r),t;if(s===i)return LD(r),e;s=s.sibling}throw Error(nt(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(nt(189))}}if(n.alternate!==i)throw Error(nt(190))}if(n.tag!==3)throw Error(nt(188));return n.stateNode.current===n?t:e}function XI(t){return t=QH(t),t!==null?qI(t):null}function qI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qI(t);if(e!==null)return e;t=t.sibling}return null}var YI=fo.unstable_scheduleCallback,PD=fo.unstable_cancelCallback,eW=fo.unstable_shouldYield,tW=fo.unstable_requestPaint,Hi=fo.unstable_now,nW=fo.unstable_getCurrentPriorityLevel,RT=fo.unstable_ImmediatePriority,KI=fo.unstable_UserBlockingPriority,M1=fo.unstable_NormalPriority,iW=fo.unstable_LowPriority,$I=fo.unstable_IdlePriority,Y1=null,ol=null;function rW(t){if(ol&&typeof ol.onCommitFiberRoot=="function")try{ol.onCommitFiberRoot(Y1,t,void 0,(t.current.flags&128)===128)}catch{}}var Sa=Math.clz32?Math.clz32:aW,sW=Math.log,oW=Math.LN2;function aW(t){return t>>>=0,t===0?32:31-(sW(t)/oW|0)|0}var Zy=64,Qy=4194304;function Ym(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function A1(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=Ym(a):(s&=o,s!==0&&(i=Ym(s)))}else o=n&~r,o!==0?i=Ym(o):s!==0&&(i=Ym(s));if(i===0)return 0;if(e!==0&&e!==i&&(e&r)===0&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if((i&4)!==0&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Sa(e),r=1<<n,i|=t[n],e&=~r;return i}function lW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cW(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Sa(s),a=1<<o,l=r[o];l===-1?((a&n)===0||(a&i)!==0)&&(r[o]=lW(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function JC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function JI(){var t=Zy;return Zy<<=1,(Zy&4194240)===0&&(Zy=64),t}function vC(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function bg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Sa(e),t[e]=n}function uW(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Sa(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function NT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Sa(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Bn=0;function ZI(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var QI,OT,eR,tR,nR,ZC=!1,e1=[],Yc=null,Kc=null,$c=null,lg=new Map,cg=new Map,Gc=[],hW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function DD(t,e){switch(t){case"focusin":case"focusout":Yc=null;break;case"dragenter":case"dragleave":Kc=null;break;case"mouseover":case"mouseout":$c=null;break;case"pointerover":case"pointerout":lg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":cg.delete(e.pointerId)}}function Fm(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Eg(e),e!==null&&OT(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function dW(t,e,n,i,r){switch(e){case"focusin":return Yc=Fm(Yc,t,e,n,i,r),!0;case"dragenter":return Kc=Fm(Kc,t,e,n,i,r),!0;case"mouseover":return $c=Fm($c,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return lg.set(s,Fm(lg.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,cg.set(s,Fm(cg.get(s)||null,t,e,n,i,r)),!0}return!1}function iR(t){var e=gh(t.target);if(e!==null){var n=Mh(e);if(n!==null){if(e=n.tag,e===13){if(e=jI(n),e!==null){t.blockedOn=e,nR(t.priority,function(){eR(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function p1(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=QC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);qC=i,n.target.dispatchEvent(i),qC=null}else return e=Eg(n),e!==null&&OT(e),t.blockedOn=n,!1;e.shift()}return!0}function ID(t,e,n){p1(t)&&n.delete(e)}function fW(){ZC=!1,Yc!==null&&p1(Yc)&&(Yc=null),Kc!==null&&p1(Kc)&&(Kc=null),$c!==null&&p1($c)&&($c=null),lg.forEach(ID),cg.forEach(ID)}function zm(t,e){t.blockedOn===e&&(t.blockedOn=null,ZC||(ZC=!0,fo.unstable_scheduleCallback(fo.unstable_NormalPriority,fW)))}function ug(t){function e(r){return zm(r,t)}if(0<e1.length){zm(e1[0],t);for(var n=1;n<e1.length;n++){var i=e1[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Yc!==null&&zm(Yc,t),Kc!==null&&zm(Kc,t),$c!==null&&zm($c,t),lg.forEach(e),cg.forEach(e),n=0;n<Gc.length;n++)i=Gc[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Gc.length&&(n=Gc[0],n.blockedOn===null);)iR(n),n.blockedOn===null&&Gc.shift()}var pf=Jl.ReactCurrentBatchConfig,k1=!0;function pW(t,e,n,i){var r=Bn,s=pf.transition;pf.transition=null;try{Bn=1,BT(t,e,n,i)}finally{Bn=r,pf.transition=s}}function mW(t,e,n,i){var r=Bn,s=pf.transition;pf.transition=null;try{Bn=4,BT(t,e,n,i)}finally{Bn=r,pf.transition=s}}function BT(t,e,n,i){if(k1){var r=QC(t,e,n,i);if(r===null)EC(t,e,i,L1,n),DD(t,i);else if(dW(r,t,e,n,i))i.stopPropagation();else if(DD(t,i),e&4&&-1<hW.indexOf(t)){for(;r!==null;){var s=Eg(r);if(s!==null&&QI(s),s=QC(t,e,n,i),s===null&&EC(t,e,i,L1,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else EC(t,e,i,null,n)}}var L1=null;function QC(t,e,n,i){if(L1=null,t=IT(i),t=gh(t),t!==null)if(e=Mh(t),e===null)t=null;else if(n=e.tag,n===13){if(t=jI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return L1=t,null}function rR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nW()){case RT:return 1;case KI:return 4;case M1:case iW:return 16;case $I:return 536870912;default:return 16}default:return 16}}var Xc=null,UT=null,m1=null;function sR(){if(m1)return m1;var t,e=UT,n=e.length,i,r="value"in Xc?Xc.value:Xc.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return m1=r.slice(t,1<i?1-i:void 0)}function g1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function t1(){return!0}function RD(){return!1}function po(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?t1:RD,this.isPropagationStopped=RD,this}return xi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=t1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=t1)},persist:function(){},isPersistent:t1}),e}var Ef={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},FT=po(Ef),wg=xi({},Ef,{view:0,detail:0}),gW=po(wg),_C,yC,Hm,K1=xi({},wg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Hm&&(Hm&&t.type==="mousemove"?(_C=t.screenX-Hm.screenX,yC=t.screenY-Hm.screenY):yC=_C=0,Hm=t),_C)},movementY:function(t){return"movementY"in t?t.movementY:yC}}),ND=po(K1),vW=xi({},K1,{dataTransfer:0}),_W=po(vW),yW=xi({},wg,{relatedTarget:0}),xC=po(yW),xW=xi({},Ef,{animationName:0,elapsedTime:0,pseudoElement:0}),SW=po(xW),bW=xi({},Ef,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wW=po(bW),EW=xi({},Ef,{data:0}),OD=po(EW),CW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=MW[t])?!!e[t]:!1}function zT(){return AW}var kW=xi({},wg,{key:function(t){if(t.key){var e=CW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=g1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zT,charCode:function(t){return t.type==="keypress"?g1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?g1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),LW=po(kW),PW=xi({},K1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),BD=po(PW),DW=xi({},wg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zT}),IW=po(DW),RW=xi({},Ef,{propertyName:0,elapsedTime:0,pseudoElement:0}),NW=po(RW),OW=xi({},K1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),BW=po(OW),UW=[9,13,27,32],HT=ql&&"CompositionEvent"in window,Zm=null;ql&&"documentMode"in document&&(Zm=document.documentMode);var FW=ql&&"TextEvent"in window&&!Zm,oR=ql&&(!HT||Zm&&8<Zm&&11>=Zm),UD=" ",FD=!1;function aR(t,e){switch(t){case"keyup":return UW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ef=!1;function zW(t,e){switch(t){case"compositionend":return lR(e);case"keypress":return e.which!==32?null:(FD=!0,UD);case"textInput":return t=e.data,t===UD&&FD?null:t;default:return null}}function HW(t,e){if(ef)return t==="compositionend"||!HT&&aR(t,e)?(t=sR(),m1=UT=Xc=null,ef=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return oR&&e.locale!=="ko"?null:e.data;default:return null}}var WW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zD(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!WW[t.type]:e==="textarea"}function cR(t,e,n,i){zI(i),e=P1(e,"onChange"),0<e.length&&(n=new FT("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Qm=null,hg=null;function VW(t){xR(t,0)}function $1(t){var e=rf(t);if(II(e))return t}function GW(t,e){if(t==="change")return e}var uR=!1;ql&&(ql?(i1="oninput"in document,i1||(SC=document.createElement("div"),SC.setAttribute("oninput","return;"),i1=typeof SC.oninput=="function"),n1=i1):n1=!1,uR=n1&&(!document.documentMode||9<document.documentMode));var n1,i1,SC;function HD(){Qm&&(Qm.detachEvent("onpropertychange",hR),hg=Qm=null)}function hR(t){if(t.propertyName==="value"&&$1(hg)){var e=[];cR(e,hg,t,IT(t)),GI(VW,e)}}function jW(t,e,n){t==="focusin"?(HD(),Qm=e,hg=n,Qm.attachEvent("onpropertychange",hR)):t==="focusout"&&HD()}function XW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $1(hg)}function qW(t,e){if(t==="click")return $1(e)}function YW(t,e){if(t==="input"||t==="change")return $1(e)}function KW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wa=typeof Object.is=="function"?Object.is:KW;function dg(t,e){if(wa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!NC.call(e,r)||!wa(t[r],e[r]))return!1}return!0}function WD(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function VD(t,e){var n=WD(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=WD(n)}}function dR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?dR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function fR(){for(var t=window,e=E1();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=E1(t.document)}return e}function WT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $W(t){var e=fR(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&dR(n.ownerDocument.documentElement,n)){if(i!==null&&WT(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=VD(n,s);var o=VD(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var JW=ql&&"documentMode"in document&&11>=document.documentMode,tf=null,eT=null,eg=null,tT=!1;function GD(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;tT||tf==null||tf!==E1(i)||(i=tf,"selectionStart"in i&&WT(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),eg&&dg(eg,i)||(eg=i,i=P1(eT,"onSelect"),0<i.length&&(e=new FT("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=tf)))}function r1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var nf={animationend:r1("Animation","AnimationEnd"),animationiteration:r1("Animation","AnimationIteration"),animationstart:r1("Animation","AnimationStart"),transitionend:r1("Transition","TransitionEnd")},bC={},pR={};ql&&(pR=document.createElement("div").style,"AnimationEvent"in window||(delete nf.animationend.animation,delete nf.animationiteration.animation,delete nf.animationstart.animation),"TransitionEvent"in window||delete nf.transitionend.transition);function J1(t){if(bC[t])return bC[t];if(!nf[t])return t;var e=nf[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in pR)return bC[t]=e[n];return t}var mR=J1("animationend"),gR=J1("animationiteration"),vR=J1("animationstart"),_R=J1("transitionend"),yR=new Map,jD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ru(t,e){yR.set(t,e),Th(e,[t])}for(s1=0;s1<jD.length;s1++)o1=jD[s1],XD=o1.toLowerCase(),qD=o1[0].toUpperCase()+o1.slice(1),ru(XD,"on"+qD);var o1,XD,qD,s1;ru(mR,"onAnimationEnd");ru(gR,"onAnimationIteration");ru(vR,"onAnimationStart");ru("dblclick","onDoubleClick");ru("focusin","onFocus");ru("focusout","onBlur");ru(_R,"onTransitionEnd");vf("onMouseEnter",["mouseout","mouseover"]);vf("onMouseLeave",["mouseout","mouseover"]);vf("onPointerEnter",["pointerout","pointerover"]);vf("onPointerLeave",["pointerout","pointerover"]);Th("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Th("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Th("onBeforeInput",["compositionend","keypress","textInput","paste"]);Th("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Th("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Th("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Km="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZW=new Set("cancel close invalid load scroll toggle".split(" ").concat(Km));function YD(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,ZH(i,e,void 0,t),t.currentTarget=null}function xR(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;YD(r,a,c),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;YD(r,a,c),s=l}}}if(T1)throw t=$C,T1=!1,$C=null,t}function ii(t,e){var n=e[oT];n===void 0&&(n=e[oT]=new Set);var i=t+"__bubble";n.has(i)||(SR(e,t,2,!1),n.add(i))}function wC(t,e,n){var i=0;e&&(i|=4),SR(n,t,i,e)}var a1="_reactListening"+Math.random().toString(36).slice(2);function fg(t){if(!t[a1]){t[a1]=!0,AI.forEach(function(n){n!=="selectionchange"&&(ZW.has(n)||wC(n,!1,t),wC(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[a1]||(e[a1]=!0,wC("selectionchange",!1,e))}}function SR(t,e,n,i){switch(rR(e)){case 1:var r=pW;break;case 4:r=mW;break;default:r=BT}n=r.bind(null,e,n,t),r=void 0,!KC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function EC(t,e,n,i,r){var s=i;if((e&1)===0&&(e&2)===0&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=gh(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}GI(function(){var c=s,u=IT(n),d=[];e:{var p=yR.get(t);if(p!==void 0){var m=FT,g=t;switch(t){case"keypress":if(g1(n)===0)break e;case"keydown":case"keyup":m=LW;break;case"focusin":g="focus",m=xC;break;case"focusout":g="blur",m=xC;break;case"beforeblur":case"afterblur":m=xC;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=ND;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=_W;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=IW;break;case mR:case gR:case vR:m=SW;break;case _R:m=NW;break;case"scroll":m=gW;break;case"wheel":m=BW;break;case"copy":case"cut":case"paste":m=wW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=BD}var _=(e&4)!==0,y=!_&&t==="scroll",v=_?p!==null?p+"Capture":null:p;_=[];for(var S=c,b;S!==null;){b=S;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=ag(S,v),w!=null&&_.push(pg(S,w,b)))),y)break;S=S.return}0<_.length&&(p=new m(p,g,null,n,u),d.push({event:p,listeners:_}))}}if((e&7)===0){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&n!==qC&&(g=n.relatedTarget||n.fromElement)&&(gh(g)||g[Yl]))break e;if((m||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=c,g=g?gh(g):null,g!==null&&(y=Mh(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(_=ND,w="onMouseLeave",v="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(_=BD,w="onPointerLeave",v="onPointerEnter",S="pointer"),y=m==null?p:rf(m),b=g==null?p:rf(g),p=new _(w,S+"leave",m,n,u),p.target=y,p.relatedTarget=b,w=null,gh(u)===c&&(_=new _(v,S+"enter",g,n,u),_.target=b,_.relatedTarget=y,w=_),y=w,m&&g)t:{for(_=m,v=g,S=0,b=_;b;b=Jd(b))S++;for(b=0,w=v;w;w=Jd(w))b++;for(;0<S-b;)_=Jd(_),S--;for(;0<b-S;)v=Jd(v),b--;for(;S--;){if(_===v||v!==null&&_===v.alternate)break t;_=Jd(_),v=Jd(v)}_=null}else _=null;m!==null&&KD(d,p,m,_,!1),g!==null&&y!==null&&KD(d,y,g,_,!0)}}e:{if(p=c?rf(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var C=GW;else if(zD(p))if(uR)C=YW;else{C=XW;var M=jW}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=qW);if(C&&(C=C(t,c))){cR(d,C,n,u);break e}M&&M(t,p,c),t==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&WC(p,"number",p.value)}switch(M=c?rf(c):window,t){case"focusin":(zD(M)||M.contentEditable==="true")&&(tf=M,eT=c,eg=null);break;case"focusout":eg=eT=tf=null;break;case"mousedown":tT=!0;break;case"contextmenu":case"mouseup":case"dragend":tT=!1,GD(d,n,u);break;case"selectionchange":if(JW)break;case"keydown":case"keyup":GD(d,n,u)}var L;if(HT)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else ef?aR(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(oR&&n.locale!=="ko"&&(ef||P!=="onCompositionStart"?P==="onCompositionEnd"&&ef&&(L=sR()):(Xc=u,UT="value"in Xc?Xc.value:Xc.textContent,ef=!0)),M=P1(c,P),0<M.length&&(P=new OD(P,t,null,n,u),d.push({event:P,listeners:M}),L?P.data=L:(L=lR(n),L!==null&&(P.data=L)))),(L=FW?zW(t,n):HW(t,n))&&(c=P1(c,"onBeforeInput"),0<c.length&&(u=new OD("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=L))}xR(d,e)})}function pg(t,e,n){return{instance:t,listener:e,currentTarget:n}}function P1(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=ag(t,n),s!=null&&i.unshift(pg(t,s,r)),s=ag(t,e),s!=null&&i.push(pg(t,s,r))),t=t.return}return i}function Jd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function KD(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,r?(l=ag(n,s),l!=null&&o.unshift(pg(n,l,a))):r||(l=ag(n,s),l!=null&&o.push(pg(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var QW=/\r\n?/g,eV=/\u0000|\uFFFD/g;function $D(t){return(typeof t=="string"?t:""+t).replace(QW,`
`).replace(eV,"")}function l1(t,e,n){if(e=$D(e),$D(t)!==e&&n)throw Error(nt(425))}function D1(){}var nT=null,iT=null;function rT(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sT=typeof setTimeout=="function"?setTimeout:void 0,tV=typeof clearTimeout=="function"?clearTimeout:void 0,JD=typeof Promise=="function"?Promise:void 0,nV=typeof queueMicrotask=="function"?queueMicrotask:typeof JD<"u"?function(t){return JD.resolve(null).then(t).catch(iV)}:sT;function iV(t){setTimeout(function(){throw t})}function CC(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),ug(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);ug(e)}function Jc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ZD(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Cf=Math.random().toString(36).slice(2),sl="__reactFiber$"+Cf,mg="__reactProps$"+Cf,Yl="__reactContainer$"+Cf,oT="__reactEvents$"+Cf,rV="__reactListeners$"+Cf,sV="__reactHandles$"+Cf;function gh(t){var e=t[sl];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Yl]||n[sl]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ZD(t);t!==null;){if(n=t[sl])return n;t=ZD(t)}return e}t=n,n=t.parentNode}return null}function Eg(t){return t=t[sl]||t[Yl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function rf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(nt(33))}function Z1(t){return t[mg]||null}var aT=[],sf=-1;function su(t){return{current:t}}function ri(t){0>sf||(t.current=aT[sf],aT[sf]=null,sf--)}function Jn(t,e){sf++,aT[sf]=t.current,t.current=e}var iu={},Kr=su(iu),Bs=su(!1),Sh=iu;function _f(t,e){var n=t.type.contextTypes;if(!n)return iu;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Us(t){return t=t.childContextTypes,t!=null}function I1(){ri(Bs),ri(Kr)}function QD(t,e,n){if(Kr.current!==iu)throw Error(nt(168));Jn(Kr,e),Jn(Bs,n)}function bR(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(nt(108,jH(t)||"Unknown",r));return xi({},n,i)}function R1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||iu,Sh=Kr.current,Jn(Kr,t),Jn(Bs,Bs.current),!0}function eI(t,e,n){var i=t.stateNode;if(!i)throw Error(nt(169));n?(t=bR(t,e,Sh),i.__reactInternalMemoizedMergedChildContext=t,ri(Bs),ri(Kr),Jn(Kr,t)):ri(Bs),Jn(Bs,n)}var Vl=null,Q1=!1,TC=!1;function wR(t){Vl===null?Vl=[t]:Vl.push(t)}function oV(t){Q1=!0,wR(t)}function ou(){if(!TC&&Vl!==null){TC=!0;var t=0,e=Bn;try{var n=Vl;for(Bn=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Vl=null,Q1=!1}catch(r){throw Vl!==null&&(Vl=Vl.slice(t+1)),YI(RT,ou),r}finally{Bn=e,TC=!1}}return null}var of=[],af=0,N1=null,O1=0,jo=[],Xo=0,bh=null,Gl=1,jl="";function ph(t,e){of[af++]=O1,of[af++]=N1,N1=t,O1=e}function ER(t,e,n){jo[Xo++]=Gl,jo[Xo++]=jl,jo[Xo++]=bh,bh=t;var i=Gl;t=jl;var r=32-Sa(i)-1;i&=~(1<<r),n+=1;var s=32-Sa(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Gl=1<<32-Sa(e)+r|n<<r|i,jl=s+t}else Gl=1<<s|n<<r|i,jl=t}function VT(t){t.return!==null&&(ph(t,1),ER(t,1,0))}function GT(t){for(;t===N1;)N1=of[--af],of[af]=null,O1=of[--af],of[af]=null;for(;t===bh;)bh=jo[--Xo],jo[Xo]=null,jl=jo[--Xo],jo[Xo]=null,Gl=jo[--Xo],jo[Xo]=null}var ho=null,uo=null,hi=!1,xa=null;function CR(t,e){var n=qo(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function tI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ho=t,uo=Jc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ho=t,uo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=bh!==null?{id:Gl,overflow:jl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=qo(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ho=t,uo=null,!0):!1;default:return!1}}function lT(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cT(t){if(hi){var e=uo;if(e){var n=e;if(!tI(t,e)){if(lT(t))throw Error(nt(418));e=Jc(n.nextSibling);var i=ho;e&&tI(t,e)?CR(i,n):(t.flags=t.flags&-4097|2,hi=!1,ho=t)}}else{if(lT(t))throw Error(nt(418));t.flags=t.flags&-4097|2,hi=!1,ho=t}}}function nI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ho=t}function c1(t){if(t!==ho)return!1;if(!hi)return nI(t),hi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!rT(t.type,t.memoizedProps)),e&&(e=uo)){if(lT(t))throw TR(),Error(nt(418));for(;e;)CR(t,e),e=Jc(e.nextSibling)}if(nI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(nt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){uo=Jc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}uo=null}}else uo=ho?Jc(t.stateNode.nextSibling):null;return!0}function TR(){for(var t=uo;t;)t=Jc(t.nextSibling)}function yf(){uo=ho=null,hi=!1}function jT(t){xa===null?xa=[t]:xa.push(t)}var aV=Jl.ReactCurrentBatchConfig;function Wm(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(nt(309));var i=n.stateNode}if(!i)throw Error(nt(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(nt(284));if(!n._owner)throw Error(nt(290,t))}return t}function u1(t,e){throw t=Object.prototype.toString.call(e),Error(nt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function iI(t){var e=t._init;return e(t._payload)}function MR(t){function e(v,S){if(t){var b=v.deletions;b===null?(v.deletions=[S],v.flags|=16):b.push(S)}}function n(v,S){if(!t)return null;for(;S!==null;)e(v,S),S=S.sibling;return null}function i(v,S){for(v=new Map;S!==null;)S.key!==null?v.set(S.key,S):v.set(S.index,S),S=S.sibling;return v}function r(v,S){return v=tu(v,S),v.index=0,v.sibling=null,v}function s(v,S,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<S?(v.flags|=2,S):b):(v.flags|=2,S)):(v.flags|=1048576,S)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,S,b,w){return S===null||S.tag!==6?(S=IC(b,v.mode,w),S.return=v,S):(S=r(S,b),S.return=v,S)}function l(v,S,b,w){var C=b.type;return C===Qd?u(v,S,b.props.children,w,b.key):S!==null&&(S.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Wc&&iI(C)===S.type)?(w=r(S,b.props),w.ref=Wm(v,S,b),w.return=v,w):(w=w1(b.type,b.key,b.props,null,v.mode,w),w.ref=Wm(v,S,b),w.return=v,w)}function c(v,S,b,w){return S===null||S.tag!==4||S.stateNode.containerInfo!==b.containerInfo||S.stateNode.implementation!==b.implementation?(S=RC(b,v.mode,w),S.return=v,S):(S=r(S,b.children||[]),S.return=v,S)}function u(v,S,b,w,C){return S===null||S.tag!==7?(S=xh(b,v.mode,w,C),S.return=v,S):(S=r(S,b),S.return=v,S)}function d(v,S,b){if(typeof S=="string"&&S!==""||typeof S=="number")return S=IC(""+S,v.mode,b),S.return=v,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ky:return b=w1(S.type,S.key,S.props,null,v.mode,b),b.ref=Wm(v,null,S),b.return=v,b;case Zd:return S=RC(S,v.mode,b),S.return=v,S;case Wc:var w=S._init;return d(v,w(S._payload),b)}if(qm(S)||Um(S))return S=xh(S,v.mode,b,null),S.return=v,S;u1(v,S)}return null}function p(v,S,b,w){var C=S!==null?S.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:a(v,S,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ky:return b.key===C?l(v,S,b,w):null;case Zd:return b.key===C?c(v,S,b,w):null;case Wc:return C=b._init,p(v,S,C(b._payload),w)}if(qm(b)||Um(b))return C!==null?null:u(v,S,b,w,null);u1(v,b)}return null}function m(v,S,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,a(S,v,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ky:return v=v.get(w.key===null?b:w.key)||null,l(S,v,w,C);case Zd:return v=v.get(w.key===null?b:w.key)||null,c(S,v,w,C);case Wc:var M=w._init;return m(v,S,b,M(w._payload),C)}if(qm(w)||Um(w))return v=v.get(b)||null,u(S,v,w,C,null);u1(S,w)}return null}function g(v,S,b,w){for(var C=null,M=null,L=S,P=S=0,T=null;L!==null&&P<b.length;P++){L.index>P?(T=L,L=null):T=L.sibling;var A=p(v,L,b[P],w);if(A===null){L===null&&(L=T);break}t&&L&&A.alternate===null&&e(v,L),S=s(A,S,P),M===null?C=A:M.sibling=A,M=A,L=T}if(P===b.length)return n(v,L),hi&&ph(v,P),C;if(L===null){for(;P<b.length;P++)L=d(v,b[P],w),L!==null&&(S=s(L,S,P),M===null?C=L:M.sibling=L,M=L);return hi&&ph(v,P),C}for(L=i(v,L);P<b.length;P++)T=m(L,v,P,b[P],w),T!==null&&(t&&T.alternate!==null&&L.delete(T.key===null?P:T.key),S=s(T,S,P),M===null?C=T:M.sibling=T,M=T);return t&&L.forEach(function(I){return e(v,I)}),hi&&ph(v,P),C}function _(v,S,b,w){var C=Um(b);if(typeof C!="function")throw Error(nt(150));if(b=C.call(b),b==null)throw Error(nt(151));for(var M=C=null,L=S,P=S=0,T=null,A=b.next();L!==null&&!A.done;P++,A=b.next()){L.index>P?(T=L,L=null):T=L.sibling;var I=p(v,L,A.value,w);if(I===null){L===null&&(L=T);break}t&&L&&I.alternate===null&&e(v,L),S=s(I,S,P),M===null?C=I:M.sibling=I,M=I,L=T}if(A.done)return n(v,L),hi&&ph(v,P),C;if(L===null){for(;!A.done;P++,A=b.next())A=d(v,A.value,w),A!==null&&(S=s(A,S,P),M===null?C=A:M.sibling=A,M=A);return hi&&ph(v,P),C}for(L=i(v,L);!A.done;P++,A=b.next())A=m(L,v,P,A.value,w),A!==null&&(t&&A.alternate!==null&&L.delete(A.key===null?P:A.key),S=s(A,S,P),M===null?C=A:M.sibling=A,M=A);return t&&L.forEach(function(F){return e(v,F)}),hi&&ph(v,P),C}function y(v,S,b,w){if(typeof b=="object"&&b!==null&&b.type===Qd&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ky:e:{for(var C=b.key,M=S;M!==null;){if(M.key===C){if(C=b.type,C===Qd){if(M.tag===7){n(v,M.sibling),S=r(M,b.props.children),S.return=v,v=S;break e}}else if(M.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Wc&&iI(C)===M.type){n(v,M.sibling),S=r(M,b.props),S.ref=Wm(v,M,b),S.return=v,v=S;break e}n(v,M);break}else e(v,M);M=M.sibling}b.type===Qd?(S=xh(b.props.children,v.mode,w,b.key),S.return=v,v=S):(w=w1(b.type,b.key,b.props,null,v.mode,w),w.ref=Wm(v,S,b),w.return=v,v=w)}return o(v);case Zd:e:{for(M=b.key;S!==null;){if(S.key===M)if(S.tag===4&&S.stateNode.containerInfo===b.containerInfo&&S.stateNode.implementation===b.implementation){n(v,S.sibling),S=r(S,b.children||[]),S.return=v,v=S;break e}else{n(v,S);break}else e(v,S);S=S.sibling}S=RC(b,v.mode,w),S.return=v,v=S}return o(v);case Wc:return M=b._init,y(v,S,M(b._payload),w)}if(qm(b))return g(v,S,b,w);if(Um(b))return _(v,S,b,w);u1(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,S!==null&&S.tag===6?(n(v,S.sibling),S=r(S,b),S.return=v,v=S):(n(v,S),S=IC(b,v.mode,w),S.return=v,v=S),o(v)):n(v,S)}return y}var xf=MR(!0),AR=MR(!1),B1=su(null),U1=null,lf=null,XT=null;function qT(){XT=lf=U1=null}function YT(t){var e=B1.current;ri(B1),t._currentValue=e}function uT(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function mf(t,e){U1=t,XT=lf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&e)!==0&&(Os=!0),t.firstContext=null)}function Ko(t){var e=t._currentValue;if(XT!==t)if(t={context:t,memoizedValue:e,next:null},lf===null){if(U1===null)throw Error(nt(308));lf=t,U1.dependencies={lanes:0,firstContext:t}}else lf=lf.next=t;return e}var vh=null;function KT(t){vh===null?vh=[t]:vh.push(t)}function kR(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,KT(e)):(n.next=r.next,r.next=n),e.interleaved=n,Kl(t,i)}function Kl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vc=!1;function $T(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Zc(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,(Cn&2)!==0){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Kl(t,n)}return r=i.interleaved,r===null?(e.next=e,KT(i)):(e.next=r.next,r.next=e),i.interleaved=e,Kl(t,n)}function v1(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,NT(t,n)}}function rI(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function F1(t,e,n,i){var r=t.updateQueue;Vc=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,u=c=l=null,a=s;do{var p=a.lane,m=a.eventTime;if((i&p)===p){u!==null&&(u=u.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,_=a;switch(p=e,m=n,_.tag){case 1:if(g=_.payload,typeof g=="function"){d=g.call(m,d,p);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=_.payload,p=typeof g=="function"?g.call(m,d,p):g,p==null)break e;d=xi({},d,p);break e;case 2:Vc=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=r.effects,p===null?r.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=m,l=d):u=u.next=m,o|=p;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;p=a,a=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Eh|=o,t.lanes=o,t.memoizedState=d}}function sI(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(nt(191,r));r.call(i)}}}var Cg={},al=su(Cg),gg=su(Cg),vg=su(Cg);function _h(t){if(t===Cg)throw Error(nt(174));return t}function JT(t,e){switch(Jn(vg,e),Jn(gg,t),Jn(al,Cg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:GC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=GC(e,t)}ri(al),Jn(al,e)}function Sf(){ri(al),ri(gg),ri(vg)}function PR(t){_h(vg.current);var e=_h(al.current),n=GC(e,t.type);e!==n&&(Jn(gg,t),Jn(al,n))}function ZT(t){gg.current===t&&(ri(al),ri(gg))}var _i=su(0);function z1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var MC=[];function QT(){for(var t=0;t<MC.length;t++)MC[t]._workInProgressVersionPrimary=null;MC.length=0}var _1=Jl.ReactCurrentDispatcher,AC=Jl.ReactCurrentBatchConfig,wh=0,yi=null,nr=null,gr=null,H1=!1,tg=!1,_g=0,lV=0;function Xr(){throw Error(nt(321))}function eM(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wa(t[n],e[n]))return!1;return!0}function tM(t,e,n,i,r,s){if(wh=s,yi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_1.current=t===null||t.memoizedState===null?dV:fV,t=n(i,r),tg){s=0;do{if(tg=!1,_g=0,25<=s)throw Error(nt(301));s+=1,gr=nr=null,e.updateQueue=null,_1.current=pV,t=n(i,r)}while(tg)}if(_1.current=W1,e=nr!==null&&nr.next!==null,wh=0,gr=nr=yi=null,H1=!1,e)throw Error(nt(300));return t}function nM(){var t=_g!==0;return _g=0,t}function rl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?yi.memoizedState=gr=t:gr=gr.next=t,gr}function $o(){if(nr===null){var t=yi.alternate;t=t!==null?t.memoizedState:null}else t=nr.next;var e=gr===null?yi.memoizedState:gr.next;if(e!==null)gr=e,nr=t;else{if(t===null)throw Error(nt(310));nr=t,t={memoizedState:nr.memoizedState,baseState:nr.baseState,baseQueue:nr.baseQueue,queue:nr.queue,next:null},gr===null?yi.memoizedState=gr=t:gr=gr.next=t}return gr}function yg(t,e){return typeof e=="function"?e(t):e}function kC(t){var e=$o(),n=e.queue;if(n===null)throw Error(nt(311));n.lastRenderedReducer=t;var i=nr,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((wh&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,yi.lanes|=u,Eh|=u}c=c.next}while(c!==null&&c!==s);l===null?o=i:l.next=a,wa(i,e.memoizedState)||(Os=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,yi.lanes|=s,Eh|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function LC(t){var e=$o(),n=e.queue;if(n===null)throw Error(nt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);wa(s,e.memoizedState)||(Os=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function DR(){}function IR(t,e){var n=yi,i=$o(),r=e(),s=!wa(i.memoizedState,r);if(s&&(i.memoizedState=r,Os=!0),i=i.queue,iM(OR.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||gr!==null&&gr.memoizedState.tag&1){if(n.flags|=2048,xg(9,NR.bind(null,n,i,r,e),void 0,null),vr===null)throw Error(nt(349));(wh&30)!==0||RR(n,e,r)}return r}function RR(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yi.updateQueue,e===null?(e={lastEffect:null,stores:null},yi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function NR(t,e,n,i){e.value=n,e.getSnapshot=i,BR(e)&&UR(t)}function OR(t,e,n){return n(function(){BR(e)&&UR(t)})}function BR(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wa(t,n)}catch{return!0}}function UR(t){var e=Kl(t,1);e!==null&&ba(e,t,1,-1)}function oI(t){var e=rl();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yg,lastRenderedState:t},e.queue=t,t=t.dispatch=hV.bind(null,yi,t),[e.memoizedState,t]}function xg(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=yi.updateQueue,e===null?(e={lastEffect:null,stores:null},yi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function FR(){return $o().memoizedState}function y1(t,e,n,i){var r=rl();yi.flags|=t,r.memoizedState=xg(1|e,n,void 0,i===void 0?null:i)}function ex(t,e,n,i){var r=$o();i=i===void 0?null:i;var s=void 0;if(nr!==null){var o=nr.memoizedState;if(s=o.destroy,i!==null&&eM(i,o.deps)){r.memoizedState=xg(e,n,s,i);return}}yi.flags|=t,r.memoizedState=xg(1|e,n,s,i)}function aI(t,e){return y1(8390656,8,t,e)}function iM(t,e){return ex(2048,8,t,e)}function zR(t,e){return ex(4,2,t,e)}function HR(t,e){return ex(4,4,t,e)}function WR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VR(t,e,n){return n=n!=null?n.concat([t]):null,ex(4,4,WR.bind(null,e,t),n)}function rM(){}function GR(t,e){var n=$o();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&eM(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function jR(t,e){var n=$o();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&eM(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function XR(t,e,n){return(wh&21)===0?(t.baseState&&(t.baseState=!1,Os=!0),t.memoizedState=n):(wa(n,e)||(n=JI(),yi.lanes|=n,Eh|=n,t.baseState=!0),e)}function cV(t,e){var n=Bn;Bn=n!==0&&4>n?n:4,t(!0);var i=AC.transition;AC.transition={};try{t(!1),e()}finally{Bn=n,AC.transition=i}}function qR(){return $o().memoizedState}function uV(t,e,n){var i=eu(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},YR(t))KR(e,n);else if(n=kR(t,e,n,i),n!==null){var r=ms();ba(n,t,i,r),$R(n,e,i)}}function hV(t,e,n){var i=eu(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(YR(t))KR(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,wa(a,o)){var l=e.interleaved;l===null?(r.next=r,KT(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}n=kR(t,e,r,i),n!==null&&(r=ms(),ba(n,t,i,r),$R(n,e,i))}}function YR(t){var e=t.alternate;return t===yi||e!==null&&e===yi}function KR(t,e){tg=H1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function $R(t,e,n){if((n&4194240)!==0){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,NT(t,n)}}var W1={readContext:Ko,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useInsertionEffect:Xr,useLayoutEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useMutableSource:Xr,useSyncExternalStore:Xr,useId:Xr,unstable_isNewReconciler:!1},dV={readContext:Ko,useCallback:function(t,e){return rl().memoizedState=[t,e===void 0?null:e],t},useContext:Ko,useEffect:aI,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,y1(4194308,4,WR.bind(null,e,t),n)},useLayoutEffect:function(t,e){return y1(4194308,4,t,e)},useInsertionEffect:function(t,e){return y1(4,2,t,e)},useMemo:function(t,e){var n=rl();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=rl();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=uV.bind(null,yi,t),[i.memoizedState,t]},useRef:function(t){var e=rl();return t={current:t},e.memoizedState=t},useState:oI,useDebugValue:rM,useDeferredValue:function(t){return rl().memoizedState=t},useTransition:function(){var t=oI(!1),e=t[0];return t=cV.bind(null,t[1]),rl().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=yi,r=rl();if(hi){if(n===void 0)throw Error(nt(407));n=n()}else{if(n=e(),vr===null)throw Error(nt(349));(wh&30)!==0||RR(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,aI(OR.bind(null,i,s,t),[t]),i.flags|=2048,xg(9,NR.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=rl(),e=vr.identifierPrefix;if(hi){var n=jl,i=Gl;n=(i&~(1<<32-Sa(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=_g++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lV++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fV={readContext:Ko,useCallback:GR,useContext:Ko,useEffect:iM,useImperativeHandle:VR,useInsertionEffect:zR,useLayoutEffect:HR,useMemo:jR,useReducer:kC,useRef:FR,useState:function(){return kC(yg)},useDebugValue:rM,useDeferredValue:function(t){var e=$o();return XR(e,nr.memoizedState,t)},useTransition:function(){var t=kC(yg)[0],e=$o().memoizedState;return[t,e]},useMutableSource:DR,useSyncExternalStore:IR,useId:qR,unstable_isNewReconciler:!1},pV={readContext:Ko,useCallback:GR,useContext:Ko,useEffect:iM,useImperativeHandle:VR,useInsertionEffect:zR,useLayoutEffect:HR,useMemo:jR,useReducer:LC,useRef:FR,useState:function(){return LC(yg)},useDebugValue:rM,useDeferredValue:function(t){var e=$o();return nr===null?e.memoizedState=t:XR(e,nr.memoizedState,t)},useTransition:function(){var t=LC(yg)[0],e=$o().memoizedState;return[t,e]},useMutableSource:DR,useSyncExternalStore:IR,useId:qR,unstable_isNewReconciler:!1};function _a(t,e){if(t&&t.defaultProps){e=xi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function hT(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:xi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tx={isMounted:function(t){return(t=t._reactInternals)?Mh(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ms(),r=eu(t),s=Xl(i,r);s.payload=e,n!=null&&(s.callback=n),e=Zc(t,s,r),e!==null&&(ba(e,t,r,i),v1(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ms(),r=eu(t),s=Xl(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Zc(t,s,r),e!==null&&(ba(e,t,r,i),v1(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ms(),i=eu(t),r=Xl(n,i);r.tag=2,e!=null&&(r.callback=e),e=Zc(t,r,i),e!==null&&(ba(e,t,i,n),v1(e,t,i))}};function lI(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!dg(n,i)||!dg(r,s):!0}function JR(t,e,n){var i=!1,r=iu,s=e.contextType;return typeof s=="object"&&s!==null?s=Ko(s):(r=Us(e)?Sh:Kr.current,i=e.contextTypes,s=(i=i!=null)?_f(t,r):iu),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tx,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function cI(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&tx.enqueueReplaceState(e,e.state,null)}function dT(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},$T(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Ko(s):(s=Us(e)?Sh:Kr.current,r.context=_f(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(hT(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&tx.enqueueReplaceState(r,r.state,null),F1(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function bf(t,e){try{var n="",i=e;do n+=GH(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function PC(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function fT(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mV=typeof WeakMap=="function"?WeakMap:Map;function ZR(t,e,n){n=Xl(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){G1||(G1=!0,wT=i),fT(t,e)},n}function QR(t,e,n){n=Xl(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){fT(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){fT(t,e),typeof i!="function"&&(Qc===null?Qc=new Set([this]):Qc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function uI(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new mV;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=kV.bind(null,t,e,n),e.then(t,t))}function hI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function dI(t,e,n,i,r){return(t.mode&1)===0?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Xl(-1,1),e.tag=2,Zc(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var gV=Jl.ReactCurrentOwner,Os=!1;function ps(t,e,n,i){e.child=t===null?AR(e,null,n,i):xf(e,t.child,n,i)}function fI(t,e,n,i,r){n=n.render;var s=e.ref;return mf(e,r),i=tM(t,e,n,i,s,r),n=nM(),t!==null&&!Os?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,$l(t,e,r)):(hi&&n&&VT(e),e.flags|=1,ps(t,e,i,r),e.child)}function pI(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!dM(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,eN(t,e,s,i,r)):(t=w1(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,(t.lanes&r)===0){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:dg,n(o,i)&&t.ref===e.ref)return $l(t,e,r)}return e.flags|=1,t=tu(s,i),t.ref=e.ref,t.return=e,e.child=t}function eN(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(dg(s,i)&&t.ref===e.ref)if(Os=!1,e.pendingProps=i=s,(t.lanes&r)!==0)(t.flags&131072)!==0&&(Os=!0);else return e.lanes=t.lanes,$l(t,e,r)}return pT(t,e,n,i,r)}function tN(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jn(uf,co),co|=n;else{if((n&1073741824)===0)return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Jn(uf,co),co|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Jn(uf,co),co|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Jn(uf,co),co|=i;return ps(t,e,r,n),e.child}function nN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function pT(t,e,n,i,r){var s=Us(n)?Sh:Kr.current;return s=_f(e,s),mf(e,r),n=tM(t,e,n,i,s,r),i=nM(),t!==null&&!Os?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,$l(t,e,r)):(hi&&i&&VT(e),e.flags|=1,ps(t,e,n,r),e.child)}function mI(t,e,n,i,r){if(Us(n)){var s=!0;R1(e)}else s=!1;if(mf(e,r),e.stateNode===null)x1(t,e),JR(e,n,i),dT(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Ko(c):(c=Us(n)?Sh:Kr.current,c=_f(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&cI(e,o,i,c),Vc=!1;var p=e.memoizedState;o.state=p,F1(e,i,o,r),l=e.memoizedState,a!==i||p!==l||Bs.current||Vc?(typeof u=="function"&&(hT(e,n,u,i),l=e.memoizedState),(a=Vc||lI(e,n,a,i,p,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,LR(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:_a(e.type,a),o.props=c,d=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ko(l):(l=Us(n)?Sh:Kr.current,l=_f(e,l));var m=n.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||p!==l)&&cI(e,o,i,l),Vc=!1,p=e.memoizedState,o.state=p,F1(e,i,o,r);var g=e.memoizedState;a!==d||p!==g||Bs.current||Vc?(typeof m=="function"&&(hT(e,n,m,i),g=e.memoizedState),(c=Vc||lI(e,n,c,i,p,g,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=g),o.props=i,o.state=g,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),i=!1)}return mT(t,e,n,i,s,r)}function mT(t,e,n,i,r,s){nN(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&eI(e,n,!1),$l(t,e,s);i=e.stateNode,gV.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=xf(e,t.child,null,s),e.child=xf(e,null,a,s)):ps(t,e,a,s),e.memoizedState=i.state,r&&eI(e,n,!0),e.child}function iN(t){var e=t.stateNode;e.pendingContext?QD(t,e.pendingContext,e.pendingContext!==e.context):e.context&&QD(t,e.context,!1),JT(t,e.containerInfo)}function gI(t,e,n,i,r){return yf(),jT(r),e.flags|=256,ps(t,e,n,i),e.child}var gT={dehydrated:null,treeContext:null,retryLane:0};function vT(t){return{baseLanes:t,cachePool:null,transitions:null}}function rN(t,e,n){var i=e.pendingProps,r=_i.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Jn(_i,r&1),t===null)return cT(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((e.mode&1)===0?e.lanes=1:t.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},(i&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=o):s=rx(o,i,0,null),t=xh(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=vT(n),e.memoizedState=gT,t):sM(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return vV(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return(o&1)===0&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=tu(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=tu(a,s):(s=xh(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?vT(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=gT,i}return s=t.child,t=s.sibling,i=tu(s,{mode:"visible",children:i.children}),(e.mode&1)===0&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function sM(t,e){return e=rx({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function h1(t,e,n,i){return i!==null&&jT(i),xf(e,t.child,null,n),t=sM(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vV(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=PC(Error(nt(422))),h1(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=rx({mode:"visible",children:i.children},r,0,null),s=xh(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,(e.mode&1)!==0&&xf(e,t.child,null,o),e.child.memoizedState=vT(o),e.memoizedState=gT,s);if((e.mode&1)===0)return h1(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(nt(419)),i=PC(s,i,void 0),h1(t,e,o,i)}if(a=(o&t.childLanes)!==0,Os||a){if(i=vr,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=(r&(i.suspendedLanes|o))!==0?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Kl(t,r),ba(i,t,r,-1))}return hM(),i=PC(Error(nt(421))),h1(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=LV.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,uo=Jc(r.nextSibling),ho=e,hi=!0,xa=null,t!==null&&(jo[Xo++]=Gl,jo[Xo++]=jl,jo[Xo++]=bh,Gl=t.id,jl=t.overflow,bh=e),e=sM(e,i.children),e.flags|=4096,e)}function vI(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),uT(t.return,e,n)}function DC(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function sN(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ps(t,e,i.children,n),i=_i.current,(i&2)!==0)i=i&1|2,e.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vI(t,n,e);else if(t.tag===19)vI(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Jn(_i,i),(e.mode&1)===0)e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&z1(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),DC(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&z1(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}DC(e,!0,n,null,s);break;case"together":DC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function x1(t,e){(e.mode&1)===0&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $l(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Eh|=e.lanes,(n&e.childLanes)===0)return null;if(t!==null&&e.child!==t.child)throw Error(nt(153));if(e.child!==null){for(t=e.child,n=tu(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=tu(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _V(t,e,n){switch(e.tag){case 3:iN(e),yf();break;case 5:PR(e);break;case 1:Us(e.type)&&R1(e);break;case 4:JT(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Jn(B1,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Jn(_i,_i.current&1),e.flags|=128,null):(n&e.child.childLanes)!==0?rN(t,e,n):(Jn(_i,_i.current&1),t=$l(t,e,n),t!==null?t.sibling:null);Jn(_i,_i.current&1);break;case 19:if(i=(n&e.childLanes)!==0,(t.flags&128)!==0){if(i)return sN(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Jn(_i,_i.current),i)break;return null;case 22:case 23:return e.lanes=0,tN(t,e,n)}return $l(t,e,n)}var oN,_T,aN,lN;oN=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_T=function(){};aN=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,_h(al.current);var s=null;switch(n){case"input":r=zC(t,r),i=zC(t,i),s=[];break;case"select":r=xi({},r,{value:void 0}),i=xi({},i,{value:void 0}),s=[];break;case"textarea":r=VC(t,r),i=VC(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=D1)}jC(n,i);var o;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(sg.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=r?.[c],i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(sg.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ii("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};lN=function(t,e,n,i){n!==i&&(e.flags|=4)};function Vm(t,e){if(!hi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function qr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function yV(t,e,n){var i=e.pendingProps;switch(GT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qr(e),null;case 1:return Us(e.type)&&I1(),qr(e),null;case 3:return i=e.stateNode,Sf(),ri(Bs),ri(Kr),QT(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(c1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,xa!==null&&(TT(xa),xa=null))),_T(t,e),qr(e),null;case 5:ZT(e);var r=_h(vg.current);if(n=e.type,t!==null&&e.stateNode!=null)aN(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(nt(166));return qr(e),null}if(t=_h(al.current),c1(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[sl]=e,i[mg]=s,t=(e.mode&1)!==0,n){case"dialog":ii("cancel",i),ii("close",i);break;case"iframe":case"object":case"embed":ii("load",i);break;case"video":case"audio":for(r=0;r<Km.length;r++)ii(Km[r],i);break;case"source":ii("error",i);break;case"img":case"image":case"link":ii("error",i),ii("load",i);break;case"details":ii("toggle",i);break;case"input":CD(i,s),ii("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},ii("invalid",i);break;case"textarea":MD(i,s),ii("invalid",i)}jC(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&l1(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&l1(i.textContent,a,t),r=["children",""+a]):sg.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ii("scroll",i)}switch(n){case"input":$y(i),TD(i,s,!0);break;case"textarea":$y(i),AD(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=D1)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=OI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[sl]=e,t[mg]=i,oN(t,e,!1,!1),e.stateNode=t;e:{switch(o=XC(n,i),n){case"dialog":ii("cancel",t),ii("close",t),r=i;break;case"iframe":case"object":case"embed":ii("load",t),r=i;break;case"video":case"audio":for(r=0;r<Km.length;r++)ii(Km[r],t);r=i;break;case"source":ii("error",t),r=i;break;case"img":case"image":case"link":ii("error",t),ii("load",t),r=i;break;case"details":ii("toggle",t),r=i;break;case"input":CD(t,i),r=zC(t,i),ii("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=xi({},i,{value:void 0}),ii("invalid",t);break;case"textarea":MD(t,i),r=VC(t,i),ii("invalid",t);break;default:r=i}jC(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?FI(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&BI(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&og(t,l):typeof l=="number"&&og(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(sg.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ii("scroll",t):l!=null&&kT(t,s,l,o))}switch(n){case"input":$y(t),TD(t,i,!1);break;case"textarea":$y(t),AD(t);break;case"option":i.value!=null&&t.setAttribute("value",""+nu(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?hf(t,!!i.multiple,s,!1):i.defaultValue!=null&&hf(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=D1)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qr(e),null;case 6:if(t&&e.stateNode!=null)lN(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(nt(166));if(n=_h(vg.current),_h(al.current),c1(e)){if(i=e.stateNode,n=e.memoizedProps,i[sl]=e,(s=i.nodeValue!==n)&&(t=ho,t!==null))switch(t.tag){case 3:l1(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&l1(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[sl]=e,e.stateNode=i}return qr(e),null;case 13:if(ri(_i),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(hi&&uo!==null&&(e.mode&1)!==0&&(e.flags&128)===0)TR(),yf(),e.flags|=98560,s=!1;else if(s=c1(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(nt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(nt(317));s[sl]=e}else yf(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;qr(e),s=!1}else xa!==null&&(TT(xa),xa=null),s=!0;if(!s)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,(e.mode&1)!==0&&(t===null||(_i.current&1)!==0?ir===0&&(ir=3):hM())),e.updateQueue!==null&&(e.flags|=4),qr(e),null);case 4:return Sf(),_T(t,e),t===null&&fg(e.stateNode.containerInfo),qr(e),null;case 10:return YT(e.type._context),qr(e),null;case 17:return Us(e.type)&&I1(),qr(e),null;case 19:if(ri(_i),s=e.memoizedState,s===null)return qr(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Vm(s,!1);else{if(ir!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(o=z1(t),o!==null){for(e.flags|=128,Vm(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Jn(_i,_i.current&1|2),e.child}t=t.sibling}s.tail!==null&&Hi()>wf&&(e.flags|=128,i=!0,Vm(s,!1),e.lanes=4194304)}else{if(!i)if(t=z1(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vm(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!hi)return qr(e),null}else 2*Hi()-s.renderingStartTime>wf&&n!==1073741824&&(e.flags|=128,i=!0,Vm(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Hi(),e.sibling=null,n=_i.current,Jn(_i,i?n&1|2:n&1),e):(qr(e),null);case 22:case 23:return uM(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&(e.mode&1)!==0?(co&1073741824)!==0&&(qr(e),e.subtreeFlags&6&&(e.flags|=8192)):qr(e),null;case 24:return null;case 25:return null}throw Error(nt(156,e.tag))}function xV(t,e){switch(GT(e),e.tag){case 1:return Us(e.type)&&I1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Sf(),ri(Bs),ri(Kr),QT(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 5:return ZT(e),null;case 13:if(ri(_i),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(nt(340));yf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ri(_i),null;case 4:return Sf(),null;case 10:return YT(e.type._context),null;case 22:case 23:return uM(),null;case 24:return null;default:return null}}var d1=!1,Yr=!1,SV=typeof WeakSet=="function"?WeakSet:Set,At=null;function cf(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){ki(t,e,i)}else n.current=null}function yT(t,e,n){try{n()}catch(i){ki(t,e,i)}}var _I=!1;function bV(t,e){if(nT=k1,t=fR(),WT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,p=null;t:for(;;){for(var m;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(m=d.firstChild)!==null;)p=d,d=m;for(;;){if(d===t)break t;if(p===n&&++c===r&&(a=o),p===s&&++u===i&&(l=o),(m=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(iT={focusedElem:t,selectionRange:n},k1=!1,At=e;At!==null;)if(e=At,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,At=t;else for(;At!==null;){e=At;try{var g=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var _=g.memoizedProps,y=g.memoizedState,v=e.stateNode,S=v.getSnapshotBeforeUpdate(e.elementType===e.type?_:_a(e.type,_),y);v.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(nt(163))}}catch(w){ki(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,At=t;break}At=e.return}return g=_I,_I=!1,g}function ng(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&yT(e,n,s)}r=r.next}while(r!==i)}}function nx(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function xT(t){var e=t.ref;if(e!==null){var n=t.stateNode;t.tag,t=n,typeof e=="function"?e(t):e.current=t}}function cN(t){var e=t.alternate;e!==null&&(t.alternate=null,cN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[sl],delete e[mg],delete e[oT],delete e[rV],delete e[sV])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function uN(t){return t.tag===5||t.tag===3||t.tag===4}function yI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||uN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ST(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=D1));else if(i!==4&&(t=t.child,t!==null))for(ST(t,e,n),t=t.sibling;t!==null;)ST(t,e,n),t=t.sibling}function bT(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(bT(t,e,n),t=t.sibling;t!==null;)bT(t,e,n),t=t.sibling}var Pr=null,ya=!1;function Hc(t,e,n){for(n=n.child;n!==null;)hN(t,e,n),n=n.sibling}function hN(t,e,n){if(ol&&typeof ol.onCommitFiberUnmount=="function")try{ol.onCommitFiberUnmount(Y1,n)}catch{}switch(n.tag){case 5:Yr||cf(n,e);case 6:var i=Pr,r=ya;Pr=null,Hc(t,e,n),Pr=i,ya=r,Pr!==null&&(ya?(t=Pr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pr.removeChild(n.stateNode));break;case 18:Pr!==null&&(ya?(t=Pr,n=n.stateNode,t.nodeType===8?CC(t.parentNode,n):t.nodeType===1&&CC(t,n),ug(t)):CC(Pr,n.stateNode));break;case 4:i=Pr,r=ya,Pr=n.stateNode.containerInfo,ya=!0,Hc(t,e,n),Pr=i,ya=r;break;case 0:case 11:case 14:case 15:if(!Yr&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&((s&2)!==0||(s&4)!==0)&&yT(n,e,o),r=r.next}while(r!==i)}Hc(t,e,n);break;case 1:if(!Yr&&(cf(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){ki(n,e,a)}Hc(t,e,n);break;case 21:Hc(t,e,n);break;case 22:n.mode&1?(Yr=(i=Yr)||n.memoizedState!==null,Hc(t,e,n),Yr=i):Hc(t,e,n);break;default:Hc(t,e,n)}}function xI(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new SV),e.forEach(function(i){var r=PV.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function va(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Pr=a.stateNode,ya=!1;break e;case 3:Pr=a.stateNode.containerInfo,ya=!0;break e;case 4:Pr=a.stateNode.containerInfo,ya=!0;break e}a=a.return}if(Pr===null)throw Error(nt(160));hN(s,o,r),Pr=null,ya=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){ki(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dN(e,t),e=e.sibling}function dN(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(va(e,t),il(t),i&4){try{ng(3,t,t.return),nx(3,t)}catch(_){ki(t,t.return,_)}try{ng(5,t,t.return)}catch(_){ki(t,t.return,_)}}break;case 1:va(e,t),il(t),i&512&&n!==null&&cf(n,n.return);break;case 5:if(va(e,t),il(t),i&512&&n!==null&&cf(n,n.return),t.flags&32){var r=t.stateNode;try{og(r,"")}catch(_){ki(t,t.return,_)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&RI(r,s),XC(a,o);var c=XC(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?FI(r,d):u==="dangerouslySetInnerHTML"?BI(r,d):u==="children"?og(r,d):kT(r,u,d,c)}switch(a){case"input":HC(r,s);break;case"textarea":NI(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?hf(r,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?hf(r,!!s.multiple,s.defaultValue,!0):hf(r,!!s.multiple,s.multiple?[]:"",!1))}r[mg]=s}catch(_){ki(t,t.return,_)}}break;case 6:if(va(e,t),il(t),i&4){if(t.stateNode===null)throw Error(nt(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(_){ki(t,t.return,_)}}break;case 3:if(va(e,t),il(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{ug(e.containerInfo)}catch(_){ki(t,t.return,_)}break;case 4:va(e,t),il(t);break;case 13:va(e,t),il(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(lM=Hi())),i&4&&xI(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Yr=(c=Yr)||u,va(e,t),Yr=c):va(e,t),il(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&(t.mode&1)!==0)for(At=t,u=t.child;u!==null;){for(d=At=u;At!==null;){switch(p=At,m=p.child,p.tag){case 0:case 11:case 14:case 15:ng(4,p,p.return);break;case 1:cf(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){i=p,n=p.return;try{e=i,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(_){ki(i,n,_)}}break;case 5:cf(p,p.return);break;case 22:if(p.memoizedState!==null){bI(d);continue}}m!==null?(m.return=p,At=m):bI(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=UI("display",o))}catch(_){ki(t,t.return,_)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(_){ki(t,t.return,_)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:va(e,t),il(t),i&4&&xI(t);break;case 21:break;default:va(e,t),il(t)}}function il(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(uN(n)){var i=n;break e}n=n.return}throw Error(nt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(og(r,""),i.flags&=-33);var s=yI(t);bT(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=yI(t);ST(t,a,o);break;default:throw Error(nt(161))}}catch(l){ki(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function wV(t,e,n){At=t,fN(t,e,n)}function fN(t,e,n){for(var i=(t.mode&1)!==0;At!==null;){var r=At,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||d1;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Yr;a=d1;var c=Yr;if(d1=o,(Yr=l)&&!c)for(At=r;At!==null;)o=At,l=o.child,o.tag===22&&o.memoizedState!==null?wI(r):l!==null?(l.return=o,At=l):wI(r);for(;s!==null;)At=s,fN(s,e,n),s=s.sibling;At=r,d1=a,Yr=c}SI(t,e,n)}else(r.subtreeFlags&8772)!==0&&s!==null?(s.return=r,At=s):SI(t,e,n)}}function SI(t){for(;At!==null;){var e=At;if((e.flags&8772)!==0){var n=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:Yr||nx(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Yr)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:_a(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&sI(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}sI(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ug(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(nt(163))}Yr||e.flags&512&&xT(e)}catch(p){ki(e,e.return,p)}}if(e===t){At=null;break}if(n=e.sibling,n!==null){n.return=e.return,At=n;break}At=e.return}}function bI(t){for(;At!==null;){var e=At;if(e===t){At=null;break}var n=e.sibling;if(n!==null){n.return=e.return,At=n;break}At=e.return}}function wI(t){for(;At!==null;){var e=At;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nx(4,e)}catch(l){ki(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){ki(e,r,l)}}var s=e.return;try{xT(e)}catch(l){ki(e,s,l)}break;case 5:var o=e.return;try{xT(e)}catch(l){ki(e,o,l)}}}catch(l){ki(e,e.return,l)}if(e===t){At=null;break}var a=e.sibling;if(a!==null){a.return=e.return,At=a;break}At=e.return}}var EV=Math.ceil,V1=Jl.ReactCurrentDispatcher,oM=Jl.ReactCurrentOwner,Yo=Jl.ReactCurrentBatchConfig,Cn=0,vr=null,Xi=null,Dr=0,co=0,uf=su(0),ir=0,Sg=null,Eh=0,ix=0,aM=0,ig=null,Ns=null,lM=0,wf=1/0,Wl=null,G1=!1,wT=null,Qc=null,f1=!1,qc=null,j1=0,rg=0,ET=null,S1=-1,b1=0;function ms(){return(Cn&6)!==0?Hi():S1!==-1?S1:S1=Hi()}function eu(t){return(t.mode&1)===0?1:(Cn&2)!==0&&Dr!==0?Dr&-Dr:aV.transition!==null?(b1===0&&(b1=JI()),b1):(t=Bn,t!==0||(t=window.event,t=t===void 0?16:rR(t.type)),t)}function ba(t,e,n,i){if(50<rg)throw rg=0,ET=null,Error(nt(185));bg(t,n,i),((Cn&2)===0||t!==vr)&&(t===vr&&((Cn&2)===0&&(ix|=n),ir===4&&jc(t,Dr)),Fs(t,i),n===1&&Cn===0&&(e.mode&1)===0&&(wf=Hi()+500,Q1&&ou()))}function Fs(t,e){var n=t.callbackNode;cW(t,e);var i=A1(t,t===vr?Dr:0);if(i===0)n!==null&&PD(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&PD(n),e===1)t.tag===0?oV(EI.bind(null,t)):wR(EI.bind(null,t)),nV(function(){(Cn&6)===0&&ou()}),n=null;else{switch(ZI(i)){case 1:n=RT;break;case 4:n=KI;break;case 16:n=M1;break;case 536870912:n=$I;break;default:n=M1}n=SN(n,pN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function pN(t,e){if(S1=-1,b1=0,(Cn&6)!==0)throw Error(nt(327));var n=t.callbackNode;if(gf()&&t.callbackNode!==n)return null;var i=A1(t,t===vr?Dr:0);if(i===0)return null;if((i&30)!==0||(i&t.expiredLanes)!==0||e)e=X1(t,i);else{e=i;var r=Cn;Cn|=2;var s=gN();(vr!==t||Dr!==e)&&(Wl=null,wf=Hi()+500,yh(t,e));do try{MV();break}catch(a){mN(t,a)}while(!0);qT(),V1.current=s,Cn=r,Xi!==null?e=0:(vr=null,Dr=0,e=ir)}if(e!==0){if(e===2&&(r=JC(t),r!==0&&(i=r,e=CT(t,r))),e===1)throw n=Sg,yh(t,0),jc(t,i),Fs(t,Hi()),n;if(e===6)jc(t,i);else{if(r=t.current.alternate,(i&30)===0&&!CV(r)&&(e=X1(t,i),e===2&&(s=JC(t),s!==0&&(i=s,e=CT(t,s))),e===1))throw n=Sg,yh(t,0),jc(t,i),Fs(t,Hi()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(nt(345));case 2:mh(t,Ns,Wl);break;case 3:if(jc(t,i),(i&130023424)===i&&(e=lM+500-Hi(),10<e)){if(A1(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){ms(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=sT(mh.bind(null,t,Ns,Wl),e);break}mh(t,Ns,Wl);break;case 4:if(jc(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Sa(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Hi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*EV(i/1960))-i,10<i){t.timeoutHandle=sT(mh.bind(null,t,Ns,Wl),i);break}mh(t,Ns,Wl);break;case 5:mh(t,Ns,Wl);break;default:throw Error(nt(329))}}}return Fs(t,Hi()),t.callbackNode===n?pN.bind(null,t):null}function CT(t,e){var n=ig;return t.current.memoizedState.isDehydrated&&(yh(t,e).flags|=256),t=X1(t,e),t!==2&&(e=Ns,Ns=n,e!==null&&TT(e)),t}function TT(t){Ns===null?Ns=t:Ns.push.apply(Ns,t)}function CV(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!wa(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jc(t,e){for(e&=~aM,e&=~ix,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Sa(e),i=1<<n;t[n]=-1,e&=~i}}function EI(t){if((Cn&6)!==0)throw Error(nt(327));gf();var e=A1(t,0);if((e&1)===0)return Fs(t,Hi()),null;var n=X1(t,e);if(t.tag!==0&&n===2){var i=JC(t);i!==0&&(e=i,n=CT(t,i))}if(n===1)throw n=Sg,yh(t,0),jc(t,e),Fs(t,Hi()),n;if(n===6)throw Error(nt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,mh(t,Ns,Wl),Fs(t,Hi()),null}function cM(t,e){var n=Cn;Cn|=1;try{return t(e)}finally{Cn=n,Cn===0&&(wf=Hi()+500,Q1&&ou())}}function Ch(t){qc!==null&&qc.tag===0&&(Cn&6)===0&&gf();var e=Cn;Cn|=1;var n=Yo.transition,i=Bn;try{if(Yo.transition=null,Bn=1,t)return t()}finally{Bn=i,Yo.transition=n,Cn=e,(Cn&6)===0&&ou()}}function uM(){co=uf.current,ri(uf)}function yh(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,tV(n)),Xi!==null)for(n=Xi.return;n!==null;){var i=n;switch(GT(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&I1();break;case 3:Sf(),ri(Bs),ri(Kr),QT();break;case 5:ZT(i);break;case 4:Sf();break;case 13:ri(_i);break;case 19:ri(_i);break;case 10:YT(i.type._context);break;case 22:case 23:uM()}n=n.return}if(vr=t,Xi=t=tu(t.current,null),Dr=co=e,ir=0,Sg=null,aM=ix=Eh=0,Ns=ig=null,vh!==null){for(e=0;e<vh.length;e++)if(n=vh[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}vh=null}return t}function mN(t,e){do{var n=Xi;try{if(qT(),_1.current=W1,H1){for(var i=yi.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}H1=!1}if(wh=0,gr=nr=yi=null,tg=!1,_g=0,oM.current=null,n===null||n.return===null){ir=1,Sg=e,Xi=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Dr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if((u.mode&1)===0&&(d===0||d===11||d===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=hI(o);if(m!==null){m.flags&=-257,dI(m,o,a,s,e),m.mode&1&&uI(s,c,e),e=m,l=c;var g=e.updateQueue;if(g===null){var _=new Set;_.add(l),e.updateQueue=_}else g.add(l);break e}else{if((e&1)===0){uI(s,c,e),hM();break e}l=Error(nt(426))}}else if(hi&&a.mode&1){var y=hI(o);if(y!==null){(y.flags&65536)===0&&(y.flags|=256),dI(y,o,a,s,e),jT(bf(l,a));break e}}s=l=bf(l,a),ir!==4&&(ir=2),ig===null?ig=[s]:ig.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=ZR(s,l,e);rI(s,v);break e;case 1:a=l;var S=s.type,b=s.stateNode;if((s.flags&128)===0&&(typeof S.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Qc===null||!Qc.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=QR(s,a,e);rI(s,w);break e}}s=s.return}while(s!==null)}_N(n)}catch(C){e=C,Xi===n&&n!==null&&(Xi=n=n.return);continue}break}while(!0)}function gN(){var t=V1.current;return V1.current=W1,t===null?W1:t}function hM(){(ir===0||ir===3||ir===2)&&(ir=4),vr===null||(Eh&268435455)===0&&(ix&268435455)===0||jc(vr,Dr)}function X1(t,e){var n=Cn;Cn|=2;var i=gN();(vr!==t||Dr!==e)&&(Wl=null,yh(t,e));do try{TV();break}catch(r){mN(t,r)}while(!0);if(qT(),Cn=n,V1.current=i,Xi!==null)throw Error(nt(261));return vr=null,Dr=0,ir}function TV(){for(;Xi!==null;)vN(Xi)}function MV(){for(;Xi!==null&&!eW();)vN(Xi)}function vN(t){var e=xN(t.alternate,t,co);t.memoizedProps=t.pendingProps,e===null?_N(t):Xi=e,oM.current=null}function _N(t){var e=t;do{var n=e.alternate;if(t=e.return,(e.flags&32768)===0){if(n=yV(n,e,co),n!==null){Xi=n;return}}else{if(n=xV(n,e),n!==null){n.flags&=32767,Xi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ir=6,Xi=null;return}}if(e=e.sibling,e!==null){Xi=e;return}Xi=e=t}while(e!==null);ir===0&&(ir=5)}function mh(t,e,n){var i=Bn,r=Yo.transition;try{Yo.transition=null,Bn=1,AV(t,e,n,i)}finally{Yo.transition=r,Bn=i}return null}function AV(t,e,n,i){do gf();while(qc!==null);if((Cn&6)!==0)throw Error(nt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(nt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(uW(t,s),t===vr&&(Xi=vr=null,Dr=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||f1||(f1=!0,SN(M1,function(){return gf(),null})),s=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||s){s=Yo.transition,Yo.transition=null;var o=Bn;Bn=1;var a=Cn;Cn|=4,oM.current=null,bV(t,n),dN(n,t),$W(iT),k1=!!nT,iT=nT=null,t.current=n,wV(n,t,r),tW(),Cn=a,Bn=o,Yo.transition=s}else t.current=n;if(f1&&(f1=!1,qc=t,j1=r),s=t.pendingLanes,s===0&&(Qc=null),rW(n.stateNode,i),Fs(t,Hi()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(G1)throw G1=!1,t=wT,wT=null,t;return(j1&1)!==0&&t.tag!==0&&gf(),s=t.pendingLanes,(s&1)!==0?t===ET?rg++:(rg=0,ET=t):rg=0,ou(),null}function gf(){if(qc!==null){var t=ZI(j1),e=Yo.transition,n=Bn;try{if(Yo.transition=null,Bn=16>t?16:t,qc===null)var i=!1;else{if(t=qc,qc=null,j1=0,(Cn&6)!==0)throw Error(nt(331));var r=Cn;for(Cn|=4,At=t.current;At!==null;){var s=At,o=s.child;if((At.flags&16)!==0){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(At=c;At!==null;){var u=At;switch(u.tag){case 0:case 11:case 15:ng(8,u,s)}var d=u.child;if(d!==null)d.return=u,At=d;else for(;At!==null;){u=At;var p=u.sibling,m=u.return;if(cN(u),u===c){At=null;break}if(p!==null){p.return=m,At=p;break}At=m}}}var g=s.alternate;if(g!==null){var _=g.child;if(_!==null){g.child=null;do{var y=_.sibling;_.sibling=null,_=y}while(_!==null)}}At=s}}if((s.subtreeFlags&2064)!==0&&o!==null)o.return=s,At=o;else e:for(;At!==null;){if(s=At,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:ng(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,At=v;break e}At=s.return}}var S=t.current;for(At=S;At!==null;){o=At;var b=o.child;if((o.subtreeFlags&2064)!==0&&b!==null)b.return=o,At=b;else e:for(o=S;At!==null;){if(a=At,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:nx(9,a)}}catch(C){ki(a,a.return,C)}if(a===o){At=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,At=w;break e}At=a.return}}if(Cn=r,ou(),ol&&typeof ol.onPostCommitFiberRoot=="function")try{ol.onPostCommitFiberRoot(Y1,t)}catch{}i=!0}return i}finally{Bn=n,Yo.transition=e}}return!1}function CI(t,e,n){e=bf(n,e),e=ZR(t,e,1),t=Zc(t,e,1),e=ms(),t!==null&&(bg(t,1,e),Fs(t,e))}function ki(t,e,n){if(t.tag===3)CI(t,t,n);else for(;e!==null;){if(e.tag===3){CI(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Qc===null||!Qc.has(i))){t=bf(n,t),t=QR(e,t,1),e=Zc(e,t,1),t=ms(),e!==null&&(bg(e,1,t),Fs(e,t));break}}e=e.return}}function kV(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=ms(),t.pingedLanes|=t.suspendedLanes&n,vr===t&&(Dr&n)===n&&(ir===4||ir===3&&(Dr&130023424)===Dr&&500>Hi()-lM?yh(t,0):aM|=n),Fs(t,e)}function yN(t,e){e===0&&((t.mode&1)===0?e=1:(e=Qy,Qy<<=1,(Qy&130023424)===0&&(Qy=4194304)));var n=ms();t=Kl(t,e),t!==null&&(bg(t,e,n),Fs(t,n))}function LV(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),yN(t,n)}function PV(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(nt(314))}i!==null&&i.delete(e),yN(t,n)}var xN;xN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Bs.current)Os=!0;else{if((t.lanes&n)===0&&(e.flags&128)===0)return Os=!1,_V(t,e,n);Os=(t.flags&131072)!==0}else Os=!1,hi&&(e.flags&1048576)!==0&&ER(e,O1,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;x1(t,e),t=e.pendingProps;var r=_f(e,Kr.current);mf(e,n),r=tM(null,e,i,t,r,n);var s=nM();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Us(i)?(s=!0,R1(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,$T(e),r.updater=tx,e.stateNode=r,r._reactInternals=e,dT(e,i,t,n),e=mT(null,e,i,!0,s,n)):(e.tag=0,hi&&s&&VT(e),ps(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(x1(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=IV(i),t=_a(i,t),r){case 0:e=pT(null,e,i,t,n);break e;case 1:e=mI(null,e,i,t,n);break e;case 11:e=fI(null,e,i,t,n);break e;case 14:e=pI(null,e,i,_a(i.type,t),n);break e}throw Error(nt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:_a(i,r),pT(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:_a(i,r),mI(t,e,i,r,n);case 3:e:{if(iN(e),t===null)throw Error(nt(387));i=e.pendingProps,s=e.memoizedState,r=s.element,LR(t,e),F1(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=bf(Error(nt(423)),e),e=gI(t,e,i,n,r);break e}else if(i!==r){r=bf(Error(nt(424)),e),e=gI(t,e,i,n,r);break e}else for(uo=Jc(e.stateNode.containerInfo.firstChild),ho=e,hi=!0,xa=null,n=AR(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(yf(),i===r){e=$l(t,e,n);break e}ps(t,e,i,n)}e=e.child}return e;case 5:return PR(e),t===null&&cT(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,rT(i,r)?o=null:s!==null&&rT(i,s)&&(e.flags|=32),nN(t,e),ps(t,e,o,n),e.child;case 6:return t===null&&cT(e),null;case 13:return rN(t,e,n);case 4:return JT(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=xf(e,null,i,n):ps(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:_a(i,r),fI(t,e,i,r,n);case 7:return ps(t,e,e.pendingProps,n),e.child;case 8:return ps(t,e,e.pendingProps.children,n),e.child;case 12:return ps(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Jn(B1,i._currentValue),i._currentValue=o,s!==null)if(wa(s.value,o)){if(s.children===r.children&&!Bs.current){e=$l(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Xl(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),uT(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(nt(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),uT(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ps(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,mf(e,n),r=Ko(r),i=i(r),e.flags|=1,ps(t,e,i,n),e.child;case 14:return i=e.type,r=_a(i,e.pendingProps),r=_a(i.type,r),pI(t,e,i,r,n);case 15:return eN(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:_a(i,r),x1(t,e),e.tag=1,Us(i)?(t=!0,R1(e)):t=!1,mf(e,n),JR(e,i,r),dT(e,i,r,n),mT(null,e,i,!0,t,n);case 19:return sN(t,e,n);case 22:return tN(t,e,n)}throw Error(nt(156,e.tag))};function SN(t,e){return YI(t,e)}function DV(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qo(t,e,n,i){return new DV(t,e,n,i)}function dM(t){return t=t.prototype,!(!t||!t.isReactComponent)}function IV(t){if(typeof t=="function")return dM(t)?1:0;if(t!=null){if(t=t.$$typeof,t===PT)return 11;if(t===DT)return 14}return 2}function tu(t,e){var n=t.alternate;return n===null?(n=qo(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function w1(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")dM(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qd:return xh(n.children,r,s,e);case LT:o=8,r|=8;break;case OC:return t=qo(12,n,e,r|2),t.elementType=OC,t.lanes=s,t;case BC:return t=qo(13,n,e,r),t.elementType=BC,t.lanes=s,t;case UC:return t=qo(19,n,e,r),t.elementType=UC,t.lanes=s,t;case PI:return rx(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case kI:o=10;break e;case LI:o=9;break e;case PT:o=11;break e;case DT:o=14;break e;case Wc:o=16,i=null;break e}throw Error(nt(130,t==null?t:typeof t,""))}return e=qo(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function xh(t,e,n,i){return t=qo(7,t,i,e),t.lanes=n,t}function rx(t,e,n,i){return t=qo(22,t,i,e),t.elementType=PI,t.lanes=n,t.stateNode={isHidden:!1},t}function IC(t,e,n){return t=qo(6,t,null,e),t.lanes=n,t}function RC(t,e,n){return e=qo(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RV(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vC(0),this.expirationTimes=vC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vC(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function fM(t,e,n,i,r,s,o,a,l){return t=new RV(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=qo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$T(s),t}function NV(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zd,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function bN(t){if(!t)return iu;t=t._reactInternals;e:{if(Mh(t)!==t||t.tag!==1)throw Error(nt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Us(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(nt(171))}if(t.tag===1){var n=t.type;if(Us(n))return bR(t,n,e)}return e}function wN(t,e,n,i,r,s,o,a,l){return t=fM(n,i,!0,t,r,s,o,a,l),t.context=bN(null),n=t.current,i=ms(),r=eu(n),s=Xl(i,r),s.callback=e??null,Zc(n,s,r),t.current.lanes=r,bg(t,r,i),Fs(t,i),t}function sx(t,e,n,i){var r=e.current,s=ms(),o=eu(r);return n=bN(n),e.context===null?e.context=n:e.pendingContext=n,e=Xl(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Zc(r,e,o),t!==null&&(ba(t,r,o,s),v1(t,r,o)),o}function q1(t){return t=t.current,t.child?(t.child.tag===5,t.child.stateNode):null}function TI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function pM(t,e){TI(t,e),(t=t.alternate)&&TI(t,e)}function OV(){return null}var EN=typeof reportError=="function"?reportError:function(t){console.error(t)};function mM(t){this._internalRoot=t}ox.prototype.render=mM.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(nt(409));sx(t,e,null,null)};ox.prototype.unmount=mM.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ch(function(){sx(null,t,null,null)}),e[Yl]=null}};function ox(t){this._internalRoot=t}ox.prototype.unstable_scheduleHydration=function(t){if(t){var e=tR();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Gc.length&&e!==0&&e<Gc[n].priority;n++);Gc.splice(n,0,t),n===0&&iR(t)}};function gM(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ax(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function MI(){}function BV(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=q1(o);s.call(c)}}var o=wN(e,i,t,0,null,!1,!1,"",MI);return t._reactRootContainer=o,t[Yl]=o.current,fg(t.nodeType===8?t.parentNode:t),Ch(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var c=q1(l);a.call(c)}}var l=fM(t,0,!1,null,null,!1,!1,"",MI);return t._reactRootContainer=l,t[Yl]=l.current,fg(t.nodeType===8?t.parentNode:t),Ch(function(){sx(e,l,n,i)}),l}function lx(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=q1(o);a.call(l)}}sx(e,o,t,r)}else o=BV(n,e,t,r,i);return q1(o)}QI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ym(e.pendingLanes);n!==0&&(NT(e,n|1),Fs(e,Hi()),(Cn&6)===0&&(wf=Hi()+500,ou()))}break;case 13:Ch(function(){var i=Kl(t,1);if(i!==null){var r=ms();ba(i,t,1,r)}}),pM(t,1)}};OT=function(t){if(t.tag===13){var e=Kl(t,134217728);if(e!==null){var n=ms();ba(e,t,134217728,n)}pM(t,134217728)}};eR=function(t){if(t.tag===13){var e=eu(t),n=Kl(t,e);if(n!==null){var i=ms();ba(n,t,e,i)}pM(t,e)}};tR=function(){return Bn};nR=function(t,e){var n=Bn;try{return Bn=t,e()}finally{Bn=n}};YC=function(t,e,n){switch(e){case"input":if(HC(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=Z1(i);if(!r)throw Error(nt(90));II(i),HC(i,r)}}}break;case"textarea":NI(t,n);break;case"select":e=n.value,e!=null&&hf(t,!!n.multiple,e,!1)}};WI=cM;VI=Ch;var UV={usingClientEntryPoint:!1,Events:[Eg,rf,Z1,zI,HI,cM]},Gm={findFiberByHostInstance:gh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FV={bundleType:Gm.bundleType,version:Gm.version,rendererPackageName:Gm.rendererPackageName,rendererConfig:Gm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=XI(t),t===null?null:t.stateNode},findFiberByHostInstance:Gm.findFiberByHostInstance||OV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(jm=__REACT_DEVTOOLS_GLOBAL_HOOK__,!jm.isDisabled&&jm.supportsFiber))try{Y1=jm.inject(FV),ol=jm}catch{}var jm;mo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UV;mo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gM(e))throw Error(nt(200));return NV(t,e,null,n)};mo.createRoot=function(t,e){if(!gM(t))throw Error(nt(299));var n=!1,i="",r=EN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=fM(t,1,!1,null,null,n,!1,i,r),t[Yl]=e.current,fg(t.nodeType===8?t.parentNode:t),new mM(e)};mo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(nt(188)):(t=Object.keys(t).join(","),Error(nt(268,t)));return t=XI(e),t=t===null?null:t.stateNode,t};mo.flushSync=function(t){return Ch(t)};mo.hydrate=function(t,e,n){if(!ax(e))throw Error(nt(200));return lx(null,t,e,!0,n)};mo.hydrateRoot=function(t,e,n){if(!gM(t))throw Error(nt(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=EN;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=wN(e,null,t,1,n??null,r,!1,s,o),t[Yl]=e.current,fg(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new ox(e)};mo.render=function(t,e,n){if(!ax(e))throw Error(nt(200));return lx(null,t,e,!1,n)};mo.unmountComponentAtNode=function(t){if(!ax(t))throw Error(nt(40));return t._reactRootContainer?(Ch(function(){lx(null,null,t,!1,function(){t._reactRootContainer=null,t[Yl]=null})}),!0):!1};mo.unstable_batchedUpdates=cM;mo.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!ax(n))throw Error(nt(200));if(t==null||t._reactInternals===void 0)throw Error(nt(38));return lx(t,e,n,!1,i)};mo.version="18.3.1-next-f1338f8080-20240426"});var AN=Kn((Sie,MN)=>{"use strict";function TN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(TN)}catch(t){console.error(t)}}TN(),MN.exports=CN()});var LN=Kn(vM=>{"use strict";var kN=AN();vM.createRoot=kN.createRoot,vM.hydrateRoot=kN.hydrateRoot;var bie});function K2(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Xf(t,e){return new zV[t](e)}function b4(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ep(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function $2(){let t=ep("canvas");return t.style.display="block",t}function w4(t){xu=t}function E4(){return xu}function tp(...t){let e="THREE."+t.shift();xu?xu("log",e,...t):console.log(e,...t)}function ut(...t){let e="THREE."+t.shift();xu?xu("warn",e,...t):console.warn(e,...t)}function It(...t){let e="THREE."+t.shift();xu?xu("error",e,...t):console.error(e,...t)}function Vh(...t){let e=t.join(" ");e in PN||(PN[e]=!0,ut(...t))}function C4(t,e,n){return new Promise(function(i,r){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}setTimeout(s,n)})}function yo(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return($r[t&255]+$r[t>>8&255]+$r[t>>16&255]+$r[t>>24&255]+"-"+$r[e&255]+$r[e>>8&255]+"-"+$r[e>>16&15|64]+$r[e>>24&255]+"-"+$r[n&63|128]+$r[n>>8&255]+"-"+$r[n>>16&255]+$r[n>>24&255]+$r[i&255]+$r[i>>8&255]+$r[i>>16&255]+$r[i>>24&255]).toLowerCase()}function Ht(t,e,n){return Math.max(e,Math.min(n,t))}function J2(t,e){return(t%e+e)%e}function HV(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function WV(t,e,n){return t!==e?(n-t)/(e-t):0}function zg(t,e,n){return(1-n)*t+n*e}function VV(t,e,n,i){return zg(t,e,1-Math.exp(-n*i))}function GV(t,e=1){return e-Math.abs(J2(t,e*2)-e)}function jV(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function XV(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function qV(t,e){return t+Math.floor(Math.random()*(e-t+1))}function YV(t,e){return t+Math.random()*(e-t)}function KV(t){return t*(.5-Math.random())}function $V(t){t!==void 0&&(DN=t);let e=DN+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function JV(t){return t*Hh}function ZV(t){return t*Gh}function QV(t){return(t&t-1)===0&&t!==0}function eG(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function tG(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function nG(t,e,n,i,r){let s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),u=o((e+i)/2),d=s((e-i)/2),p=o((e-i)/2),m=s((i-e)/2),g=o((i-e)/2);switch(r){case"XYX":t.set(a*u,l*d,l*p,a*c);break;case"YZY":t.set(l*p,a*u,l*d,a*c);break;case"ZXZ":t.set(l*d,l*p,a*u,a*c);break;case"XZX":t.set(a*u,l*g,l*m,a*c);break;case"YXY":t.set(l*m,a*u,l*g,a*c);break;case"ZYZ":t.set(l*g,l*m,a*u,a*c);break;default:ut("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ys(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Qt(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}function iG(){let t={enabled:!0,workingColorSpace:yu,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===Dn&&(r.r=oc(r.r),r.g=oc(r.g),r.b=oc(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Dn&&(r.r=qf(r.r),r.g=qf(r.g),r.b=qf(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===pl?Zf:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return Vh("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return Vh("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[yu]:{primaries:e,whitePoint:i,transfer:Zf,toXYZ:RN,fromXYZ:NN,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:_s},outputColorSpaceConfig:{drawingBufferColorSpace:_s}},[_s]:{primaries:e,whitePoint:i,transfer:Dn,toXYZ:RN,fromXYZ:NN,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:_s}}}),t}function oc(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function qf(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}function xM(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?Xg.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(ut("Texture: Unable to serialize Texture."),{})}function bM(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){kh.fromArray(t,s);let a=r.x*Math.abs(kh.x)+r.y*Math.abs(kh.y)+r.z*Math.abs(kh.z),l=e.dot(kh),c=n.dot(kh),u=i.dot(kh);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}function NM(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}function pG(){let t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){let c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}let s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;(c&8388608)===0;)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Hs(t){Math.abs(t)>65504&&ut("DataUtils.toHalfFloat(): Value out of range."),t=Ht(t,-65504,65504),rc.floatView[0]=t;let e=rc.uint32View[0],n=e>>23&511;return rc.baseTable[n]+((e&8388607)>>rc.shiftTable[n])}function Bg(t){let e=t>>10;return rc.uint32View[0]=rc.mantissaTable[rc.offsetTable[e]+(t&1023)]+rc.exponentTable[e],rc.floatView[0]}function vG(t,e,n,i,r,s,o,a){let l;if(e.side===es?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===hl,a),l===null)return null;wx.copy(a),wx.applyMatrix4(t.matrixWorld);let c=n.ray.origin.distanceTo(wx);return c<n.near||c>n.far?null:{distance:c,point:wx.clone(),object:t}}function Ex(t,e,n,i,r,s,o,a,l,c){t.getVertexPosition(a,yx),t.getVertexPosition(l,xx),t.getVertexPosition(c,Sx);let u=vG(t,e,n,i,yx,xx,Sx,XN);if(u){let d=new Y;Ma.getBarycoord(XN,yx,xx,Sx,d),r&&(u.uv=Ma.getInterpolatedAttribute(r,a,l,c,d,new We)),s&&(u.uv1=Ma.getInterpolatedAttribute(s,a,l,c,d,new We)),o&&(u.normal=Ma.getInterpolatedAttribute(o,a,l,c,d,new Y),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));let p={a,b:l,c,normal:new Y,materialIndex:0};Ma.getNormal(yx,xx,Sx,p.normal),u.face=p,u.barycoord=d}return u}function ud(t){let e={};for(let n in t){e[n]={};for(let i in t[n]){let r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(ut("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function ns(t){let e={};for(let n=0;n<t.length;n++){let i=ud(t[n]);for(let r in i)e[r]=i[r]}return e}function _G(t){let e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function Z2(t){let e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:yn.workingColorSpace}function Mx(t,e,n,i,r,s){Hf.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(Pg.x=s*Hf.x-r*Hf.y,Pg.y=r*Hf.x+s*Hf.y):Pg.copy(Hf),t.copy(e),t.x+=Pg.x,t.y+=Pg.y,t.applyMatrix4(A4)}function WM(t,e){return t-e}function AG(t,e){return t.z-e.z}function kG(t,e){return e.z-t.z}function IG(t,e,n=0){let i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){let r=t.count;for(let s=0;s<r;s++)for(let o=0;o<i;o++)e.setComponent(s+n,o,t.getComponent(s,o))}else e.array.set(t.array,n*i);e.needsUpdate=!0}function Ih(t,e){if(t.constructor!==e.constructor){let n=Math.min(t.length,e.length);for(let i=0;i<n;i++)e[i]=t[i]}else{let n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}function Nx(t,e,n,i,r,s,o){let a=t.geometry.attributes.position;if(lS.fromBufferAttribute(a,r),cS.fromBufferAttribute(a,s),n.distanceSqToSegment(lS,cS,GM,cO)>i)return;GM.applyMatrix4(t.matrixWorld);let c=e.ray.origin.distanceTo(GM);if(!(c<e.near||c>e.far))return{distance:c,point:cO.clone().applyMatrix4(t.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:t}}function fO(t,e,n,i,r,s,o){let a=n2.distanceSqToPoint(t);if(a<n){let l=new Y;n2.closestPointToPoint(t,l),l.applyMatrix4(i);let c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}function Q2(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let p=(o-s)/c-(a-s)/(c+u)+(a-o)/u,m=(a-o)/u-(l-o)/(u+d)+(l-a)/d;p*=u,m*=u,r(o,a,p,m)},calc:function(s){let o=s*s,a=o*s;return t+e*s+n*o+i*a}}}function pO(t,e,n,i,r){let s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function RG(t,e){let n=1-t;return n*n*e}function NG(t,e){return 2*(1-t)*t*e}function OG(t,e){return t*t*e}function Hg(t,e,n,i){return RG(t,e)+NG(t,n)+OG(t,i)}function BG(t,e){let n=1-t;return n*n*n*e}function UG(t,e){let n=1-t;return 3*n*n*t*e}function FG(t,e){return 3*(1-t)*t*t*e}function zG(t,e){return t*t*t*e}function Wg(t,e,n,i,r){return BG(t,e)+UG(t,n)+FG(t,i)+zG(t,r)}function HG(t,e,n=2){let i=e&&e.length,r=i?e[0]*n:t.length,s=k4(t,0,r,n,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c;if(i&&(s=XG(t,e,s,n)),t.length>80*n){a=t[0],l=t[1];let u=a,d=l;for(let p=n;p<r;p+=n){let m=t[p],g=t[p+1];m<a&&(a=m),g<l&&(l=g),m>u&&(u=m),g>d&&(d=g)}c=Math.max(u-a,d-l),c=c!==0?32767/c:0}return gv(s,o,n,a,l,c,0),o}function k4(t,e,n,i,r){let s;if(r===i9(t,e,n,i)>0)for(let o=e;o<n;o+=i)s=mO(o/i|0,t[o],t[o+1],s);else for(let o=n-i;o>=e;o-=i)s=mO(o/i|0,t[o],t[o+1],s);return s&&gp(s,s.next)&&(_v(s),s=s.next),s}function ed(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(gp(n,n.next)||Si(n.prev,n,n.next)===0)){if(_v(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function gv(t,e,n,i,r,s,o){if(!t)return;!o&&s&&JG(t,i,r,s);let a=t;for(;t.prev!==t.next;){let l=t.prev,c=t.next;if(s?VG(t,i,r,s):WG(t)){e.push(l.i,t.i,c.i),_v(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=GG(ed(t),e),gv(t,e,n,i,r,s,2)):o===2&&jG(t,e,n,i,r,s):gv(ed(t),e,n,i,r,s,1);break}}}function WG(t){let e=t.prev,n=t,i=t.next;if(Si(e,n,i)>=0)return!1;let r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,c=i.y,u=Math.min(r,s,o),d=Math.min(a,l,c),p=Math.max(r,s,o),m=Math.max(a,l,c),g=i.next;for(;g!==e;){if(g.x>=u&&g.x<=p&&g.y>=d&&g.y<=m&&Ug(r,a,s,l,o,c,g.x,g.y)&&Si(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function VG(t,e,n,i){let r=t.prev,s=t,o=t.next;if(Si(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,u=r.y,d=s.y,p=o.y,m=Math.min(a,l,c),g=Math.min(u,d,p),_=Math.max(a,l,c),y=Math.max(u,d,p),v=i2(m,g,e,n,i),S=i2(_,y,e,n,i),b=t.prevZ,w=t.nextZ;for(;b&&b.z>=v&&w&&w.z<=S;){if(b.x>=m&&b.x<=_&&b.y>=g&&b.y<=y&&b!==r&&b!==o&&Ug(a,u,l,d,c,p,b.x,b.y)&&Si(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=m&&w.x<=_&&w.y>=g&&w.y<=y&&w!==r&&w!==o&&Ug(a,u,l,d,c,p,w.x,w.y)&&Si(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=v;){if(b.x>=m&&b.x<=_&&b.y>=g&&b.y<=y&&b!==r&&b!==o&&Ug(a,u,l,d,c,p,b.x,b.y)&&Si(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=S;){if(w.x>=m&&w.x<=_&&w.y>=g&&w.y<=y&&w!==r&&w!==o&&Ug(a,u,l,d,c,p,w.x,w.y)&&Si(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function GG(t,e){let n=t;do{let i=n.prev,r=n.next.next;!gp(i,r)&&P4(i,n,n.next,r)&&vv(i,r)&&vv(r,i)&&(e.push(i.i,n.i,r.i),_v(n),_v(n.next),n=t=r),n=n.next}while(n!==t);return ed(n)}function jG(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&e9(o,a)){let l=D4(o,a);o=ed(o,o.next),l=ed(l,l.next),gv(o,e,n,i,r,s,0),gv(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function XG(t,e,n,i){let r=[];for(let s=0,o=e.length;s<o;s++){let a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=k4(t,a,l,i,!1);c===c.next&&(c.steiner=!0),r.push(QG(c))}r.sort(qG);for(let s=0;s<r.length;s++)n=YG(r[s],n);return n}function qG(t,e){let n=t.x-e.x;if(n===0&&(n=t.y-e.y,n===0)){let i=(t.next.y-t.y)/(t.next.x-t.x),r=(e.next.y-e.y)/(e.next.x-e.x);n=i-r}return n}function YG(t,e){let n=KG(t,e);if(!n)return e;let i=D4(n,t);return ed(i,i.next),ed(n,n.next)}function KG(t,e){let n=e,i=t.x,r=t.y,s=-1/0,o;if(gp(t,n))return n;do{if(gp(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){let d=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=i&&d>s&&(s=d,o=n.x<n.next.x?n:n.next,d===i))return o}n=n.next}while(n!==e);if(!o)return null;let a=o,l=o.x,c=o.y,u=1/0;n=o;do{if(i>=n.x&&n.x>=l&&i!==n.x&&L4(r<c?i:s,r,l,c,r<c?s:i,r,n.x,n.y)){let d=Math.abs(r-n.y)/(i-n.x);vv(n,t)&&(d<u||d===u&&(n.x>o.x||n.x===o.x&&$G(o,n)))&&(o=n,u=d)}n=n.next}while(n!==a);return o}function $G(t,e){return Si(t.prev,t,e.prev)<0&&Si(e.next,t,t.next)<0}function JG(t,e,n,i){let r=t;do r.z===0&&(r.z=i2(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,ZG(r)}function ZG(t){let e,n=1;do{let i=t,r;t=null;let s=null;for(e=0;i;){e++;let o=i,a=0;for(let c=0;c<n&&(a++,o=o.nextZ,!!o);c++);let l=n;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=o}s.nextZ=null,n*=2}while(e>1);return t}function i2(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function QG(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function L4(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function Ug(t,e,n,i,r,s,o,a){return!(t===o&&e===a)&&L4(t,e,n,i,r,s,o,a)}function e9(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!t9(t,e)&&(vv(t,e)&&vv(e,t)&&n9(t,e)&&(Si(t.prev,t,e.prev)||Si(t,e.prev,e))||gp(t,e)&&Si(t.prev,t,t.next)>0&&Si(e.prev,e,e.next)>0)}function Si(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function gp(t,e){return t.x===e.x&&t.y===e.y}function P4(t,e,n,i){let r=Vx(Si(t,e,n)),s=Vx(Si(t,e,i)),o=Vx(Si(n,i,t)),a=Vx(Si(n,i,e));return!!(r!==s&&o!==a||r===0&&Wx(t,n,e)||s===0&&Wx(t,i,e)||o===0&&Wx(n,t,i)||a===0&&Wx(n,e,i))}function Wx(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Vx(t){return t>0?1:t<0?-1:0}function t9(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&P4(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function vv(t,e){return Si(t.prev,t,t.next)<0?Si(t,e,t.next)>=0&&Si(t,t.prev,e)>=0:Si(t,e,t.prev)<0||Si(t,t.next,e)<0}function n9(t,e){let n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function D4(t,e){let n=r2(t.i,t.x,t.y),i=r2(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function mO(t,e,n,i){let r=r2(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function _v(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function r2(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function i9(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}function gO(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function vO(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function s9(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){let s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function o9(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){let r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}function _O(t,e,n){let i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}function zh(t,e){return!t||t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function I4(t){function e(r,s){return t[r]-t[s]}let n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function o2(t,e,n){let i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){let a=n[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function eA(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),n.push(...o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),n.push(o)),s=t[r++];while(s!==void 0)}function a9(t,e,n,i,r=30){let s=t.clone();s.name=e;let o=[];for(let l=0;l<s.tracks.length;++l){let c=s.tracks[l],u=c.getValueSize(),d=[],p=[];for(let m=0;m<c.times.length;++m){let g=c.times[m]*r;if(!(g<n||g>=i)){d.push(c.times[m]);for(let _=0;_<u;++_)p.push(c.values[m*u+_])}}d.length!==0&&(c.times=zh(d,c.times.constructor),c.values=zh(p,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function l9(t,e=0,n=t,i=30){i<=0&&(i=30);let r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){let a=n.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;let c=t.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(c===void 0)continue;let u=0,d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let p=0,m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=m/3);let g=a.times.length-1,_;if(s<=a.times[0]){let v=u,S=d-u;_=a.values.slice(v,S)}else if(s>=a.times[g]){let v=g*d+u,S=v+d-u;_=a.values.slice(v,S)}else{let v=a.createInterpolant(),S=u,b=d-u;v.evaluate(s),_=v.resultBuffer.slice(S,b)}l==="quaternion"&&new Yi().fromArray(_).normalize().conjugate().toArray(_);let y=c.times.length;for(let v=0;v<y;++v){let S=v*m+p;if(l==="quaternion")Yi.multiplyQuaternionsFlat(c.values,S,_,0,c.values,S);else{let b=m-p*2;for(let w=0;w<b;++w)c.values[S+w]-=_[w]}}}return t.blendMode=Sb,t}function c9(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Au;case"vector":case"vector2":case"vector3":case"vector4":return Lu;case"color":return xp;case"quaternion":return ku;case"bool":case"boolean":return dl;case"string":return fl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function u9(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=c9(t.type);if(t.times===void 0){let n=[],i=[];eA(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}function AO(t,e){return t.distance-e.distance}function d2(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){let s=t.children;for(let o=0,a=s.length;o<a;o++)d2(s[o],e,n,!0)}}function E9(){this._document.hidden===!1&&this.reset()}function R4(t){let e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push(...R4(t.children[n]));return e}function Wi(t,e,n,i,r,s,o){Yx.set(r,s,o).unproject(i);let a=e[t];if(a!==void 0){let l=n.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],Yx.x,Yx.y,Yx.z)}}function A9(t,e){let n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function k9(t,e){let n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function L9(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function Eb(t,e,n,i){let r=P9(i);switch(n){case yb:return t*e;case h0:return t*e/r.components*r.byteLength;case Pp:return t*e/r.components*r.byteLength;case Ru:return t*e*2/r.components*r.byteLength;case d0:return t*e*2/r.components*r.byteLength;case xb:return t*e*3/r.components*r.byteLength;case rr:return t*e*4/r.components*r.byteLength;case f0:return t*e*4/r.components*r.byteLength;case Dp:case Ip:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case Rp:case Np:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case m0:case v0:return Math.max(t,16)*Math.max(e,8)/4;case p0:case g0:return Math.max(t,8)*Math.max(e,8)/2;case _0:case y0:case S0:case b0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case x0:case w0:case E0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case C0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case T0:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case M0:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case A0:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case k0:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case L0:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case P0:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case D0:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case I0:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case R0:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case N0:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case O0:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case B0:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case U0:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case F0:case z0:case H0:return Math.ceil(t/4)*Math.ceil(e/4)*16;case W0:case V0:return Math.ceil(t/4)*Math.ceil(e/4)*8;case G0:case j0:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function P9(t){switch(t){case Or:case mb:return{byteLength:1,components:1};case ld:case gb:case za:return{byteLength:2,components:1};case c0:case u0:return{byteLength:2,components:4};case wo:case l0:case Rr:return{byteLength:4,components:1};case vb:case _b:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}var f2,dc,fc,p2,ib,m2,BO,rb,Iu,sd,pc,hl,es,ts,Ba,vu,sb,ob,ab,g2,ac,v2,_2,y2,x2,S2,b2,w2,E2,Vg,Gg,C2,T2,M2,A2,k2,L2,P2,D2,I2,e0,t0,n0,_u,i0,r0,s0,o0,Tp,R2,N2,Xs,lb,cb,ub,Mp,hb,db,fb,Jx,O2,a0,Ua,mc,Ap,kp,od,Yf,xs,Kf,Ii,pb,UO,ad,FO,Un,Lp,zO,Fa,HO,Or,mb,gb,ld,l0,wo,Rr,za,c0,u0,cd,vb,_b,yb,xb,rr,La,gc,h0,Pp,Ru,d0,WO,f0,Dp,Ip,Rp,Np,p0,m0,g0,v0,_0,y0,x0,S0,b0,w0,E0,C0,T0,M0,A0,k0,L0,P0,D0,I0,R0,N0,O0,B0,U0,F0,z0,H0,W0,V0,G0,j0,B2,U2,F2,$f,jg,Fg,mu,gu,Jf,X0,Sb,VO,GO,jO,z2,bb,XO,qO,vc,H2,pl,_s,yu,Zf,Dn,YO,KO,$O,JO,pu,ZO,QO,e4,t4,n4,i4,r4,s4,o4,a4,l4,c4,u4,Zx,W2,V2,G2,q0,j2,X2,Y0,q2,Qf,Y2,h4,d4,f4,p4,m4,g4,v4,_4,wb,Ws,Wh,y4,x4,S4,zV,PN,xu,xo,$r,DN,Hh,Gh,T4,We,Yi,Y,_M,IN,Xt,yM,RN,NN,yn,Tf,Xg,rG,Aa,sG,SM,bi,Rn,np,Qr,jh,Qx,Xh,eS,Pi,Zl,Ea,cx,Mf,Af,kf,au,lu,Ah,Tg,ux,hx,kh,oG,Mg,wM,Di,Ql,EM,dx,cu,CM,fx,TM,Pa,Ft,Lf,Ca,aG,lG,uu,px,go,ON,BN,Vs,Da,cG,UN,Pf,ec,mx,Ag,uG,hG,FN,zN,HN,WN,dG,Df,MM,Ln,Ta,tc,AM,nc,If,Rf,VN,kM,LM,PM,DM,IM,RM,Ma,M4,hu,gx,dt,Jr,fG,sr,So,rc,tS,qi,vx,mG,In,nS,iS,rS,sS,ip,oS,rp,aS,bt,gG,Jo,OM,Nf,vo,kg,_r,Wt,GN,Lh,_x,jN,yx,xx,Sx,BM,bx,XN,wx,zn,Su,K0,yG,xG,bs,lc,du,qN,YN,Zn,Of,Bf,qg,bu,sp,sc,SG,qh,Yg,Kg,Yh,Kh,vs,wu,op,Uf,Lg,Ff,zf,Hf,Pg,A4,Cx,Dg,Tx,KN,UM,$N,$g,Ax,JN,Jg,ZN,QN,eO,bG,tO,kx,FM,nO,zM,Zg,ap,Ss,iO,wG,Qg,Ia,Wf,rO,Lx,sO,EG,Ig,Rg,ev,HM,CG,TG,_o,Ph,MG,Px,cc,ll,cl,tv,t2,zs,LG,oO,PG,Dx,Dh,Ng,aO,DG,VM,Zr,Ix,nv,yr,lS,cS,lO,Og,Rx,GM,cO,Ra,uO,hO,bo,iv,lp,dO,n2,Ox,Bx,rv,sv,uS,hS,$h,dS,fS,pS,uc,ov,cp,av,lv,Jh,up,hc,cv,Ux,Fx,jM,zx,uv,Gs,Zh,hv,Hx,XM,qM,YM,dv,hp,fv,dp,pv,fp,pp,mp,mS,mv,Qh,ul,s2,Zo,yv,r9,xv,Sv,vp,Na,bv,wv,Eu,Ev,Cv,Tv,Mv,Av,yO,kv,_p,td,Lv,Pv,Dv,Iv,Rv,Cu,Tu,Nv,Ov,gS,Mu,Bv,yp,Uv,ws,dl,xp,Au,Fv,ku,fl,Lu,Pu,ka,Sp,tA,Nr,ic,a2,Qo,vS,_S,Vf,Du,yS,xS,SS,Oa,zv,KM,xO,SO,Hv,l2,Wv,c2,Vv,js,u2,Gv,jv,Xv,bp,qv,Yv,wp,nd,Kv,bS,h9,bO,wO,$M,wS,Gx,Ep,ES,EO,CO,Rh,CS,$v,id,Nh,JM,d9,Oh,Bh,TS,Jv,Uh,TO,f9,Fh,MS,AS,Zv,nA,p9,iA,m9,g9,v9,_9,y9,x9,S9,h2,On,kS,Qv,b9,LS,PS,DS,w9,IS,RS,NS,MO,Cp,OS,rd,BS,US,kO,FS,LO,jx,Gf,jf,ZM,C9,T9,zS,PO,HS,fu,Xx,QM,WS,VS,M9,DO,IO,GS,jS,XS,RO,qx,NO,qS,Yx,Li,YS,Kx,KS,$S,JS,OO,$x,e2,ZS,QS,eb,tb,nb,rA=Hl(()=>{f2="182",dc={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},fc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},p2=0,ib=1,m2=2,BO=3,rb=0,Iu=1,sd=2,pc=3,hl=0,es=1,ts=2,Ba=0,vu=1,sb=2,ob=3,ab=4,g2=5,ac=100,v2=101,_2=102,y2=103,x2=104,S2=200,b2=201,w2=202,E2=203,Vg=204,Gg=205,C2=206,T2=207,M2=208,A2=209,k2=210,L2=211,P2=212,D2=213,I2=214,e0=0,t0=1,n0=2,_u=3,i0=4,r0=5,s0=6,o0=7,Tp=0,R2=1,N2=2,Xs=0,lb=1,cb=2,ub=3,Mp=4,hb=5,db=6,fb=7,Jx="attached",O2="detached",a0=300,Ua=301,mc=302,Ap=303,kp=304,od=306,Yf=1e3,xs=1001,Kf=1002,Ii=1003,pb=1004,UO=1004,ad=1005,FO=1005,Un=1006,Lp=1007,zO=1007,Fa=1008,HO=1008,Or=1009,mb=1010,gb=1011,ld=1012,l0=1013,wo=1014,Rr=1015,za=1016,c0=1017,u0=1018,cd=1020,vb=35902,_b=35899,yb=1021,xb=1022,rr=1023,La=1026,gc=1027,h0=1028,Pp=1029,Ru=1030,d0=1031,WO=1032,f0=1033,Dp=33776,Ip=33777,Rp=33778,Np=33779,p0=35840,m0=35841,g0=35842,v0=35843,_0=36196,y0=37492,x0=37496,S0=37488,b0=37489,w0=37490,E0=37491,C0=37808,T0=37809,M0=37810,A0=37811,k0=37812,L0=37813,P0=37814,D0=37815,I0=37816,R0=37817,N0=37818,O0=37819,B0=37820,U0=37821,F0=36492,z0=36494,H0=36495,W0=36283,V0=36284,G0=36285,j0=36286,B2=2200,U2=2201,F2=2202,$f=2300,jg=2301,Fg=2302,mu=2400,gu=2401,Jf=2402,X0=2500,Sb=2501,VO=0,GO=1,jO=2,z2=3200,bb=3201,XO=3202,qO=3203,vc=0,H2=1,pl="",_s="srgb",yu="srgb-linear",Zf="linear",Dn="srgb",YO="",KO="rg",$O="ga",JO=0,pu=7680,ZO=7681,QO=7682,e4=7683,t4=34055,n4=34056,i4=5386,r4=512,s4=513,o4=514,a4=515,l4=516,c4=517,u4=518,Zx=519,W2=512,V2=513,G2=514,q0=515,j2=516,X2=517,Y0=518,q2=519,Qf=35044,Y2=35048,h4=35040,d4=35045,f4=35049,p4=35041,m4=35046,g4=35050,v4=35042,_4="100",wb="300 es",Ws=2e3,Wh=2001,y4={COMPUTE:"compute",RENDER:"render"},x4={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},S4={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};zV={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};PN={},xu=null;xo=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){let i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){let i=this._listeners;if(i===void 0)return;let r=i[e];if(r!==void 0){let s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){let n=this._listeners;if(n===void 0)return;let i=n[e.type];if(i!==void 0){e.target=this;let r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}},$r=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],DN=1234567,Hh=Math.PI/180,Gh=180/Math.PI;T4={DEG2RAD:Hh,RAD2DEG:Gh,generateUUID:yo,clamp:Ht,euclideanModulo:J2,mapLinear:HV,inverseLerp:WV,lerp:zg,damp:VV,pingpong:GV,smoothstep:jV,smootherstep:XV,randInt:qV,randFloat:YV,randFloatSpread:KV,seededRandom:$V,degToRad:JV,radToDeg:ZV,isPowerOfTwo:QV,ceilPowerOfTwo:eG,floorPowerOfTwo:tG,setQuaternionFromProperEuler:nG,normalize:Qt,denormalize:ys},We=class t{constructor(e=0,n=0){t.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Ht(this.x,e.x,n.x),this.y=Ht(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Ht(this.x,e,n),this.y=Ht(this.y,e,n),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ht(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;let i=this.dot(e)/n;return Math.acos(Ht(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){let i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Yi=class{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3],p=s[o+0],m=s[o+1],g=s[o+2],_=s[o+3];if(a<=0){e[n+0]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d;return}if(a>=1){e[n+0]=p,e[n+1]=m,e[n+2]=g,e[n+3]=_;return}if(d!==_||l!==p||c!==m||u!==g){let y=l*p+c*m+u*g+d*_;y<0&&(p=-p,m=-m,g=-g,_=-_,y=-y);let v=1-a;if(y<.9995){let S=Math.acos(y),b=Math.sin(S);v=Math.sin(v*S)/b,a=Math.sin(a*S)/b,l=l*v+p*a,c=c*v+m*a,u=u*v+g*a,d=d*v+_*a}else{l=l*v+p*a,c=c*v+m*a,u=u*v+g*a,d=d*v+_*a;let S=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=S,c*=S,u*=S,d*=S}}e[n]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d}static multiplyQuaternionsFlat(e,n,i,r,s,o){let a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],p=s[o+1],m=s[o+2],g=s[o+3];return e[n]=a*g+u*d+l*m-c*p,e[n+1]=l*g+u*p+c*d-a*m,e[n+2]=c*g+u*m+a*p-l*d,e[n+3]=u*g-a*d-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){let i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),p=l(i/2),m=l(r/2),g=l(s/2);switch(o){case"XYZ":this._x=p*u*d+c*m*g,this._y=c*m*d-p*u*g,this._z=c*u*g+p*m*d,this._w=c*u*d-p*m*g;break;case"YXZ":this._x=p*u*d+c*m*g,this._y=c*m*d-p*u*g,this._z=c*u*g-p*m*d,this._w=c*u*d+p*m*g;break;case"ZXY":this._x=p*u*d-c*m*g,this._y=c*m*d+p*u*g,this._z=c*u*g+p*m*d,this._w=c*u*d-p*m*g;break;case"ZYX":this._x=p*u*d-c*m*g,this._y=c*m*d+p*u*g,this._z=c*u*g-p*m*d,this._w=c*u*d+p*m*g;break;case"YZX":this._x=p*u*d+c*m*g,this._y=c*m*d+p*u*g,this._z=c*u*g-p*m*d,this._w=c*u*d-p*m*g;break;case"XZY":this._x=p*u*d-c*m*g,this._y=c*m*d-p*u*g,this._z=c*u*g+p*m*d,this._w=c*u*d+p*m*g;break;default:ut("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){let i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],l=n[9],c=n[2],u=n[6],d=n[10],p=i+a+d;if(p>0){let m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(i>a&&i>d){let m=2*Math.sqrt(1+i-a-d);this._w=(u-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>d){let m=2*Math.sqrt(1+a-i-d);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+u)/m}else{let m=2*Math.sqrt(1+d-i-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ht(this.dot(e),-1,1)))}rotateTowards(e,n){let i=this.angleTo(e);if(i===0)return this;let r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){let i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,l=n._y,c=n._z,u=n._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,n){if(n<=0)return this;if(n>=1)return this.copy(e);let i=e._x,r=e._y,s=e._z,o=e._w,a=this.dot(e);a<0&&(i=-i,r=-r,s=-s,o=-o,a=-a);let l=1-n;if(a<.9995){let c=Math.acos(a),u=Math.sin(c);l=Math.sin(l*c)/u,n=Math.sin(n*c)/u,this._x=this._x*l+i*n,this._y=this._y*l+r*n,this._z=this._z*l+s*n,this._w=this._w*l+o*n,this._onChangeCallback()}else this._x=this._x*l+i*n,this._y=this._y*l+r*n,this._z=this._z*l+s*n,this._w=this._w*l+o*n,this.normalize();return this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){let e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Y=class t{constructor(e=0,n=0,i=0){t.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(IN.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(IN.setFromAxisAngle(e,n))}applyMatrix3(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){let n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*i),u=2*(a*n-s*r),d=2*(s*i-o*n);return this.x=n+l*c+o*d-a*u,this.y=i+l*u+a*c-s*d,this.z=r+l*d+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Ht(this.x,e.x,n.x),this.y=Ht(this.y,e.y,n.y),this.z=Ht(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Ht(this.x,e,n),this.y=Ht(this.y,e,n),this.z=Ht(this.z,e,n),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ht(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){let i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){let n=e.lengthSq();if(n===0)return this.set(0,0,0);let i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return _M.copy(this).projectOnVector(e),this.sub(_M)}reflect(e){return this.sub(_M.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;let i=this.dot(e)/n;return Math.acos(Ht(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){let r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){let n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){let n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},_M=new Y,IN=new Yi,Xt=class t{constructor(e,n,i,r,s,o,a,l,c){t.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,l,c)}set(e,n,i,r,s,o,a,l,c){let u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=n,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){let i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],p=i[2],m=i[5],g=i[8],_=r[0],y=r[3],v=r[6],S=r[1],b=r[4],w=r[7],C=r[2],M=r[5],L=r[8];return s[0]=o*_+a*S+l*C,s[3]=o*y+a*b+l*M,s[6]=o*v+a*w+l*L,s[1]=c*_+u*S+d*C,s[4]=c*y+u*b+d*M,s[7]=c*v+u*w+d*L,s[2]=p*_+m*S+g*C,s[5]=p*y+m*b+g*M,s[8]=p*v+m*w+g*L,this}multiplyScalar(e){let n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return n*o*u-n*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,p=a*l-u*s,m=c*s-o*l,g=n*d+i*p+r*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);let _=1/g;return e[0]=d*_,e[1]=(r*c-u*i)*_,e[2]=(a*i-r*o)*_,e[3]=p*_,e[4]=(u*n-r*l)*_,e[5]=(r*s-a*n)*_,e[6]=m*_,e[7]=(i*l-c*n)*_,e[8]=(o*n-i*s)*_,this}transpose(){let e,n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){let l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(yM.makeScale(e,n)),this}rotate(e){return this.premultiply(yM.makeRotation(-e)),this}translate(e,n){return this.premultiply(yM.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){let n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){let i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},yM=new Xt,RN=new Xt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),NN=new Xt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);yn=iG();Xg=class{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Tf===void 0&&(Tf=ep("canvas")),Tf.width=e.width,Tf.height=e.height;let r=Tf.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=Tf}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let n=ep("canvas");n.width=e.width,n.height=e.height;let i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=oc(s[o]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){let n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(oc(n[i]/255)*255):n[i]=oc(n[i]);return{data:n,width:e.width,height:e.height}}else return ut("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},rG=0,Aa=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:rG++}),this.uuid=yo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){let n=this.data;return typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?e.set(n.videoWidth,n.videoHeight,0):typeof VideoFrame<"u"&&n instanceof VideoFrame?e.set(n.displayHeight,n.displayWidth,0):n!==null?e.set(n.width,n.height,n.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(xM(r[o].image)):s.push(xM(r[o]))}else s=xM(r);i.url=s}return n||(e.images[this.uuid]=i),i}};sG=0,SM=new Y,bi=class t extends xo{constructor(e=t.DEFAULT_IMAGE,n=t.DEFAULT_MAPPING,i=xs,r=xs,s=Un,o=Fa,a=rr,l=Or,c=t.DEFAULT_ANISOTROPY,u=pl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:sG++}),this.uuid=yo(),this.name="",this.source=new Aa(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new We(0,0),this.repeat=new We(1,1),this.center=new We(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(SM).x}get height(){return this.source.getSize(SM).y}get depth(){return this.source.getSize(SM).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(let n in e){let i=e[n];if(i===void 0){ut(`Texture.setValues(): parameter '${n}' has value of undefined.`);continue}let r=this[n];if(r===void 0){ut(`Texture.setValues(): property '${n}' does not exist.`);continue}r&&i&&r.isVector2&&i.isVector2||r&&i&&r.isVector3&&i.isVector3||r&&i&&r.isMatrix3&&i.isMatrix3?r.copy(i):this[n]=i}}toJSON(e){let n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==a0)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Yf:e.x=e.x-Math.floor(e.x);break;case xs:e.x=e.x<0?0:1;break;case Kf:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Yf:e.y=e.y-Math.floor(e.y);break;case xs:e.y=e.y<0?0:1;break;case Kf:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};bi.DEFAULT_IMAGE=null;bi.DEFAULT_MAPPING=a0;bi.DEFAULT_ANISOTROPY=1;Rn=class t{constructor(e=0,n=0,i=0,r=1){t.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s,l=e.elements,c=l[0],u=l[4],d=l[8],p=l[1],m=l[5],g=l[9],_=l[2],y=l[6],v=l[10];if(Math.abs(u-p)<.01&&Math.abs(d-_)<.01&&Math.abs(g-y)<.01){if(Math.abs(u+p)<.1&&Math.abs(d+_)<.1&&Math.abs(g+y)<.1&&Math.abs(c+m+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;let b=(c+1)/2,w=(m+1)/2,C=(v+1)/2,M=(u+p)/4,L=(d+_)/4,P=(g+y)/4;return b>w&&b>C?b<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(b),r=M/i,s=L/i):w>C?w<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(w),i=M/r,s=P/r):C<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(C),i=L/s,r=P/s),this.set(i,r,s,n),this}let S=Math.sqrt((y-g)*(y-g)+(d-_)*(d-_)+(p-u)*(p-u));return Math.abs(S)<.001&&(S=1),this.x=(y-g)/S,this.y=(d-_)/S,this.z=(p-u)/S,this.w=Math.acos((c+m+v-1)/2),this}setFromMatrixPosition(e){let n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Ht(this.x,e.x,n.x),this.y=Ht(this.y,e.y,n.y),this.z=Ht(this.z,e.z,n.z),this.w=Ht(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Ht(this.x,e,n),this.y=Ht(this.y,e,n),this.z=Ht(this.z,e,n),this.w=Ht(this.w,e,n),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ht(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},np=class extends xo{constructor(e=1,n=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Un,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth,this.scissor=new Rn(0,0,e,n),this.scissorTest=!1,this.viewport=new Rn(0,0,e,n);let r={width:e,height:n,depth:i.depth},s=new bi(r);this.textures=[];let o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){let n={minFilter:Un,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(n.mapping=e.mapping),e.wrapS!==void 0&&(n.wrapS=e.wrapS),e.wrapT!==void 0&&(n.wrapT=e.wrapT),e.wrapR!==void 0&&(n.wrapR=e.wrapR),e.magFilter!==void 0&&(n.magFilter=e.magFilter),e.minFilter!==void 0&&(n.minFilter=e.minFilter),e.format!==void 0&&(n.format=e.format),e.type!==void 0&&(n.type=e.type),e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(n.colorSpace=e.colorSpace),e.flipY!==void 0&&(n.flipY=e.flipY),e.generateMipmaps!==void 0&&(n.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(n.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(n)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;let r=Object.assign({},e.textures[n].image);this.textures[n].source=new Aa(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Qr=class extends np{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}},jh=class extends bi{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=xs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},Qx=class extends Qr{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new jh(null,e,n,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},Xh=class extends bi{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=xs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},eS=class extends Qr{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new Xh(null,e,n,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},Pi=class{constructor(e=new Y(1/0,1/0,1/0),n=new Y(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Ea.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Ea.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){let i=Ea.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Ea):Ea.fromBufferAttribute(s,o),Ea.applyMatrix4(e.matrixWorld),this.expandByPoint(Ea);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),cx.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),cx.copy(i.boundingBox)),cx.applyMatrix4(e.matrixWorld),this.union(cx)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ea),Ea.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Tg),ux.subVectors(this.max,Tg),Mf.subVectors(e.a,Tg),Af.subVectors(e.b,Tg),kf.subVectors(e.c,Tg),au.subVectors(Af,Mf),lu.subVectors(kf,Af),Ah.subVectors(Mf,kf);let n=[0,-au.z,au.y,0,-lu.z,lu.y,0,-Ah.z,Ah.y,au.z,0,-au.x,lu.z,0,-lu.x,Ah.z,0,-Ah.x,-au.y,au.x,0,-lu.y,lu.x,0,-Ah.y,Ah.x,0];return!bM(n,Mf,Af,kf,ux)||(n=[1,0,0,0,1,0,0,0,1],!bM(n,Mf,Af,kf,ux))?!1:(hx.crossVectors(au,lu),n=[hx.x,hx.y,hx.z],bM(n,Mf,Af,kf,ux))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ea).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ea).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Zl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Zl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Zl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Zl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Zl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Zl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Zl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Zl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Zl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}},Zl=[new Y,new Y,new Y,new Y,new Y,new Y,new Y,new Y],Ea=new Y,cx=new Pi,Mf=new Y,Af=new Y,kf=new Y,au=new Y,lu=new Y,Ah=new Y,Tg=new Y,ux=new Y,hx=new Y,kh=new Y;oG=new Pi,Mg=new Y,wM=new Y,Di=class{constructor(e=new Y,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){let i=this.center;n!==void 0?i.copy(n):oG.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){let i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Mg.subVectors(e,this.center);let n=Mg.lengthSq();if(n>this.radius*this.radius){let i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(Mg,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(wM.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Mg.copy(e.center).add(wM)),this.expandByPoint(Mg.copy(e.center).sub(wM))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}},Ql=new Y,EM=new Y,dx=new Y,cu=new Y,CM=new Y,fx=new Y,TM=new Y,Pa=class{constructor(e=new Y,n=new Y(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ql)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);let i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let n=Ql.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Ql.copy(this.origin).addScaledVector(this.direction,n),Ql.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){EM.copy(e).add(n).multiplyScalar(.5),dx.copy(n).sub(e).normalize(),cu.copy(this.origin).sub(EM);let s=e.distanceTo(n)*.5,o=-this.direction.dot(dx),a=cu.dot(this.direction),l=-cu.dot(dx),c=cu.lengthSq(),u=Math.abs(1-o*o),d,p,m,g;if(u>0)if(d=o*l-a,p=o*a-l,g=s*u,d>=0)if(p>=-g)if(p<=g){let _=1/u;d*=_,p*=_,m=d*(d+o*p+2*a)+p*(o*d+p+2*l)+c}else p=s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;else p=-s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;else p<=-g?(d=Math.max(0,-(-o*s+a)),p=d>0?-s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c):p<=g?(d=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(d=Math.max(0,-(o*s+a)),p=d>0?s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c);else p=o>0?-s:s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(EM).addScaledVector(dx,p),m}intersectSphere(e,n){Ql.subVectors(e.center,this.origin);let i=Ql.dot(this.direction),r=Ql.dot(Ql)-i*i,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){let i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){let n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,l,c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,p=this.origin;return c>=0?(i=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(i=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),u>=0?(s=(e.min.y-p.y)*u,o=(e.max.y-p.y)*u):(s=(e.max.y-p.y)*u,o=(e.min.y-p.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-p.z)*d,l=(e.max.z-p.z)*d):(a=(e.max.z-p.z)*d,l=(e.min.z-p.z)*d),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,Ql)!==null}intersectTriangle(e,n,i,r,s){CM.subVectors(n,e),fx.subVectors(i,e),TM.crossVectors(CM,fx);let o=this.direction.dot(TM),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;cu.subVectors(this.origin,e);let l=a*this.direction.dot(fx.crossVectors(cu,fx));if(l<0)return null;let c=a*this.direction.dot(CM.cross(cu));if(c<0||l+c>o)return null;let u=-a*cu.dot(TM);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ft=class t{constructor(e,n,i,r,s,o,a,l,c,u,d,p,m,g,_,y){t.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,l,c,u,d,p,m,g,_,y)}set(e,n,i,r,s,o,a,l,c,u,d,p,m,g,_,y){let v=this.elements;return v[0]=e,v[4]=n,v[8]=i,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=u,v[10]=d,v[14]=p,v[3]=m,v[7]=g,v[11]=_,v[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new t().fromArray(this.elements)}copy(e){let n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){let n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){let n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return this.determinant()===0?(e.set(1,0,0),n.set(0,1,0),i.set(0,0,1),this):(e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();let n=this.elements,i=e.elements,r=1/Lf.setFromMatrixColumn(e,0).length(),s=1/Lf.setFromMatrixColumn(e,1).length(),o=1/Lf.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){let n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){let p=o*u,m=o*d,g=a*u,_=a*d;n[0]=l*u,n[4]=-l*d,n[8]=c,n[1]=m+g*c,n[5]=p-_*c,n[9]=-a*l,n[2]=_-p*c,n[6]=g+m*c,n[10]=o*l}else if(e.order==="YXZ"){let p=l*u,m=l*d,g=c*u,_=c*d;n[0]=p+_*a,n[4]=g*a-m,n[8]=o*c,n[1]=o*d,n[5]=o*u,n[9]=-a,n[2]=m*a-g,n[6]=_+p*a,n[10]=o*l}else if(e.order==="ZXY"){let p=l*u,m=l*d,g=c*u,_=c*d;n[0]=p-_*a,n[4]=-o*d,n[8]=g+m*a,n[1]=m+g*a,n[5]=o*u,n[9]=_-p*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){let p=o*u,m=o*d,g=a*u,_=a*d;n[0]=l*u,n[4]=g*c-m,n[8]=p*c+_,n[1]=l*d,n[5]=_*c+p,n[9]=m*c-g,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){let p=o*l,m=o*c,g=a*l,_=a*c;n[0]=l*u,n[4]=_-p*d,n[8]=g*d+m,n[1]=d,n[5]=o*u,n[9]=-a*u,n[2]=-c*u,n[6]=m*d+g,n[10]=p-_*d}else if(e.order==="XZY"){let p=o*l,m=o*c,g=a*l,_=a*c;n[0]=l*u,n[4]=-d,n[8]=c*u,n[1]=p*d+_,n[5]=o*u,n[9]=m*d-g,n[2]=g*d-m,n[6]=a*u,n[10]=_*d+p}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(aG,e,lG)}lookAt(e,n,i){let r=this.elements;return go.subVectors(e,n),go.lengthSq()===0&&(go.z=1),go.normalize(),uu.crossVectors(i,go),uu.lengthSq()===0&&(Math.abs(i.z)===1?go.x+=1e-4:go.z+=1e-4,go.normalize(),uu.crossVectors(i,go)),uu.normalize(),px.crossVectors(go,uu),r[0]=uu.x,r[4]=px.x,r[8]=go.x,r[1]=uu.y,r[5]=px.y,r[9]=go.y,r[2]=uu.z,r[6]=px.z,r[10]=go.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){let i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],p=i[9],m=i[13],g=i[2],_=i[6],y=i[10],v=i[14],S=i[3],b=i[7],w=i[11],C=i[15],M=r[0],L=r[4],P=r[8],T=r[12],A=r[1],I=r[5],F=r[9],B=r[13],O=r[2],z=r[6],U=r[10],G=r[14],j=r[3],J=r[7],K=r[11],D=r[15];return s[0]=o*M+a*A+l*O+c*j,s[4]=o*L+a*I+l*z+c*J,s[8]=o*P+a*F+l*U+c*K,s[12]=o*T+a*B+l*G+c*D,s[1]=u*M+d*A+p*O+m*j,s[5]=u*L+d*I+p*z+m*J,s[9]=u*P+d*F+p*U+m*K,s[13]=u*T+d*B+p*G+m*D,s[2]=g*M+_*A+y*O+v*j,s[6]=g*L+_*I+y*z+v*J,s[10]=g*P+_*F+y*U+v*K,s[14]=g*T+_*B+y*G+v*D,s[3]=S*M+b*A+w*O+C*j,s[7]=S*L+b*I+w*z+C*J,s[11]=S*P+b*F+w*U+C*K,s[15]=S*T+b*B+w*G+C*D,this}multiplyScalar(e){let n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){let e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],p=e[10],m=e[14],g=e[3],_=e[7],y=e[11],v=e[15],S=l*m-c*p,b=a*m-c*d,w=a*p-l*d,C=o*m-c*u,M=o*p-l*u,L=o*d-a*u;return n*(_*S-y*b+v*w)-i*(g*S-y*C+v*M)+r*(g*b-_*C+v*L)-s*(g*w-_*M+y*L)}transpose(){let e=this.elements,n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],p=e[10],m=e[11],g=e[12],_=e[13],y=e[14],v=e[15],S=d*y*c-_*p*c+_*l*m-a*y*m-d*l*v+a*p*v,b=g*p*c-u*y*c-g*l*m+o*y*m+u*l*v-o*p*v,w=u*_*c-g*d*c+g*a*m-o*_*m-u*a*v+o*d*v,C=g*d*l-u*_*l-g*a*p+o*_*p+u*a*y-o*d*y,M=n*S+i*b+r*w+s*C;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let L=1/M;return e[0]=S*L,e[1]=(_*p*s-d*y*s-_*r*m+i*y*m+d*r*v-i*p*v)*L,e[2]=(a*y*s-_*l*s+_*r*c-i*y*c-a*r*v+i*l*v)*L,e[3]=(d*l*s-a*p*s-d*r*c+i*p*c+a*r*m-i*l*m)*L,e[4]=b*L,e[5]=(u*y*s-g*p*s+g*r*m-n*y*m-u*r*v+n*p*v)*L,e[6]=(g*l*s-o*y*s-g*r*c+n*y*c+o*r*v-n*l*v)*L,e[7]=(o*p*s-u*l*s+u*r*c-n*p*c-o*r*m+n*l*m)*L,e[8]=w*L,e[9]=(g*d*s-u*_*s-g*i*m+n*_*m+u*i*v-n*d*v)*L,e[10]=(o*_*s-g*a*s+g*i*c-n*_*c-o*i*v+n*a*v)*L,e[11]=(u*a*s-o*d*s-u*i*c+n*d*c+o*i*m-n*a*m)*L,e[12]=C*L,e[13]=(u*_*r-g*d*r+g*i*p-n*_*p-u*i*y+n*d*y)*L,e[14]=(g*a*r-o*_*r-g*i*l+n*_*l+o*i*y-n*a*y)*L,e[15]=(o*d*r-u*a*r+u*i*l-n*d*l-o*i*p+n*a*p)*L,this}scale(e){let n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){let n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){let i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){let r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,u=o+o,d=a+a,p=s*c,m=s*u,g=s*d,_=o*u,y=o*d,v=a*d,S=l*c,b=l*u,w=l*d,C=i.x,M=i.y,L=i.z;return r[0]=(1-(_+v))*C,r[1]=(m+w)*C,r[2]=(g-b)*C,r[3]=0,r[4]=(m-w)*M,r[5]=(1-(p+v))*M,r[6]=(y+S)*M,r[7]=0,r[8]=(g+b)*L,r[9]=(y-S)*L,r[10]=(1-(p+_))*L,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){let r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return i.set(1,1,1),n.identity(),this;let s=Lf.set(r[0],r[1],r[2]).length(),o=Lf.set(r[4],r[5],r[6]).length(),a=Lf.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),Ca.copy(this);let c=1/s,u=1/o,d=1/a;return Ca.elements[0]*=c,Ca.elements[1]*=c,Ca.elements[2]*=c,Ca.elements[4]*=u,Ca.elements[5]*=u,Ca.elements[6]*=u,Ca.elements[8]*=d,Ca.elements[9]*=d,Ca.elements[10]*=d,n.setFromRotationMatrix(Ca),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o,a=Ws,l=!1){let c=this.elements,u=2*s/(n-e),d=2*s/(i-r),p=(n+e)/(n-e),m=(i+r)/(i-r),g,_;if(l)g=s/(o-s),_=o*s/(o-s);else if(a===Ws)g=-(o+s)/(o-s),_=-2*o*s/(o-s);else if(a===Wh)g=-o/(o-s),_=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=u,c[4]=0,c[8]=p,c[12]=0,c[1]=0,c[5]=d,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=g,c[14]=_,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,r,s,o,a=Ws,l=!1){let c=this.elements,u=2/(n-e),d=2/(i-r),p=-(n+e)/(n-e),m=-(i+r)/(i-r),g,_;if(l)g=1/(o-s),_=o/(o-s);else if(a===Ws)g=-2/(o-s),_=-(o+s)/(o-s);else if(a===Wh)g=-1/(o-s),_=-s/(o-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=u,c[4]=0,c[8]=0,c[12]=p,c[1]=0,c[5]=d,c[9]=0,c[13]=m,c[2]=0,c[6]=0,c[10]=g,c[14]=_,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){let n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){let i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}},Lf=new Y,Ca=new Ft,aG=new Y(0,0,0),lG=new Y(1,1,1),uu=new Y,px=new Y,go=new Y,ON=new Ft,BN=new Yi,Vs=class t{constructor(e=0,n=0,i=0,r=t.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){let r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],d=r[2],p=r[6],m=r[10];switch(n){case"XYZ":this._y=Math.asin(Ht(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Ht(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ht(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Ht(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Ht(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-Ht(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:ut("Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return ON.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ON,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return BN.setFromEuler(this),this.setFromQuaternion(BN,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Vs.DEFAULT_ORDER="XYZ";Da=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},cG=0,UN=new Y,Pf=new Yi,ec=new Ft,mx=new Y,Ag=new Y,uG=new Y,hG=new Yi,FN=new Y(1,0,0),zN=new Y(0,1,0),HN=new Y(0,0,1),WN={type:"added"},dG={type:"removed"},Df={type:"childadded",child:null},MM={type:"childremoved",child:null},Ln=class t extends xo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cG++}),this.uuid=yo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=t.DEFAULT_UP.clone();let e=new Y,n=new Vs,i=new Yi,r=new Y(1,1,1);function s(){i.setFromEuler(n,!1)}function o(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ft},normalMatrix:{value:new Xt}}),this.matrix=new Ft,this.matrixWorld=new Ft,this.matrixAutoUpdate=t.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Da,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Pf.setFromAxisAngle(e,n),this.quaternion.multiply(Pf),this}rotateOnWorldAxis(e,n){return Pf.setFromAxisAngle(e,n),this.quaternion.premultiply(Pf),this}rotateX(e){return this.rotateOnAxis(FN,e)}rotateY(e){return this.rotateOnAxis(zN,e)}rotateZ(e){return this.rotateOnAxis(HN,e)}translateOnAxis(e,n){return UN.copy(e).applyQuaternion(this.quaternion),this.position.add(UN.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(FN,e)}translateY(e){return this.translateOnAxis(zN,e)}translateZ(e){return this.translateOnAxis(HN,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ec.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?mx.copy(e):mx.set(e,n,i);let r=this.parent;this.updateWorldMatrix(!0,!1),Ag.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ec.lookAt(Ag,mx,this.up):ec.lookAt(mx,Ag,this.up),this.quaternion.setFromRotationMatrix(ec),r&&(ec.extractRotation(r.matrixWorld),Pf.setFromRotationMatrix(ec),this.quaternion.premultiply(Pf.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(It("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(WN),Df.child=e,this.dispatchEvent(Df),Df.child=null):It("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(dG),MM.child=e,this.dispatchEvent(MM),MM.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ec.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ec.multiply(e.parent.matrixWorld)),e.applyMatrix4(ec),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(WN),Df.child=e,this.dispatchEvent(Df),Df.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){let o=this.children[i].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);let r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ag,e,uG),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ag,hG,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);let n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){let n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){let i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){let r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){let n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?a.boundingBox.toJSON():void 0,boundingSphere:a.boundingSphere?a.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(a=>({...a})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){let d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){let l=this.animations[a];r.animations.push(s(e.animations,l))}}if(n){let a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),p=o(e.skeletons),m=o(e.animations),g=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),p.length>0&&(i.skeletons=p),m.length>0&&(i.animations=m),g.length>0&&(i.nodes=g)}return i.object=r,i;function o(a){let l=[];for(let c in a){let u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){let r=e.children[i];this.add(r.clone())}return this}};Ln.DEFAULT_UP=new Y(0,1,0);Ln.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ln.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;Ta=new Y,tc=new Y,AM=new Y,nc=new Y,If=new Y,Rf=new Y,VN=new Y,kM=new Y,LM=new Y,PM=new Y,DM=new Rn,IM=new Rn,RM=new Rn,Ma=class t{constructor(e=new Y,n=new Y,i=new Y){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Ta.subVectors(e,n),r.cross(Ta);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Ta.subVectors(r,n),tc.subVectors(i,n),AM.subVectors(e,n);let o=Ta.dot(Ta),a=Ta.dot(tc),l=Ta.dot(AM),c=tc.dot(tc),u=tc.dot(AM),d=o*c-a*a;if(d===0)return s.set(0,0,0),null;let p=1/d,m=(c*l-a*u)*p,g=(o*u-a*l)*p;return s.set(1-m-g,g,m)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,nc)===null?!1:nc.x>=0&&nc.y>=0&&nc.x+nc.y<=1}static getInterpolation(e,n,i,r,s,o,a,l){return this.getBarycoord(e,n,i,r,nc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,nc.x),l.addScaledVector(o,nc.y),l.addScaledVector(a,nc.z),l)}static getInterpolatedAttribute(e,n,i,r,s,o){return DM.setScalar(0),IM.setScalar(0),RM.setScalar(0),DM.fromBufferAttribute(e,n),IM.fromBufferAttribute(e,i),RM.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(DM,s.x),o.addScaledVector(IM,s.y),o.addScaledVector(RM,s.z),o}static isFrontFacing(e,n,i,r){return Ta.subVectors(i,n),tc.subVectors(e,n),Ta.cross(tc).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ta.subVectors(this.c,this.b),tc.subVectors(this.a,this.b),Ta.cross(tc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return t.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return t.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,s){return t.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return t.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return t.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){let i=this.a,r=this.b,s=this.c,o,a;If.subVectors(r,i),Rf.subVectors(s,i),kM.subVectors(e,i);let l=If.dot(kM),c=Rf.dot(kM);if(l<=0&&c<=0)return n.copy(i);LM.subVectors(e,r);let u=If.dot(LM),d=Rf.dot(LM);if(u>=0&&d<=u)return n.copy(r);let p=l*d-u*c;if(p<=0&&l>=0&&u<=0)return o=l/(l-u),n.copy(i).addScaledVector(If,o);PM.subVectors(e,s);let m=If.dot(PM),g=Rf.dot(PM);if(g>=0&&m<=g)return n.copy(s);let _=m*c-l*g;if(_<=0&&c>=0&&g<=0)return a=c/(c-g),n.copy(i).addScaledVector(Rf,a);let y=u*g-m*d;if(y<=0&&d-u>=0&&m-g>=0)return VN.subVectors(s,r),a=(d-u)/(d-u+(m-g)),n.copy(r).addScaledVector(VN,a);let v=1/(y+_+p);return o=_*v,a=p*v,n.copy(i).addScaledVector(If,o).addScaledVector(Rf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},M4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hu={h:0,s:0,l:0},gx={h:0,s:0,l:0};dt=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=_s){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,yn.colorSpaceToWorking(this,n),this}setRGB(e,n,i,r=yn.workingColorSpace){return this.r=e,this.g=n,this.b=i,yn.colorSpaceToWorking(this,r),this}setHSL(e,n,i,r=yn.workingColorSpace){if(e=J2(e,1),n=Ht(n,0,1),i=Ht(i,0,1),n===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=NM(o,s,e+1/3),this.g=NM(o,s,e),this.b=NM(o,s,e-1/3)}return yn.colorSpaceToWorking(this,r),this}setStyle(e,n=_s){function i(s){s!==void 0&&parseFloat(s)<1&&ut("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:ut("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);ut("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=_s){let i=M4[e.toLowerCase()];return i!==void 0?this.setHex(i,n):ut("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=oc(e.r),this.g=oc(e.g),this.b=oc(e.b),this}copyLinearToSRGB(e){return this.r=qf(e.r),this.g=qf(e.g),this.b=qf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=_s){return yn.workingToColorSpace(Jr.copy(this),e),Math.round(Ht(Jr.r*255,0,255))*65536+Math.round(Ht(Jr.g*255,0,255))*256+Math.round(Ht(Jr.b*255,0,255))}getHexString(e=_s){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=yn.workingColorSpace){yn.workingToColorSpace(Jr.copy(this),n);let i=Jr.r,r=Jr.g,s=Jr.b,o=Math.max(i,r,s),a=Math.min(i,r,s),l,c,u=(a+o)/2;if(a===o)l=0,c=0;else{let d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,n=yn.workingColorSpace){return yn.workingToColorSpace(Jr.copy(this),n),e.r=Jr.r,e.g=Jr.g,e.b=Jr.b,e}getStyle(e=_s){yn.workingToColorSpace(Jr.copy(this),e);let n=Jr.r,i=Jr.g,r=Jr.b;return e!==_s?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(hu),this.setHSL(hu.h+e,hu.s+n,hu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(hu),e.getHSL(gx);let i=zg(hu.h,gx.h,n),r=zg(hu.s,gx.s,n),s=zg(hu.l,gx.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},Jr=new dt;dt.NAMES=M4;fG=0,sr=class extends xo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:fG++}),this.uuid=yo(),this.name="",this.type="Material",this.blending=vu,this.side=hl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Vg,this.blendDst=Gg,this.blendEquation=ac,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new dt(0,0,0),this.blendAlpha=0,this.depthFunc=_u,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Zx,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=pu,this.stencilZFail=pu,this.stencilZPass=pu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let n in e){let i=e[n];if(i===void 0){ut(`Material: parameter '${n}' has value of undefined.`);continue}let r=this[n];if(r===void 0){ut(`Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){let n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});let i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==vu&&(i.blending=this.blending),this.side!==hl&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Vg&&(i.blendSrc=this.blendSrc),this.blendDst!==Gg&&(i.blendDst=this.blendDst),this.blendEquation!==ac&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==_u&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Zx&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==pu&&(i.stencilFail=this.stencilFail),this.stencilZFail!==pu&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==pu&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.allowOverride===!1&&(i.allowOverride=!1),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){let o=[];for(let a in s){let l=s[a];delete l.metadata,o.push(l)}return o}if(n){let s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let n=e.clippingPlanes,i=null;if(n!==null){let r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},So=class extends sr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new dt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vs,this.combine=Tp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},rc=pG();tS=class{static toHalfFloat(e){return Hs(e)}static fromHalfFloat(e){return Bg(e)}},qi=new Y,vx=new We,mG=0,In=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:mG++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=Qf,this.updateRanges=[],this.gpuType=Rr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)vx.fromBufferAttribute(this,n),vx.applyMatrix3(e),this.setXY(n,vx.x,vx.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix3(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix4(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.applyNormalMatrix(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.transformDirection(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=ys(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Qt(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=ys(n,this.array)),n}setX(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=ys(n,this.array)),n}setY(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=ys(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=ys(n,this.array)),n}setW(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array),s=Qt(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Qf&&(e.usage=this.usage),e}},nS=class extends In{constructor(e,n,i){super(new Int8Array(e),n,i)}},iS=class extends In{constructor(e,n,i){super(new Uint8Array(e),n,i)}},rS=class extends In{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}},sS=class extends In{constructor(e,n,i){super(new Int16Array(e),n,i)}},ip=class extends In{constructor(e,n,i){super(new Uint16Array(e),n,i)}},oS=class extends In{constructor(e,n,i){super(new Int32Array(e),n,i)}},rp=class extends In{constructor(e,n,i){super(new Uint32Array(e),n,i)}},aS=class extends In{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=Bg(this.array[e*this.itemSize]);return this.normalized&&(n=ys(n,this.array)),n}setX(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize]=Hs(n),this}getY(e){let n=Bg(this.array[e*this.itemSize+1]);return this.normalized&&(n=ys(n,this.array)),n}setY(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize+1]=Hs(n),this}getZ(e){let n=Bg(this.array[e*this.itemSize+2]);return this.normalized&&(n=ys(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize+2]=Hs(n),this}getW(e){let n=Bg(this.array[e*this.itemSize+3]);return this.normalized&&(n=ys(n,this.array)),n}setW(e,n){return this.normalized&&(n=Qt(n,this.array)),this.array[e*this.itemSize+3]=Hs(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array)),this.array[e+0]=Hs(n),this.array[e+1]=Hs(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array)),this.array[e+0]=Hs(n),this.array[e+1]=Hs(i),this.array[e+2]=Hs(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array),s=Qt(s,this.array)),this.array[e+0]=Hs(n),this.array[e+1]=Hs(i),this.array[e+2]=Hs(r),this.array[e+3]=Hs(s),this}},bt=class extends In{constructor(e,n,i){super(new Float32Array(e),n,i)}},gG=0,Jo=new Ft,OM=new Ln,Nf=new Y,vo=new Pi,kg=new Pi,_r=new Y,Wt=class t extends xo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:gG++}),this.uuid=yo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(K2(e)?rp:ip)(e,1):this.index=e,this}setIndirect(e,n=0){return this.indirect=e,this.indirectOffset=n,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){let n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new Xt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Jo.makeRotationFromQuaternion(e),this.applyMatrix4(Jo),this}rotateX(e){return Jo.makeRotationX(e),this.applyMatrix4(Jo),this}rotateY(e){return Jo.makeRotationY(e),this.applyMatrix4(Jo),this}rotateZ(e){return Jo.makeRotationZ(e),this.applyMatrix4(Jo),this}translate(e,n,i){return Jo.makeTranslation(e,n,i),this.applyMatrix4(Jo),this}scale(e,n,i){return Jo.makeScale(e,n,i),this.applyMatrix4(Jo),this}lookAt(e){return OM.lookAt(e),OM.updateMatrix(),this.applyMatrix4(OM.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Nf).negate(),this.translate(Nf.x,Nf.y,Nf.z),this}setFromPoints(e){let n=this.getAttribute("position");if(n===void 0){let i=[];for(let r=0,s=e.length;r<s;r++){let o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new bt(i,3))}else{let i=Math.min(e.length,n.count);for(let r=0;r<i;r++){let s=e[r];n.setXYZ(r,s.x,s.y,s.z||0)}e.length>n.count&&ut("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Pi);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){It("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Y(-1/0,-1/0,-1/0),new Y(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){let s=n[i];vo.setFromBufferAttribute(s),this.morphTargetsRelative?(_r.addVectors(this.boundingBox.min,vo.min),this.boundingBox.expandByPoint(_r),_r.addVectors(this.boundingBox.max,vo.max),this.boundingBox.expandByPoint(_r)):(this.boundingBox.expandByPoint(vo.min),this.boundingBox.expandByPoint(vo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&It('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Di);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){It("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Y,1/0);return}if(e){let i=this.boundingSphere.center;if(vo.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){let a=n[s];kg.setFromBufferAttribute(a),this.morphTargetsRelative?(_r.addVectors(vo.min,kg.min),vo.expandByPoint(_r),_r.addVectors(vo.max,kg.max),vo.expandByPoint(_r)):(vo.expandByPoint(kg.min),vo.expandByPoint(kg.max))}vo.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)_r.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(_r));if(n)for(let s=0,o=n.length;s<o;s++){let a=n[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)_r.fromBufferAttribute(a,c),l&&(Nf.fromBufferAttribute(e,c),_r.add(Nf)),r=Math.max(r,i.distanceToSquared(_r))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&It('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){It("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=n.position,r=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new In(new Float32Array(4*i.count),4));let o=this.getAttribute("tangent"),a=[],l=[];for(let P=0;P<i.count;P++)a[P]=new Y,l[P]=new Y;let c=new Y,u=new Y,d=new Y,p=new We,m=new We,g=new We,_=new Y,y=new Y;function v(P,T,A){c.fromBufferAttribute(i,P),u.fromBufferAttribute(i,T),d.fromBufferAttribute(i,A),p.fromBufferAttribute(s,P),m.fromBufferAttribute(s,T),g.fromBufferAttribute(s,A),u.sub(c),d.sub(c),m.sub(p),g.sub(p);let I=1/(m.x*g.y-g.x*m.y);isFinite(I)&&(_.copy(u).multiplyScalar(g.y).addScaledVector(d,-m.y).multiplyScalar(I),y.copy(d).multiplyScalar(m.x).addScaledVector(u,-g.x).multiplyScalar(I),a[P].add(_),a[T].add(_),a[A].add(_),l[P].add(y),l[T].add(y),l[A].add(y))}let S=this.groups;S.length===0&&(S=[{start:0,count:e.count}]);for(let P=0,T=S.length;P<T;++P){let A=S[P],I=A.start,F=A.count;for(let B=I,O=I+F;B<O;B+=3)v(e.getX(B+0),e.getX(B+1),e.getX(B+2))}let b=new Y,w=new Y,C=new Y,M=new Y;function L(P){C.fromBufferAttribute(r,P),M.copy(C);let T=a[P];b.copy(T),b.sub(C.multiplyScalar(C.dot(T))).normalize(),w.crossVectors(M,T);let I=w.dot(l[P])<0?-1:1;o.setXYZW(P,b.x,b.y,b.z,I)}for(let P=0,T=S.length;P<T;++P){let A=S[P],I=A.start,F=A.count;for(let B=I,O=I+F;B<O;B+=3)L(e.getX(B+0)),L(e.getX(B+1)),L(e.getX(B+2))}}computeVertexNormals(){let e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new In(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);let r=new Y,s=new Y,o=new Y,a=new Y,l=new Y,c=new Y,u=new Y,d=new Y;if(e)for(let p=0,m=e.count;p<m;p+=3){let g=e.getX(p+0),_=e.getX(p+1),y=e.getX(p+2);r.fromBufferAttribute(n,g),s.fromBufferAttribute(n,_),o.fromBufferAttribute(n,y),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,g),l.fromBufferAttribute(i,_),c.fromBufferAttribute(i,y),a.add(u),l.add(u),c.add(u),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(_,l.x,l.y,l.z),i.setXYZ(y,c.x,c.y,c.z)}else for(let p=0,m=n.count;p<m;p+=3)r.fromBufferAttribute(n,p+0),s.fromBufferAttribute(n,p+1),o.fromBufferAttribute(n,p+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(p+0,u.x,u.y,u.z),i.setXYZ(p+1,u.x,u.y,u.z),i.setXYZ(p+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)_r.fromBufferAttribute(e,n),_r.normalize(),e.setXYZ(n,_r.x,_r.y,_r.z)}toNonIndexed(){function e(a,l){let c=a.array,u=a.itemSize,d=a.normalized,p=new c.constructor(l.length*u),m=0,g=0;for(let _=0,y=l.length;_<y;_++){a.isInterleavedBufferAttribute?m=l[_]*a.data.stride+a.offset:m=l[_]*u;for(let v=0;v<u;v++)p[g++]=c[m++]}return new In(p,u,d)}if(this.index===null)return ut("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let n=new t,i=this.index.array,r=this.attributes;for(let a in r){let l=r[a],c=e(l,i);n.setAttribute(a,c)}let s=this.morphAttributes;for(let a in s){let l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){let p=c[u],m=e(p,i);l.push(m)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,l=o.length;a<l;a++){let c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){let e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};let n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});let i=this.attributes;for(let l in i){let c=i[l];e.data.attributes[l]=c.toJSON(e.data)}let r={},s=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],u=[];for(let d=0,p=c.length;d<p;d++){let m=c[d];u.push(m.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let n={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone());let r=e.attributes;for(let c in r){let u=r[c];this.setAttribute(c,u.clone(n))}let s=e.morphAttributes;for(let c in s){let u=[],d=s[c];for(let p=0,m=d.length;p<m;p++)u.push(d[p].clone(n));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let c=0,u=o.length;c<u;c++){let d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},GN=new Ft,Lh=new Pa,_x=new Di,jN=new Y,yx=new Y,xx=new Y,Sx=new Y,BM=new Y,bx=new Y,XN=new Y,wx=new Y,zn=class extends Ln{constructor(e=new Wt,n=new So){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){let r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){let i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){bx.set(0,0,0);for(let l=0,c=s.length;l<c;l++){let u=a[l],d=s[l];u!==0&&(BM.fromBufferAttribute(d,e),o?bx.addScaledVector(BM,u):bx.addScaledVector(BM.sub(n),u))}n.add(bx)}return n}raycast(e,n){let i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),_x.copy(i.boundingSphere),_x.applyMatrix4(s),Lh.copy(e.ray).recast(e.near),!(_x.containsPoint(Lh.origin)===!1&&(Lh.intersectSphere(_x,jN)===null||Lh.origin.distanceToSquared(jN)>(e.far-e.near)**2))&&(GN.copy(s).invert(),Lh.copy(e.ray).applyMatrix4(GN),!(i.boundingBox!==null&&Lh.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Lh)))}_computeIntersections(e,n,i){let r,s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,p=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let g=0,_=p.length;g<_;g++){let y=p[g],v=o[y.materialIndex],S=Math.max(y.start,m.start),b=Math.min(a.count,Math.min(y.start+y.count,m.start+m.count));for(let w=S,C=b;w<C;w+=3){let M=a.getX(w),L=a.getX(w+1),P=a.getX(w+2);r=Ex(this,v,e,i,c,u,d,M,L,P),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{let g=Math.max(0,m.start),_=Math.min(a.count,m.start+m.count);for(let y=g,v=_;y<v;y+=3){let S=a.getX(y),b=a.getX(y+1),w=a.getX(y+2);r=Ex(this,o,e,i,c,u,d,S,b,w),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let g=0,_=p.length;g<_;g++){let y=p[g],v=o[y.materialIndex],S=Math.max(y.start,m.start),b=Math.min(l.count,Math.min(y.start+y.count,m.start+m.count));for(let w=S,C=b;w<C;w+=3){let M=w,L=w+1,P=w+2;r=Ex(this,v,e,i,c,u,d,M,L,P),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{let g=Math.max(0,m.start),_=Math.min(l.count,m.start+m.count);for(let y=g,v=_;y<v;y+=3){let S=y,b=y+1,w=y+2;r=Ex(this,o,e,i,c,u,d,S,b,w),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}}};Su=class t extends Wt{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let l=[],c=[],u=[],d=[],p=0,m=0;g("z","y","x",-1,-1,i,n,e,o,s,0),g("z","y","x",1,-1,i,n,-e,o,s,1),g("x","z","y",1,1,e,i,n,r,o,2),g("x","z","y",1,-1,e,i,-n,r,o,3),g("x","y","z",1,-1,e,n,i,r,s,4),g("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new bt(c,3)),this.setAttribute("normal",new bt(u,3)),this.setAttribute("uv",new bt(d,2));function g(_,y,v,S,b,w,C,M,L,P,T){let A=w/L,I=C/P,F=w/2,B=C/2,O=M/2,z=L+1,U=P+1,G=0,j=0,J=new Y;for(let K=0;K<U;K++){let D=K*I-B;for(let X=0;X<z;X++){let q=X*A-F;J[_]=q*S,J[y]=D*b,J[v]=O,c.push(J.x,J.y,J.z),J[_]=0,J[y]=0,J[v]=M>0?1:-1,u.push(J.x,J.y,J.z),d.push(X/L),d.push(1-K/P),G+=1}}for(let K=0;K<P;K++)for(let D=0;D<L;D++){let X=p+D+z*K,q=p+D+z*(K+1),ne=p+(D+1)+z*(K+1),re=p+(D+1)+z*K;l.push(X,q,re),l.push(q,ne,re),j+=6}a.addGroup(m,j,T),m+=j,p+=G}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};K0={clone:ud,merge:ns},yG=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,xG=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,bs=class extends sr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=yG,this.fragmentShader=xG,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ud(e.uniforms),this.uniformsGroups=_G(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){let n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(let r in this.uniforms){let o=this.uniforms[r].value;o&&o.isTexture?n.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[r]={type:"m4",value:o.toArray()}:n.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}},lc=class extends Ln{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ft,this.projectionMatrix=new Ft,this.projectionMatrixInverse=new Ft,this.coordinateSystem=Ws,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},du=new Y,qN=new We,YN=new We,Zn=class extends lc{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let n=.5*this.getFilmHeight()/e;this.fov=Gh*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Hh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Gh*2*Math.atan(Math.tan(Hh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){du.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(du.x,du.y).multiplyScalar(-e/du.z),du.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(du.x,du.y).multiplyScalar(-e/du.z)}getViewSize(e,n){return this.getViewBounds(e,qN,YN),n.subVectors(YN,qN)}setViewOffset(e,n,i,r,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,n=e*Math.tan(Hh*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,n-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}},Of=-90,Bf=1,qg=class extends Ln{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new Zn(Of,Bf,e,n);r.layers=this.layers,this.add(r);let s=new Zn(Of,Bf,e,n);s.layers=this.layers,this.add(s);let o=new Zn(Of,Bf,e,n);o.layers=this.layers,this.add(o);let a=new Zn(Of,Bf,e,n);a.layers=this.layers,this.add(a);let l=new Zn(Of,Bf,e,n);l.layers=this.layers,this.add(l);let c=new Zn(Of,Bf,e,n);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){let e=this.coordinateSystem,n=this.children.concat(),[i,r,s,o,a,l]=n;for(let c of n)this.remove(c);if(e===Ws)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Wh)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let c of n)this.add(c),c.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,l,c,u]=this.children,d=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;let _=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,o),e.setRenderTarget(i,2,r),e.render(n,a),e.setRenderTarget(i,3,r),e.render(n,l),e.setRenderTarget(i,4,r),e.render(n,c),i.texture.generateMipmaps=_,e.setRenderTarget(i,5,r),e.render(n,u),e.setRenderTarget(d,p,m),e.xr.enabled=g,i.texture.needsPMREMUpdate=!0}},bu=class extends bi{constructor(e=[],n=Ua,i,r,s,o,a,l,c,u){super(e,n,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},sp=class extends Qr{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new bu(r),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Su(5,5,5),s=new bs({name:"CubemapFromEquirect",uniforms:ud(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:es,blending:Ba});s.uniforms.tEquirect.value=n;let o=new zn(r,s),a=n.minFilter;return n.minFilter===Fa&&(n.minFilter=Un),new qg(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n=!0,i=!0,r=!0){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,r);e.setRenderTarget(s)}},sc=class extends Ln{constructor(){super(),this.isGroup=!0,this.type="Group"}},SG={type:"move"},qh=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new sc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new sc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Y,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Y),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new sc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Y,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Y),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let n=this._hand;if(n)for(let i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,o=null,a=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(let _ of e.hand.values()){let y=n.getJointPose(_,i),v=this._getHandJoint(c,_);y!==null&&(v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=y.radius),v.visible=y!==null}let u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],p=u.position.distanceTo(d.position),m=.02,g=.005;c.inputState.pinching&&p>m+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(SG)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){let i=new sc;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}},Yg=class t{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new dt(e),this.density=n}clone(){return new t(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}},Kg=class t{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new dt(e),this.near=n,this.far=i}clone(){return new t(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}},Yh=class extends Ln{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Vs,this.environmentIntensity=1,this.environmentRotation=new Vs,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}},Kh=class{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=Qf,this.updateRanges=[],this.version=0,this.uuid=yo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=yo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=yo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},vs=new Y,wu=class t{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)vs.fromBufferAttribute(this,n),vs.applyMatrix4(e),this.setXYZ(n,vs.x,vs.y,vs.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)vs.fromBufferAttribute(this,n),vs.applyNormalMatrix(e),this.setXYZ(n,vs.x,vs.y,vs.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)vs.fromBufferAttribute(this,n),vs.transformDirection(e),this.setXYZ(n,vs.x,vs.y,vs.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=ys(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Qt(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=Qt(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=Qt(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=Qt(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=Qt(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=ys(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=ys(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=ys(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=ys(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array),s=Qt(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){tp("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let n=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new In(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new t(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){tp("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let n=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},op=class extends sr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new dt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},Lg=new Y,Ff=new Y,zf=new Y,Hf=new We,Pg=new We,A4=new Ft,Cx=new Y,Dg=new Y,Tx=new Y,KN=new We,UM=new We,$N=new We,$g=class extends Ln{constructor(e=new op){if(super(),this.isSprite=!0,this.type="Sprite",Uf===void 0){Uf=new Wt;let n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Kh(n,5);Uf.setIndex([0,1,2,0,2,3]),Uf.setAttribute("position",new wu(i,3,0,!1)),Uf.setAttribute("uv",new wu(i,2,3,!1))}this.geometry=Uf,this.material=e,this.center=new We(.5,.5),this.count=1}raycast(e,n){e.camera===null&&It('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ff.setFromMatrixScale(this.matrixWorld),A4.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),zf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ff.multiplyScalar(-zf.z);let i=this.material.rotation,r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));let o=this.center;Mx(Cx.set(-.5,-.5,0),zf,o,Ff,r,s),Mx(Dg.set(.5,-.5,0),zf,o,Ff,r,s),Mx(Tx.set(.5,.5,0),zf,o,Ff,r,s),KN.set(0,0),UM.set(1,0),$N.set(1,1);let a=e.ray.intersectTriangle(Cx,Dg,Tx,!1,Lg);if(a===null&&(Mx(Dg.set(-.5,.5,0),zf,o,Ff,r,s),UM.set(0,1),a=e.ray.intersectTriangle(Cx,Tx,Dg,!1,Lg),a===null))return;let l=e.ray.origin.distanceTo(Lg);l<e.near||l>e.far||n.push({distance:l,point:Lg.clone(),uv:Ma.getInterpolation(Lg,Cx,Dg,Tx,KN,UM,$N,new We),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}};Ax=new Y,JN=new Y,Jg=class extends Ln{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let n=e.levels;for(let i=0,r=n.length;i<r;i++){let s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);let r=this.levels,s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){let n=this.levels;for(let i=0;i<n.length;i++)if(n[i].distance===e){let r=n.splice(i,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){Ax.setFromMatrixPosition(this.matrixWorld);let r=e.ray.origin.distanceTo(Ax);this.getObjectForDistance(r).raycast(e,n)}}update(e){let n=this.levels;if(n.length>1){Ax.setFromMatrixPosition(e.matrixWorld),JN.setFromMatrixPosition(this.matrixWorld);let i=Ax.distanceTo(JN)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let o=n[r].distance;if(n[r].object.visible&&(o-=o*n[r].hysteresis),i>=o)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){let n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];let i=this.levels;for(let r=0,s=i.length;r<s;r++){let o=i[r];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}},ZN=new Y,QN=new Rn,eO=new Rn,bG=new Y,tO=new Ft,kx=new Y,FM=new Di,nO=new Ft,zM=new Pa,Zg=class extends zn{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Jx,this.bindMatrix=new Ft,this.bindMatrixInverse=new Ft,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Pi),this.boundingBox.makeEmpty();let n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,kx),this.boundingBox.expandByPoint(kx)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Di),this.boundingSphere.makeEmpty();let n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,kx),this.boundingSphere.expandByPoint(kx)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){let i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),FM.copy(this.boundingSphere),FM.applyMatrix4(r),e.ray.intersectsSphere(FM)!==!1&&(nO.copy(r).invert(),zM.copy(e.ray).applyMatrix4(nO),!(this.boundingBox!==null&&zM.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,zM)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Rn,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Jx?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===O2?this.bindMatrixInverse.copy(this.bindMatrix).invert():ut("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){let i=this.skeleton,r=this.geometry;QN.fromBufferAttribute(r.attributes.skinIndex,e),eO.fromBufferAttribute(r.attributes.skinWeight,e),ZN.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){let o=eO.getComponent(s);if(o!==0){let a=QN.getComponent(s);tO.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),n.addScaledVector(bG.copy(ZN).applyMatrix4(tO),o)}}return n.applyMatrix4(this.bindMatrixInverse)}},ap=class extends Ln{constructor(){super(),this.isBone=!0,this.type="Bone"}},Ss=class extends bi{constructor(e=null,n=1,i=1,r,s,o,a,l,c=Ii,u=Ii,d,p){super(null,o,a,l,c,u,r,s,d,p),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},iO=new Ft,wG=new Ft,Qg=class t{constructor(e=[],n=[]){this.uuid=yo(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){ut("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ft)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){let i=new Ft;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){let a=e[s]?e[s].matrixWorld:wG;iO.multiplyMatrices(a,n[s]),iO.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new t(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let n=new Float32Array(e*e*4);n.set(this.boneMatrices);let i=new Ss(n,e,e,rr,Rr);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){let r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){let s=e.bones[i],o=n[s];o===void 0&&(ut("Skeleton: No bone found with UUID:",s),o=new ap),this.bones.push(o),this.boneInverses.push(new Ft().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){let o=n[r];e.bones.push(o.uuid);let a=i[r];e.boneInverses.push(a.toArray())}return e}},Ia=class extends In{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Wf=new Ft,rO=new Ft,Lx=[],sO=new Pi,EG=new Ft,Ig=new zn,Rg=new Di,ev=class extends zn{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Ia(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,EG)}computeBoundingBox(){let e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new Pi),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Wf),sO.copy(e.boundingBox).applyMatrix4(Wf),this.boundingBox.union(sO)}computeBoundingSphere(){let e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Di),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Wf),Rg.copy(e.boundingSphere).applyMatrix4(Wf),this.boundingSphere.union(Rg)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){let i=n.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,o=e*s+1;for(let a=0;a<i.length;a++)i[a]=r[o+a]}raycast(e,n){let i=this.matrixWorld,r=this.count;if(Ig.geometry=this.geometry,Ig.material=this.material,Ig.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Rg.copy(this.boundingSphere),Rg.applyMatrix4(i),e.ray.intersectsSphere(Rg)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Wf),rO.multiplyMatrices(i,Wf),Ig.matrixWorld=rO,Ig.raycast(e,Lx);for(let o=0,a=Lx.length;o<a;o++){let l=Lx[o];l.instanceId=s,l.object=this,n.push(l)}Lx.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Ia(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){let i=n.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new Ss(new Float32Array(r*this.count),r,this.count,h0,Rr));let s=this.morphTexture.source.data.data,o=0;for(let c=0;c<i.length;c++)o+=i[c];let a=this.geometry.morphTargetsRelative?1:1-o,l=r*e;s[l]=a,s.set(i,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}},HM=new Y,CG=new Y,TG=new Xt,_o=class{constructor(e=new Y(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){let r=HM.subVectors(i,n).cross(CG.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){let i=e.delta(HM),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){let n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){let i=n||TG.getNormalMatrix(e),r=this.coplanarPoint(HM).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Ph=new Di,MG=new We(.5,.5),Px=new Y,cc=class{constructor(e=new _o,n=new _o,i=new _o,r=new _o,s=new _o,o=new _o){this.planes=[e,n,i,r,s,o]}set(e,n,i,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Ws,i=!1){let r=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],c=s[3],u=s[4],d=s[5],p=s[6],m=s[7],g=s[8],_=s[9],y=s[10],v=s[11],S=s[12],b=s[13],w=s[14],C=s[15];if(r[0].setComponents(c-o,m-u,v-g,C-S).normalize(),r[1].setComponents(c+o,m+u,v+g,C+S).normalize(),r[2].setComponents(c+a,m+d,v+_,C+b).normalize(),r[3].setComponents(c-a,m-d,v-_,C-b).normalize(),i)r[4].setComponents(l,p,y,w).normalize(),r[5].setComponents(c-l,m-p,v-y,C-w).normalize();else if(r[4].setComponents(c-l,m-p,v-y,C-w).normalize(),n===Ws)r[5].setComponents(c+l,m+p,v+y,C+w).normalize();else if(n===Wh)r[5].setComponents(l,p,y,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Ph.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Ph.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ph)}intersectsSprite(e){Ph.center.set(0,0,0);let n=MG.distanceTo(e.center);return Ph.radius=.7071067811865476+n,Ph.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ph)}intersectsSphere(e){let n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){let n=this.planes;for(let i=0;i<6;i++){let r=n[i];if(Px.x=r.normal.x>0?e.max.x:e.min.x,Px.y=r.normal.y>0?e.max.y:e.min.y,Px.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Px)<0)return!1}return!0}containsPoint(e){let n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},ll=new Ft,cl=new cc,tv=class t{constructor(){this.coordinateSystem=Ws}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){let r=n.cameras[i];if(ll.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cl.setFromProjectionMatrix(ll,r.coordinateSystem,r.reversedDepth),cl.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){let r=n.cameras[i];if(ll.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cl.setFromProjectionMatrix(ll,r.coordinateSystem,r.reversedDepth),cl.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){let r=n.cameras[i];if(ll.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cl.setFromProjectionMatrix(ll,r.coordinateSystem,r.reversedDepth),cl.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){let r=n.cameras[i];if(ll.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cl.setFromProjectionMatrix(ll,r.coordinateSystem,r.reversedDepth),cl.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){let r=n.cameras[i];if(ll.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cl.setFromProjectionMatrix(ll,r.coordinateSystem,r.reversedDepth),cl.containsPoint(e))return!0}return!1}clone(){return new t}};t2=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i,r){let s=this.pool,o=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});let a=s[this.index];o.push(a),this.index++,a.start=e,a.count=n,a.z=i,a.index=r}reset(){this.list.length=0,this.index=0}},zs=new Ft,LG=new dt(1,1,1),oO=new cc,PG=new tv,Dx=new Pi,Dh=new Di,Ng=new Y,aO=new Y,DG=new Y,VM=new t2,Zr=new zn,Ix=[];nv=class extends zn{constructor(e,n,i=n*2,r){super(new Wt,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let n=new Float32Array(e*e*4),i=new Ss(n,e,e,rr,Rr);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let n=new Uint32Array(e*e),i=new Ss(n,e,e,Pp,wo);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let n=new Float32Array(e*e*4).fill(1),i=new Ss(n,e,e,rr,Rr);i.colorSpace=yn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){let n=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(let s in e.attributes){let o=e.getAttribute(s),{array:a,itemSize:l,normalized:c}=o,u=new a.constructor(i*l),d=new In(u,l,c);n.setAttribute(s,d)}if(e.getIndex()!==null){let s=i>65535?new Uint32Array(r):new Uint16Array(r);n.setIndex(new In(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){let n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let i in n.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);let r=e.getAttribute(i),s=n.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){let n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){let n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Pi);let e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;let s=n[i].geometryIndex;this.getMatrixAt(i,zs),this.getBoundingBoxAt(s,Dx).applyMatrix4(zs),e.union(Dx)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Di);let e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;let s=n[i].geometryIndex;this.getMatrixAt(i,zs),this.getBoundingSphereAt(s,Dh).applyMatrix4(zs),e.union(Dh)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");let i={visible:!0,active:!0,geometryIndex:e},r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(WM),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=i):(r=this._instanceInfo.length,this._instanceInfo.push(i));let s=this._matricesTexture;zs.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;let o=this._colorsTexture;return o&&(LG.toArray(o.image.data,r*4),o.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,n=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);let r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=n===-1?e.getAttribute("position").count:n;let o=e.getIndex();if(o!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=i===-1?o.count:i),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(WM),l=this._availableGeometryIds.shift(),s[l]=r):(l=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(l,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,l}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);let i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),o=n.getIndex(),a=this._geometryInfo[e];if(r&&o.count>a.reservedIndexCount||n.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let l=a.vertexStart,c=a.reservedVertexCount;a.vertexCount=n.getAttribute("position").count;for(let u in i.attributes){let d=n.getAttribute(u),p=i.getAttribute(u);IG(d,p,l);let m=d.itemSize;for(let g=d.count,_=c;g<_;g++){let y=l+g;for(let v=0;v<m;v++)p.setComponent(y,v,0)}p.needsUpdate=!0,p.addUpdateRange(l*m,c*m)}if(r){let u=a.indexStart,d=a.reservedIndexCount;a.indexCount=n.getIndex().count;for(let p=0;p<o.count;p++)s.setX(u+p,l+o.getX(p));for(let p=o.count,m=d;p<m;p++)s.setX(u+p,l);s.needsUpdate=!0,s.addUpdateRange(u,a.reservedIndexCount)}return a.start=r?a.indexStart:a.vertexStart,a.count=r?a.indexCount:a.vertexCount,a.boundingBox=null,n.boundingBox!==null&&(a.boundingBox=n.boundingBox.clone()),a.boundingSphere=null,n.boundingSphere!==null&&(a.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;let i=this._instanceInfo;for(let r=0,s=i.length;r<s;r++)i[r].active&&i[r].geometryIndex===e&&this.deleteInstance(r);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0,i=this._geometryInfo,r=i.map((o,a)=>a).sort((o,a)=>i[o].vertexStart-i[a].vertexStart),s=this.geometry;for(let o=0,a=i.length;o<a;o++){let l=r[o],c=i[l];if(c.active!==!1){if(s.index!==null){if(c.indexStart!==n){let{indexStart:u,vertexStart:d,reservedIndexCount:p}=c,m=s.index,g=m.array,_=e-d;for(let y=u;y<u+p;y++)g[y]=g[y]+_;m.array.copyWithin(n,u,u+p),m.addUpdateRange(n,p),m.needsUpdate=!0,c.indexStart=n}n+=c.reservedIndexCount}if(c.vertexStart!==e){let{vertexStart:u,reservedVertexCount:d}=c,p=s.attributes;for(let m in p){let g=p[m],{array:_,itemSize:y}=g;_.copyWithin(e*y,u*y,(u+d)*y),g.addUpdateRange(e*y,d*y),g.needsUpdate=!0}c.vertexStart=e}e+=c.reservedVertexCount,c.start=s.index?c.indexStart:c.vertexStart,this._nextIndexStart=s.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;let i=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){let s=new Pi,o=i.index,a=i.attributes.position;for(let l=r.start,c=r.start+r.count;l<c;l++){let u=l;o&&(u=o.getX(u)),s.expandByPoint(Ng.fromBufferAttribute(a,u))}r.boundingBox=s}return n.copy(r.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;let i=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){let s=new Di;this.getBoundingBoxAt(e,Dx),Dx.getCenter(s.center);let o=i.index,a=i.attributes.position,l=0;for(let c=r.start,u=r.start+r.count;c<u;c++){let d=c;o&&(d=o.getX(d)),Ng.fromBufferAttribute(a,d),l=Math.max(l,s.center.distanceToSquared(Ng))}s.radius=Math.sqrt(l),r.boundingSphere=s}return n.copy(r.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);let i=this._matricesTexture,r=this._matricesTexture.image.data;return n.toArray(r,e*16),i.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);let i=this._geometryInfo[e];return n.vertexStart=i.vertexStart,n.vertexCount=i.vertexCount,n.reservedVertexCount=i.reservedVertexCount,n.indexStart=i.indexStart,n.indexCount=i.indexCount,n.reservedIndexCount=i.reservedIndexCount,n.start=i.start,n.count=i.count,n}setInstanceCount(e){let n=this._availableInstanceIds,i=this._instanceInfo;for(n.sort(WM);n[n.length-1]===i.length-1;)i.pop(),n.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);let r=new Int32Array(e),s=new Int32Array(e);Ih(this._multiDrawCounts,r),Ih(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;let o=this._indirectTexture,a=this._matricesTexture,l=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Ih(o.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),Ih(a.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),Ih(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){let i=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...i.map(a=>a.vertexStart+a.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(l=>l.indexStart+l.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);let s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Wt,this._initializeGeometry(s));let o=this.geometry;s.index&&Ih(s.index.array,o.index.array);for(let a in s.attributes)Ih(s.attributes[a].array,o.attributes[a].array)}raycast(e,n){let i=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,o=this.geometry;Zr.material=this.material,Zr.geometry.index=o.index,Zr.geometry.attributes=o.attributes,Zr.geometry.boundingBox===null&&(Zr.geometry.boundingBox=new Pi),Zr.geometry.boundingSphere===null&&(Zr.geometry.boundingSphere=new Di);for(let a=0,l=i.length;a<l;a++){if(!i[a].visible||!i[a].active)continue;let c=i[a].geometryIndex,u=r[c];Zr.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(a,Zr.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,Zr.geometry.boundingBox),this.getBoundingSphereAt(c,Zr.geometry.boundingSphere),Zr.raycast(e,Ix);for(let d=0,p=Ix.length;d<p;d++){let m=Ix[d];m.object=this,m.batchId=a,n.push(m)}Ix.length=0}Zr.material=null,Zr.geometry.index=null,Zr.geometry.attributes={},Zr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,n,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=r.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,d=this._geometryInfo,p=this.perObjectFrustumCulled,m=this._indirectTexture,g=m.image.data,_=i.isArrayCamera?PG:oO;p&&!i.isArrayCamera&&(zs.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),oO.setFromProjectionMatrix(zs,i.coordinateSystem,i.reversedDepth));let y=0;if(this.sortObjects){zs.copy(this.matrixWorld).invert(),Ng.setFromMatrixPosition(i.matrixWorld).applyMatrix4(zs),aO.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(zs);for(let b=0,w=l.length;b<w;b++)if(l[b].visible&&l[b].active){let C=l[b].geometryIndex;this.getMatrixAt(b,zs),this.getBoundingSphereAt(C,Dh).applyMatrix4(zs);let M=!1;if(p&&(M=!_.intersectsSphere(Dh,i)),!M){let L=d[C],P=DG.subVectors(Dh.center,Ng).dot(aO);VM.push(L.start,L.count,P,b)}}let v=VM.list,S=this.customSort;S===null?v.sort(s.transparent?kG:AG):S.call(this,v,i);for(let b=0,w=v.length;b<w;b++){let C=v[b];c[y]=C.start*a,u[y]=C.count,g[y]=C.index,y++}VM.reset()}else for(let v=0,S=l.length;v<S;v++)if(l[v].visible&&l[v].active){let b=l[v].geometryIndex,w=!1;if(p&&(this.getMatrixAt(v,zs),this.getBoundingSphereAt(b,Dh).applyMatrix4(zs),w=!_.intersectsSphere(Dh,i)),!w){let C=d[b];c[y]=C.start*a,u[y]=C.count,g[y]=v,y++}}m.needsUpdate=!0,this._multiDrawCount=y,this._visibilityChanged=!1}onBeforeShadow(e,n,i,r,s,o){this.onBeforeRender(e,null,r,s,o)}},yr=class extends sr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new dt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},lS=new Y,cS=new Y,lO=new Ft,Og=new Pa,Rx=new Di,GM=new Y,cO=new Y,Ra=class extends Ln{constructor(e=new Wt,n=new yr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)lS.fromBufferAttribute(n,r-1),cS.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=lS.distanceTo(cS);e.setAttribute("lineDistance",new bt(i,1))}else ut("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){let i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Rx.copy(i.boundingSphere),Rx.applyMatrix4(r),Rx.radius+=s,e.ray.intersectsSphere(Rx)===!1)return;lO.copy(r).invert(),Og.copy(e.ray).applyMatrix4(lO);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=this.isLineSegments?2:1,u=i.index,p=i.attributes.position;if(u!==null){let m=Math.max(0,o.start),g=Math.min(u.count,o.start+o.count);for(let _=m,y=g-1;_<y;_+=c){let v=u.getX(_),S=u.getX(_+1),b=Nx(this,e,Og,l,v,S,_);b&&n.push(b)}if(this.isLineLoop){let _=u.getX(g-1),y=u.getX(m),v=Nx(this,e,Og,l,_,y,g-1);v&&n.push(v)}}else{let m=Math.max(0,o.start),g=Math.min(p.count,o.start+o.count);for(let _=m,y=g-1;_<y;_+=c){let v=Nx(this,e,Og,l,_,_+1,_);v&&n.push(v)}if(this.isLineLoop){let _=Nx(this,e,Og,l,g-1,m,g-1);_&&n.push(_)}}}updateMorphTargets(){let n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){let r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};uO=new Y,hO=new Y,bo=class extends Ra{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)uO.fromBufferAttribute(n,r),hO.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+uO.distanceTo(hO);e.setAttribute("lineDistance",new bt(i,1))}else ut("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},iv=class extends Ra{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}},lp=class extends sr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new dt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},dO=new Ft,n2=new Pa,Ox=new Di,Bx=new Y,rv=class extends Ln{constructor(e=new Wt,n=new lp){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){let i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Ox.copy(i.boundingSphere),Ox.applyMatrix4(r),Ox.radius+=s,e.ray.intersectsSphere(Ox)===!1)return;dO.copy(r).invert(),n2.copy(e.ray).applyMatrix4(dO);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(c!==null){let p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);for(let g=p,_=m;g<_;g++){let y=c.getX(g);Bx.fromBufferAttribute(d,y),fO(Bx,y,l,r,e,n,this)}}else{let p=Math.max(0,o.start),m=Math.min(d.count,o.start+o.count);for(let g=p,_=m;g<_;g++)Bx.fromBufferAttribute(d,g),fO(Bx,g,l,r,e,n,this)}}updateMorphTargets(){let n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){let r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};sv=class extends bi{constructor(e,n,i,r,s=Un,o=Un,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;let u=this;function d(){u.needsUpdate=!0,u._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d))}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}},uS=class extends sv{constructor(e,n,i,r,s,o,a,l){super({},e,n,i,r,s,o,a,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}},hS=class extends bi{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Ii,this.minFilter=Ii,this.generateMipmaps=!1,this.needsUpdate=!0}},$h=class extends bi{constructor(e,n,i,r,s,o,a,l,c,u,d,p){super(null,o,a,l,c,u,r,s,d,p),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}},dS=class extends $h{constructor(e,n,i,r,s,o){super(e,n,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=xs,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},fS=class extends $h{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,Ua),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}},pS=class extends bi{constructor(e,n,i,r,s,o,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}},uc=class extends bi{constructor(e,n,i=wo,r,s,o,a=Ii,l=Ii,c,u=La,d=1){if(u!==La&&u!==gc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");let p={width:e,height:n,depth:d};super(p,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Aa(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){let n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}},ov=class extends uc{constructor(e,n=wo,i=Ua,r,s,o=Ii,a=Ii,l,c=La){let u={width:e,height:e,depth:1},d=[u,u,u,u,u,u];super(e,e,n,i,r,s,o,a,l,c),this.image=d,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}},cp=class extends bi{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}},av=class t extends Wt{constructor(e=1,n=1,i=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r,heightSegments:s},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));let o=[],a=[],l=[],c=[],u=n/2,d=Math.PI/2*e,p=n,m=2*d+p,g=i*2+s,_=r+1,y=new Y,v=new Y;for(let S=0;S<=g;S++){let b=0,w=0,C=0,M=0;if(S<=i){let T=S/i,A=T*Math.PI/2;w=-u-e*Math.cos(A),C=e*Math.sin(A),M=-e*Math.cos(A),b=T*d}else if(S<=i+s){let T=(S-i)/s;w=-u+T*n,C=e,M=0,b=d+T*p}else{let T=(S-i-s)/i,A=T*Math.PI/2;w=u+e*Math.sin(A),C=e*Math.cos(A),M=e*Math.sin(A),b=d+p+T*d}let L=Math.max(0,Math.min(1,b/m)),P=0;S===0?P=.5/r:S===g&&(P=-.5/r);for(let T=0;T<=r;T++){let A=T/r,I=A*Math.PI*2,F=Math.sin(I),B=Math.cos(I);v.x=-C*B,v.y=w,v.z=C*F,a.push(v.x,v.y,v.z),y.set(-C*B,M,C*F),y.normalize(),l.push(y.x,y.y,y.z),c.push(A+P,L)}if(S>0){let T=(S-1)*_;for(let A=0;A<r;A++){let I=T+A,F=T+A+1,B=S*_+A,O=S*_+A+1;o.push(I,F,B),o.push(F,O,B)}}}this.setIndex(o),this.setAttribute("position",new bt(a,3)),this.setAttribute("normal",new bt(l,3)),this.setAttribute("uv",new bt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}},lv=class t extends Wt{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);let s=[],o=[],a=[],l=[],c=new Y,u=new We;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,p=3;d<=n;d++,p+=3){let m=i+d/n*r;c.x=e*Math.cos(m),c.y=e*Math.sin(m),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[p]/e+1)/2,u.y=(o[p+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=n;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new bt(o,3)),this.setAttribute("normal",new bt(a,3)),this.setAttribute("uv",new bt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.radius,e.segments,e.thetaStart,e.thetaLength)}},Jh=class t extends Wt{constructor(e=1,n=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};let c=this;r=Math.floor(r),s=Math.floor(s);let u=[],d=[],p=[],m=[],g=0,_=[],y=i/2,v=0;S(),o===!1&&(e>0&&b(!0),n>0&&b(!1)),this.setIndex(u),this.setAttribute("position",new bt(d,3)),this.setAttribute("normal",new bt(p,3)),this.setAttribute("uv",new bt(m,2));function S(){let w=new Y,C=new Y,M=0,L=(n-e)/i;for(let P=0;P<=s;P++){let T=[],A=P/s,I=A*(n-e)+e;for(let F=0;F<=r;F++){let B=F/r,O=B*l+a,z=Math.sin(O),U=Math.cos(O);C.x=I*z,C.y=-A*i+y,C.z=I*U,d.push(C.x,C.y,C.z),w.set(z,L,U).normalize(),p.push(w.x,w.y,w.z),m.push(B,1-A),T.push(g++)}_.push(T)}for(let P=0;P<r;P++)for(let T=0;T<s;T++){let A=_[T][P],I=_[T+1][P],F=_[T+1][P+1],B=_[T][P+1];(e>0||T!==0)&&(u.push(A,I,B),M+=3),(n>0||T!==s-1)&&(u.push(I,F,B),M+=3)}c.addGroup(v,M,0),v+=M}function b(w){let C=g,M=new We,L=new Y,P=0,T=w===!0?e:n,A=w===!0?1:-1;for(let F=1;F<=r;F++)d.push(0,y*A,0),p.push(0,A,0),m.push(.5,.5),g++;let I=g;for(let F=0;F<=r;F++){let O=F/r*l+a,z=Math.cos(O),U=Math.sin(O);L.x=T*U,L.y=y*A,L.z=T*z,d.push(L.x,L.y,L.z),p.push(0,A,0),M.x=z*.5+.5,M.y=U*.5*A+.5,m.push(M.x,M.y),g++}for(let F=0;F<r;F++){let B=C+F,O=I+F;w===!0?u.push(O,O+1,B):u.push(O+1,O,B),P+=3}c.addGroup(v,P,w===!0?1:2),v+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},up=class t extends Jh{constructor(e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,n,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new t(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},hc=class t extends Wt{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};let s=[],o=[];a(r),c(i),u(),this.setAttribute("position",new bt(s,3)),this.setAttribute("normal",new bt(s.slice(),3)),this.setAttribute("uv",new bt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(S){let b=new Y,w=new Y,C=new Y;for(let M=0;M<n.length;M+=3)m(n[M+0],b),m(n[M+1],w),m(n[M+2],C),l(b,w,C,S)}function l(S,b,w,C){let M=C+1,L=[];for(let P=0;P<=M;P++){L[P]=[];let T=S.clone().lerp(w,P/M),A=b.clone().lerp(w,P/M),I=M-P;for(let F=0;F<=I;F++)F===0&&P===M?L[P][F]=T:L[P][F]=T.clone().lerp(A,F/I)}for(let P=0;P<M;P++)for(let T=0;T<2*(M-P)-1;T++){let A=Math.floor(T/2);T%2===0?(p(L[P][A+1]),p(L[P+1][A]),p(L[P][A])):(p(L[P][A+1]),p(L[P+1][A+1]),p(L[P+1][A]))}}function c(S){let b=new Y;for(let w=0;w<s.length;w+=3)b.x=s[w+0],b.y=s[w+1],b.z=s[w+2],b.normalize().multiplyScalar(S),s[w+0]=b.x,s[w+1]=b.y,s[w+2]=b.z}function u(){let S=new Y;for(let b=0;b<s.length;b+=3){S.x=s[b+0],S.y=s[b+1],S.z=s[b+2];let w=y(S)/2/Math.PI+.5,C=v(S)/Math.PI+.5;o.push(w,1-C)}g(),d()}function d(){for(let S=0;S<o.length;S+=6){let b=o[S+0],w=o[S+2],C=o[S+4],M=Math.max(b,w,C),L=Math.min(b,w,C);M>.9&&L<.1&&(b<.2&&(o[S+0]+=1),w<.2&&(o[S+2]+=1),C<.2&&(o[S+4]+=1))}}function p(S){s.push(S.x,S.y,S.z)}function m(S,b){let w=S*3;b.x=e[w+0],b.y=e[w+1],b.z=e[w+2]}function g(){let S=new Y,b=new Y,w=new Y,C=new Y,M=new We,L=new We,P=new We;for(let T=0,A=0;T<s.length;T+=9,A+=6){S.set(s[T+0],s[T+1],s[T+2]),b.set(s[T+3],s[T+4],s[T+5]),w.set(s[T+6],s[T+7],s[T+8]),M.set(o[A+0],o[A+1]),L.set(o[A+2],o[A+3]),P.set(o[A+4],o[A+5]),C.copy(S).add(b).add(w).divideScalar(3);let I=y(C);_(M,A+0,S,I),_(L,A+2,b,I),_(P,A+4,w,I)}}function _(S,b,w,C){C<0&&S.x===1&&(o[b]=S.x-1),w.x===0&&w.z===0&&(o[b]=C/2/Math.PI+.5)}function y(S){return Math.atan2(S.z,-S.x)}function v(S){return Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.vertices,e.indices,e.radius,e.detail)}},cv=class t extends hc{constructor(e=1,n=0){let i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new t(e.radius,e.detail)}},Ux=new Y,Fx=new Y,jM=new Y,zx=new Ma,uv=class extends Wt{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){let r=Math.pow(10,4),s=Math.cos(Hh*n),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),p={},m=[];for(let g=0;g<l;g+=3){o?(c[0]=o.getX(g),c[1]=o.getX(g+1),c[2]=o.getX(g+2)):(c[0]=g,c[1]=g+1,c[2]=g+2);let{a:_,b:y,c:v}=zx;if(_.fromBufferAttribute(a,c[0]),y.fromBufferAttribute(a,c[1]),v.fromBufferAttribute(a,c[2]),zx.getNormal(jM),d[0]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,d[1]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,d[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let S=0;S<3;S++){let b=(S+1)%3,w=d[S],C=d[b],M=zx[u[S]],L=zx[u[b]],P=`${w}_${C}`,T=`${C}_${w}`;T in p&&p[T]?(jM.dot(p[T].normal)<=s&&(m.push(M.x,M.y,M.z),m.push(L.x,L.y,L.z)),p[T]=null):P in p||(p[P]={index0:c[S],index1:c[b],normal:jM.clone()})}}for(let g in p)if(p[g]){let{index0:_,index1:y}=p[g];Ux.fromBufferAttribute(a,_),Fx.fromBufferAttribute(a,y),m.push(Ux.x,Ux.y,Ux.z),m.push(Fx.x,Fx.y,Fx.z)}this.setAttribute("position",new bt(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}},Gs=class{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){ut("Curve: .getPoint() not implemented.")}getPointAt(e,n){let i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){let n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){let n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let n=[],i,r=this.getPoint(0),s=0;n.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){let i=this.getLengths(),r=0,s=i.length,o;n?o=n:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);let u=i[r],p=i[r+1]-u,m=(o-u)/p;return(r+m)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);let o=this.getPoint(r),a=this.getPoint(s),l=n||(o.isVector2?new We:new Y);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,n){let i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){let i=new Y,r=[],s=[],o=[],a=new Y,l=new Ft;for(let m=0;m<=e;m++){let g=m/e;r[m]=this.getTangentAt(g,new Y)}s[0]=new Y,o[0]=new Y;let c=Number.MAX_VALUE,u=Math.abs(r[0].x),d=Math.abs(r[0].y),p=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),p<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();let g=Math.acos(Ht(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,g))}o[m].crossVectors(r[m],s[m])}if(n===!0){let m=Math.acos(Ht(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(r[g],m*g)),o[g].crossVectors(r[g],s[g])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Zh=class extends Gs{constructor(e=0,n=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,n=new We){let i=n,r=Math.PI*2,s=this.aEndAngle-this.aStartAngle,o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);let a=this.aStartAngle+e*s,l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*u-m*d+this.aX,c=p*d+m*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},hv=class extends Zh{constructor(e,n,i,r,s,o){super(e,n,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}};Hx=new Y,XM=new Q2,qM=new Q2,YM=new Q2,dv=class extends Gs{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new Y){let i=n,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%s]:(Hx.subVectors(r[0],r[1]).add(r[0]),c=Hx);let d=r[a%s],p=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(Hx.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=Hx),this.curveType==="centripetal"||this.curveType==="chordal"){let m=this.curveType==="chordal"?.5:.25,g=Math.pow(c.distanceToSquared(d),m),_=Math.pow(d.distanceToSquared(p),m),y=Math.pow(p.distanceToSquared(u),m);_<1e-4&&(_=1),g<1e-4&&(g=_),y<1e-4&&(y=_),XM.initNonuniformCatmullRom(c.x,d.x,p.x,u.x,g,_,y),qM.initNonuniformCatmullRom(c.y,d.y,p.y,u.y,g,_,y),YM.initNonuniformCatmullRom(c.z,d.z,p.z,u.z,g,_,y)}else this.curveType==="catmullrom"&&(XM.initCatmullRom(c.x,d.x,p.x,u.x,this.tension),qM.initCatmullRom(c.y,d.y,p.y,u.y,this.tension),YM.initCatmullRom(c.z,d.z,p.z,u.z,this.tension));return i.set(XM.calc(l),qM.calc(l),YM.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){let r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){let r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){let r=e.points[n];this.points.push(new Y().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};hp=class extends Gs{constructor(e=new We,n=new We,i=new We,r=new We){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new We){let i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Wg(e,r.x,s.x,o.x,a.x),Wg(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},fv=class extends Gs{constructor(e=new Y,n=new Y,i=new Y,r=new Y){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Y){let i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Wg(e,r.x,s.x,o.x,a.x),Wg(e,r.y,s.y,o.y,a.y),Wg(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},dp=class extends Gs{constructor(e=new We,n=new We){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new We){let i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new We){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},pv=class extends Gs{constructor(e=new Y,n=new Y){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new Y){let i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Y){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},fp=class extends Gs{constructor(e=new We,n=new We,i=new We){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new We){let i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Hg(e,r.x,s.x,o.x),Hg(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},pp=class extends Gs{constructor(e=new Y,n=new Y,i=new Y){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Y){let i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Hg(e,r.x,s.x,o.x),Hg(e,r.y,s.y,o.y),Hg(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},mp=class extends Gs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new We){let i=n,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(pO(a,l.x,c.x,u.x,d.x),pO(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){let r=e.points[n];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){let r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){let r=e.points[n];this.points.push(new We().fromArray(r))}return this}},mS=Object.freeze({__proto__:null,ArcCurve:hv,CatmullRomCurve3:dv,CubicBezierCurve:hp,CubicBezierCurve3:fv,EllipseCurve:Zh,LineCurve:dp,LineCurve3:pv,QuadraticBezierCurve:fp,QuadraticBezierCurve3:pp,SplineCurve:mp}),mv=class extends Gs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){let i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new mS[i](n,e))}return this}getPoint(e,n){let i=e*this.getLength(),r=this.getCurveLengths(),s=0;for(;s<r.length;){if(r[s]>=i){let o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,n)}s++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){let n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){let n=[],i;for(let r=0,s=this.curves;r<s.length;r++){let o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){let u=l[c];i&&i.equals(u)||(n.push(u),i=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){let r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){let r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){let r=e.curves[n];this.curves.push(new mS[r.type]().fromJSON(r))}return this}},Qh=class extends mv{constructor(e){super(),this.type="Path",this.currentPoint=new We,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){let i=new dp(this.currentPoint.clone(),new We(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){let s=new fp(this.currentPoint.clone(),new We(e,n),new We(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,o){let a=new hp(this.currentPoint.clone(),new We(e,n),new We(i,r),new We(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){let n=[this.currentPoint.clone()].concat(e),i=new mp(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,o){let a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,n+l,i,r,s,o),this}absarc(e,n,i,r,s,o){return this.absellipse(e,n,i,i,r,s,o),this}ellipse(e,n,i,r,s,o,a,l){let c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,n+u,i,r,s,o,a,l),this}absellipse(e,n,i,r,s,o,a,l){let c=new Zh(e,n,i,r,s,o,a,l);if(this.curves.length>0){let d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);let u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},ul=class extends Qh{constructor(e){super(e),this.uuid=yo(),this.type="Shape",this.holes=[]}getPointsHoles(e){let n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){let r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){let r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){let r=e.holes[n];this.holes.push(new Qh().fromJSON(r))}return this}};s2=class{static triangulate(e,n,i=2){return HG(e,n,i)}},Zo=class t{static area(e){let n=e.length,i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return t.area(e)<0}static triangulateShape(e,n){let i=[],r=[],s=[];gO(e),vO(i,e);let o=e.length;n.forEach(gO);for(let l=0;l<n.length;l++)r.push(o),o+=n[l].length,vO(i,n[l]);let a=s2.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}};yv=class t extends Wt{constructor(e=new ul([new We(.5,.5),new We(-.5,.5),new We(-.5,-.5),new We(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];let i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){let c=e[a];o(c)}this.setAttribute("position",new bt(r,3)),this.setAttribute("uv",new bt(s,2)),this.computeVertexNormals();function o(a){let l=[],c=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,d=n.depth!==void 0?n.depth:1,p=n.bevelEnabled!==void 0?n.bevelEnabled:!0,m=n.bevelThickness!==void 0?n.bevelThickness:.2,g=n.bevelSize!==void 0?n.bevelSize:m-.1,_=n.bevelOffset!==void 0?n.bevelOffset:0,y=n.bevelSegments!==void 0?n.bevelSegments:3,v=n.extrudePath,S=n.UVGenerator!==void 0?n.UVGenerator:r9,b,w=!1,C,M,L,P;if(v){b=v.getSpacedPoints(u),w=!0,p=!1;let me=v.isCatmullRomCurve3?v.closed:!1;C=v.computeFrenetFrames(u,me),M=new Y,L=new Y,P=new Y}p||(y=0,m=0,g=0,_=0);let T=a.extractPoints(c),A=T.shape,I=T.holes;if(!Zo.isClockWise(A)){A=A.reverse();for(let me=0,ve=I.length;me<ve;me++){let ge=I[me];Zo.isClockWise(ge)&&(I[me]=ge.reverse())}}function B(me){let ge=10000000000000001e-36,Ie=me[0];for(let V=1;V<=me.length;V++){let Ge=V%me.length,Me=me[Ge],_e=Me.x-Ie.x,Ne=Me.y-Ie.y,W=_e*_e+Ne*Ne,R=Math.max(Math.abs(Me.x),Math.abs(Me.y),Math.abs(Ie.x),Math.abs(Ie.y)),Z=ge*R*R;if(W<=Z){me.splice(Ge,1),V--;continue}Ie=Me}}B(A),I.forEach(B);let O=I.length,z=A;for(let me=0;me<O;me++){let ve=I[me];A=A.concat(ve)}function U(me,ve,ge){return ve||It("ExtrudeGeometry: vec does not exist"),me.clone().addScaledVector(ve,ge)}let G=A.length;function j(me,ve,ge){let Ie,V,Ge,Me=me.x-ve.x,_e=me.y-ve.y,Ne=ge.x-me.x,W=ge.y-me.y,R=Me*Me+_e*_e,Z=Me*W-_e*Ne;if(Math.abs(Z)>Number.EPSILON){let fe=Math.sqrt(R),he=Math.sqrt(Ne*Ne+W*W),ae=ve.x-_e/fe,je=ve.y+Me/fe,ze=ge.x-W/he,Qe=ge.y+Ne/he,ct=((ze-ae)*W-(Qe-je)*Ne)/(Me*W-_e*Ne);Ie=ae+Me*ct-me.x,V=je+_e*ct-me.y;let Ae=Ie*Ie+V*V;if(Ae<=2)return new We(Ie,V);Ge=Math.sqrt(Ae/2)}else{let fe=!1;Me>Number.EPSILON?Ne>Number.EPSILON&&(fe=!0):Me<-Number.EPSILON?Ne<-Number.EPSILON&&(fe=!0):Math.sign(_e)===Math.sign(W)&&(fe=!0),fe?(Ie=-_e,V=Me,Ge=Math.sqrt(R)):(Ie=Me,V=_e,Ge=Math.sqrt(R/2))}return new We(Ie/Ge,V/Ge)}let J=[];for(let me=0,ve=z.length,ge=ve-1,Ie=me+1;me<ve;me++,ge++,Ie++)ge===ve&&(ge=0),Ie===ve&&(Ie=0),J[me]=j(z[me],z[ge],z[Ie]);let K=[],D,X=J.concat();for(let me=0,ve=O;me<ve;me++){let ge=I[me];D=[];for(let Ie=0,V=ge.length,Ge=V-1,Me=Ie+1;Ie<V;Ie++,Ge++,Me++)Ge===V&&(Ge=0),Me===V&&(Me=0),D[Ie]=j(ge[Ie],ge[Ge],ge[Me]);K.push(D),X=X.concat(D)}let q;if(y===0)q=Zo.triangulateShape(z,I);else{let me=[],ve=[];for(let ge=0;ge<y;ge++){let Ie=ge/y,V=m*Math.cos(Ie*Math.PI/2),Ge=g*Math.sin(Ie*Math.PI/2)+_;for(let Me=0,_e=z.length;Me<_e;Me++){let Ne=U(z[Me],J[Me],Ge);Ee(Ne.x,Ne.y,-V),Ie===0&&me.push(Ne)}for(let Me=0,_e=O;Me<_e;Me++){let Ne=I[Me];D=K[Me];let W=[];for(let R=0,Z=Ne.length;R<Z;R++){let fe=U(Ne[R],D[R],Ge);Ee(fe.x,fe.y,-V),Ie===0&&W.push(fe)}Ie===0&&ve.push(W)}}q=Zo.triangulateShape(me,ve)}let ne=q.length,re=g+_;for(let me=0;me<G;me++){let ve=p?U(A[me],X[me],re):A[me];w?(L.copy(C.normals[0]).multiplyScalar(ve.x),M.copy(C.binormals[0]).multiplyScalar(ve.y),P.copy(b[0]).add(L).add(M),Ee(P.x,P.y,P.z)):Ee(ve.x,ve.y,0)}for(let me=1;me<=u;me++)for(let ve=0;ve<G;ve++){let ge=p?U(A[ve],X[ve],re):A[ve];w?(L.copy(C.normals[me]).multiplyScalar(ge.x),M.copy(C.binormals[me]).multiplyScalar(ge.y),P.copy(b[me]).add(L).add(M),Ee(P.x,P.y,P.z)):Ee(ge.x,ge.y,d/u*me)}for(let me=y-1;me>=0;me--){let ve=me/y,ge=m*Math.cos(ve*Math.PI/2),Ie=g*Math.sin(ve*Math.PI/2)+_;for(let V=0,Ge=z.length;V<Ge;V++){let Me=U(z[V],J[V],Ie);Ee(Me.x,Me.y,d+ge)}for(let V=0,Ge=I.length;V<Ge;V++){let Me=I[V];D=K[V];for(let _e=0,Ne=Me.length;_e<Ne;_e++){let W=U(Me[_e],D[_e],Ie);w?Ee(W.x,W.y+b[u-1].y,b[u-1].x+ge):Ee(W.x,W.y,d+ge)}}}$(),ie();function $(){let me=r.length/3;if(p){let ve=0,ge=G*ve;for(let Ie=0;Ie<ne;Ie++){let V=q[Ie];ke(V[2]+ge,V[1]+ge,V[0]+ge)}ve=u+y*2,ge=G*ve;for(let Ie=0;Ie<ne;Ie++){let V=q[Ie];ke(V[0]+ge,V[1]+ge,V[2]+ge)}}else{for(let ve=0;ve<ne;ve++){let ge=q[ve];ke(ge[2],ge[1],ge[0])}for(let ve=0;ve<ne;ve++){let ge=q[ve];ke(ge[0]+G*u,ge[1]+G*u,ge[2]+G*u)}}i.addGroup(me,r.length/3-me,0)}function ie(){let me=r.length/3,ve=0;le(z,ve),ve+=z.length;for(let ge=0,Ie=I.length;ge<Ie;ge++){let V=I[ge];le(V,ve),ve+=V.length}i.addGroup(me,r.length/3-me,1)}function le(me,ve){let ge=me.length;for(;--ge>=0;){let Ie=ge,V=ge-1;V<0&&(V=me.length-1);for(let Ge=0,Me=u+y*2;Ge<Me;Ge++){let _e=G*Ge,Ne=G*(Ge+1),W=ve+Ie+_e,R=ve+V+_e,Z=ve+V+Ne,fe=ve+Ie+Ne;Pe(W,R,Z,fe)}}}function Ee(me,ve,ge){l.push(me),l.push(ve),l.push(ge)}function ke(me,ve,ge){Te(me),Te(ve),Te(ge);let Ie=r.length/3,V=S.generateTopUV(i,r,Ie-3,Ie-2,Ie-1);De(V[0]),De(V[1]),De(V[2])}function Pe(me,ve,ge,Ie){Te(me),Te(ve),Te(Ie),Te(ve),Te(ge),Te(Ie);let V=r.length/3,Ge=S.generateSideWallUV(i,r,V-6,V-3,V-2,V-1);De(Ge[0]),De(Ge[1]),De(Ge[3]),De(Ge[1]),De(Ge[2]),De(Ge[3])}function Te(me){r.push(l[me*3+0]),r.push(l[me*3+1]),r.push(l[me*3+2])}function De(me){s.push(me.x),s.push(me.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return s9(n,i,e)}static fromJSON(e,n){let i=[];for(let s=0,o=e.shapes.length;s<o;s++){let a=n[e.shapes[s]];i.push(a)}let r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new mS[r.type]().fromJSON(r)),new t(i,e.options)}},r9={generateTopUV:function(t,e,n,i,r){let s=e[n*3],o=e[n*3+1],a=e[i*3],l=e[i*3+1],c=e[r*3],u=e[r*3+1];return[new We(s,o),new We(a,l),new We(c,u)]},generateSideWallUV:function(t,e,n,i,r,s){let o=e[n*3],a=e[n*3+1],l=e[n*3+2],c=e[i*3],u=e[i*3+1],d=e[i*3+2],p=e[r*3],m=e[r*3+1],g=e[r*3+2],_=e[s*3],y=e[s*3+1],v=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new We(o,1-l),new We(c,1-d),new We(p,1-g),new We(_,1-v)]:[new We(a,1-l),new We(u,1-d),new We(m,1-g),new We(y,1-v)]}};xv=class t extends hc{constructor(e=1,n=0){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new t(e.radius,e.detail)}},Sv=class t extends Wt{constructor(e=[new We(0,-.5),new We(.5,0),new We(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=Ht(r,0,Math.PI*2);let s=[],o=[],a=[],l=[],c=[],u=1/n,d=new Y,p=new We,m=new Y,g=new Y,_=new Y,y=0,v=0;for(let S=0;S<=e.length-1;S++)switch(S){case 0:y=e[S+1].x-e[S].x,v=e[S+1].y-e[S].y,m.x=v*1,m.y=-y,m.z=v*0,_.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:y=e[S+1].x-e[S].x,v=e[S+1].y-e[S].y,m.x=v*1,m.y=-y,m.z=v*0,g.copy(m),m.x+=_.x,m.y+=_.y,m.z+=_.z,m.normalize(),l.push(m.x,m.y,m.z),_.copy(g)}for(let S=0;S<=n;S++){let b=i+S*u*r,w=Math.sin(b),C=Math.cos(b);for(let M=0;M<=e.length-1;M++){d.x=e[M].x*w,d.y=e[M].y,d.z=e[M].x*C,o.push(d.x,d.y,d.z),p.x=S/n,p.y=M/(e.length-1),a.push(p.x,p.y);let L=l[3*M+0]*w,P=l[3*M+1],T=l[3*M+0]*C;c.push(L,P,T)}}for(let S=0;S<n;S++)for(let b=0;b<e.length-1;b++){let w=b+S*e.length,C=w,M=w+e.length,L=w+e.length+1,P=w+1;s.push(C,M,P),s.push(L,P,M)}this.setIndex(s),this.setAttribute("position",new bt(o,3)),this.setAttribute("uv",new bt(a,2)),this.setAttribute("normal",new bt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.points,e.segments,e.phiStart,e.phiLength)}},vp=class t extends hc{constructor(e=1,n=0){let i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new t(e.radius,e.detail)}},Na=class t extends Wt{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};let s=e/2,o=n/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,p=n/l,m=[],g=[],_=[],y=[];for(let v=0;v<u;v++){let S=v*p-o;for(let b=0;b<c;b++){let w=b*d-s;g.push(w,-S,0),_.push(0,0,1),y.push(b/a),y.push(1-v/l)}}for(let v=0;v<l;v++)for(let S=0;S<a;S++){let b=S+c*v,w=S+c*(v+1),C=S+1+c*(v+1),M=S+1+c*v;m.push(b,w,M),m.push(w,C,M)}this.setIndex(m),this.setAttribute("position",new bt(g,3)),this.setAttribute("normal",new bt(_,3)),this.setAttribute("uv",new bt(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.width,e.height,e.widthSegments,e.heightSegments)}},bv=class t extends Wt{constructor(e=.5,n=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);let a=[],l=[],c=[],u=[],d=e,p=(n-e)/r,m=new Y,g=new We;for(let _=0;_<=r;_++){for(let y=0;y<=i;y++){let v=s+y/i*o;m.x=d*Math.cos(v),m.y=d*Math.sin(v),l.push(m.x,m.y,m.z),c.push(0,0,1),g.x=(m.x/n+1)/2,g.y=(m.y/n+1)/2,u.push(g.x,g.y)}d+=p}for(let _=0;_<r;_++){let y=_*(i+1);for(let v=0;v<i;v++){let S=v+y,b=S,w=S+i+1,C=S+i+2,M=S+1;a.push(b,w,M),a.push(w,C,M)}}this.setIndex(a),this.setAttribute("position",new bt(l,3)),this.setAttribute("normal",new bt(c,3)),this.setAttribute("uv",new bt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}},wv=class t extends Wt{constructor(e=new ul([new We(0,.5),new We(-.5,-.5),new We(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};let i=[],r=[],s=[],o=[],a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new bt(r,3)),this.setAttribute("normal",new bt(s,3)),this.setAttribute("uv",new bt(o,2));function c(u){let d=r.length/3,p=u.extractPoints(n),m=p.shape,g=p.holes;Zo.isClockWise(m)===!1&&(m=m.reverse());for(let y=0,v=g.length;y<v;y++){let S=g[y];Zo.isClockWise(S)===!0&&(g[y]=S.reverse())}let _=Zo.triangulateShape(m,g);for(let y=0,v=g.length;y<v;y++){let S=g[y];m=m.concat(S)}for(let y=0,v=m.length;y<v;y++){let S=m[y];r.push(S.x,S.y,0),s.push(0,0,1),o.push(S.x,S.y)}for(let y=0,v=_.length;y<v;y++){let S=_[y],b=S[0]+d,w=S[1]+d,C=S[2]+d;i.push(b,w,C),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),n=this.parameters.shapes;return o9(n,e)}static fromJSON(e,n){let i=[];for(let r=0,s=e.shapes.length;r<s;r++){let o=n[e.shapes[r]];i.push(o)}return new t(i,e.curveSegments)}};Eu=class t extends Wt{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));let l=Math.min(o+a,Math.PI),c=0,u=[],d=new Y,p=new Y,m=[],g=[],_=[],y=[];for(let v=0;v<=i;v++){let S=[],b=v/i,w=0;v===0&&o===0?w=.5/n:v===i&&l===Math.PI&&(w=-.5/n);for(let C=0;C<=n;C++){let M=C/n;d.x=-e*Math.cos(r+M*s)*Math.sin(o+b*a),d.y=e*Math.cos(o+b*a),d.z=e*Math.sin(r+M*s)*Math.sin(o+b*a),g.push(d.x,d.y,d.z),p.copy(d).normalize(),_.push(p.x,p.y,p.z),y.push(M+w,1-b),S.push(c++)}u.push(S)}for(let v=0;v<i;v++)for(let S=0;S<n;S++){let b=u[v][S+1],w=u[v][S],C=u[v+1][S],M=u[v+1][S+1];(v!==0||o>0)&&m.push(b,w,M),(v!==i-1||l<Math.PI)&&m.push(w,C,M)}this.setIndex(m),this.setAttribute("position",new bt(g,3)),this.setAttribute("normal",new bt(_,3)),this.setAttribute("uv",new bt(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},Ev=class t extends hc{constructor(e=1,n=0){let i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new t(e.radius,e.detail)}},Cv=class t extends Wt{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);let o=[],a=[],l=[],c=[],u=new Y,d=new Y,p=new Y;for(let m=0;m<=i;m++)for(let g=0;g<=r;g++){let _=g/r*s,y=m/i*Math.PI*2;d.x=(e+n*Math.cos(y))*Math.cos(_),d.y=(e+n*Math.cos(y))*Math.sin(_),d.z=n*Math.sin(y),a.push(d.x,d.y,d.z),u.x=e*Math.cos(_),u.y=e*Math.sin(_),p.subVectors(d,u).normalize(),l.push(p.x,p.y,p.z),c.push(g/r),c.push(m/i)}for(let m=1;m<=i;m++)for(let g=1;g<=r;g++){let _=(r+1)*m+g-1,y=(r+1)*(m-1)+g-1,v=(r+1)*(m-1)+g,S=(r+1)*m+g;o.push(_,y,S),o.push(y,v,S)}this.setIndex(o),this.setAttribute("position",new bt(a,3)),this.setAttribute("normal",new bt(l,3)),this.setAttribute("uv",new bt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},Tv=class t extends Wt{constructor(e=1,n=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);let a=[],l=[],c=[],u=[],d=new Y,p=new Y,m=new Y,g=new Y,_=new Y,y=new Y,v=new Y;for(let b=0;b<=i;++b){let w=b/i*s*Math.PI*2;S(w,s,o,e,m),S(w+.01,s,o,e,g),y.subVectors(g,m),v.addVectors(g,m),_.crossVectors(y,v),v.crossVectors(_,y),_.normalize(),v.normalize();for(let C=0;C<=r;++C){let M=C/r*Math.PI*2,L=-n*Math.cos(M),P=n*Math.sin(M);d.x=m.x+(L*v.x+P*_.x),d.y=m.y+(L*v.y+P*_.y),d.z=m.z+(L*v.z+P*_.z),l.push(d.x,d.y,d.z),p.subVectors(d,m).normalize(),c.push(p.x,p.y,p.z),u.push(b/i),u.push(C/r)}}for(let b=1;b<=i;b++)for(let w=1;w<=r;w++){let C=(r+1)*(b-1)+(w-1),M=(r+1)*b+(w-1),L=(r+1)*b+w,P=(r+1)*(b-1)+w;a.push(C,M,P),a.push(M,L,P)}this.setIndex(a),this.setAttribute("position",new bt(l,3)),this.setAttribute("normal",new bt(c,3)),this.setAttribute("uv",new bt(u,2));function S(b,w,C,M,L){let P=Math.cos(b),T=Math.sin(b),A=C/w*b,I=Math.cos(A);L.x=M*(2+I)*.5*P,L.y=M*(2+I)*T*.5,L.z=M*Math.sin(A)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},Mv=class t extends Wt{constructor(e=new pp(new Y(-1,-1,0),new Y(-1,1,0),new Y(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};let o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let a=new Y,l=new Y,c=new We,u=new Y,d=[],p=[],m=[],g=[];_(),this.setIndex(g),this.setAttribute("position",new bt(d,3)),this.setAttribute("normal",new bt(p,3)),this.setAttribute("uv",new bt(m,2));function _(){for(let b=0;b<n;b++)y(b);y(s===!1?n:0),S(),v()}function y(b){u=e.getPointAt(b/n,u);let w=o.normals[b],C=o.binormals[b];for(let M=0;M<=r;M++){let L=M/r*Math.PI*2,P=Math.sin(L),T=-Math.cos(L);l.x=T*w.x+P*C.x,l.y=T*w.y+P*C.y,l.z=T*w.z+P*C.z,l.normalize(),p.push(l.x,l.y,l.z),a.x=u.x+i*l.x,a.y=u.y+i*l.y,a.z=u.z+i*l.z,d.push(a.x,a.y,a.z)}}function v(){for(let b=1;b<=n;b++)for(let w=1;w<=r;w++){let C=(r+1)*(b-1)+(w-1),M=(r+1)*b+(w-1),L=(r+1)*b+w,P=(r+1)*(b-1)+w;g.push(C,M,P),g.push(M,L,P)}}function S(){for(let b=0;b<=n;b++)for(let w=0;w<=r;w++)c.x=b/n,c.y=w/r,m.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new t(new mS[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}},Av=class extends Wt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){let n=[],i=new Set,r=new Y,s=new Y;if(e.index!==null){let o=e.attributes.position,a=e.index,l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){let d=l[c],p=d.start,m=d.count;for(let g=p,_=p+m;g<_;g+=3)for(let y=0;y<3;y++){let v=a.getX(g+y),S=a.getX(g+(y+1)%3);r.fromBufferAttribute(o,v),s.fromBufferAttribute(o,S),_O(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{let o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){let u=3*a+c,d=3*a+(c+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,d),_O(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new bt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};yO=Object.freeze({__proto__:null,BoxGeometry:Su,CapsuleGeometry:av,CircleGeometry:lv,ConeGeometry:up,CylinderGeometry:Jh,DodecahedronGeometry:cv,EdgesGeometry:uv,ExtrudeGeometry:yv,IcosahedronGeometry:xv,LatheGeometry:Sv,OctahedronGeometry:vp,PlaneGeometry:Na,PolyhedronGeometry:hc,RingGeometry:bv,ShapeGeometry:wv,SphereGeometry:Eu,TetrahedronGeometry:Ev,TorusGeometry:Cv,TorusKnotGeometry:Tv,TubeGeometry:Mv,WireframeGeometry:Av}),kv=class extends sr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new dt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}},_p=class extends bs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}},td=class extends sr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new dt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vc,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vs,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Lv=class extends td{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new We(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ht(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new dt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new dt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new dt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},Pv=class extends sr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new dt(16777215),this.specular=new dt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vc,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vs,this.combine=Tp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Dv=class extends sr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new dt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vc,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Iv=class extends sr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vc,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},Rv=class extends sr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new dt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vc,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vs,this.combine=Tp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Cu=class extends sr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=z2,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Tu=class extends sr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Nv=class extends sr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new dt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vc,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}},Ov=class extends yr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};gS=class{static convertArray(e,n){return zh(e,n)}static isTypedArray(e){return b4(e)}static getKeyframeOrder(e){return I4(e)}static sortedArray(e,n,i){return o2(e,n,i)}static flattenJSON(e,n,i,r){eA(e,n,i,r)}static subclip(e,n,i,r,s=30){return a9(e,n,i,r,s)}static makeClipAdditive(e,n=0,i=e,r=30){return l9(e,n,i,r)}},Mu=class{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let n=this.parameterPositions,i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=n[++i],e<r)break t}o=n.length;break n}if(!(e>=s)){let a=n[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=n[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){let a=i+o>>>1;e<n[a]?o=a:i=a+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)n[o]=i[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Bv=class extends Mu{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:mu,endingEnd:mu}}intervalChanged_(e,n,i){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case gu:s=e,a=2*n-i;break;case Jf:s=r.length-2,a=n+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case gu:o=e,l=2*i-n;break;case Jf:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=n}let c=(i-n)*.5,u=this.valueSize;this._weightPrev=c/(n-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,n,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,p=this._weightPrev,m=this._weightNext,g=(i-n)/(r-n),_=g*g,y=_*g,v=-p*y+2*p*_-p*g,S=(1+p)*y+(-1.5-2*p)*_+(-.5+p)*g+1,b=(-1-m)*y+(1.5+m)*_+.5*g,w=m*y-m*_;for(let C=0;C!==a;++C)s[C]=v*o[u+C]+S*o[c+C]+b*o[l+C]+w*o[d+C];return s}},yp=class extends Mu{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-n)/(r-n),d=1-u;for(let p=0;p!==a;++p)s[p]=o[c+p]*d+o[l+p]*u;return s}},Uv=class extends Mu{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}},ws=class{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=zh(n,this.TimeBufferType),this.values=zh(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let n=e.constructor,i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:zh(e.times,Array),values:zh(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Uv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new yp(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Bv(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case $f:n=this.InterpolantFactoryMethodDiscrete;break;case jg:n=this.InterpolantFactoryMethodLinear;break;case Fg:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return ut("KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $f;case this.InterpolantFactoryMethodLinear:return jg;case this.InterpolantFactoryMethodSmooth:return Fg}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){let n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){let i=this.times,r=i.length,s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>n;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,n=this.getValueSize();n-Math.floor(n)!==0&&(It("KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,r=this.values,s=i.length;s===0&&(It("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let l=i[a];if(typeof l=="number"&&isNaN(l)){It("KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){It("KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&b4(r))for(let a=0,l=r.length;a!==l;++a){let c=r[a];if(isNaN(c)){It("KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){let e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===Fg,s=e.length-1,o=1;for(let a=1;a<s;++a){let l=!1,c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(r)l=!0;else{let d=a*i,p=d-i,m=d+i;for(let g=0;g!==i;++g){let _=n[d+g];if(_!==n[p+g]||_!==n[m+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];let d=a*i,p=o*i;for(let m=0;m!==i;++m)n[p+m]=n[d+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)n[l+c]=n[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=n.slice(0,o*i)):(this.times=e,this.values=n),this}clone(){let e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}};ws.prototype.ValueTypeName="";ws.prototype.TimeBufferType=Float32Array;ws.prototype.ValueBufferType=Float32Array;ws.prototype.DefaultInterpolation=jg;dl=class extends ws{constructor(e,n,i){super(e,n,i)}};dl.prototype.ValueTypeName="bool";dl.prototype.ValueBufferType=Array;dl.prototype.DefaultInterpolation=$f;dl.prototype.InterpolantFactoryMethodLinear=void 0;dl.prototype.InterpolantFactoryMethodSmooth=void 0;xp=class extends ws{constructor(e,n,i,r){super(e,n,i,r)}};xp.prototype.ValueTypeName="color";Au=class extends ws{constructor(e,n,i,r){super(e,n,i,r)}};Au.prototype.ValueTypeName="number";Fv=class extends Mu{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-n)/(r-n),c=e*a;for(let u=c+a;c!==u;c+=4)Yi.slerpFlat(s,0,o,c-a,o,c,l);return s}},ku=class extends ws{constructor(e,n,i,r){super(e,n,i,r)}InterpolantFactoryMethodLinear(e){return new Fv(this.times,this.values,this.getValueSize(),e)}};ku.prototype.ValueTypeName="quaternion";ku.prototype.InterpolantFactoryMethodSmooth=void 0;fl=class extends ws{constructor(e,n,i){super(e,n,i)}};fl.prototype.ValueTypeName="string";fl.prototype.ValueBufferType=Array;fl.prototype.DefaultInterpolation=$f;fl.prototype.InterpolantFactoryMethodLinear=void 0;fl.prototype.InterpolantFactoryMethodSmooth=void 0;Lu=class extends ws{constructor(e,n,i,r){super(e,n,i,r)}};Lu.prototype.ValueTypeName="vector";Pu=class{constructor(e="",n=-1,i=[],r=X0){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=yo(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){let n=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)n.push(u9(i[o]).scale(r));let s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){let n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,o=i.length;s!==o;++s)n.push(ws.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){let s=n.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);let u=I4(l);l=o2(l,1,u),c=o2(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Au(".morphTargetInfluences["+n[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,n){let i=e;if(!Array.isArray(e)){let r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){let r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){let c=e[a],u=c.name.match(s);if(u&&u.length>1){let d=u[1],p=r[d];p||(r[d]=p=[]),p.push(c)}}let o=[];for(let a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],n,i));return o}static parseAnimation(e,n){if(ut("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return It("AnimationClip: No animation in JSONLoader data."),null;let i=function(d,p,m,g,_){if(m.length!==0){let y=[],v=[];eA(m,y,v,g),y.length!==0&&_.push(new d(p,y,v))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode,l=e.length||-1,c=e.hierarchy||[];for(let d=0;d<c.length;d++){let p=c[d].keys;if(!(!p||p.length===0))if(p[0].morphTargets){let m={},g;for(g=0;g<p.length;g++)if(p[g].morphTargets)for(let _=0;_<p[g].morphTargets.length;_++)m[p[g].morphTargets[_]]=-1;for(let _ in m){let y=[],v=[];for(let S=0;S!==p[g].morphTargets.length;++S){let b=p[g];y.push(b.time),v.push(b.morphTarget===_?1:0)}r.push(new Au(".morphTargetInfluence["+_+"]",y,v))}l=m.length*o}else{let m=".bones["+n[d].name+"]";i(Lu,m+".position",p,"pos",r),i(ku,m+".quaternion",p,"rot",r),i(Lu,m+".scale",p,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){let e=this.tracks,n=0;for(let i=0,r=e.length;i!==r;++i){let s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());let n=new this.constructor(this.name,this.duration,e,this.blendMode);return n.userData=JSON.parse(JSON.stringify(this.userData)),n}toJSON(){return this.constructor.toJSON(this)}};ka={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Sp=class{constructor(e,n,i){let r=this,s=!1,o=0,a=0,l,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this._abortController=null,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){let d=c.indexOf(u);return d!==-1&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,p=c.length;d<p;d+=2){let m=c[d],g=c[d+1];if(m.global&&(m.lastIndex=0),m.test(u))return g}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}},tA=new Sp,Nr=class{constructor(e){this.manager=e!==void 0?e:tA,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){let i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}};Nr.DEFAULT_MATERIAL_NAME="__DEFAULT";ic={},a2=class extends Error{constructor(e,n){super(e),this.response=n}},Qo=class extends Nr{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=ka.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(ic[e]!==void 0){ic[e].push({onLoad:n,onProgress:i,onError:r});return}ic[e]=[],ic[e].push({onLoad:n,onProgress:i,onError:r});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&ut("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;let u=ic[e],d=c.body.getReader(),p=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),m=p?parseInt(p):0,g=m!==0,_=0,y=new ReadableStream({start(v){S();function S(){d.read().then(({done:b,value:w})=>{if(b)v.close();else{_+=w.byteLength;let C=new ProgressEvent("progress",{lengthComputable:g,loaded:_,total:m});for(let M=0,L=u.length;M<L;M++){let P=u[M];P.onProgress&&P.onProgress(C)}v.enqueue(w),S()}},b=>{v.error(b)})}}});return new Response(y)}else throw new a2(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a==="")return c.text();{let d=/charset="?([^;"\s]*)"?/i.exec(a),p=d&&d[1]?d[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(g=>m.decode(g))}}}).then(c=>{ka.add(`file:${e}`,c);let u=ic[e];delete ic[e];for(let d=0,p=u.length;d<p;d++){let m=u[d];m.onLoad&&m.onLoad(c)}}).catch(c=>{let u=ic[e];if(u===void 0)throw this.manager.itemError(e),c;delete ic[e];for(let d=0,p=u.length;d<p;d++){let m=u[d];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}},vS=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=this,o=new Qo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):It(l),s.manager.itemError(e)}},i,r)}parse(e){let n=[];for(let i=0;i<e.length;i++){let r=Pu.parse(e[i]);n.push(r)}return n}},_S=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=this,o=[],a=new $h,l=new Qo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(d){l.load(e[d],function(p){let m=s.parse(p,!0);o[d]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},c+=1,c===6&&(m.mipmapCount===1&&(a.minFilter=Un),a.image=o,a.format=m.format,a.needsUpdate=!0,n&&n(a))},i,r)}if(Array.isArray(e))for(let d=0,p=e.length;d<p;++d)u(d);else l.load(e,function(d){let p=s.parse(d,!0);if(p.isCubemap){let m=p.mipmaps.length/p.mipmapCount;for(let g=0;g<m;g++){o[g]={mipmaps:[]};for(let _=0;_<p.mipmapCount;_++)o[g].mipmaps.push(p.mipmaps[g*p.mipmapCount+_]),o[g].format=p.format,o[g].width=p.width,o[g].height=p.height}a.image=o}else a.image.width=p.width,a.image.height=p.height,a.mipmaps=p.mipmaps;p.mipmapCount===1&&(a.minFilter=Un),a.format=p.format,a.needsUpdate=!0,n&&n(a)},i,r);return a}},Vf=new WeakMap,Du=class extends Nr{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=ka.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0);else{let d=Vf.get(o);d===void 0&&(d=[],Vf.set(o,d)),d.push({onLoad:n,onError:r})}return o}let a=ep("img");function l(){u(),n&&n(this);let d=Vf.get(this)||[];for(let p=0;p<d.length;p++){let m=d[p];m.onLoad&&m.onLoad(this)}Vf.delete(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),ka.remove(`image:${e}`);let p=Vf.get(this)||[];for(let m=0;m<p.length;m++){let g=p[m];g.onError&&g.onError(d)}Vf.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),ka.add(`image:${e}`,a),s.manager.itemStart(e),a.src=e,a}},yS=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=new bu;s.colorSpace=_s;let o=new Du(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}},xS=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=this,o=new Ss,a=new Qo(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(r!==void 0)r(u);else{u(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:xs,o.wrapT=c.wrapT!==void 0?c.wrapT:xs,o.magFilter=c.magFilter!==void 0?c.magFilter:Un,o.minFilter=c.minFilter!==void 0?c.minFilter:Un,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(o.colorSpace=c.colorSpace),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Fa),c.mipmapCount===1&&(o.minFilter=Un),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,n&&n(o,c)},i,r),o}},SS=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=new bi,o=new Du(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}},Oa=class extends Ln{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new dt(e),this.intensity=n}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,n}},zv=class extends Oa{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.groundColor=new dt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}toJSON(e){let n=super.toJSON(e);return n.object.groundColor=this.groundColor.getHex(),n}},KM=new Ft,xO=new Y,SO=new Y,Hv=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new We(512,512),this.mapType=Or,this.map=null,this.mapPass=null,this.matrix=new Ft,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new cc,this._frameExtents=new We(1,1),this._viewportCount=1,this._viewports=[new Rn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let n=this.camera,i=this.matrix;xO.setFromMatrixPosition(e.matrixWorld),n.position.copy(xO),SO.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(SO),n.updateMatrixWorld(),KM.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(KM,n.coordinateSystem,n.reversedDepth),n.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(KM)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},l2=class extends Hv{constructor(){super(new Zn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){let n=this.camera,i=Gh*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},Wv=class extends Oa{constructor(e,n,i=0,r=Math.PI/3,s=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.target=new Ln,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new l2}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){let n=super.toJSON(e);return n.object.distance=this.distance,n.object.angle=this.angle,n.object.decay=this.decay,n.object.penumbra=this.penumbra,n.object.target=this.target.uuid,this.map&&this.map.isTexture&&(n.object.map=this.map.toJSON(e).uuid),n.object.shadow=this.shadow.toJSON(),n}},c2=class extends Hv{constructor(){super(new Zn(90,1,.5,500)),this.isPointLightShadow=!0}},Vv=class extends Oa{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new c2}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){let n=super.toJSON(e);return n.object.distance=this.distance,n.object.decay=this.decay,n.object.shadow=this.shadow.toJSON(),n}},js=class extends lc{constructor(e=-1,n=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=i-e,o=i+e,a=r+n,l=r-n;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}},u2=class extends Hv{constructor(){super(new js(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Gv=class extends Oa{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.target=new Ln,this.shadow=new u2}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){let n=super.toJSON(e);return n.object.shadow=this.shadow.toJSON(),n.object.target=this.target.uuid,n}},jv=class extends Oa{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}},Xv=class extends Oa{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}},bp=class{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Y)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){let i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*r),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*r)),n.addScaledVector(o[5],1.092548*(r*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(i*s)),n.addScaledVector(o[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){let i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*r),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*r),n.addScaledVector(o[5],2*.429043*r*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*i*s),n.addScaledVector(o[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){let i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){let i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){let i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}},qv=class extends Oa{constructor(e=new bp,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){let n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}},Yv=class t extends Nr{constructor(e){super(e),this.textures={}}load(e,n,i,r){let s=this,o=new Qo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):It(l),s.manager.itemError(e)}},i,r)}parse(e){let n=this.textures;function i(s){return n[s]===void 0&&ut("MaterialLoader: Undefined texture",s),n[s]}let r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new dt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let s in e.uniforms){let o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new dt().setHex(o.value);break;case"v2":r.uniforms[s].value=new We().fromArray(o.value);break;case"v3":r.uniforms[s].value=new Y().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Rn().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Xt().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Ft().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(let s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new We().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new We().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return t.createMaterialFromType(e)}static createMaterialFromType(e){let n={ShadowMaterial:kv,SpriteMaterial:op,RawShaderMaterial:_p,ShaderMaterial:bs,PointsMaterial:lp,MeshPhysicalMaterial:Lv,MeshStandardMaterial:td,MeshPhongMaterial:Pv,MeshToonMaterial:Dv,MeshNormalMaterial:Iv,MeshLambertMaterial:Rv,MeshDepthMaterial:Cu,MeshDistanceMaterial:Tu,MeshBasicMaterial:So,MeshMatcapMaterial:Nv,LineDashedMaterial:Ov,LineBasicMaterial:yr,Material:sr};return new n[e]}},wp=class{static extractUrlBase(e){let n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}},nd=class extends Wt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},Kv=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=this,o=new Qo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):It(l),s.manager.itemError(e)}},i,r)}parse(e){let n={},i={};function r(m,g){if(n[g]!==void 0)return n[g];let y=m.interleavedBuffers[g],v=s(m,y.buffer),S=Xf(y.type,v),b=new Kh(S,y.stride);return b.uuid=y.uuid,n[g]=b,b}function s(m,g){if(i[g]!==void 0)return i[g];let y=m.arrayBuffers[g],v=new Uint32Array(y).buffer;return i[g]=v,v}let o=e.isInstancedBufferGeometry?new nd:new Wt,a=e.data.index;if(a!==void 0){let m=Xf(a.type,a.array);o.setIndex(new In(m,1))}let l=e.data.attributes;for(let m in l){let g=l[m],_;if(g.isInterleavedBufferAttribute){let y=r(e.data,g.data);_=new wu(y,g.itemSize,g.offset,g.normalized)}else{let y=Xf(g.type,g.array),v=g.isInstancedBufferAttribute?Ia:In;_=new v(y,g.itemSize,g.normalized)}g.name!==void 0&&(_.name=g.name),g.usage!==void 0&&_.setUsage(g.usage),o.setAttribute(m,_)}let c=e.data.morphAttributes;if(c)for(let m in c){let g=c[m],_=[];for(let y=0,v=g.length;y<v;y++){let S=g[y],b;if(S.isInterleavedBufferAttribute){let w=r(e.data,S.data);b=new wu(w,S.itemSize,S.offset,S.normalized)}else{let w=Xf(S.type,S.array);b=new In(w,S.itemSize,S.normalized)}S.name!==void 0&&(b.name=S.name),_.push(b)}o.morphAttributes[m]=_}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);let d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let m=0,g=d.length;m!==g;++m){let _=d[m];o.addGroup(_.start,_.count,_.materialIndex)}let p=e.data.boundingSphere;return p!==void 0&&(o.boundingSphere=new Di().fromJSON(p)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}},bS=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=this,o=this.path===""?wp.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;let a=new Qo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){r!==void 0&&r(d),d("ObjectLoader: Can't parse "+e+".",d.message);return}let u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),It("ObjectLoader: Can't load "+e);return}s.parse(c,n)},i,r)}async loadAsync(e,n){let i=this,r=this.path===""?wp.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;let s=new Qo(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);let o=await s.loadAsync(e,n),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,n){let i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){n!==void 0&&n(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),n!==void 0){let d=!1;for(let p in o)if(o[p].data instanceof HTMLImageElement){d=!0;break}d===!1&&n(c)}return c}async parseAsync(e){let n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){let n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){let s=new ul().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){let i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){let a=new Qg().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,n){let i={};if(e!==void 0){let r=new Kv;for(let s=0,o=e.length;s<o;s++){let a,l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in yO?a=yO[l.type].fromJSON(l,n):ut(`ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,n){let i={},r={};if(e!==void 0){let s=new Yv;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){let l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){let n={};if(e!==void 0)for(let i=0;i<e.length;i++){let r=e[i],s=Pu.parse(r);n[s.uuid]=s}return n}parseImages(e,n){let i=this,r={},s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){let c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return o(u)}else return l.data?{data:Xf(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){let l=new Sp(n);s=new Du(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){let d=e[c],p=d.url;if(Array.isArray(p)){let m=[];for(let g=0,_=p.length;g<_;g++){let y=p[g],v=a(y);v!==null&&(v instanceof HTMLImageElement?m.push(v):m.push(new Ss(v.data,v.width,v.height)))}r[d.uuid]=new Aa(m)}else{let m=a(d.url);r[d.uuid]=new Aa(m)}}}return r}async parseImagesAsync(e){let n=this,i={},r;async function s(o){if(typeof o=="string"){let a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:n.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Xf(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Du(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){let l=e[o],c=l.url;if(Array.isArray(c)){let u=[];for(let d=0,p=c.length;d<p;d++){let m=c[d],g=await s(m);g!==null&&(g instanceof HTMLImageElement?u.push(g):u.push(new Ss(g.data,g.width,g.height)))}i[l.uuid]=new Aa(u)}else{let u=await s(l.url);i[l.uuid]=new Aa(u)}}}return i}parseTextures(e,n){function i(s,o){return typeof s=="number"?s:(ut("ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}let r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){let a=e[s];a.image===void 0&&ut('ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&ut("ObjectLoader: Undefined image",a.image);let l=n[a.image],c=l.data,u;Array.isArray(c)?(u=new bu,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Ss:u=new bi,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=i(a.mapping,h9)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=i(a.wrap[0],bO),u.wrapT=i(a.wrap[1],bO)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.minFilter!==void 0&&(u.minFilter=i(a.minFilter,wO)),a.magFilter!==void 0&&(u.magFilter=i(a.magFilter,wO)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,n,i,r,s){let o;function a(p){return n[p]===void 0&&ut("ObjectLoader: Undefined geometry",p),n[p]}function l(p){if(p!==void 0){if(Array.isArray(p)){let m=[];for(let g=0,_=p.length;g<_;g++){let y=p[g];i[y]===void 0&&ut("ObjectLoader: Undefined material",y),m.push(i[y])}return m}return i[p]===void 0&&ut("ObjectLoader: Undefined material",p),i[p]}}function c(p){return r[p]===void 0&&ut("ObjectLoader: Undefined texture",p),r[p]}let u,d;switch(e.type){case"Scene":o=new Yh,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new dt(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Kg(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Yg(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Zn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new js(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new jv(e.color,e.intensity);break;case"DirectionalLight":o=new Gv(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Vv(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Xv(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Wv(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new zv(e.color,e.groundColor,e.intensity);break;case"LightProbe":let p=new bp().fromArray(e.sh);o=new qv(p,e.intensity);break;case"SkinnedMesh":u=a(e.geometry),d=l(e.material),o=new Zg(u,d),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),d=l(e.material),o=new zn(u,d);break;case"InstancedMesh":u=a(e.geometry),d=l(e.material);let m=e.count,g=e.instanceMatrix,_=e.instanceColor;o=new ev(u,d,m),o.instanceMatrix=new Ia(new Float32Array(g.array),16),_!==void 0&&(o.instanceColor=new Ia(new Float32Array(_.array),_.itemSize));break;case"BatchedMesh":u=a(e.geometry),d=l(e.material),o=new nv(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,d),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(y=>{let v=null,S=null;return y.boundingBox!==void 0&&(v=new Pi().fromJSON(y.boundingBox)),y.boundingSphere!==void 0&&(S=new Di().fromJSON(y.boundingSphere)),{...y,boundingBox:v,boundingSphere:S}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=c(e.matricesTexture.uuid),o._indirectTexture=c(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=c(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new Di().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new Pi().fromJSON(e.boundingBox));break;case"LOD":o=new Jg;break;case"Line":o=new Ra(a(e.geometry),l(e.material));break;case"LineLoop":o=new iv(a(e.geometry),l(e.material));break;case"LineSegments":o=new bo(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new rv(a(e.geometry),l(e.material));break;case"Sprite":o=new $g(l(e.material));break;case"Group":o=new sc;break;case"Bone":o=new ap;break;default:o=new Ln}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){let p=e.children;for(let m=0;m<p.length;m++)o.add(this.parseObject(p[m],n,i,r,s))}if(e.animations!==void 0){let p=e.animations;for(let m=0;m<p.length;m++){let g=p[m];o.animations.push(s[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);let p=e.levels;for(let m=0;m<p.length;m++){let g=p[m],_=o.getObjectByProperty("uuid",g.object);_!==void 0&&o.addLevel(_,g.distance,g.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){let r=n[i.skeleton];r===void 0?ut("ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){let i=n.target,r=e.getObjectByProperty("uuid",i);r!==void 0?n.target=r:n.target=new Ln}})}},h9={UVMapping:a0,CubeReflectionMapping:Ua,CubeRefractionMapping:mc,EquirectangularReflectionMapping:Ap,EquirectangularRefractionMapping:kp,CubeUVReflectionMapping:od},bO={RepeatWrapping:Yf,ClampToEdgeWrapping:xs,MirroredRepeatWrapping:Kf},wO={NearestFilter:Ii,NearestMipmapNearestFilter:pb,NearestMipmapLinearFilter:ad,LinearFilter:Un,LinearMipmapNearestFilter:Lp,LinearMipmapLinearFilter:Fa},$M=new WeakMap,wS=class extends Nr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&ut("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&ut("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=ka.get(`image-bitmap:${e}`);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{if($M.has(o)===!0)r&&r($M.get(o)),s.manager.itemError(e),s.manager.itemEnd(e);else return n&&n(c),s.manager.itemEnd(e),c});return}return setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o}let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,a.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;let l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return ka.add(`image-bitmap:${e}`,c),n&&n(c),s.manager.itemEnd(e),c}).catch(function(c){r&&r(c),$M.set(l,c),ka.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});ka.add(`image-bitmap:${e}`,l),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}},Ep=class{static getContext(){return Gx===void 0&&(Gx=new(window.AudioContext||window.webkitAudioContext)),Gx}static setContext(e){Gx=e}},ES=class extends Nr{constructor(e){super(e)}load(e,n,i,r){let s=this,o=new Qo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{let c=l.slice(0);Ep.getContext().decodeAudioData(c,function(d){n(d)}).catch(a)}catch(c){a(c)}},i,r);function a(l){r?r(l):It(l),s.manager.itemError(e)}}},EO=new Ft,CO=new Ft,Rh=new Ft,CS=class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Zn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Zn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){let n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Rh.copy(e.projectionMatrix);let r=n.eyeSep/2,s=r*n.near/n.focus,o=n.near*Math.tan(Hh*n.fov*.5)/n.zoom,a,l;CO.elements[12]=-r,EO.elements[12]=r,a=-o*n.aspect+s,l=o*n.aspect+s,Rh.elements[0]=2*n.near/(l-a),Rh.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Rh),a=-o*n.aspect-s,l=o*n.aspect-s,Rh.elements[0]=2*n.near/(l-a),Rh.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Rh)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(CO),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(EO)}},$v=class extends Zn{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}},id=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let n=performance.now();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}},Nh=new Y,JM=new Yi,d9=new Y,Oh=new Y,Bh=new Y,TS=class extends Ln{constructor(){super(),this.type="AudioListener",this.context=Ep.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new id}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let n=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Nh,JM,d9),Oh.set(0,0,-1).applyQuaternion(JM),Bh.set(0,1,0).applyQuaternion(JM),n.positionX){let i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Nh.x,i),n.positionY.linearRampToValueAtTime(Nh.y,i),n.positionZ.linearRampToValueAtTime(Nh.z,i),n.forwardX.linearRampToValueAtTime(Oh.x,i),n.forwardY.linearRampToValueAtTime(Oh.y,i),n.forwardZ.linearRampToValueAtTime(Oh.z,i),n.upX.linearRampToValueAtTime(Bh.x,i),n.upY.linearRampToValueAtTime(Bh.y,i),n.upZ.linearRampToValueAtTime(Bh.z,i)}else n.setPosition(Nh.x,Nh.y,Nh.z),n.setOrientation(Oh.x,Oh.y,Oh.z,Bh.x,Bh.y,Bh.z)}},Jv=class extends Ln{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){ut("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){ut("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;let n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){ut("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){ut("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){ut("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(ut("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){ut("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(ut("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}},Uh=new Y,TO=new Yi,f9=new Y,Fh=new Y,MS=class extends Jv{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Uh,TO,f9),Fh.set(0,0,1).applyQuaternion(TO);let n=this.panner;if(n.positionX){let i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Uh.x,i),n.positionY.linearRampToValueAtTime(Uh.y,i),n.positionZ.linearRampToValueAtTime(Uh.z,i),n.orientationX.linearRampToValueAtTime(Fh.x,i),n.orientationY.linearRampToValueAtTime(Fh.y,i),n.orientationZ.linearRampToValueAtTime(Fh.z,i)}else n.setPosition(Uh.x,Uh.y,Uh.z),n.setOrientation(Fh.x,Fh.y,Fh.z)}},AS=class{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}},Zv=class{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,o;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){let i=this.buffer,r=this.valueSize,s=e*r+r,o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=n}else{o+=n;let a=n/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){let n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){let n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){let l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-s,n)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,c=n+n;l!==c;++l)if(i[l]!==i[l+n]){a.setValue(i,r);break}}saveOriginalState(){let e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,o=r;s!==o;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[n+o]=e[i+o]}_slerp(e,n,i,r){Yi.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){let o=this._workIndex*s;Yi.multiplyQuaternionsFlat(e,o,e,n,e,i),Yi.slerpFlat(e,n,e,n,e,o,r)}_lerp(e,n,i,r,s){let o=1-r;for(let a=0;a!==s;++a){let l=n+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,n,i,r,s){for(let o=0;o!==s;++o){let a=n+o;e[a]=e[a]+e[i+o]*r}}},nA="\\[\\]\\.:\\/",p9=new RegExp("["+nA+"]","g"),iA="[^"+nA+"]",m9="[^"+nA.replace("\\.","")+"]",g9=/((?:WC+[\/:])*)/.source.replace("WC",iA),v9=/(WCOD+)?/.source.replace("WCOD",m9),_9=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",iA),y9=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",iA),x9=new RegExp("^"+g9+v9+_9+y9+"$"),S9=["material","materials","bones","map"],h2=class{constructor(e,n,i){let r=i||On.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){let e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){let e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}},On=class t{constructor(e,n,i){this.path=n,this.parsedPath=i||t.parseTrackName(n),this.node=t.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new t.Composite(e,n,i):new t(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(p9,"")}static parseTrackName(e){let n=x9.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let s=i.nodeName.substring(r+1);S9.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){let i=function(s){for(let o=0;o<s.length;o++){let a=s[o];if(a.name===n||a.uuid===n)return a;let l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node,n=this.parsedPath,i=n.objectName,r=n.propertyName,s=n.propertyIndex;if(e||(e=t.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){ut("PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=n.objectIndex;switch(i){case"materials":if(!e.material){It("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){It("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){It("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){It("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){It("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){It("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){It("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}let o=e[r];if(o===void 0){let c=n.nodeName;It("PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?a=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){It("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){It("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};On.Composite=h2;On.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};On.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};On.prototype.GetterByBindingType=[On.prototype._getValue_direct,On.prototype._getValue_array,On.prototype._getValue_arrayElement,On.prototype._getValue_toArray];On.prototype.SetterByBindingTypeAndVersioning=[[On.prototype._setValue_direct,On.prototype._setValue_direct_setNeedsUpdate,On.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[On.prototype._setValue_array,On.prototype._setValue_array_setNeedsUpdate,On.prototype._setValue_array_setMatrixWorldNeedsUpdate],[On.prototype._setValue_arrayElement,On.prototype._setValue_arrayElement_setNeedsUpdate,On.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[On.prototype._setValue_fromArray,On.prototype._setValue_fromArray_setNeedsUpdate,On.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];kS=class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=yo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){let e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length,a,l=e.length,c=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){let p=arguments[u],m=p.uuid,g=n[m];if(g===void 0){g=l++,n[m]=g,e.push(p);for(let _=0,y=o;_!==y;++_)s[_].push(new On(p,i[_],r[_]))}else if(g<c){a=e[g];let _=--c,y=e[_];n[y.uuid]=g,e[g]=y,n[m]=_,e[_]=p;for(let v=0,S=o;v!==S;++v){let b=s[v],w=b[_],C=b[g];b[g]=w,C===void 0&&(C=new On(p,i[v],r[v])),b[_]=C}}else e[g]!==a&&It("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){let e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length,s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){let l=arguments[o],c=l.uuid,u=n[c];if(u!==void 0&&u>=s){let d=s++,p=e[d];n[p.uuid]=u,e[u]=p,n[c]=d,e[d]=l;for(let m=0,g=r;m!==g;++m){let _=i[m],y=_[d],v=_[u];_[u]=y,_[d]=v}}}this.nCachedObjects_=s}uncache(){let e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length,s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){let c=arguments[a],u=c.uuid,d=n[u];if(d!==void 0)if(delete n[u],d<s){let p=--s,m=e[p],g=--o,_=e[g];n[m.uuid]=d,e[d]=m,n[_.uuid]=p,e[p]=_,e.pop();for(let y=0,v=r;y!==v;++y){let S=i[y],b=S[p],w=S[g];S[d]=b,S[p]=w,S.pop()}}else{let p=--o,m=e[p];p>0&&(n[m.uuid]=d),e[d]=m,e.pop();for(let g=0,_=r;g!==_;++g){let y=i[g];y[d]=y[p],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){let i=this._bindingsIndicesByPath,r=i[e],s=this._bindings;if(r!==void 0)return s[r];let o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,d=new Array(c);r=s.length,i[e]=r,o.push(e),a.push(n),s.push(d);for(let p=u,m=l.length;p!==m;++p){let g=l[p];d[p]=new On(g,e,n)}return d}unsubscribe_(e){let n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){let r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];n[c]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}},Qv=class{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;let s=n.tracks,o=s.length,a=new Array(o),l={endingStart:mu,endingEnd:mu};for(let c=0;c!==o;++c){let u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=U2,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){let r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){let r=this._mixer,s=r.time,o=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);let l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=n/o,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}let s=this._startTime;if(s!==null){let l=(e-s)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);let o=this._updateTime(n),a=this._updateWeight(e);if(a>0){let l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case Sb:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case X0:default:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;let i=this._weightInterpolant;if(i!==null){let r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;let i=this._timeScaleInterpolant;if(i!==null){let r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){let n=this._clip.duration,i=this.loop,r=this.time+e,s=this._loopCount,o=i===F2;if(e===0)return s===-1?r:o&&(s&1)===1?n-r:r;if(i===B2){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=n||r<0){let a=Math.floor(r/n);r-=n*a,s+=Math.abs(a);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){let r=this._interpolantSettings;i?(r.endingStart=gu,r.endingEnd=gu):(e?r.endingStart=this.zeroSlopeAtStart?gu:mu:r.endingStart=Jf,n?r.endingEnd=this.zeroSlopeAtEnd?gu:mu:r.endingEnd=Jf)}_scheduleFading(e,n,i){let r=this._mixer,s=r.time,o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);let a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=n,a[1]=s+e,l[1]=i,this}},b9=new Float32Array(1),LS=class extends xo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){let i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName,u=c[l];u===void 0&&(u={},c[l]=u);for(let d=0;d!==s;++d){let p=r[d],m=p.name,g=u[m];if(g!==void 0)++g.referenceCount,o[d]=g;else{if(g=o[d],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,l,m));continue}let _=n&&n._propertyBindings[d].binding.parsedPath;g=new Zv(On.create(i,m,_),p.ValueTypeName,p.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,l,m),o[d]=g}a[d].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}let n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){let s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){let s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){let r=this._actions,s=this._actionsByClip,o=s[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=o;else{let a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){let n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;let s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;let d=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete d[p],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){let s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){let n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){let n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){let r=this._bindingsByRootAndName,s=this._bindings,o=r[n];o===void 0&&(o={},r[n]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){let n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=n[n.length-1],c=e._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){let n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){let n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){let e=this._controlInterpolants,n=this._nActiveControlInterpolants++,i=e[n];return i===void 0&&(i=new yp(new Float32Array(2),new Float32Array(2),1,b9),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){let n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){let r=n||this._root,s=r.uuid,o=typeof e=="string"?Pu.findByName(r,e):e,a=o!==null?o.uuid:e,l=this._actionsByClip[a],c=null;if(i===void 0&&(o!==null?i=o.blendMode:i=X0),l!==void 0){let d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===i)return d;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;let u=new Qv(this,o,n,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,n){let i=n||this._root,r=i.uuid,s=typeof e=="string"?Pu.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){let e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;let n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)n[c]._update(r,e,s,o);let a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){let o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){let c=o[a];this._deactivateAction(c);let u=c._cacheIndex,d=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,n[u]=d,n.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){let n=e.uuid,i=this._actionsByClip;for(let o in i){let a=i[o].actionByRoot,l=a[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}let r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(let o in s){let a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,n){let i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}},PS=class extends np{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTarget3D=!0,this.depth=i,this.texture=new Xh(null,e,n,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},DS=class t{constructor(e){this.value=e}clone(){return new t(this.value.clone===void 0?this.value:this.value.clone())}},w9=0,IS=class extends xo{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:w9++}),this.name="",this.usage=Qf,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){let n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;let n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++){let s=Array.isArray(n[i])?n[i]:[n[i]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}},RS=class extends Kh{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){let n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}},NS=class{constructor(e,n,i,r,s,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},MO=new Ft,Cp=class{constructor(e,n,i=0,r=1/0){this.ray=new Pa(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new Da,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):It("Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return MO.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(MO),this}intersectObject(e,n=!0,i=[]){return d2(e,this,i,n),i.sort(AO),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)d2(e[r],this,i,n);return i.sort(AO),i}};OS=class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=E9.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}};rd=class{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Ht(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Ht(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},BS=class{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}},US=class t{constructor(e,n,i,r){t.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,r){let s=this.elements;return s[0]=e,s[2]=n,s[1]=i,s[3]=r,this}},kO=new We,FS=class{constructor(e=new We(1/0,1/0),n=new We(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){let i=kO.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,kO).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},LO=new Y,jx=new Y,Gf=new Y,jf=new Y,ZM=new Y,C9=new Y,T9=new Y,zS=class{constructor(e=new Y,n=new Y){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){LO.subVectors(e,this.start),jx.subVectors(this.end,this.start);let i=jx.dot(jx),s=jx.dot(LO)/i;return n&&(s=Ht(s,0,1)),s}closestPointToPoint(e,n,i){let r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,n=C9,i=T9){let r=10000000000000001e-32,s,o,a=this.start,l=e.start,c=this.end,u=e.end;Gf.subVectors(c,a),jf.subVectors(u,l),ZM.subVectors(a,l);let d=Gf.dot(Gf),p=jf.dot(jf),m=jf.dot(ZM);if(d<=r&&p<=r)return n.copy(a),i.copy(l),n.sub(i),n.dot(n);if(d<=r)s=0,o=m/p,o=Ht(o,0,1);else{let g=Gf.dot(ZM);if(p<=r)o=0,s=Ht(-g/d,0,1);else{let _=Gf.dot(jf),y=d*p-_*_;y!==0?s=Ht((_*m-g*p)/y,0,1):s=0,o=(_*s+m)/p,o<0?(o=0,s=Ht(-g/d,0,1)):o>1&&(o=1,s=Ht((_-g)/d,0,1))}}return n.copy(a).add(Gf.multiplyScalar(s)),i.copy(l).add(jf.multiplyScalar(o)),n.sub(i),n.dot(n)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},PO=new Y,HS=class extends Ln{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";let i=new Wt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){let c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new bt(r,3));let s=new yr({fog:!1,toneMapped:!1});this.cone=new bo(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);let e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),PO.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(PO),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},fu=new Y,Xx=new Ft,QM=new Ft,WS=class extends bo{constructor(e){let n=R4(e),i=new Wt,r=[],s=[];for(let c=0;c<n.length;c++){let u=n[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}i.setAttribute("position",new bt(r,3)),i.setAttribute("color",new bt(s,3));let o=new yr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;let a=new dt(255),l=new dt(65280);this.setColors(a,l)}updateMatrixWorld(e){let n=this.bones,i=this.geometry,r=i.getAttribute("position");QM.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<n.length;s++){let a=n[s];a.parent&&a.parent.isBone&&(Xx.multiplyMatrices(QM,a.matrixWorld),fu.setFromMatrixPosition(Xx),r.setXYZ(o,fu.x,fu.y,fu.z),Xx.multiplyMatrices(QM,a.parent.matrixWorld),fu.setFromMatrixPosition(Xx),r.setXYZ(o+1,fu.x,fu.y,fu.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,n){let r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,n.r,n.g,n.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};VS=class extends zn{constructor(e,n,i){let r=new Eu(n,4,2),s=new So({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},M9=new Y,DO=new dt,IO=new dt,GS=class extends Ln{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";let r=new vp(n);r.rotateY(Math.PI*.5),this.material=new So({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);let s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new In(o,3)),this.add(new zn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{let n=e.geometry.getAttribute("color");DO.copy(this.light.color),IO.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){let s=i<r/2?DO:IO;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(M9.setFromMatrixPosition(this.light.matrixWorld).negate())}},jS=class extends bo{constructor(e=10,n=10,i=4473924,r=8947848){i=new dt(i),r=new dt(r);let s=n/2,o=e/n,a=e/2,l=[],c=[];for(let p=0,m=0,g=-a;p<=n;p++,g+=o){l.push(-a,0,g,a,0,g),l.push(g,0,-a,g,0,a);let _=p===s?i:r;_.toArray(c,m),m+=3,_.toArray(c,m),m+=3,_.toArray(c,m),m+=3,_.toArray(c,m),m+=3}let u=new Wt;u.setAttribute("position",new bt(l,3)),u.setAttribute("color",new bt(c,3));let d=new yr({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},XS=class extends bo{constructor(e=10,n=16,i=8,r=64,s=4473924,o=8947848){s=new dt(s),o=new dt(o);let a=[],l=[];if(n>1)for(let d=0;d<n;d++){let p=d/n*(Math.PI*2),m=Math.sin(p)*e,g=Math.cos(p)*e;a.push(0,0,0),a.push(m,0,g);let _=d&1?s:o;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let d=0;d<i;d++){let p=d&1?s:o,m=e-e/i*d;for(let g=0;g<r;g++){let _=g/r*(Math.PI*2),y=Math.sin(_)*m,v=Math.cos(_)*m;a.push(y,0,v),l.push(p.r,p.g,p.b),_=(g+1)/r*(Math.PI*2),y=Math.sin(_)*m,v=Math.cos(_)*m,a.push(y,0,v),l.push(p.r,p.g,p.b)}}let c=new Wt;c.setAttribute("position",new bt(a,3)),c.setAttribute("color",new bt(l,3));let u=new yr({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},RO=new Y,qx=new Y,NO=new Y,qS=class extends Ln{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Wt;r.setAttribute("position",new bt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));let s=new yr({fog:!1,toneMapped:!1});this.lightPlane=new Ra(r,s),this.add(this.lightPlane),r=new Wt,r.setAttribute("position",new bt([0,0,0,0,0,1],3)),this.targetLine=new Ra(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),RO.setFromMatrixPosition(this.light.matrixWorld),qx.setFromMatrixPosition(this.light.target.matrixWorld),NO.subVectors(qx,RO),this.lightPlane.lookAt(qx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(qx),this.targetLine.scale.z=NO.length()}},Yx=new Y,Li=new lc,YS=class extends bo{constructor(e){let n=new Wt,i=new yr({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(g,_){l(g),l(_)}function l(g){r.push(0,0,0),s.push(0,0,0),o[g]===void 0&&(o[g]=[]),o[g].push(r.length/3-1)}n.setAttribute("position",new bt(r,3)),n.setAttribute("color",new bt(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();let c=new dt(16755200),u=new dt(16711680),d=new dt(43775),p=new dt(16777215),m=new dt(3355443);this.setColors(c,u,d,p,m)}setColors(e,n,i,r,s){let a=this.geometry.getAttribute("color");return a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,n.r,n.g,n.b),a.setXYZ(25,n.r,n.g,n.b),a.setXYZ(26,n.r,n.g,n.b),a.setXYZ(27,n.r,n.g,n.b),a.setXYZ(28,n.r,n.g,n.b),a.setXYZ(29,n.r,n.g,n.b),a.setXYZ(30,n.r,n.g,n.b),a.setXYZ(31,n.r,n.g,n.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0,this}update(){let e=this.geometry,n=this.pointMap,i=1,r=1,s,o;if(Li.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,o=0;else if(this.camera.coordinateSystem===Ws)s=-1,o=1;else if(this.camera.coordinateSystem===Wh)s=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);Wi("c",n,e,Li,0,0,s),Wi("t",n,e,Li,0,0,o),Wi("n1",n,e,Li,-i,-r,s),Wi("n2",n,e,Li,i,-r,s),Wi("n3",n,e,Li,-i,r,s),Wi("n4",n,e,Li,i,r,s),Wi("f1",n,e,Li,-i,-r,o),Wi("f2",n,e,Li,i,-r,o),Wi("f3",n,e,Li,-i,r,o),Wi("f4",n,e,Li,i,r,o),Wi("u1",n,e,Li,i*.7,r*1.1,s),Wi("u2",n,e,Li,-i*.7,r*1.1,s),Wi("u3",n,e,Li,0,r*2,s),Wi("cf1",n,e,Li,-i,0,o),Wi("cf2",n,e,Li,i,0,o),Wi("cf3",n,e,Li,0,-r,o),Wi("cf4",n,e,Li,0,r,o),Wi("cn1",n,e,Li,-i,0,s),Wi("cn2",n,e,Li,i,0,s),Wi("cn3",n,e,Li,0,-r,s),Wi("cn4",n,e,Li,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};Kx=new Pi,KS=class extends bo{constructor(e,n=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new Wt;s.setIndex(new In(i,1)),s.setAttribute("position",new In(r,3)),super(s,new yr({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Kx.setFromObject(this.object),Kx.isEmpty())return;let e=Kx.min,n=Kx.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},$S=class extends bo{constructor(e,n=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Wt;s.setIndex(new In(i,1)),s.setAttribute("position",new bt(r,3)),super(s,new yr({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},JS=class extends Ra{constructor(e,n=1,i=16776960){let r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Wt;o.setAttribute("position",new bt(s,3)),o.computeBoundingSphere(),super(o,new yr({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;let a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Wt;l.setAttribute("position",new bt(a,3)),l.computeBoundingSphere(),this.add(new zn(l,new So({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},OO=new Y,ZS=class extends Ln{constructor(e=new Y(0,0,1),n=new Y(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",$x===void 0&&($x=new Wt,$x.setAttribute("position",new bt([0,0,0,0,1,0],3)),e2=new up(.5,1,5,1),e2.translate(0,-.5,0)),this.position.copy(n),this.line=new Ra($x,new yr({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new zn(e2,new So({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{OO.set(e.z,0,-e.x).normalize();let n=Math.acos(e.y);this.quaternion.setFromAxisAngle(OO,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},QS=class extends bo{constructor(e=1){let n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Wt;r.setAttribute("position",new bt(n,3)),r.setAttribute("color",new bt(i,3));let s=new yr({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){let r=new dt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},eb=class{constructor(){this.type="ShapePath",this.color=new dt,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new Qh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,o){return this.currentPath.bezierCurveTo(e,n,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(v){let S=[];for(let b=0,w=v.length;b<w;b++){let C=v[b],M=new ul;M.curves=C.curves,S.push(M)}return S}function i(v,S){let b=S.length,w=!1;for(let C=b-1,M=0;M<b;C=M++){let L=S[C],P=S[M],T=P.x-L.x,A=P.y-L.y;if(Math.abs(A)>Number.EPSILON){if(A<0&&(L=S[M],T=-T,P=S[C],A=-A),v.y<L.y||v.y>P.y)continue;if(v.y===L.y){if(v.x===L.x)return!0}else{let I=A*(v.x-L.x)-T*(v.y-L.y);if(I===0)return!0;if(I<0)continue;w=!w}}else{if(v.y!==L.y)continue;if(P.x<=v.x&&v.x<=L.x||L.x<=v.x&&v.x<=P.x)return!0}}return w}let r=Zo.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l,c=[];if(s.length===1)return a=s[0],l=new ul,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;let d=[],p=[],m=[],g=0,_;p[g]=void 0,m[g]=[];for(let v=0,S=s.length;v<S;v++)a=s[v],_=a.getPoints(),o=r(_),o=e?!o:o,o?(!u&&p[g]&&g++,p[g]={s:new ul,p:_},p[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:_[0]});if(!p[0])return n(s);if(p.length>1){let v=!1,S=0;for(let b=0,w=p.length;b<w;b++)d[b]=[];for(let b=0,w=p.length;b<w;b++){let C=m[b];for(let M=0;M<C.length;M++){let L=C[M],P=!0;for(let T=0;T<p.length;T++)i(L.p,p[T].p)&&(b!==T&&S++,P?(P=!1,d[T].push(L)):v=!0);P&&d[b].push(L)}}S>0&&v===!1&&(m=d)}let y;for(let v=0,S=p.length;v<S;v++){l=p[v].s,c.push(l),y=m[v];for(let b=0,w=y.length;b<w;b++)l.holes.push(y[b].h)}return c}},tb=class extends xo{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){ut("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}};nb=class{static contain(e,n){return A9(e,n)}static cover(e,n){return k9(e,n)}static fill(e){return L9(e)}static getByteLength(e,n,i,r){return Eb(e,n,i,r)}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"182"}}));typeof window<"u"&&(window.__THREE__?ut("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="182")});var Fp={};KP(Fp,{ACESFilmicToneMapping:()=>Mp,AddEquation:()=>ac,AddOperation:()=>N2,AdditiveAnimationBlendMode:()=>Sb,AdditiveBlending:()=>sb,AgXToneMapping:()=>db,AlphaFormat:()=>yb,AlwaysCompare:()=>q2,AlwaysDepth:()=>t0,AlwaysStencilFunc:()=>Zx,AmbientLight:()=>jv,AnimationAction:()=>Qv,AnimationClip:()=>Pu,AnimationLoader:()=>vS,AnimationMixer:()=>LS,AnimationObjectGroup:()=>kS,AnimationUtils:()=>gS,ArcCurve:()=>hv,ArrayCamera:()=>$v,ArrowHelper:()=>ZS,AttachedBindMode:()=>Jx,Audio:()=>Jv,AudioAnalyser:()=>AS,AudioContext:()=>Ep,AudioListener:()=>TS,AudioLoader:()=>ES,AxesHelper:()=>QS,BackSide:()=>es,BasicDepthPacking:()=>z2,BasicShadowMap:()=>rb,BatchedMesh:()=>nv,Bone:()=>ap,BooleanKeyframeTrack:()=>dl,Box2:()=>FS,Box3:()=>Pi,Box3Helper:()=>$S,BoxGeometry:()=>Su,BoxHelper:()=>KS,BufferAttribute:()=>In,BufferGeometry:()=>Wt,BufferGeometryLoader:()=>Kv,ByteType:()=>mb,Cache:()=>ka,Camera:()=>lc,CameraHelper:()=>YS,CanvasTexture:()=>pS,CapsuleGeometry:()=>av,CatmullRomCurve3:()=>dv,CineonToneMapping:()=>ub,CircleGeometry:()=>lv,ClampToEdgeWrapping:()=>xs,Clock:()=>id,Color:()=>dt,ColorKeyframeTrack:()=>xp,ColorManagement:()=>yn,CompressedArrayTexture:()=>dS,CompressedCubeTexture:()=>fS,CompressedTexture:()=>$h,CompressedTextureLoader:()=>_S,ConeGeometry:()=>up,ConstantAlphaFactor:()=>D2,ConstantColorFactor:()=>L2,Controls:()=>tb,CubeCamera:()=>qg,CubeDepthTexture:()=>ov,CubeReflectionMapping:()=>Ua,CubeRefractionMapping:()=>mc,CubeTexture:()=>bu,CubeTextureLoader:()=>yS,CubeUVReflectionMapping:()=>od,CubicBezierCurve:()=>hp,CubicBezierCurve3:()=>fv,CubicInterpolant:()=>Bv,CullFaceBack:()=>ib,CullFaceFront:()=>m2,CullFaceFrontBack:()=>BO,CullFaceNone:()=>p2,Curve:()=>Gs,CurvePath:()=>mv,CustomBlending:()=>g2,CustomToneMapping:()=>hb,CylinderGeometry:()=>Jh,Cylindrical:()=>BS,Data3DTexture:()=>Xh,DataArrayTexture:()=>jh,DataTexture:()=>Ss,DataTextureLoader:()=>xS,DataUtils:()=>tS,DecrementStencilOp:()=>e4,DecrementWrapStencilOp:()=>n4,DefaultLoadingManager:()=>tA,DepthFormat:()=>La,DepthStencilFormat:()=>gc,DepthTexture:()=>uc,DetachedBindMode:()=>O2,DirectionalLight:()=>Gv,DirectionalLightHelper:()=>qS,DiscreteInterpolant:()=>Uv,DodecahedronGeometry:()=>cv,DoubleSide:()=>ts,DstAlphaFactor:()=>C2,DstColorFactor:()=>M2,DynamicCopyUsage:()=>g4,DynamicDrawUsage:()=>Y2,DynamicReadUsage:()=>f4,EdgesGeometry:()=>uv,EllipseCurve:()=>Zh,EqualCompare:()=>G2,EqualDepth:()=>i0,EqualStencilFunc:()=>o4,EquirectangularReflectionMapping:()=>Ap,EquirectangularRefractionMapping:()=>kp,Euler:()=>Vs,EventDispatcher:()=>xo,ExternalTexture:()=>cp,ExtrudeGeometry:()=>yv,FileLoader:()=>Qo,Float16BufferAttribute:()=>aS,Float32BufferAttribute:()=>bt,FloatType:()=>Rr,Fog:()=>Kg,FogExp2:()=>Yg,FramebufferTexture:()=>hS,FrontSide:()=>hl,Frustum:()=>cc,FrustumArray:()=>tv,GLBufferAttribute:()=>NS,GLSL1:()=>_4,GLSL3:()=>wb,GreaterCompare:()=>j2,GreaterDepth:()=>s0,GreaterEqualCompare:()=>Y0,GreaterEqualDepth:()=>r0,GreaterEqualStencilFunc:()=>u4,GreaterStencilFunc:()=>l4,GridHelper:()=>jS,Group:()=>sc,HalfFloatType:()=>za,HemisphereLight:()=>zv,HemisphereLightHelper:()=>GS,IcosahedronGeometry:()=>xv,ImageBitmapLoader:()=>wS,ImageLoader:()=>Du,ImageUtils:()=>Xg,IncrementStencilOp:()=>QO,IncrementWrapStencilOp:()=>t4,InstancedBufferAttribute:()=>Ia,InstancedBufferGeometry:()=>nd,InstancedInterleavedBuffer:()=>RS,InstancedMesh:()=>ev,Int16BufferAttribute:()=>sS,Int32BufferAttribute:()=>oS,Int8BufferAttribute:()=>nS,IntType:()=>l0,InterleavedBuffer:()=>Kh,InterleavedBufferAttribute:()=>wu,Interpolant:()=>Mu,InterpolateDiscrete:()=>$f,InterpolateLinear:()=>jg,InterpolateSmooth:()=>Fg,InterpolationSamplingMode:()=>S4,InterpolationSamplingType:()=>x4,InvertStencilOp:()=>i4,KeepStencilOp:()=>pu,KeyframeTrack:()=>ws,LOD:()=>Jg,LatheGeometry:()=>Sv,Layers:()=>Da,LessCompare:()=>V2,LessDepth:()=>n0,LessEqualCompare:()=>q0,LessEqualDepth:()=>_u,LessEqualStencilFunc:()=>a4,LessStencilFunc:()=>s4,Light:()=>Oa,LightProbe:()=>qv,Line:()=>Ra,Line3:()=>zS,LineBasicMaterial:()=>yr,LineCurve:()=>dp,LineCurve3:()=>pv,LineDashedMaterial:()=>Ov,LineLoop:()=>iv,LineSegments:()=>bo,LinearFilter:()=>Un,LinearInterpolant:()=>yp,LinearMipMapLinearFilter:()=>HO,LinearMipMapNearestFilter:()=>zO,LinearMipmapLinearFilter:()=>Fa,LinearMipmapNearestFilter:()=>Lp,LinearSRGBColorSpace:()=>yu,LinearToneMapping:()=>lb,LinearTransfer:()=>Zf,Loader:()=>Nr,LoaderUtils:()=>wp,LoadingManager:()=>Sp,LoopOnce:()=>B2,LoopPingPong:()=>F2,LoopRepeat:()=>U2,MOUSE:()=>dc,Material:()=>sr,MaterialLoader:()=>Yv,MathUtils:()=>T4,Matrix2:()=>US,Matrix3:()=>Xt,Matrix4:()=>Ft,MaxEquation:()=>x2,Mesh:()=>zn,MeshBasicMaterial:()=>So,MeshDepthMaterial:()=>Cu,MeshDistanceMaterial:()=>Tu,MeshLambertMaterial:()=>Rv,MeshMatcapMaterial:()=>Nv,MeshNormalMaterial:()=>Iv,MeshPhongMaterial:()=>Pv,MeshPhysicalMaterial:()=>Lv,MeshStandardMaterial:()=>td,MeshToonMaterial:()=>Dv,MinEquation:()=>y2,MirroredRepeatWrapping:()=>Kf,MixOperation:()=>R2,MultiplyBlending:()=>ab,MultiplyOperation:()=>Tp,NearestFilter:()=>Ii,NearestMipMapLinearFilter:()=>FO,NearestMipMapNearestFilter:()=>UO,NearestMipmapLinearFilter:()=>ad,NearestMipmapNearestFilter:()=>pb,NeutralToneMapping:()=>fb,NeverCompare:()=>W2,NeverDepth:()=>e0,NeverStencilFunc:()=>r4,NoBlending:()=>Ba,NoColorSpace:()=>pl,NoNormalPacking:()=>YO,NoToneMapping:()=>Xs,NormalAnimationBlendMode:()=>X0,NormalBlending:()=>vu,NormalGAPacking:()=>$O,NormalRGPacking:()=>KO,NotEqualCompare:()=>X2,NotEqualDepth:()=>o0,NotEqualStencilFunc:()=>c4,NumberKeyframeTrack:()=>Au,Object3D:()=>Ln,ObjectLoader:()=>bS,ObjectSpaceNormalMap:()=>H2,OctahedronGeometry:()=>vp,OneFactor:()=>b2,OneMinusConstantAlphaFactor:()=>I2,OneMinusConstantColorFactor:()=>P2,OneMinusDstAlphaFactor:()=>T2,OneMinusDstColorFactor:()=>A2,OneMinusSrcAlphaFactor:()=>Gg,OneMinusSrcColorFactor:()=>E2,OrthographicCamera:()=>js,PCFShadowMap:()=>Iu,PCFSoftShadowMap:()=>sd,PMREMGenerator:()=>Q0,Path:()=>Qh,PerspectiveCamera:()=>Zn,Plane:()=>_o,PlaneGeometry:()=>Na,PlaneHelper:()=>JS,PointLight:()=>Vv,PointLightHelper:()=>VS,Points:()=>rv,PointsMaterial:()=>lp,PolarGridHelper:()=>XS,PolyhedronGeometry:()=>hc,PositionalAudio:()=>MS,PropertyBinding:()=>On,PropertyMixer:()=>Zv,QuadraticBezierCurve:()=>fp,QuadraticBezierCurve3:()=>pp,Quaternion:()=>Yi,QuaternionKeyframeTrack:()=>ku,QuaternionLinearInterpolant:()=>Fv,R11_EAC_Format:()=>S0,RED_GREEN_RGTC2_Format:()=>G0,RED_RGTC1_Format:()=>W0,REVISION:()=>f2,RG11_EAC_Format:()=>w0,RGBADepthPacking:()=>bb,RGBAFormat:()=>rr,RGBAIntegerFormat:()=>f0,RGBA_ASTC_10x10_Format:()=>O0,RGBA_ASTC_10x5_Format:()=>I0,RGBA_ASTC_10x6_Format:()=>R0,RGBA_ASTC_10x8_Format:()=>N0,RGBA_ASTC_12x10_Format:()=>B0,RGBA_ASTC_12x12_Format:()=>U0,RGBA_ASTC_4x4_Format:()=>C0,RGBA_ASTC_5x4_Format:()=>T0,RGBA_ASTC_5x5_Format:()=>M0,RGBA_ASTC_6x5_Format:()=>A0,RGBA_ASTC_6x6_Format:()=>k0,RGBA_ASTC_8x5_Format:()=>L0,RGBA_ASTC_8x6_Format:()=>P0,RGBA_ASTC_8x8_Format:()=>D0,RGBA_BPTC_Format:()=>F0,RGBA_ETC2_EAC_Format:()=>x0,RGBA_PVRTC_2BPPV1_Format:()=>v0,RGBA_PVRTC_4BPPV1_Format:()=>g0,RGBA_S3TC_DXT1_Format:()=>Ip,RGBA_S3TC_DXT3_Format:()=>Rp,RGBA_S3TC_DXT5_Format:()=>Np,RGBDepthPacking:()=>XO,RGBFormat:()=>xb,RGBIntegerFormat:()=>WO,RGB_BPTC_SIGNED_Format:()=>z0,RGB_BPTC_UNSIGNED_Format:()=>H0,RGB_ETC1_Format:()=>_0,RGB_ETC2_Format:()=>y0,RGB_PVRTC_2BPPV1_Format:()=>m0,RGB_PVRTC_4BPPV1_Format:()=>p0,RGB_S3TC_DXT1_Format:()=>Dp,RGDepthPacking:()=>qO,RGFormat:()=>Ru,RGIntegerFormat:()=>d0,RawShaderMaterial:()=>_p,Ray:()=>Pa,Raycaster:()=>Cp,RectAreaLight:()=>Xv,RedFormat:()=>h0,RedIntegerFormat:()=>Pp,ReinhardToneMapping:()=>cb,RenderTarget:()=>np,RenderTarget3D:()=>PS,RepeatWrapping:()=>Yf,ReplaceStencilOp:()=>ZO,ReverseSubtractEquation:()=>_2,RingGeometry:()=>bv,SIGNED_R11_EAC_Format:()=>b0,SIGNED_RED_GREEN_RGTC2_Format:()=>j0,SIGNED_RED_RGTC1_Format:()=>V0,SIGNED_RG11_EAC_Format:()=>E0,SRGBColorSpace:()=>_s,SRGBTransfer:()=>Dn,Scene:()=>Yh,ShaderChunk:()=>Jt,ShaderLib:()=>ea,ShaderMaterial:()=>bs,ShadowMaterial:()=>kv,Shape:()=>ul,ShapeGeometry:()=>wv,ShapePath:()=>eb,ShapeUtils:()=>Zo,ShortType:()=>gb,Skeleton:()=>Qg,SkeletonHelper:()=>WS,SkinnedMesh:()=>Zg,Source:()=>Aa,Sphere:()=>Di,SphereGeometry:()=>Eu,Spherical:()=>rd,SphericalHarmonics3:()=>bp,SplineCurve:()=>mp,SpotLight:()=>Wv,SpotLightHelper:()=>HS,Sprite:()=>$g,SpriteMaterial:()=>op,SrcAlphaFactor:()=>Vg,SrcAlphaSaturateFactor:()=>k2,SrcColorFactor:()=>w2,StaticCopyUsage:()=>m4,StaticDrawUsage:()=>Qf,StaticReadUsage:()=>d4,StereoCamera:()=>CS,StreamCopyUsage:()=>v4,StreamDrawUsage:()=>h4,StreamReadUsage:()=>p4,StringKeyframeTrack:()=>fl,SubtractEquation:()=>v2,SubtractiveBlending:()=>ob,TOUCH:()=>fc,TangentSpaceNormalMap:()=>vc,TetrahedronGeometry:()=>Ev,Texture:()=>bi,TextureLoader:()=>SS,TextureUtils:()=>nb,Timer:()=>OS,TimestampQuery:()=>y4,TorusGeometry:()=>Cv,TorusKnotGeometry:()=>Tv,Triangle:()=>Ma,TriangleFanDrawMode:()=>jO,TriangleStripDrawMode:()=>GO,TrianglesDrawMode:()=>VO,TubeGeometry:()=>Mv,UVMapping:()=>a0,Uint16BufferAttribute:()=>ip,Uint32BufferAttribute:()=>rp,Uint8BufferAttribute:()=>iS,Uint8ClampedBufferAttribute:()=>rS,Uniform:()=>DS,UniformsGroup:()=>IS,UniformsLib:()=>pt,UniformsUtils:()=>K0,UnsignedByteType:()=>Or,UnsignedInt101111Type:()=>_b,UnsignedInt248Type:()=>cd,UnsignedInt5999Type:()=>vb,UnsignedIntType:()=>wo,UnsignedShort4444Type:()=>c0,UnsignedShort5551Type:()=>u0,UnsignedShortType:()=>ld,VSMShadowMap:()=>pc,Vector2:()=>We,Vector3:()=>Y,Vector4:()=>Rn,VectorKeyframeTrack:()=>Lu,VideoFrameTexture:()=>uS,VideoTexture:()=>sv,WebGL3DRenderTarget:()=>eS,WebGLArrayRenderTarget:()=>Qx,WebGLCoordinateSystem:()=>Ws,WebGLCubeRenderTarget:()=>sp,WebGLRenderTarget:()=>Qr,WebGLRenderer:()=>e_,WebGLUtils:()=>lB,WebGPUCoordinateSystem:()=>Wh,WebXRController:()=>qh,WireframeGeometry:()=>Av,WrapAroundEnding:()=>Jf,ZeroCurvatureEnding:()=>mu,ZeroFactor:()=>S2,ZeroSlopeEnding:()=>gu,ZeroStencilOp:()=>JO,createCanvasElement:()=>$2,error:()=>It,getConsoleFunction:()=>E4,log:()=>tp,setConsoleFunction:()=>w4,warn:()=>ut,warnOnce:()=>Vh});function iB(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function D9(t){let e=new WeakMap;function n(a,l){let c=a.array,u=a.usage,d=c.byteLength,p=t.createBuffer();t.bindBuffer(l,p),t.bufferData(l,c,u),a.onUploadCallback();let m;if(c instanceof Float32Array)m=t.FLOAT;else if(typeof Float16Array<"u"&&c instanceof Float16Array)m=t.HALF_FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?m=t.HALF_FLOAT:m=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=t.SHORT;else if(c instanceof Uint32Array)m=t.UNSIGNED_INT;else if(c instanceof Int32Array)m=t.INT;else if(c instanceof Int8Array)m=t.BYTE;else if(c instanceof Uint8Array)m=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:p,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:d}}function i(a,l,c){let u=l.array,d=l.updateRanges;if(t.bindBuffer(c,a),d.length===0)t.bufferSubData(c,0,u);else{d.sort((m,g)=>m.start-g.start);let p=0;for(let m=1;m<d.length;m++){let g=d[p],_=d[m];_.start<=g.start+g.count+1?g.count=Math.max(g.count,_.start+_.count-g.start):(++p,d[p]=_)}d.length=p+1;for(let m=0,g=d.length;m<g;m++){let _=d[m];t.bufferSubData(c,_.start*u.BYTES_PER_ELEMENT,u,_.start,_.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);let l=e.get(a);l&&(t.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){let u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}let c=e.get(a);if(c===void 0)e.set(a,n(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,a,l),c.version=a.version}}return{get:r,remove:s,update:o}}function fX(t,e,n,i,r,s,o){let a=new dt(0),l=s===!0?0:1,c,u,d=null,p=0,m=null;function g(b){let w=b.isScene===!0?b.background:null;return w&&w.isTexture&&(w=(b.backgroundBlurriness>0?n:e).get(w)),w}function _(b){let w=!1,C=g(b);C===null?v(a,l):C&&C.isColor&&(v(C,1),w=!0);let M=t.xr.getEnvironmentBlendMode();M==="additive"?i.buffers.color.setClear(0,0,0,1,o):M==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(t.autoClear||w)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function y(b,w){let C=g(w);C&&(C.isCubeTexture||C.mapping===od)?(u===void 0&&(u=new zn(new Su(1,1,1),new bs({name:"BackgroundCubeMaterial",uniforms:ud(ea.backgroundCube.uniforms),vertexShader:ea.backgroundCube.vertexShader,fragmentShader:ea.backgroundCube.fragmentShader,side:es,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,L,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),hd.copy(w.backgroundRotation),hd.x*=-1,hd.y*=-1,hd.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(hd.y*=-1,hd.z*=-1),u.material.uniforms.envMap.value=C,u.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(dX.makeRotationFromEuler(hd)),u.material.toneMapped=yn.getTransfer(C.colorSpace)!==Dn,(d!==C||p!==C.version||m!==t.toneMapping)&&(u.material.needsUpdate=!0,d=C,p=C.version,m=t.toneMapping),u.layers.enableAll(),b.unshift(u,u.geometry,u.material,0,0,null)):C&&C.isTexture&&(c===void 0&&(c=new zn(new Na(2,2),new bs({name:"BackgroundMaterial",uniforms:ud(ea.background.uniforms),vertexShader:ea.background.vertexShader,fragmentShader:ea.background.fragmentShader,side:hl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=C,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=yn.getTransfer(C.colorSpace)!==Dn,C.matrixAutoUpdate===!0&&C.updateMatrix(),c.material.uniforms.uvTransform.value.copy(C.matrix),(d!==C||p!==C.version||m!==t.toneMapping)&&(c.material.needsUpdate=!0,d=C,p=C.version,m=t.toneMapping),c.layers.enableAll(),b.unshift(c,c.geometry,c.material,0,0,null))}function v(b,w){b.getRGB(Cb,Z2(t)),i.buffers.color.setClear(Cb.r,Cb.g,Cb.b,w,o)}function S(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return a},setClearColor:function(b,w=1){a.set(b),l=w,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(b){l=b,v(a,l)},render:_,addToRenderList:y,dispose:S}}function pX(t,e){let n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=p(null),s=r,o=!1;function a(A,I,F,B,O){let z=!1,U=d(B,F,I);s!==U&&(s=U,c(s.object)),z=m(A,B,F,O),z&&g(A,B,F,O),O!==null&&e.update(O,t.ELEMENT_ARRAY_BUFFER),(z||o)&&(o=!1,w(A,I,F,B),O!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(O).buffer))}function l(){return t.createVertexArray()}function c(A){return t.bindVertexArray(A)}function u(A){return t.deleteVertexArray(A)}function d(A,I,F){let B=F.wireframe===!0,O=i[A.id];O===void 0&&(O={},i[A.id]=O);let z=O[I.id];z===void 0&&(z={},O[I.id]=z);let U=z[B];return U===void 0&&(U=p(l()),z[B]=U),U}function p(A){let I=[],F=[],B=[];for(let O=0;O<n;O++)I[O]=0,F[O]=0,B[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:I,enabledAttributes:F,attributeDivisors:B,object:A,attributes:{},index:null}}function m(A,I,F,B){let O=s.attributes,z=I.attributes,U=0,G=F.getAttributes();for(let j in G)if(G[j].location>=0){let K=O[j],D=z[j];if(D===void 0&&(j==="instanceMatrix"&&A.instanceMatrix&&(D=A.instanceMatrix),j==="instanceColor"&&A.instanceColor&&(D=A.instanceColor)),K===void 0||K.attribute!==D||D&&K.data!==D.data)return!0;U++}return s.attributesNum!==U||s.index!==B}function g(A,I,F,B){let O={},z=I.attributes,U=0,G=F.getAttributes();for(let j in G)if(G[j].location>=0){let K=z[j];K===void 0&&(j==="instanceMatrix"&&A.instanceMatrix&&(K=A.instanceMatrix),j==="instanceColor"&&A.instanceColor&&(K=A.instanceColor));let D={};D.attribute=K,K&&K.data&&(D.data=K.data),O[j]=D,U++}s.attributes=O,s.attributesNum=U,s.index=B}function _(){let A=s.newAttributes;for(let I=0,F=A.length;I<F;I++)A[I]=0}function y(A){v(A,0)}function v(A,I){let F=s.newAttributes,B=s.enabledAttributes,O=s.attributeDivisors;F[A]=1,B[A]===0&&(t.enableVertexAttribArray(A),B[A]=1),O[A]!==I&&(t.vertexAttribDivisor(A,I),O[A]=I)}function S(){let A=s.newAttributes,I=s.enabledAttributes;for(let F=0,B=I.length;F<B;F++)I[F]!==A[F]&&(t.disableVertexAttribArray(F),I[F]=0)}function b(A,I,F,B,O,z,U){U===!0?t.vertexAttribIPointer(A,I,F,O,z):t.vertexAttribPointer(A,I,F,B,O,z)}function w(A,I,F,B){_();let O=B.attributes,z=F.getAttributes(),U=I.defaultAttributeValues;for(let G in z){let j=z[G];if(j.location>=0){let J=O[G];if(J===void 0&&(G==="instanceMatrix"&&A.instanceMatrix&&(J=A.instanceMatrix),G==="instanceColor"&&A.instanceColor&&(J=A.instanceColor)),J!==void 0){let K=J.normalized,D=J.itemSize,X=e.get(J);if(X===void 0)continue;let q=X.buffer,ne=X.type,re=X.bytesPerElement,$=ne===t.INT||ne===t.UNSIGNED_INT||J.gpuType===l0;if(J.isInterleavedBufferAttribute){let ie=J.data,le=ie.stride,Ee=J.offset;if(ie.isInstancedInterleavedBuffer){for(let ke=0;ke<j.locationSize;ke++)v(j.location+ke,ie.meshPerAttribute);A.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=ie.meshPerAttribute*ie.count)}else for(let ke=0;ke<j.locationSize;ke++)y(j.location+ke);t.bindBuffer(t.ARRAY_BUFFER,q);for(let ke=0;ke<j.locationSize;ke++)b(j.location+ke,D/j.locationSize,ne,K,le*re,(Ee+D/j.locationSize*ke)*re,$)}else{if(J.isInstancedBufferAttribute){for(let ie=0;ie<j.locationSize;ie++)v(j.location+ie,J.meshPerAttribute);A.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=J.meshPerAttribute*J.count)}else for(let ie=0;ie<j.locationSize;ie++)y(j.location+ie);t.bindBuffer(t.ARRAY_BUFFER,q);for(let ie=0;ie<j.locationSize;ie++)b(j.location+ie,D/j.locationSize,ne,K,D*re,D/j.locationSize*ie*re,$)}}else if(U!==void 0){let K=U[G];if(K!==void 0)switch(K.length){case 2:t.vertexAttrib2fv(j.location,K);break;case 3:t.vertexAttrib3fv(j.location,K);break;case 4:t.vertexAttrib4fv(j.location,K);break;default:t.vertexAttrib1fv(j.location,K)}}}}S()}function C(){P();for(let A in i){let I=i[A];for(let F in I){let B=I[F];for(let O in B)u(B[O].object),delete B[O];delete I[F]}delete i[A]}}function M(A){if(i[A.id]===void 0)return;let I=i[A.id];for(let F in I){let B=I[F];for(let O in B)u(B[O].object),delete B[O];delete I[F]}delete i[A.id]}function L(A){for(let I in i){let F=i[I];if(F[A.id]===void 0)continue;let B=F[A.id];for(let O in B)u(B[O].object),delete B[O];delete F[A.id]}}function P(){T(),o=!0,s!==r&&(s=r,c(s.object))}function T(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:P,resetDefaultState:T,dispose:C,releaseStatesOfGeometry:M,releaseStatesOfProgram:L,initAttributes:_,enableAttribute:y,disableUnusedAttributes:S}}function mX(t,e,n){let i;function r(c){i=c}function s(c,u){t.drawArrays(i,c,u),n.update(u,i,1)}function o(c,u,d){d!==0&&(t.drawArraysInstanced(i,c,u,d),n.update(u,i,d))}function a(c,u,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,u,0,d);let m=0;for(let g=0;g<d;g++)m+=u[g];n.update(m,i,1)}function l(c,u,d,p){if(d===0)return;let m=e.get("WEBGL_multi_draw");if(m===null)for(let g=0;g<c.length;g++)o(c[g],u[g],p[g]);else{m.multiDrawArraysInstancedWEBGL(i,c,0,u,0,p,0,d);let g=0;for(let _=0;_<d;_++)g+=u[_]*p[_];n.update(g,i,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function gX(t,e,n,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let L=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(L){return!(L!==rr&&i.convert(L)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(L){let P=L===za&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(L!==Or&&i.convert(L)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&L!==Rr&&!P)}function l(L){if(L==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return L==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=n.precision!==void 0?n.precision:"highp",u=l(c);u!==c&&(ut("WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);let d=n.logarithmicDepthBuffer===!0,p=n.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),m=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),g=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=t.getParameter(t.MAX_TEXTURE_SIZE),y=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),v=t.getParameter(t.MAX_VERTEX_ATTRIBS),S=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),b=t.getParameter(t.MAX_VARYING_VECTORS),w=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),C=t.getParameter(t.MAX_SAMPLES),M=t.getParameter(t.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:d,reversedDepthBuffer:p,maxTextures:m,maxVertexTextures:g,maxTextureSize:_,maxCubemapSize:y,maxAttributes:v,maxVertexUniforms:S,maxVaryings:b,maxFragmentUniforms:w,maxSamples:C,samples:M}}function vX(t){let e=this,n=null,i=0,r=!1,s=!1,o=new _o,a=new Xt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,p){let m=d.length!==0||p||i!==0||r;return r=p,i=d.length,m},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,p){n=u(d,p,0)},this.setState=function(d,p,m){let g=d.clippingPlanes,_=d.clipIntersection,y=d.clipShadows,v=t.get(d);if(!r||g===null||g.length===0||s&&!y)s?u(null):c();else{let S=s?0:i,b=S*4,w=v.clippingState||null;l.value=w,w=u(g,p,b,m);for(let C=0;C!==b;++C)w[C]=n[C];v.clippingState=w,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=S}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,p,m,g){let _=d!==null?d.length:0,y=null;if(_!==0){if(y=l.value,g!==!0||y===null){let v=m+_*4,S=p.matrixWorldInverse;a.getNormalMatrix(S),(y===null||y.length<v)&&(y=new Float32Array(v));for(let b=0,w=m;b!==_;++b,w+=4)o.copy(d[b]).applyMatrix4(S,a),o.normal.toArray(y,w),y[w+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,y}}function _X(t){let e=new WeakMap;function n(o,a){return a===Ap?o.mapping=Ua:a===kp&&(o.mapping=mc),o}function i(o){if(o&&o.isTexture){let a=o.mapping;if(a===Ap||a===kp)if(e.has(o)){let l=e.get(o).texture;return n(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new sp(l.height);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),n(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}function SX(t){let e=[],n=[],i=[],r=t,s=t-Nu+1+N4.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);e.push(a);let l=1/a;o>t-Nu?l=N4[o-t+Nu-1]:o===0&&(l=0),n.push(l);let c=1/(a-2),u=-c,d=1+c,p=[u,u,d,u,d,d,u,u,d,d,u,d],m=6,g=6,_=3,y=2,v=1,S=new Float32Array(_*g*m),b=new Float32Array(y*g*m),w=new Float32Array(v*g*m);for(let M=0;M<m;M++){let L=M%3*2/3-1,P=M>2?0:-1,T=[L,P,0,L+2/3,P,0,L+2/3,P+1,0,L,P,0,L+2/3,P+1,0,L,P+1,0];S.set(T,_*g*M),b.set(p,y*g*M);let A=[M,M,M,M,M,M];w.set(A,v*g*M)}let C=new Wt;C.setAttribute("position",new In(S,_)),C.setAttribute("uv",new In(b,y)),C.setAttribute("faceIndex",new In(w,v)),i.push(new zn(C,null)),r>Nu&&r--}return{lodMeshes:i,sizeLods:e,sigmas:n}}function B4(t,e,n){let i=new Qr(t,e,n);return i.texture.mapping=od,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Op(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function bX(t,e,n){return new bs({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:yX,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:Mb(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Ba,depthTest:!1,depthWrite:!1})}function wX(t,e,n){let i=new Float32Array(fd),r=new Y(0,1,0);return new bs({name:"SphericalGaussianBlur",defines:{n:fd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Mb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ba,depthTest:!1,depthWrite:!1})}function U4(){return new bs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Mb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ba,depthTest:!1,depthWrite:!1})}function F4(){return new bs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Mb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ba,depthTest:!1,depthWrite:!1})}function Mb(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function EX(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){let l=a.mapping,c=l===Ap||l===kp,u=l===Ua||l===mc;if(c||u){let d=e.get(a),p=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==p)return n===null&&(n=new Q0(t)),d=c?n.fromEquirectangular(a,d):n.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{let m=a.image;return c&&m&&m.height>0||u&&m&&r(m)?(n===null&&(n=new Q0(t)),d=c?n.fromEquirectangular(a):n.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function r(a){let l=0,c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function CX(t){let e={};function n(i){if(e[i]!==void 0)return e[i];let r=t.getExtension(i);return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){let r=n(i);return r===null&&Vh("WebGLRenderer: "+i+" extension not supported."),r}}}function TX(t,e,n,i){let r={},s=new WeakMap;function o(d){let p=d.target;p.index!==null&&e.remove(p.index);for(let g in p.attributes)e.remove(p.attributes[g]);p.removeEventListener("dispose",o),delete r[p.id];let m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,n.memory.geometries--}function a(d,p){return r[p.id]===!0||(p.addEventListener("dispose",o),r[p.id]=!0,n.memory.geometries++),p}function l(d){let p=d.attributes;for(let m in p)e.update(p[m],t.ARRAY_BUFFER)}function c(d){let p=[],m=d.index,g=d.attributes.position,_=0;if(m!==null){let S=m.array;_=m.version;for(let b=0,w=S.length;b<w;b+=3){let C=S[b+0],M=S[b+1],L=S[b+2];p.push(C,M,M,L,L,C)}}else if(g!==void 0){let S=g.array;_=g.version;for(let b=0,w=S.length/3-1;b<w;b+=3){let C=b+0,M=b+1,L=b+2;p.push(C,M,M,L,L,C)}}else return;let y=new(K2(p)?rp:ip)(p,1);y.version=_;let v=s.get(d);v&&e.remove(v),s.set(d,y)}function u(d){let p=s.get(d);if(p){let m=d.index;m!==null&&p.version<m.version&&c(d)}else c(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:u}}function MX(t,e,n){let i;function r(p){i=p}let s,o;function a(p){s=p.type,o=p.bytesPerElement}function l(p,m){t.drawElements(i,m,s,p*o),n.update(m,i,1)}function c(p,m,g){g!==0&&(t.drawElementsInstanced(i,m,s,p*o,g),n.update(m,i,g))}function u(p,m,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,m,0,s,p,0,g);let y=0;for(let v=0;v<g;v++)y+=m[v];n.update(y,i,1)}function d(p,m,g,_){if(g===0)return;let y=e.get("WEBGL_multi_draw");if(y===null)for(let v=0;v<p.length;v++)c(p[v]/o,m[v],_[v]);else{y.multiDrawElementsInstancedWEBGL(i,m,0,s,p,0,_,0,g);let v=0;for(let S=0;S<g;S++)v+=m[S]*_[S];n.update(v,i,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function AX(t){let e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:It("WebGLInfo: Unknown draw mode:",o);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function kX(t,e,n){let i=new WeakMap,r=new Rn;function s(o,a,l){let c=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=u!==void 0?u.length:0,p=i.get(a);if(p===void 0||p.count!==d){let T=function(){L.dispose(),i.delete(a),a.removeEventListener("dispose",T)};p!==void 0&&p.texture.dispose();let m=a.morphAttributes.position!==void 0,g=a.morphAttributes.normal!==void 0,_=a.morphAttributes.color!==void 0,y=a.morphAttributes.position||[],v=a.morphAttributes.normal||[],S=a.morphAttributes.color||[],b=0;m===!0&&(b=1),g===!0&&(b=2),_===!0&&(b=3);let w=a.attributes.position.count*b,C=1;w>e.maxTextureSize&&(C=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);let M=new Float32Array(w*C*4*d),L=new jh(M,w,C,d);L.type=Rr,L.needsUpdate=!0;let P=b*4;for(let A=0;A<d;A++){let I=y[A],F=v[A],B=S[A],O=w*C*4*A;for(let z=0;z<I.count;z++){let U=z*P;m===!0&&(r.fromBufferAttribute(I,z),M[O+U+0]=r.x,M[O+U+1]=r.y,M[O+U+2]=r.z,M[O+U+3]=0),g===!0&&(r.fromBufferAttribute(F,z),M[O+U+4]=r.x,M[O+U+5]=r.y,M[O+U+6]=r.z,M[O+U+7]=0),_===!0&&(r.fromBufferAttribute(B,z),M[O+U+8]=r.x,M[O+U+9]=r.y,M[O+U+10]=r.z,M[O+U+11]=B.itemSize===4?r.w:1)}}p={count:d,texture:L,size:new We(w,C)},i.set(a,p),a.addEventListener("dispose",T)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",o.morphTexture,n);else{let m=0;for(let _=0;_<c.length;_++)m+=c[_];let g=a.morphTargetsRelative?1:1-m;l.getUniforms().setValue(t,"morphTargetBaseInfluence",g),l.getUniforms().setValue(t,"morphTargetInfluences",c)}l.getUniforms().setValue(t,"morphTargetsTexture",p.texture,n),l.getUniforms().setValue(t,"morphTargetsTextureSize",p.size)}return{update:s}}function LX(t,e,n,i){let r=new WeakMap;function s(l){let c=i.render.frame,u=l.geometry,d=e.get(l,u);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){let p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return d}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}function DX(t,e,n,i,r){let s=new Qr(e,n,{type:t,depthBuffer:i,stencilBuffer:r}),o=new Qr(e,n,{type:za,depthBuffer:!1,stencilBuffer:!1}),a=new Wt;a.setAttribute("position",new bt([-1,3,0,-1,-1,0,3,-1,0],3)),a.setAttribute("uv",new bt([0,2,0,0,2,0],2));let l=new _p({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),c=new zn(a,l),u=new js(-1,1,1,-1,0,1),d=null,p=null,m=!1,g,_=null,y=[],v=!1;this.setSize=function(S,b){s.setSize(S,b),o.setSize(S,b);for(let w=0;w<y.length;w++){let C=y[w];C.setSize&&C.setSize(S,b)}},this.setEffects=function(S){y=S,v=y.length>0&&y[0].isRenderPass===!0;let b=s.width,w=s.height;for(let C=0;C<y.length;C++){let M=y[C];M.setSize&&M.setSize(b,w)}},this.begin=function(S,b){if(m||S.toneMapping===Xs&&y.length===0)return!1;if(_=b,b!==null){let w=b.width,C=b.height;(s.width!==w||s.height!==C)&&this.setSize(w,C)}return v===!1&&S.setRenderTarget(s),g=S.toneMapping,S.toneMapping=Xs,!0},this.hasRenderPass=function(){return v},this.end=function(S,b){S.toneMapping=g,m=!0;let w=s,C=o;for(let M=0;M<y.length;M++){let L=y[M];if(L.enabled!==!1&&(L.render(S,C,w,b),L.needsSwap!==!1)){let P=w;w=C,C=P}}if(d!==S.outputColorSpace||p!==S.toneMapping){d=S.outputColorSpace,p=S.toneMapping,l.defines={},yn.getTransfer(d)===Dn&&(l.defines.SRGB_TRANSFER="");let M=PX[p];M&&(l.defines[M]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=w.texture,S.setRenderTarget(_),S.render(c,u),_=null,m=!1},this.isCompositing=function(){return m},this.dispose=function(){s.dispose(),o.dispose(),a.dispose(),l.dispose()}}function Up(t,e,n){let i=t[0];if(i<=0||i>0)return t;let r=e*n,s=z4[r];if(s===void 0&&(s=new Float32Array(r),z4[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function or(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function ar(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function Ab(t,e){let n=H4[e];n===void 0&&(n=new Int32Array(e),H4[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function IX(t,e){let n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function RX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(or(n,e))return;t.uniform2fv(this.addr,e),ar(n,e)}}function NX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(or(n,e))return;t.uniform3fv(this.addr,e),ar(n,e)}}function OX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(or(n,e))return;t.uniform4fv(this.addr,e),ar(n,e)}}function BX(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(or(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),ar(n,e)}else{if(or(n,i))return;G4.set(i),t.uniformMatrix2fv(this.addr,!1,G4),ar(n,i)}}function UX(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(or(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),ar(n,e)}else{if(or(n,i))return;V4.set(i),t.uniformMatrix3fv(this.addr,!1,V4),ar(n,i)}}function FX(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(or(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),ar(n,e)}else{if(or(n,i))return;W4.set(i),t.uniformMatrix4fv(this.addr,!1,W4),ar(n,i)}}function zX(t,e){let n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function HX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(or(n,e))return;t.uniform2iv(this.addr,e),ar(n,e)}}function WX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(or(n,e))return;t.uniform3iv(this.addr,e),ar(n,e)}}function VX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(or(n,e))return;t.uniform4iv(this.addr,e),ar(n,e)}}function GX(t,e){let n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function jX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(or(n,e))return;t.uniform2uiv(this.addr,e),ar(n,e)}}function XX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(or(n,e))return;t.uniform3uiv(this.addr,e),ar(n,e)}}function qX(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(or(n,e))return;t.uniform4uiv(this.addr,e),ar(n,e)}}function YX(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let s;this.type===t.SAMPLER_2D_SHADOW?(hA.compareFunction=n.isReversedDepthBuffer()?Y0:q0,s=hA):s=rB,n.setTexture2D(e||s,r)}function KX(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||oB,r)}function $X(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||aB,r)}function JX(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||sB,r)}function ZX(t){switch(t){case 5126:return IX;case 35664:return RX;case 35665:return NX;case 35666:return OX;case 35674:return BX;case 35675:return UX;case 35676:return FX;case 5124:case 35670:return zX;case 35667:case 35671:return HX;case 35668:case 35672:return WX;case 35669:case 35673:return VX;case 5125:return GX;case 36294:return jX;case 36295:return XX;case 36296:return qX;case 35678:case 36198:case 36298:case 36306:case 35682:return YX;case 35679:case 36299:case 36307:return KX;case 35680:case 36300:case 36308:case 36293:return $X;case 36289:case 36303:case 36311:case 36292:return JX}}function QX(t,e){t.uniform1fv(this.addr,e)}function eq(t,e){let n=Up(e,this.size,2);t.uniform2fv(this.addr,n)}function tq(t,e){let n=Up(e,this.size,3);t.uniform3fv(this.addr,n)}function nq(t,e){let n=Up(e,this.size,4);t.uniform4fv(this.addr,n)}function iq(t,e){let n=Up(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function rq(t,e){let n=Up(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function sq(t,e){let n=Up(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function oq(t,e){t.uniform1iv(this.addr,e)}function aq(t,e){t.uniform2iv(this.addr,e)}function lq(t,e){t.uniform3iv(this.addr,e)}function cq(t,e){t.uniform4iv(this.addr,e)}function uq(t,e){t.uniform1uiv(this.addr,e)}function hq(t,e){t.uniform2uiv(this.addr,e)}function dq(t,e){t.uniform3uiv(this.addr,e)}function fq(t,e){t.uniform4uiv(this.addr,e)}function pq(t,e,n){let i=this.cache,r=e.length,s=Ab(n,r);or(i,s)||(t.uniform1iv(this.addr,s),ar(i,s));let o;this.type===t.SAMPLER_2D_SHADOW?o=hA:o=rB;for(let a=0;a!==r;++a)n.setTexture2D(e[a]||o,s[a])}function mq(t,e,n){let i=this.cache,r=e.length,s=Ab(n,r);or(i,s)||(t.uniform1iv(this.addr,s),ar(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||oB,s[o])}function gq(t,e,n){let i=this.cache,r=e.length,s=Ab(n,r);or(i,s)||(t.uniform1iv(this.addr,s),ar(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||aB,s[o])}function vq(t,e,n){let i=this.cache,r=e.length,s=Ab(n,r);or(i,s)||(t.uniform1iv(this.addr,s),ar(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||sB,s[o])}function _q(t){switch(t){case 5126:return QX;case 35664:return eq;case 35665:return tq;case 35666:return nq;case 35674:return iq;case 35675:return rq;case 35676:return sq;case 5124:case 35670:return oq;case 35667:case 35671:return aq;case 35668:case 35672:return lq;case 35669:case 35673:return cq;case 5125:return uq;case 36294:return hq;case 36295:return dq;case 36296:return fq;case 35678:case 36198:case 36298:case 36306:case 35682:return pq;case 35679:case 36299:case 36307:return mq;case 35680:case 36300:case 36308:case 36293:return gq;case 36289:case 36303:case 36311:case 36292:return vq}}function j4(t,e){t.seq.push(e),t.map[e.id]=e}function yq(t,e,n){let i=t.name,r=i.length;for(cA.lastIndex=0;;){let s=cA.exec(i),o=cA.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){j4(n,c===void 0?new dA(a,t,e):new fA(a,t,e));break}else{let d=n.map[a];d===void 0&&(d=new pA(a),j4(n,d)),n=d}}}function X4(t,e,n){let i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}function bq(t,e){let n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){let a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function wq(t){yn._getMatrix(q4,yn.workingColorSpace,t);let e=`mat3( ${q4.elements.map(n=>n.toFixed(4))} )`;switch(yn.getTransfer(t)){case Zf:return[e,"LinearTransferOETF"];case Dn:return[e,"sRGBTransferOETF"];default:return ut("WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function Y4(t,e,n){let i=t.getShaderParameter(e,t.COMPILE_STATUS),s=(t.getShaderInfoLog(e)||"").trim();if(i&&s==="")return"";let o=/ERROR: 0:(\d+)/.exec(s);if(o){let a=parseInt(o[1]);return n.toUpperCase()+`

`+s+`

`+bq(t.getShaderSource(e),a)}else return s}function Eq(t,e){let n=wq(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function Tq(t,e){let n=Cq[e];return n===void 0?(ut("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+t+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Mq(){yn.getLuminanceCoefficients(Tb);let t=Tb.x.toFixed(4),e=Tb.y.toFixed(4),n=Tb.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Aq(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Z0).join(`
`)}function kq(t){let e=[];for(let n in t){let i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function Lq(t,e){let n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){let s=t.getActiveAttrib(e,r),o=s.name,a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function Z0(t){return t!==""}function K4(t,e){let n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function $4(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function mA(t){return t.replace(Pq,Iq)}function Iq(t,e){let n=Jt[e];if(n===void 0){let i=Dq.get(e);if(i!==void 0)n=Jt[i],ut('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return mA(n)}function J4(t){return t.replace(Rq,Nq)}function Nq(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Z4(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Bq(t){return Oq[t.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}function Fq(t){return t.envMap===!1?"ENVMAP_TYPE_CUBE":Uq[t.envMapMode]||"ENVMAP_TYPE_CUBE"}function Hq(t){return t.envMap===!1?"ENVMAP_MODE_REFLECTION":zq[t.envMapMode]||"ENVMAP_MODE_REFLECTION"}function Vq(t){return t.envMap===!1?"ENVMAP_BLENDING_NONE":Wq[t.combine]||"ENVMAP_BLENDING_NONE"}function Gq(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}function jq(t,e,n,i){let r=t.getContext(),s=n.defines,o=n.vertexShader,a=n.fragmentShader,l=Bq(n),c=Fq(n),u=Hq(n),d=Vq(n),p=Gq(n),m=Aq(n),g=kq(s),_=r.createProgram(),y,v,S=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(Z0).join(`
`),y.length>0&&(y+=`
`),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(Z0).join(`
`),v.length>0&&(v+=`
`)):(y=[Z4(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Z0).join(`
`),v=[Z4(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Xs?"#define TONE_MAPPING":"",n.toneMapping!==Xs?Jt.tonemapping_pars_fragment:"",n.toneMapping!==Xs?Tq("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Jt.colorspace_pars_fragment,Eq("linearToOutputTexel",n.outputColorSpace),Mq(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Z0).join(`
`)),o=mA(o),o=K4(o,n),o=$4(o,n),a=mA(a),a=K4(a,n),a=$4(a,n),o=J4(o),a=J4(a),n.isRawShaderMaterial!==!0&&(S=`#version 300 es
`,y=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["#define varying in",n.glslVersion===wb?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===wb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let b=S+y+o,w=S+v+a,C=X4(r,r.VERTEX_SHADER,b),M=X4(r,r.FRAGMENT_SHADER,w);r.attachShader(_,C),r.attachShader(_,M),n.index0AttributeName!==void 0?r.bindAttribLocation(_,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_);function L(I){if(t.debug.checkShaderErrors){let F=r.getProgramInfoLog(_)||"",B=r.getShaderInfoLog(C)||"",O=r.getShaderInfoLog(M)||"",z=F.trim(),U=B.trim(),G=O.trim(),j=!0,J=!0;if(r.getProgramParameter(_,r.LINK_STATUS)===!1)if(j=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,_,C,M);else{let K=Y4(r,C,"vertex"),D=Y4(r,M,"fragment");It("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+`

Material Name: `+I.name+`
Material Type: `+I.type+`

Program Info Log: `+z+`
`+K+`
`+D)}else z!==""?ut("WebGLProgram: Program Info Log:",z):(U===""||G==="")&&(J=!1);J&&(I.diagnostics={runnable:j,programLog:z,vertexShader:{log:U,prefix:y},fragmentShader:{log:G,prefix:v}})}r.deleteShader(C),r.deleteShader(M),P=new Bp(r,_),T=Lq(r,_)}let P;this.getUniforms=function(){return P===void 0&&L(this),P};let T;this.getAttributes=function(){return T===void 0&&L(this),T};let A=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return A===!1&&(A=r.getProgramParameter(_,xq)),A},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Sq++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=C,this.fragmentShader=M,this}function qq(t,e,n,i,r,s,o){let a=new Da,l=new gA,c=new Set,u=[],d=new Map,p=r.logarithmicDepthBuffer,m=r.precision,g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(T){return c.add(T),T===0?"uv":`uv${T}`}function y(T,A,I,F,B){let O=F.fog,z=B.geometry,U=T.isMeshStandardMaterial?F.environment:null,G=(T.isMeshStandardMaterial?n:e).get(T.envMap||U),j=G&&G.mapping===od?G.image.height:null,J=g[T.type];T.precision!==null&&(m=r.getMaxPrecision(T.precision),m!==T.precision&&ut("WebGLProgram.getParameters:",T.precision,"not supported, using",m,"instead."));let K=z.morphAttributes.position||z.morphAttributes.normal||z.morphAttributes.color,D=K!==void 0?K.length:0,X=0;z.morphAttributes.position!==void 0&&(X=1),z.morphAttributes.normal!==void 0&&(X=2),z.morphAttributes.color!==void 0&&(X=3);let q,ne,re,$;if(J){let kt=ea[J];q=kt.vertexShader,ne=kt.fragmentShader}else q=T.vertexShader,ne=T.fragmentShader,l.update(T),re=l.getVertexShaderID(T),$=l.getFragmentShaderID(T);let ie=t.getRenderTarget(),le=t.state.buffers.depth.getReversed(),Ee=B.isInstancedMesh===!0,ke=B.isBatchedMesh===!0,Pe=!!T.map,Te=!!T.matcap,De=!!G,me=!!T.aoMap,ve=!!T.lightMap,ge=!!T.bumpMap,Ie=!!T.normalMap,V=!!T.displacementMap,Ge=!!T.emissiveMap,Me=!!T.metalnessMap,_e=!!T.roughnessMap,Ne=T.anisotropy>0,W=T.clearcoat>0,R=T.dispersion>0,Z=T.iridescence>0,fe=T.sheen>0,he=T.transmission>0,ae=Ne&&!!T.anisotropyMap,je=W&&!!T.clearcoatMap,ze=W&&!!T.clearcoatNormalMap,Qe=W&&!!T.clearcoatRoughnessMap,ct=Z&&!!T.iridescenceMap,Ae=Z&&!!T.iridescenceThicknessMap,Ve=fe&&!!T.sheenColorMap,Ue=fe&&!!T.sheenRoughnessMap,Q=!!T.specularMap,ce=!!T.specularColorMap,Ye=!!T.specularIntensityMap,te=he&&!!T.transmissionMap,we=he&&!!T.thicknessMap,Be=!!T.gradientMap,it=!!T.alphaMap,Fe=T.alphaTest>0,Se=!!T.alphaHash,Xe=!!T.extensions,Je=Xs;T.toneMapped&&(ie===null||ie.isXRRenderTarget===!0)&&(Je=t.toneMapping);let ot={shaderID:J,shaderType:T.type,shaderName:T.name,vertexShader:q,fragmentShader:ne,defines:T.defines,customVertexShaderID:re,customFragmentShaderID:$,isRawShaderMaterial:T.isRawShaderMaterial===!0,glslVersion:T.glslVersion,precision:m,batching:ke,batchingColor:ke&&B._colorsTexture!==null,instancing:Ee,instancingColor:Ee&&B.instanceColor!==null,instancingMorph:Ee&&B.morphTexture!==null,outputColorSpace:ie===null?t.outputColorSpace:ie.isXRRenderTarget===!0?ie.texture.colorSpace:yu,alphaToCoverage:!!T.alphaToCoverage,map:Pe,matcap:Te,envMap:De,envMapMode:De&&G.mapping,envMapCubeUVHeight:j,aoMap:me,lightMap:ve,bumpMap:ge,normalMap:Ie,displacementMap:V,emissiveMap:Ge,normalMapObjectSpace:Ie&&T.normalMapType===H2,normalMapTangentSpace:Ie&&T.normalMapType===vc,metalnessMap:Me,roughnessMap:_e,anisotropy:Ne,anisotropyMap:ae,clearcoat:W,clearcoatMap:je,clearcoatNormalMap:ze,clearcoatRoughnessMap:Qe,dispersion:R,iridescence:Z,iridescenceMap:ct,iridescenceThicknessMap:Ae,sheen:fe,sheenColorMap:Ve,sheenRoughnessMap:Ue,specularMap:Q,specularColorMap:ce,specularIntensityMap:Ye,transmission:he,transmissionMap:te,thicknessMap:we,gradientMap:Be,opaque:T.transparent===!1&&T.blending===vu&&T.alphaToCoverage===!1,alphaMap:it,alphaTest:Fe,alphaHash:Se,combine:T.combine,mapUv:Pe&&_(T.map.channel),aoMapUv:me&&_(T.aoMap.channel),lightMapUv:ve&&_(T.lightMap.channel),bumpMapUv:ge&&_(T.bumpMap.channel),normalMapUv:Ie&&_(T.normalMap.channel),displacementMapUv:V&&_(T.displacementMap.channel),emissiveMapUv:Ge&&_(T.emissiveMap.channel),metalnessMapUv:Me&&_(T.metalnessMap.channel),roughnessMapUv:_e&&_(T.roughnessMap.channel),anisotropyMapUv:ae&&_(T.anisotropyMap.channel),clearcoatMapUv:je&&_(T.clearcoatMap.channel),clearcoatNormalMapUv:ze&&_(T.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Qe&&_(T.clearcoatRoughnessMap.channel),iridescenceMapUv:ct&&_(T.iridescenceMap.channel),iridescenceThicknessMapUv:Ae&&_(T.iridescenceThicknessMap.channel),sheenColorMapUv:Ve&&_(T.sheenColorMap.channel),sheenRoughnessMapUv:Ue&&_(T.sheenRoughnessMap.channel),specularMapUv:Q&&_(T.specularMap.channel),specularColorMapUv:ce&&_(T.specularColorMap.channel),specularIntensityMapUv:Ye&&_(T.specularIntensityMap.channel),transmissionMapUv:te&&_(T.transmissionMap.channel),thicknessMapUv:we&&_(T.thicknessMap.channel),alphaMapUv:it&&_(T.alphaMap.channel),vertexTangents:!!z.attributes.tangent&&(Ie||Ne),vertexColors:T.vertexColors,vertexAlphas:T.vertexColors===!0&&!!z.attributes.color&&z.attributes.color.itemSize===4,pointsUvs:B.isPoints===!0&&!!z.attributes.uv&&(Pe||it),fog:!!O,useFog:T.fog===!0,fogExp2:!!O&&O.isFogExp2,flatShading:T.flatShading===!0&&T.wireframe===!1,sizeAttenuation:T.sizeAttenuation===!0,logarithmicDepthBuffer:p,reversedDepthBuffer:le,skinning:B.isSkinnedMesh===!0,morphTargets:z.morphAttributes.position!==void 0,morphNormals:z.morphAttributes.normal!==void 0,morphColors:z.morphAttributes.color!==void 0,morphTargetsCount:D,morphTextureStride:X,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numLightProbes:A.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:T.dithering,shadowMapEnabled:t.shadowMap.enabled&&I.length>0,shadowMapType:t.shadowMap.type,toneMapping:Je,decodeVideoTexture:Pe&&T.map.isVideoTexture===!0&&yn.getTransfer(T.map.colorSpace)===Dn,decodeVideoTextureEmissive:Ge&&T.emissiveMap.isVideoTexture===!0&&yn.getTransfer(T.emissiveMap.colorSpace)===Dn,premultipliedAlpha:T.premultipliedAlpha,doubleSided:T.side===ts,flipSided:T.side===es,useDepthPacking:T.depthPacking>=0,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionClipCullDistance:Xe&&T.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Xe&&T.extensions.multiDraw===!0||ke)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:T.customProgramCacheKey()};return ot.vertexUv1s=c.has(1),ot.vertexUv2s=c.has(2),ot.vertexUv3s=c.has(3),c.clear(),ot}function v(T){let A=[];if(T.shaderID?A.push(T.shaderID):(A.push(T.customVertexShaderID),A.push(T.customFragmentShaderID)),T.defines!==void 0)for(let I in T.defines)A.push(I),A.push(T.defines[I]);return T.isRawShaderMaterial===!1&&(S(A,T),b(A,T),A.push(t.outputColorSpace)),A.push(T.customProgramCacheKey),A.join()}function S(T,A){T.push(A.precision),T.push(A.outputColorSpace),T.push(A.envMapMode),T.push(A.envMapCubeUVHeight),T.push(A.mapUv),T.push(A.alphaMapUv),T.push(A.lightMapUv),T.push(A.aoMapUv),T.push(A.bumpMapUv),T.push(A.normalMapUv),T.push(A.displacementMapUv),T.push(A.emissiveMapUv),T.push(A.metalnessMapUv),T.push(A.roughnessMapUv),T.push(A.anisotropyMapUv),T.push(A.clearcoatMapUv),T.push(A.clearcoatNormalMapUv),T.push(A.clearcoatRoughnessMapUv),T.push(A.iridescenceMapUv),T.push(A.iridescenceThicknessMapUv),T.push(A.sheenColorMapUv),T.push(A.sheenRoughnessMapUv),T.push(A.specularMapUv),T.push(A.specularColorMapUv),T.push(A.specularIntensityMapUv),T.push(A.transmissionMapUv),T.push(A.thicknessMapUv),T.push(A.combine),T.push(A.fogExp2),T.push(A.sizeAttenuation),T.push(A.morphTargetsCount),T.push(A.morphAttributeCount),T.push(A.numDirLights),T.push(A.numPointLights),T.push(A.numSpotLights),T.push(A.numSpotLightMaps),T.push(A.numHemiLights),T.push(A.numRectAreaLights),T.push(A.numDirLightShadows),T.push(A.numPointLightShadows),T.push(A.numSpotLightShadows),T.push(A.numSpotLightShadowsWithMaps),T.push(A.numLightProbes),T.push(A.shadowMapType),T.push(A.toneMapping),T.push(A.numClippingPlanes),T.push(A.numClipIntersection),T.push(A.depthPacking)}function b(T,A){a.disableAll(),A.instancing&&a.enable(0),A.instancingColor&&a.enable(1),A.instancingMorph&&a.enable(2),A.matcap&&a.enable(3),A.envMap&&a.enable(4),A.normalMapObjectSpace&&a.enable(5),A.normalMapTangentSpace&&a.enable(6),A.clearcoat&&a.enable(7),A.iridescence&&a.enable(8),A.alphaTest&&a.enable(9),A.vertexColors&&a.enable(10),A.vertexAlphas&&a.enable(11),A.vertexUv1s&&a.enable(12),A.vertexUv2s&&a.enable(13),A.vertexUv3s&&a.enable(14),A.vertexTangents&&a.enable(15),A.anisotropy&&a.enable(16),A.alphaHash&&a.enable(17),A.batching&&a.enable(18),A.dispersion&&a.enable(19),A.batchingColor&&a.enable(20),A.gradientMap&&a.enable(21),T.push(a.mask),a.disableAll(),A.fog&&a.enable(0),A.useFog&&a.enable(1),A.flatShading&&a.enable(2),A.logarithmicDepthBuffer&&a.enable(3),A.reversedDepthBuffer&&a.enable(4),A.skinning&&a.enable(5),A.morphTargets&&a.enable(6),A.morphNormals&&a.enable(7),A.morphColors&&a.enable(8),A.premultipliedAlpha&&a.enable(9),A.shadowMapEnabled&&a.enable(10),A.doubleSided&&a.enable(11),A.flipSided&&a.enable(12),A.useDepthPacking&&a.enable(13),A.dithering&&a.enable(14),A.transmission&&a.enable(15),A.sheen&&a.enable(16),A.opaque&&a.enable(17),A.pointsUvs&&a.enable(18),A.decodeVideoTexture&&a.enable(19),A.decodeVideoTextureEmissive&&a.enable(20),A.alphaToCoverage&&a.enable(21),T.push(a.mask)}function w(T){let A=g[T.type],I;if(A){let F=ea[A];I=K0.clone(F.uniforms)}else I=T.uniforms;return I}function C(T,A){let I=d.get(A);return I!==void 0?++I.usedTimes:(I=new jq(t,A,T,s),u.push(I),d.set(A,I)),I}function M(T){if(--T.usedTimes===0){let A=u.indexOf(T);u[A]=u[u.length-1],u.pop(),d.delete(T.cacheKey),T.destroy()}}function L(T){l.remove(T)}function P(){l.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:w,acquireProgram:C,releaseProgram:M,releaseShaderCache:L,programs:u,dispose:P}}function Yq(){let t=new WeakMap;function e(o){return t.has(o)}function n(o){let a=t.get(o);return a===void 0&&(a={},t.set(o,a)),a}function i(o){t.delete(o)}function r(o,a,l){t.get(o)[a]=l}function s(){t=new WeakMap}return{has:e,get:n,remove:i,update:r,dispose:s}}function Kq(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Q4(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function eB(){let t=[],e=0,n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(d,p,m,g,_,y){let v=t[e];return v===void 0?(v={id:d.id,object:d,geometry:p,material:m,groupOrder:g,renderOrder:d.renderOrder,z:_,group:y},t[e]=v):(v.id=d.id,v.object=d,v.geometry=p,v.material=m,v.groupOrder=g,v.renderOrder=d.renderOrder,v.z=_,v.group=y),e++,v}function a(d,p,m,g,_,y){let v=o(d,p,m,g,_,y);m.transmission>0?i.push(v):m.transparent===!0?r.push(v):n.push(v)}function l(d,p,m,g,_,y){let v=o(d,p,m,g,_,y);m.transmission>0?i.unshift(v):m.transparent===!0?r.unshift(v):n.unshift(v)}function c(d,p){n.length>1&&n.sort(d||Kq),i.length>1&&i.sort(p||Q4),r.length>1&&r.sort(p||Q4)}function u(){for(let d=e,p=t.length;d<p;d++){let m=t[d];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function $q(){let t=new WeakMap;function e(i,r){let s=t.get(i),o;return s===void 0?(o=new eB,t.set(i,[o])):r>=s.length?(o=new eB,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function Jq(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Y,color:new dt};break;case"SpotLight":n={position:new Y,direction:new Y,color:new dt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Y,color:new dt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Y,skyColor:new dt,groundColor:new dt};break;case"RectAreaLight":n={color:new dt,position:new Y,halfWidth:new Y,halfHeight:new Y};break}return t[e.id]=n,n}}}function Zq(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}function eY(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function tY(t){let e=new Jq,n=Zq(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new Y);let r=new Y,s=new Ft,o=new Ft;function a(c){let u=0,d=0,p=0;for(let T=0;T<9;T++)i.probe[T].set(0,0,0);let m=0,g=0,_=0,y=0,v=0,S=0,b=0,w=0,C=0,M=0,L=0;c.sort(eY);for(let T=0,A=c.length;T<A;T++){let I=c[T],F=I.color,B=I.intensity,O=I.distance,z=null;if(I.shadow&&I.shadow.map&&(I.shadow.map.texture.format===Ru?z=I.shadow.map.texture:z=I.shadow.map.depthTexture||I.shadow.map.texture),I.isAmbientLight)u+=F.r*B,d+=F.g*B,p+=F.b*B;else if(I.isLightProbe){for(let U=0;U<9;U++)i.probe[U].addScaledVector(I.sh.coefficients[U],B);L++}else if(I.isDirectionalLight){let U=e.get(I);if(U.color.copy(I.color).multiplyScalar(I.intensity),I.castShadow){let G=I.shadow,j=n.get(I);j.shadowIntensity=G.intensity,j.shadowBias=G.bias,j.shadowNormalBias=G.normalBias,j.shadowRadius=G.radius,j.shadowMapSize=G.mapSize,i.directionalShadow[m]=j,i.directionalShadowMap[m]=z,i.directionalShadowMatrix[m]=I.shadow.matrix,S++}i.directional[m]=U,m++}else if(I.isSpotLight){let U=e.get(I);U.position.setFromMatrixPosition(I.matrixWorld),U.color.copy(F).multiplyScalar(B),U.distance=O,U.coneCos=Math.cos(I.angle),U.penumbraCos=Math.cos(I.angle*(1-I.penumbra)),U.decay=I.decay,i.spot[_]=U;let G=I.shadow;if(I.map&&(i.spotLightMap[C]=I.map,C++,G.updateMatrices(I),I.castShadow&&M++),i.spotLightMatrix[_]=G.matrix,I.castShadow){let j=n.get(I);j.shadowIntensity=G.intensity,j.shadowBias=G.bias,j.shadowNormalBias=G.normalBias,j.shadowRadius=G.radius,j.shadowMapSize=G.mapSize,i.spotShadow[_]=j,i.spotShadowMap[_]=z,w++}_++}else if(I.isRectAreaLight){let U=e.get(I);U.color.copy(F).multiplyScalar(B),U.halfWidth.set(I.width*.5,0,0),U.halfHeight.set(0,I.height*.5,0),i.rectArea[y]=U,y++}else if(I.isPointLight){let U=e.get(I);if(U.color.copy(I.color).multiplyScalar(I.intensity),U.distance=I.distance,U.decay=I.decay,I.castShadow){let G=I.shadow,j=n.get(I);j.shadowIntensity=G.intensity,j.shadowBias=G.bias,j.shadowNormalBias=G.normalBias,j.shadowRadius=G.radius,j.shadowMapSize=G.mapSize,j.shadowCameraNear=G.camera.near,j.shadowCameraFar=G.camera.far,i.pointShadow[g]=j,i.pointShadowMap[g]=z,i.pointShadowMatrix[g]=I.shadow.matrix,b++}i.point[g]=U,g++}else if(I.isHemisphereLight){let U=e.get(I);U.skyColor.copy(I.color).multiplyScalar(B),U.groundColor.copy(I.groundColor).multiplyScalar(B),i.hemi[v]=U,v++}}y>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=pt.LTC_FLOAT_1,i.rectAreaLTC2=pt.LTC_FLOAT_2):(i.rectAreaLTC1=pt.LTC_HALF_1,i.rectAreaLTC2=pt.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=d,i.ambient[2]=p;let P=i.hash;(P.directionalLength!==m||P.pointLength!==g||P.spotLength!==_||P.rectAreaLength!==y||P.hemiLength!==v||P.numDirectionalShadows!==S||P.numPointShadows!==b||P.numSpotShadows!==w||P.numSpotMaps!==C||P.numLightProbes!==L)&&(i.directional.length=m,i.spot.length=_,i.rectArea.length=y,i.point.length=g,i.hemi.length=v,i.directionalShadow.length=S,i.directionalShadowMap.length=S,i.pointShadow.length=b,i.pointShadowMap.length=b,i.spotShadow.length=w,i.spotShadowMap.length=w,i.directionalShadowMatrix.length=S,i.pointShadowMatrix.length=b,i.spotLightMatrix.length=w+C-M,i.spotLightMap.length=C,i.numSpotLightShadowsWithMaps=M,i.numLightProbes=L,P.directionalLength=m,P.pointLength=g,P.spotLength=_,P.rectAreaLength=y,P.hemiLength=v,P.numDirectionalShadows=S,P.numPointShadows=b,P.numSpotShadows=w,P.numSpotMaps=C,P.numLightProbes=L,i.version=Qq++)}function l(c,u){let d=0,p=0,m=0,g=0,_=0,y=u.matrixWorldInverse;for(let v=0,S=c.length;v<S;v++){let b=c[v];if(b.isDirectionalLight){let w=i.directional[d];w.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(r),w.direction.transformDirection(y),d++}else if(b.isSpotLight){let w=i.spot[m];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),w.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(r),w.direction.transformDirection(y),m++}else if(b.isRectAreaLight){let w=i.rectArea[g];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),o.identity(),s.copy(b.matrixWorld),s.premultiply(y),o.extractRotation(s),w.halfWidth.set(b.width*.5,0,0),w.halfHeight.set(0,b.height*.5,0),w.halfWidth.applyMatrix4(o),w.halfHeight.applyMatrix4(o),g++}else if(b.isPointLight){let w=i.point[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),p++}else if(b.isHemisphereLight){let w=i.hemi[_];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(y),_++}}}return{setup:a,setupView:l,state:i}}function tB(t){let e=new tY(t),n=[],i=[];function r(u){c.camera=u,n.length=0,i.length=0}function s(u){n.push(u)}function o(u){i.push(u)}function a(){e.setup(n)}function l(u){e.setupView(n,u)}let c={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function nY(t){let e=new WeakMap;function n(r,s=0){let o=e.get(r),a;return o===void 0?(a=new tB(t),e.set(r,[a])):s>=o.length?(a=new tB(t),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:n,dispose:i}}function aY(t,e,n){let i=new cc,r=new We,s=new We,o=new Rn,a=new Cu,l=new Tu,c={},u=n.maxTextureSize,d={[hl]:es,[es]:hl,[ts]:ts},p=new bs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new We},radius:{value:4}},vertexShader:iY,fragmentShader:rY}),m=p.clone();m.defines.HORIZONTAL_PASS=1;let g=new Wt;g.setAttribute("position",new In(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let _=new zn(g,p),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Iu;let v=this.type;this.render=function(M,L,P){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||M.length===0)return;M.type===sd&&(ut("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),M.type=Iu);let T=t.getRenderTarget(),A=t.getActiveCubeFace(),I=t.getActiveMipmapLevel(),F=t.state;F.setBlending(Ba),F.buffers.depth.getReversed()===!0?F.buffers.color.setClear(0,0,0,0):F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);let B=v!==this.type;B&&L.traverse(function(O){O.material&&(Array.isArray(O.material)?O.material.forEach(z=>z.needsUpdate=!0):O.material.needsUpdate=!0)});for(let O=0,z=M.length;O<z;O++){let U=M[O],G=U.shadow;if(G===void 0){ut("WebGLShadowMap:",U,"has no shadow.");continue}if(G.autoUpdate===!1&&G.needsUpdate===!1)continue;r.copy(G.mapSize);let j=G.getFrameExtents();if(r.multiply(j),s.copy(G.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/j.x),r.x=s.x*j.x,G.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/j.y),r.y=s.y*j.y,G.mapSize.y=s.y)),G.map===null||B===!0){if(G.map!==null&&(G.map.depthTexture!==null&&(G.map.depthTexture.dispose(),G.map.depthTexture=null),G.map.dispose()),this.type===pc){if(U.isPointLight){ut("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}G.map=new Qr(r.x,r.y,{format:Ru,type:za,minFilter:Un,magFilter:Un,generateMipmaps:!1}),G.map.texture.name=U.name+".shadowMap",G.map.depthTexture=new uc(r.x,r.y,Rr),G.map.depthTexture.name=U.name+".shadowMapDepth",G.map.depthTexture.format=La,G.map.depthTexture.compareFunction=null,G.map.depthTexture.minFilter=Ii,G.map.depthTexture.magFilter=Ii}else{U.isPointLight?(G.map=new sp(r.x),G.map.depthTexture=new ov(r.x,wo)):(G.map=new Qr(r.x,r.y),G.map.depthTexture=new uc(r.x,r.y,wo)),G.map.depthTexture.name=U.name+".shadowMap",G.map.depthTexture.format=La;let K=t.state.buffers.depth.getReversed();this.type===Iu?(G.map.depthTexture.compareFunction=K?Y0:q0,G.map.depthTexture.minFilter=Un,G.map.depthTexture.magFilter=Un):(G.map.depthTexture.compareFunction=null,G.map.depthTexture.minFilter=Ii,G.map.depthTexture.magFilter=Ii)}G.camera.updateProjectionMatrix()}let J=G.map.isWebGLCubeRenderTarget?6:1;for(let K=0;K<J;K++){if(G.map.isWebGLCubeRenderTarget)t.setRenderTarget(G.map,K),t.clear();else{K===0&&(t.setRenderTarget(G.map),t.clear());let D=G.getViewport(K);o.set(s.x*D.x,s.y*D.y,s.x*D.z,s.y*D.w),F.viewport(o)}if(U.isPointLight){let D=G.camera,X=G.matrix,q=U.distance||D.far;q!==D.far&&(D.far=q,D.updateProjectionMatrix()),J0.setFromMatrixPosition(U.matrixWorld),D.position.copy(J0),uA.copy(D.position),uA.add(sY[K]),D.up.copy(oY[K]),D.lookAt(uA),D.updateMatrixWorld(),X.makeTranslation(-J0.x,-J0.y,-J0.z),nB.multiplyMatrices(D.projectionMatrix,D.matrixWorldInverse),G._frustum.setFromProjectionMatrix(nB,D.coordinateSystem,D.reversedDepth)}else G.updateMatrices(U);i=G.getFrustum(),w(L,P,G.camera,U,this.type)}G.isPointLightShadow!==!0&&this.type===pc&&S(G,P),G.needsUpdate=!1}v=this.type,y.needsUpdate=!1,t.setRenderTarget(T,A,I)};function S(M,L){let P=e.update(_);p.defines.VSM_SAMPLES!==M.blurSamples&&(p.defines.VSM_SAMPLES=M.blurSamples,m.defines.VSM_SAMPLES=M.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Qr(r.x,r.y,{format:Ru,type:za})),p.uniforms.shadow_pass.value=M.map.depthTexture,p.uniforms.resolution.value=M.mapSize,p.uniforms.radius.value=M.radius,t.setRenderTarget(M.mapPass),t.clear(),t.renderBufferDirect(L,null,P,p,_,null),m.uniforms.shadow_pass.value=M.mapPass.texture,m.uniforms.resolution.value=M.mapSize,m.uniforms.radius.value=M.radius,t.setRenderTarget(M.map),t.clear(),t.renderBufferDirect(L,null,P,m,_,null)}function b(M,L,P,T){let A=null,I=P.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(I!==void 0)A=I;else if(A=P.isPointLight===!0?l:a,t.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0||L.alphaToCoverage===!0){let F=A.uuid,B=L.uuid,O=c[F];O===void 0&&(O={},c[F]=O);let z=O[B];z===void 0&&(z=A.clone(),O[B]=z,L.addEventListener("dispose",C)),A=z}if(A.visible=L.visible,A.wireframe=L.wireframe,T===pc?A.side=L.shadowSide!==null?L.shadowSide:L.side:A.side=L.shadowSide!==null?L.shadowSide:d[L.side],A.alphaMap=L.alphaMap,A.alphaTest=L.alphaToCoverage===!0?.5:L.alphaTest,A.map=L.map,A.clipShadows=L.clipShadows,A.clippingPlanes=L.clippingPlanes,A.clipIntersection=L.clipIntersection,A.displacementMap=L.displacementMap,A.displacementScale=L.displacementScale,A.displacementBias=L.displacementBias,A.wireframeLinewidth=L.wireframeLinewidth,A.linewidth=L.linewidth,P.isPointLight===!0&&A.isMeshDistanceMaterial===!0){let F=t.properties.get(A);F.light=P}return A}function w(M,L,P,T,A){if(M.visible===!1)return;if(M.layers.test(L.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&A===pc)&&(!M.frustumCulled||i.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,M.matrixWorld);let B=e.update(M),O=M.material;if(Array.isArray(O)){let z=B.groups;for(let U=0,G=z.length;U<G;U++){let j=z[U],J=O[j.materialIndex];if(J&&J.visible){let K=b(M,J,T,A);M.onBeforeShadow(t,M,L,P,B,K,j),t.renderBufferDirect(P,null,B,K,M,j),M.onAfterShadow(t,M,L,P,B,K,j)}}}else if(O.visible){let z=b(M,O,T,A);M.onBeforeShadow(t,M,L,P,B,z,null),t.renderBufferDirect(P,null,B,z,M,null),M.onAfterShadow(t,M,L,P,B,z,null)}}let F=M.children;for(let B=0,O=F.length;B<O;B++)w(F[B],L,P,T,A)}function C(M){M.target.removeEventListener("dispose",C);for(let P in c){let T=c[P],A=M.target.uuid;A in T&&(T[A].dispose(),delete T[A])}}}function cY(t,e){function n(){let te=!1,we=new Rn,Be=null,it=new Rn(0,0,0,0);return{setMask:function(Fe){Be!==Fe&&!te&&(t.colorMask(Fe,Fe,Fe,Fe),Be=Fe)},setLocked:function(Fe){te=Fe},setClear:function(Fe,Se,Xe,Je,ot){ot===!0&&(Fe*=Je,Se*=Je,Xe*=Je),we.set(Fe,Se,Xe,Je),it.equals(we)===!1&&(t.clearColor(Fe,Se,Xe,Je),it.copy(we))},reset:function(){te=!1,Be=null,it.set(-1,0,0,0)}}}function i(){let te=!1,we=!1,Be=null,it=null,Fe=null;return{setReversed:function(Se){if(we!==Se){let Xe=e.get("EXT_clip_control");Se?Xe.clipControlEXT(Xe.LOWER_LEFT_EXT,Xe.ZERO_TO_ONE_EXT):Xe.clipControlEXT(Xe.LOWER_LEFT_EXT,Xe.NEGATIVE_ONE_TO_ONE_EXT),we=Se;let Je=Fe;Fe=null,this.setClear(Je)}},getReversed:function(){return we},setTest:function(Se){Se?ie(t.DEPTH_TEST):le(t.DEPTH_TEST)},setMask:function(Se){Be!==Se&&!te&&(t.depthMask(Se),Be=Se)},setFunc:function(Se){if(we&&(Se=lY[Se]),it!==Se){switch(Se){case e0:t.depthFunc(t.NEVER);break;case t0:t.depthFunc(t.ALWAYS);break;case n0:t.depthFunc(t.LESS);break;case _u:t.depthFunc(t.LEQUAL);break;case i0:t.depthFunc(t.EQUAL);break;case r0:t.depthFunc(t.GEQUAL);break;case s0:t.depthFunc(t.GREATER);break;case o0:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}it=Se}},setLocked:function(Se){te=Se},setClear:function(Se){Fe!==Se&&(we&&(Se=1-Se),t.clearDepth(Se),Fe=Se)},reset:function(){te=!1,Be=null,it=null,Fe=null,we=!1}}}function r(){let te=!1,we=null,Be=null,it=null,Fe=null,Se=null,Xe=null,Je=null,ot=null;return{setTest:function(kt){te||(kt?ie(t.STENCIL_TEST):le(t.STENCIL_TEST))},setMask:function(kt){we!==kt&&!te&&(t.stencilMask(kt),we=kt)},setFunc:function(kt,un,mn){(Be!==kt||it!==un||Fe!==mn)&&(t.stencilFunc(kt,un,mn),Be=kt,it=un,Fe=mn)},setOp:function(kt,un,mn){(Se!==kt||Xe!==un||Je!==mn)&&(t.stencilOp(kt,un,mn),Se=kt,Xe=un,Je=mn)},setLocked:function(kt){te=kt},setClear:function(kt){ot!==kt&&(t.clearStencil(kt),ot=kt)},reset:function(){te=!1,we=null,Be=null,it=null,Fe=null,Se=null,Xe=null,Je=null,ot=null}}}let s=new n,o=new i,a=new r,l=new WeakMap,c=new WeakMap,u={},d={},p=new WeakMap,m=[],g=null,_=!1,y=null,v=null,S=null,b=null,w=null,C=null,M=null,L=new dt(0,0,0),P=0,T=!1,A=null,I=null,F=null,B=null,O=null,z=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),U=!1,G=0,j=t.getParameter(t.VERSION);j.indexOf("WebGL")!==-1?(G=parseFloat(/^WebGL (\d)/.exec(j)[1]),U=G>=1):j.indexOf("OpenGL ES")!==-1&&(G=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),U=G>=2);let J=null,K={},D=t.getParameter(t.SCISSOR_BOX),X=t.getParameter(t.VIEWPORT),q=new Rn().fromArray(D),ne=new Rn().fromArray(X);function re(te,we,Be,it){let Fe=new Uint8Array(4),Se=t.createTexture();t.bindTexture(te,Se),t.texParameteri(te,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(te,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Xe=0;Xe<Be;Xe++)te===t.TEXTURE_3D||te===t.TEXTURE_2D_ARRAY?t.texImage3D(we,0,t.RGBA,1,1,it,0,t.RGBA,t.UNSIGNED_BYTE,Fe):t.texImage2D(we+Xe,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Fe);return Se}let $={};$[t.TEXTURE_2D]=re(t.TEXTURE_2D,t.TEXTURE_2D,1),$[t.TEXTURE_CUBE_MAP]=re(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),$[t.TEXTURE_2D_ARRAY]=re(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),$[t.TEXTURE_3D]=re(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),ie(t.DEPTH_TEST),o.setFunc(_u),ge(!1),Ie(ib),ie(t.CULL_FACE),me(Ba);function ie(te){u[te]!==!0&&(t.enable(te),u[te]=!0)}function le(te){u[te]!==!1&&(t.disable(te),u[te]=!1)}function Ee(te,we){return d[te]!==we?(t.bindFramebuffer(te,we),d[te]=we,te===t.DRAW_FRAMEBUFFER&&(d[t.FRAMEBUFFER]=we),te===t.FRAMEBUFFER&&(d[t.DRAW_FRAMEBUFFER]=we),!0):!1}function ke(te,we){let Be=m,it=!1;if(te){Be=p.get(we),Be===void 0&&(Be=[],p.set(we,Be));let Fe=te.textures;if(Be.length!==Fe.length||Be[0]!==t.COLOR_ATTACHMENT0){for(let Se=0,Xe=Fe.length;Se<Xe;Se++)Be[Se]=t.COLOR_ATTACHMENT0+Se;Be.length=Fe.length,it=!0}}else Be[0]!==t.BACK&&(Be[0]=t.BACK,it=!0);it&&t.drawBuffers(Be)}function Pe(te){return g!==te?(t.useProgram(te),g=te,!0):!1}let Te={[ac]:t.FUNC_ADD,[v2]:t.FUNC_SUBTRACT,[_2]:t.FUNC_REVERSE_SUBTRACT};Te[y2]=t.MIN,Te[x2]=t.MAX;let De={[S2]:t.ZERO,[b2]:t.ONE,[w2]:t.SRC_COLOR,[Vg]:t.SRC_ALPHA,[k2]:t.SRC_ALPHA_SATURATE,[M2]:t.DST_COLOR,[C2]:t.DST_ALPHA,[E2]:t.ONE_MINUS_SRC_COLOR,[Gg]:t.ONE_MINUS_SRC_ALPHA,[A2]:t.ONE_MINUS_DST_COLOR,[T2]:t.ONE_MINUS_DST_ALPHA,[L2]:t.CONSTANT_COLOR,[P2]:t.ONE_MINUS_CONSTANT_COLOR,[D2]:t.CONSTANT_ALPHA,[I2]:t.ONE_MINUS_CONSTANT_ALPHA};function me(te,we,Be,it,Fe,Se,Xe,Je,ot,kt){if(te===Ba){_===!0&&(le(t.BLEND),_=!1);return}if(_===!1&&(ie(t.BLEND),_=!0),te!==g2){if(te!==y||kt!==T){if((v!==ac||w!==ac)&&(t.blendEquation(t.FUNC_ADD),v=ac,w=ac),kt)switch(te){case vu:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case sb:t.blendFunc(t.ONE,t.ONE);break;case ob:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case ab:t.blendFuncSeparate(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE);break;default:It("WebGLState: Invalid blending: ",te);break}else switch(te){case vu:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case sb:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case ob:It("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case ab:It("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:It("WebGLState: Invalid blending: ",te);break}S=null,b=null,C=null,M=null,L.set(0,0,0),P=0,y=te,T=kt}return}Fe=Fe||we,Se=Se||Be,Xe=Xe||it,(we!==v||Fe!==w)&&(t.blendEquationSeparate(Te[we],Te[Fe]),v=we,w=Fe),(Be!==S||it!==b||Se!==C||Xe!==M)&&(t.blendFuncSeparate(De[Be],De[it],De[Se],De[Xe]),S=Be,b=it,C=Se,M=Xe),(Je.equals(L)===!1||ot!==P)&&(t.blendColor(Je.r,Je.g,Je.b,ot),L.copy(Je),P=ot),y=te,T=!1}function ve(te,we){te.side===ts?le(t.CULL_FACE):ie(t.CULL_FACE);let Be=te.side===es;we&&(Be=!Be),ge(Be),te.blending===vu&&te.transparent===!1?me(Ba):me(te.blending,te.blendEquation,te.blendSrc,te.blendDst,te.blendEquationAlpha,te.blendSrcAlpha,te.blendDstAlpha,te.blendColor,te.blendAlpha,te.premultipliedAlpha),o.setFunc(te.depthFunc),o.setTest(te.depthTest),o.setMask(te.depthWrite),s.setMask(te.colorWrite);let it=te.stencilWrite;a.setTest(it),it&&(a.setMask(te.stencilWriteMask),a.setFunc(te.stencilFunc,te.stencilRef,te.stencilFuncMask),a.setOp(te.stencilFail,te.stencilZFail,te.stencilZPass)),Ge(te.polygonOffset,te.polygonOffsetFactor,te.polygonOffsetUnits),te.alphaToCoverage===!0?ie(t.SAMPLE_ALPHA_TO_COVERAGE):le(t.SAMPLE_ALPHA_TO_COVERAGE)}function ge(te){A!==te&&(te?t.frontFace(t.CW):t.frontFace(t.CCW),A=te)}function Ie(te){te!==p2?(ie(t.CULL_FACE),te!==I&&(te===ib?t.cullFace(t.BACK):te===m2?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):le(t.CULL_FACE),I=te}function V(te){te!==F&&(U&&t.lineWidth(te),F=te)}function Ge(te,we,Be){te?(ie(t.POLYGON_OFFSET_FILL),(B!==we||O!==Be)&&(t.polygonOffset(we,Be),B=we,O=Be)):le(t.POLYGON_OFFSET_FILL)}function Me(te){te?ie(t.SCISSOR_TEST):le(t.SCISSOR_TEST)}function _e(te){te===void 0&&(te=t.TEXTURE0+z-1),J!==te&&(t.activeTexture(te),J=te)}function Ne(te,we,Be){Be===void 0&&(J===null?Be=t.TEXTURE0+z-1:Be=J);let it=K[Be];it===void 0&&(it={type:void 0,texture:void 0},K[Be]=it),(it.type!==te||it.texture!==we)&&(J!==Be&&(t.activeTexture(Be),J=Be),t.bindTexture(te,we||$[te]),it.type=te,it.texture=we)}function W(){let te=K[J];te!==void 0&&te.type!==void 0&&(t.bindTexture(te.type,null),te.type=void 0,te.texture=void 0)}function R(){try{t.compressedTexImage2D(...arguments)}catch(te){It("WebGLState:",te)}}function Z(){try{t.compressedTexImage3D(...arguments)}catch(te){It("WebGLState:",te)}}function fe(){try{t.texSubImage2D(...arguments)}catch(te){It("WebGLState:",te)}}function he(){try{t.texSubImage3D(...arguments)}catch(te){It("WebGLState:",te)}}function ae(){try{t.compressedTexSubImage2D(...arguments)}catch(te){It("WebGLState:",te)}}function je(){try{t.compressedTexSubImage3D(...arguments)}catch(te){It("WebGLState:",te)}}function ze(){try{t.texStorage2D(...arguments)}catch(te){It("WebGLState:",te)}}function Qe(){try{t.texStorage3D(...arguments)}catch(te){It("WebGLState:",te)}}function ct(){try{t.texImage2D(...arguments)}catch(te){It("WebGLState:",te)}}function Ae(){try{t.texImage3D(...arguments)}catch(te){It("WebGLState:",te)}}function Ve(te){q.equals(te)===!1&&(t.scissor(te.x,te.y,te.z,te.w),q.copy(te))}function Ue(te){ne.equals(te)===!1&&(t.viewport(te.x,te.y,te.z,te.w),ne.copy(te))}function Q(te,we){let Be=c.get(we);Be===void 0&&(Be=new WeakMap,c.set(we,Be));let it=Be.get(te);it===void 0&&(it=t.getUniformBlockIndex(we,te.name),Be.set(te,it))}function ce(te,we){let it=c.get(we).get(te);l.get(we)!==it&&(t.uniformBlockBinding(we,it,te.__bindingPointIndex),l.set(we,it))}function Ye(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},J=null,K={},d={},p=new WeakMap,m=[],g=null,_=!1,y=null,v=null,S=null,b=null,w=null,C=null,M=null,L=new dt(0,0,0),P=0,T=!1,A=null,I=null,F=null,B=null,O=null,q.set(0,0,t.canvas.width,t.canvas.height),ne.set(0,0,t.canvas.width,t.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:ie,disable:le,bindFramebuffer:Ee,drawBuffers:ke,useProgram:Pe,setBlending:me,setMaterial:ve,setFlipSided:ge,setCullFace:Ie,setLineWidth:V,setPolygonOffset:Ge,setScissorTest:Me,activeTexture:_e,bindTexture:Ne,unbindTexture:W,compressedTexImage2D:R,compressedTexImage3D:Z,texImage2D:ct,texImage3D:Ae,updateUBOMapping:Q,uniformBlockBinding:ce,texStorage2D:ze,texStorage3D:Qe,texSubImage2D:fe,texSubImage3D:he,compressedTexSubImage2D:ae,compressedTexSubImage3D:je,scissor:Ve,viewport:Ue,reset:Ye}}function uY(t,e,n,i,r,s,o){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new We,u=new WeakMap,d,p=new WeakMap,m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(W,R){return m?new OffscreenCanvas(W,R):ep("canvas")}function _(W,R,Z){let fe=1,he=Ne(W);if((he.width>Z||he.height>Z)&&(fe=Z/Math.max(he.width,he.height)),fe<1)if(typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&W instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&W instanceof ImageBitmap||typeof VideoFrame<"u"&&W instanceof VideoFrame){let ae=Math.floor(fe*he.width),je=Math.floor(fe*he.height);d===void 0&&(d=g(ae,je));let ze=R?g(ae,je):d;return ze.width=ae,ze.height=je,ze.getContext("2d").drawImage(W,0,0,ae,je),ut("WebGLRenderer: Texture has been resized from ("+he.width+"x"+he.height+") to ("+ae+"x"+je+")."),ze}else return"data"in W&&ut("WebGLRenderer: Image in DataTexture is too big ("+he.width+"x"+he.height+")."),W;return W}function y(W){return W.generateMipmaps}function v(W){t.generateMipmap(W)}function S(W){return W.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:W.isWebGL3DRenderTarget?t.TEXTURE_3D:W.isWebGLArrayRenderTarget||W.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function b(W,R,Z,fe,he=!1){if(W!==null){if(t[W]!==void 0)return t[W];ut("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+W+"'")}let ae=R;if(R===t.RED&&(Z===t.FLOAT&&(ae=t.R32F),Z===t.HALF_FLOAT&&(ae=t.R16F),Z===t.UNSIGNED_BYTE&&(ae=t.R8)),R===t.RED_INTEGER&&(Z===t.UNSIGNED_BYTE&&(ae=t.R8UI),Z===t.UNSIGNED_SHORT&&(ae=t.R16UI),Z===t.UNSIGNED_INT&&(ae=t.R32UI),Z===t.BYTE&&(ae=t.R8I),Z===t.SHORT&&(ae=t.R16I),Z===t.INT&&(ae=t.R32I)),R===t.RG&&(Z===t.FLOAT&&(ae=t.RG32F),Z===t.HALF_FLOAT&&(ae=t.RG16F),Z===t.UNSIGNED_BYTE&&(ae=t.RG8)),R===t.RG_INTEGER&&(Z===t.UNSIGNED_BYTE&&(ae=t.RG8UI),Z===t.UNSIGNED_SHORT&&(ae=t.RG16UI),Z===t.UNSIGNED_INT&&(ae=t.RG32UI),Z===t.BYTE&&(ae=t.RG8I),Z===t.SHORT&&(ae=t.RG16I),Z===t.INT&&(ae=t.RG32I)),R===t.RGB_INTEGER&&(Z===t.UNSIGNED_BYTE&&(ae=t.RGB8UI),Z===t.UNSIGNED_SHORT&&(ae=t.RGB16UI),Z===t.UNSIGNED_INT&&(ae=t.RGB32UI),Z===t.BYTE&&(ae=t.RGB8I),Z===t.SHORT&&(ae=t.RGB16I),Z===t.INT&&(ae=t.RGB32I)),R===t.RGBA_INTEGER&&(Z===t.UNSIGNED_BYTE&&(ae=t.RGBA8UI),Z===t.UNSIGNED_SHORT&&(ae=t.RGBA16UI),Z===t.UNSIGNED_INT&&(ae=t.RGBA32UI),Z===t.BYTE&&(ae=t.RGBA8I),Z===t.SHORT&&(ae=t.RGBA16I),Z===t.INT&&(ae=t.RGBA32I)),R===t.RGB&&(Z===t.UNSIGNED_INT_5_9_9_9_REV&&(ae=t.RGB9_E5),Z===t.UNSIGNED_INT_10F_11F_11F_REV&&(ae=t.R11F_G11F_B10F)),R===t.RGBA){let je=he?Zf:yn.getTransfer(fe);Z===t.FLOAT&&(ae=t.RGBA32F),Z===t.HALF_FLOAT&&(ae=t.RGBA16F),Z===t.UNSIGNED_BYTE&&(ae=je===Dn?t.SRGB8_ALPHA8:t.RGBA8),Z===t.UNSIGNED_SHORT_4_4_4_4&&(ae=t.RGBA4),Z===t.UNSIGNED_SHORT_5_5_5_1&&(ae=t.RGB5_A1)}return(ae===t.R16F||ae===t.R32F||ae===t.RG16F||ae===t.RG32F||ae===t.RGBA16F||ae===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ae}function w(W,R){let Z;return W?R===null||R===wo||R===cd?Z=t.DEPTH24_STENCIL8:R===Rr?Z=t.DEPTH32F_STENCIL8:R===ld&&(Z=t.DEPTH24_STENCIL8,ut("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):R===null||R===wo||R===cd?Z=t.DEPTH_COMPONENT24:R===Rr?Z=t.DEPTH_COMPONENT32F:R===ld&&(Z=t.DEPTH_COMPONENT16),Z}function C(W,R){return y(W)===!0||W.isFramebufferTexture&&W.minFilter!==Ii&&W.minFilter!==Un?Math.log2(Math.max(R.width,R.height))+1:W.mipmaps!==void 0&&W.mipmaps.length>0?W.mipmaps.length:W.isCompressedTexture&&Array.isArray(W.image)?R.mipmaps.length:1}function M(W){let R=W.target;R.removeEventListener("dispose",M),P(R),R.isVideoTexture&&u.delete(R)}function L(W){let R=W.target;R.removeEventListener("dispose",L),A(R)}function P(W){let R=i.get(W);if(R.__webglInit===void 0)return;let Z=W.source,fe=p.get(Z);if(fe){let he=fe[R.__cacheKey];he.usedTimes--,he.usedTimes===0&&T(W),Object.keys(fe).length===0&&p.delete(Z)}i.remove(W)}function T(W){let R=i.get(W);t.deleteTexture(R.__webglTexture);let Z=W.source,fe=p.get(Z);delete fe[R.__cacheKey],o.memory.textures--}function A(W){let R=i.get(W);if(W.depthTexture&&(W.depthTexture.dispose(),i.remove(W.depthTexture)),W.isWebGLCubeRenderTarget)for(let fe=0;fe<6;fe++){if(Array.isArray(R.__webglFramebuffer[fe]))for(let he=0;he<R.__webglFramebuffer[fe].length;he++)t.deleteFramebuffer(R.__webglFramebuffer[fe][he]);else t.deleteFramebuffer(R.__webglFramebuffer[fe]);R.__webglDepthbuffer&&t.deleteRenderbuffer(R.__webglDepthbuffer[fe])}else{if(Array.isArray(R.__webglFramebuffer))for(let fe=0;fe<R.__webglFramebuffer.length;fe++)t.deleteFramebuffer(R.__webglFramebuffer[fe]);else t.deleteFramebuffer(R.__webglFramebuffer);if(R.__webglDepthbuffer&&t.deleteRenderbuffer(R.__webglDepthbuffer),R.__webglMultisampledFramebuffer&&t.deleteFramebuffer(R.__webglMultisampledFramebuffer),R.__webglColorRenderbuffer)for(let fe=0;fe<R.__webglColorRenderbuffer.length;fe++)R.__webglColorRenderbuffer[fe]&&t.deleteRenderbuffer(R.__webglColorRenderbuffer[fe]);R.__webglDepthRenderbuffer&&t.deleteRenderbuffer(R.__webglDepthRenderbuffer)}let Z=W.textures;for(let fe=0,he=Z.length;fe<he;fe++){let ae=i.get(Z[fe]);ae.__webglTexture&&(t.deleteTexture(ae.__webglTexture),o.memory.textures--),i.remove(Z[fe])}i.remove(W)}let I=0;function F(){I=0}function B(){let W=I;return W>=r.maxTextures&&ut("WebGLTextures: Trying to use "+W+" texture units while this GPU supports only "+r.maxTextures),I+=1,W}function O(W){let R=[];return R.push(W.wrapS),R.push(W.wrapT),R.push(W.wrapR||0),R.push(W.magFilter),R.push(W.minFilter),R.push(W.anisotropy),R.push(W.internalFormat),R.push(W.format),R.push(W.type),R.push(W.generateMipmaps),R.push(W.premultiplyAlpha),R.push(W.flipY),R.push(W.unpackAlignment),R.push(W.colorSpace),R.join()}function z(W,R){let Z=i.get(W);if(W.isVideoTexture&&Me(W),W.isRenderTargetTexture===!1&&W.isExternalTexture!==!0&&W.version>0&&Z.__version!==W.version){let fe=W.image;if(fe===null)ut("WebGLRenderer: Texture marked for update but no image data found.");else if(fe.complete===!1)ut("WebGLRenderer: Texture marked for update but image is incomplete");else{$(Z,W,R);return}}else W.isExternalTexture&&(Z.__webglTexture=W.sourceTexture?W.sourceTexture:null);n.bindTexture(t.TEXTURE_2D,Z.__webglTexture,t.TEXTURE0+R)}function U(W,R){let Z=i.get(W);if(W.isRenderTargetTexture===!1&&W.version>0&&Z.__version!==W.version){$(Z,W,R);return}else W.isExternalTexture&&(Z.__webglTexture=W.sourceTexture?W.sourceTexture:null);n.bindTexture(t.TEXTURE_2D_ARRAY,Z.__webglTexture,t.TEXTURE0+R)}function G(W,R){let Z=i.get(W);if(W.isRenderTargetTexture===!1&&W.version>0&&Z.__version!==W.version){$(Z,W,R);return}n.bindTexture(t.TEXTURE_3D,Z.__webglTexture,t.TEXTURE0+R)}function j(W,R){let Z=i.get(W);if(W.isCubeDepthTexture!==!0&&W.version>0&&Z.__version!==W.version){ie(Z,W,R);return}n.bindTexture(t.TEXTURE_CUBE_MAP,Z.__webglTexture,t.TEXTURE0+R)}let J={[Yf]:t.REPEAT,[xs]:t.CLAMP_TO_EDGE,[Kf]:t.MIRRORED_REPEAT},K={[Ii]:t.NEAREST,[pb]:t.NEAREST_MIPMAP_NEAREST,[ad]:t.NEAREST_MIPMAP_LINEAR,[Un]:t.LINEAR,[Lp]:t.LINEAR_MIPMAP_NEAREST,[Fa]:t.LINEAR_MIPMAP_LINEAR},D={[W2]:t.NEVER,[q2]:t.ALWAYS,[V2]:t.LESS,[q0]:t.LEQUAL,[G2]:t.EQUAL,[Y0]:t.GEQUAL,[j2]:t.GREATER,[X2]:t.NOTEQUAL};function X(W,R){if(R.type===Rr&&e.has("OES_texture_float_linear")===!1&&(R.magFilter===Un||R.magFilter===Lp||R.magFilter===ad||R.magFilter===Fa||R.minFilter===Un||R.minFilter===Lp||R.minFilter===ad||R.minFilter===Fa)&&ut("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(W,t.TEXTURE_WRAP_S,J[R.wrapS]),t.texParameteri(W,t.TEXTURE_WRAP_T,J[R.wrapT]),(W===t.TEXTURE_3D||W===t.TEXTURE_2D_ARRAY)&&t.texParameteri(W,t.TEXTURE_WRAP_R,J[R.wrapR]),t.texParameteri(W,t.TEXTURE_MAG_FILTER,K[R.magFilter]),t.texParameteri(W,t.TEXTURE_MIN_FILTER,K[R.minFilter]),R.compareFunction&&(t.texParameteri(W,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(W,t.TEXTURE_COMPARE_FUNC,D[R.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(R.magFilter===Ii||R.minFilter!==ad&&R.minFilter!==Fa||R.type===Rr&&e.has("OES_texture_float_linear")===!1)return;if(R.anisotropy>1||i.get(R).__currentAnisotropy){let Z=e.get("EXT_texture_filter_anisotropic");t.texParameterf(W,Z.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),i.get(R).__currentAnisotropy=R.anisotropy}}}function q(W,R){let Z=!1;W.__webglInit===void 0&&(W.__webglInit=!0,R.addEventListener("dispose",M));let fe=R.source,he=p.get(fe);he===void 0&&(he={},p.set(fe,he));let ae=O(R);if(ae!==W.__cacheKey){he[ae]===void 0&&(he[ae]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,Z=!0),he[ae].usedTimes++;let je=he[W.__cacheKey];je!==void 0&&(he[W.__cacheKey].usedTimes--,je.usedTimes===0&&T(R)),W.__cacheKey=ae,W.__webglTexture=he[ae].texture}return Z}function ne(W,R,Z){return Math.floor(Math.floor(W/Z)/R)}function re(W,R,Z,fe){let ae=W.updateRanges;if(ae.length===0)n.texSubImage2D(t.TEXTURE_2D,0,0,0,R.width,R.height,Z,fe,R.data);else{ae.sort((Ae,Ve)=>Ae.start-Ve.start);let je=0;for(let Ae=1;Ae<ae.length;Ae++){let Ve=ae[je],Ue=ae[Ae],Q=Ve.start+Ve.count,ce=ne(Ue.start,R.width,4),Ye=ne(Ve.start,R.width,4);Ue.start<=Q+1&&ce===Ye&&ne(Ue.start+Ue.count-1,R.width,4)===ce?Ve.count=Math.max(Ve.count,Ue.start+Ue.count-Ve.start):(++je,ae[je]=Ue)}ae.length=je+1;let ze=t.getParameter(t.UNPACK_ROW_LENGTH),Qe=t.getParameter(t.UNPACK_SKIP_PIXELS),ct=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,R.width);for(let Ae=0,Ve=ae.length;Ae<Ve;Ae++){let Ue=ae[Ae],Q=Math.floor(Ue.start/4),ce=Math.ceil(Ue.count/4),Ye=Q%R.width,te=Math.floor(Q/R.width),we=ce,Be=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,Ye),t.pixelStorei(t.UNPACK_SKIP_ROWS,te),n.texSubImage2D(t.TEXTURE_2D,0,Ye,te,we,Be,Z,fe,R.data)}W.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,ze),t.pixelStorei(t.UNPACK_SKIP_PIXELS,Qe),t.pixelStorei(t.UNPACK_SKIP_ROWS,ct)}}function $(W,R,Z){let fe=t.TEXTURE_2D;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(fe=t.TEXTURE_2D_ARRAY),R.isData3DTexture&&(fe=t.TEXTURE_3D);let he=q(W,R),ae=R.source;n.bindTexture(fe,W.__webglTexture,t.TEXTURE0+Z);let je=i.get(ae);if(ae.version!==je.__version||he===!0){n.activeTexture(t.TEXTURE0+Z);let ze=yn.getPrimaries(yn.workingColorSpace),Qe=R.colorSpace===pl?null:yn.getPrimaries(R.colorSpace),ct=R.colorSpace===pl||ze===Qe?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,R.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,R.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,ct);let Ae=_(R.image,!1,r.maxTextureSize);Ae=_e(R,Ae);let Ve=s.convert(R.format,R.colorSpace),Ue=s.convert(R.type),Q=b(R.internalFormat,Ve,Ue,R.colorSpace,R.isVideoTexture);X(fe,R);let ce,Ye=R.mipmaps,te=R.isVideoTexture!==!0,we=je.__version===void 0||he===!0,Be=ae.dataReady,it=C(R,Ae);if(R.isDepthTexture)Q=w(R.format===gc,R.type),we&&(te?n.texStorage2D(t.TEXTURE_2D,1,Q,Ae.width,Ae.height):n.texImage2D(t.TEXTURE_2D,0,Q,Ae.width,Ae.height,0,Ve,Ue,null));else if(R.isDataTexture)if(Ye.length>0){te&&we&&n.texStorage2D(t.TEXTURE_2D,it,Q,Ye[0].width,Ye[0].height);for(let Fe=0,Se=Ye.length;Fe<Se;Fe++)ce=Ye[Fe],te?Be&&n.texSubImage2D(t.TEXTURE_2D,Fe,0,0,ce.width,ce.height,Ve,Ue,ce.data):n.texImage2D(t.TEXTURE_2D,Fe,Q,ce.width,ce.height,0,Ve,Ue,ce.data);R.generateMipmaps=!1}else te?(we&&n.texStorage2D(t.TEXTURE_2D,it,Q,Ae.width,Ae.height),Be&&re(R,Ae,Ve,Ue)):n.texImage2D(t.TEXTURE_2D,0,Q,Ae.width,Ae.height,0,Ve,Ue,Ae.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){te&&we&&n.texStorage3D(t.TEXTURE_2D_ARRAY,it,Q,Ye[0].width,Ye[0].height,Ae.depth);for(let Fe=0,Se=Ye.length;Fe<Se;Fe++)if(ce=Ye[Fe],R.format!==rr)if(Ve!==null)if(te){if(Be)if(R.layerUpdates.size>0){let Xe=Eb(ce.width,ce.height,R.format,R.type);for(let Je of R.layerUpdates){let ot=ce.data.subarray(Je*Xe/ce.data.BYTES_PER_ELEMENT,(Je+1)*Xe/ce.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Fe,0,0,Je,ce.width,ce.height,1,Ve,ot)}R.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Fe,0,0,0,ce.width,ce.height,Ae.depth,Ve,ce.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Fe,Q,ce.width,ce.height,Ae.depth,0,ce.data,0,0);else ut("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else te?Be&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Fe,0,0,0,ce.width,ce.height,Ae.depth,Ve,Ue,ce.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Fe,Q,ce.width,ce.height,Ae.depth,0,Ve,Ue,ce.data)}else{te&&we&&n.texStorage2D(t.TEXTURE_2D,it,Q,Ye[0].width,Ye[0].height);for(let Fe=0,Se=Ye.length;Fe<Se;Fe++)ce=Ye[Fe],R.format!==rr?Ve!==null?te?Be&&n.compressedTexSubImage2D(t.TEXTURE_2D,Fe,0,0,ce.width,ce.height,Ve,ce.data):n.compressedTexImage2D(t.TEXTURE_2D,Fe,Q,ce.width,ce.height,0,ce.data):ut("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):te?Be&&n.texSubImage2D(t.TEXTURE_2D,Fe,0,0,ce.width,ce.height,Ve,Ue,ce.data):n.texImage2D(t.TEXTURE_2D,Fe,Q,ce.width,ce.height,0,Ve,Ue,ce.data)}else if(R.isDataArrayTexture)if(te){if(we&&n.texStorage3D(t.TEXTURE_2D_ARRAY,it,Q,Ae.width,Ae.height,Ae.depth),Be)if(R.layerUpdates.size>0){let Fe=Eb(Ae.width,Ae.height,R.format,R.type);for(let Se of R.layerUpdates){let Xe=Ae.data.subarray(Se*Fe/Ae.data.BYTES_PER_ELEMENT,(Se+1)*Fe/Ae.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Se,Ae.width,Ae.height,1,Ve,Ue,Xe)}R.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Ae.width,Ae.height,Ae.depth,Ve,Ue,Ae.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,Q,Ae.width,Ae.height,Ae.depth,0,Ve,Ue,Ae.data);else if(R.isData3DTexture)te?(we&&n.texStorage3D(t.TEXTURE_3D,it,Q,Ae.width,Ae.height,Ae.depth),Be&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Ae.width,Ae.height,Ae.depth,Ve,Ue,Ae.data)):n.texImage3D(t.TEXTURE_3D,0,Q,Ae.width,Ae.height,Ae.depth,0,Ve,Ue,Ae.data);else if(R.isFramebufferTexture){if(we)if(te)n.texStorage2D(t.TEXTURE_2D,it,Q,Ae.width,Ae.height);else{let Fe=Ae.width,Se=Ae.height;for(let Xe=0;Xe<it;Xe++)n.texImage2D(t.TEXTURE_2D,Xe,Q,Fe,Se,0,Ve,Ue,null),Fe>>=1,Se>>=1}}else if(Ye.length>0){if(te&&we){let Fe=Ne(Ye[0]);n.texStorage2D(t.TEXTURE_2D,it,Q,Fe.width,Fe.height)}for(let Fe=0,Se=Ye.length;Fe<Se;Fe++)ce=Ye[Fe],te?Be&&n.texSubImage2D(t.TEXTURE_2D,Fe,0,0,Ve,Ue,ce):n.texImage2D(t.TEXTURE_2D,Fe,Q,Ve,Ue,ce);R.generateMipmaps=!1}else if(te){if(we){let Fe=Ne(Ae);n.texStorage2D(t.TEXTURE_2D,it,Q,Fe.width,Fe.height)}Be&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Ve,Ue,Ae)}else n.texImage2D(t.TEXTURE_2D,0,Q,Ve,Ue,Ae);y(R)&&v(fe),je.__version=ae.version,R.onUpdate&&R.onUpdate(R)}W.__version=R.version}function ie(W,R,Z){if(R.image.length!==6)return;let fe=q(W,R),he=R.source;n.bindTexture(t.TEXTURE_CUBE_MAP,W.__webglTexture,t.TEXTURE0+Z);let ae=i.get(he);if(he.version!==ae.__version||fe===!0){n.activeTexture(t.TEXTURE0+Z);let je=yn.getPrimaries(yn.workingColorSpace),ze=R.colorSpace===pl?null:yn.getPrimaries(R.colorSpace),Qe=R.colorSpace===pl||je===ze?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,R.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,R.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qe);let ct=R.isCompressedTexture||R.image[0].isCompressedTexture,Ae=R.image[0]&&R.image[0].isDataTexture,Ve=[];for(let Se=0;Se<6;Se++)!ct&&!Ae?Ve[Se]=_(R.image[Se],!0,r.maxCubemapSize):Ve[Se]=Ae?R.image[Se].image:R.image[Se],Ve[Se]=_e(R,Ve[Se]);let Ue=Ve[0],Q=s.convert(R.format,R.colorSpace),ce=s.convert(R.type),Ye=b(R.internalFormat,Q,ce,R.colorSpace),te=R.isVideoTexture!==!0,we=ae.__version===void 0||fe===!0,Be=he.dataReady,it=C(R,Ue);X(t.TEXTURE_CUBE_MAP,R);let Fe;if(ct){te&&we&&n.texStorage2D(t.TEXTURE_CUBE_MAP,it,Ye,Ue.width,Ue.height);for(let Se=0;Se<6;Se++){Fe=Ve[Se].mipmaps;for(let Xe=0;Xe<Fe.length;Xe++){let Je=Fe[Xe];R.format!==rr?Q!==null?te?Be&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe,0,0,Je.width,Je.height,Q,Je.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe,Ye,Je.width,Je.height,0,Je.data):ut("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):te?Be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe,0,0,Je.width,Je.height,Q,ce,Je.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe,Ye,Je.width,Je.height,0,Q,ce,Je.data)}}}else{if(Fe=R.mipmaps,te&&we){Fe.length>0&&it++;let Se=Ne(Ve[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,it,Ye,Se.width,Se.height)}for(let Se=0;Se<6;Se++)if(Ae){te?Be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,0,0,Ve[Se].width,Ve[Se].height,Q,ce,Ve[Se].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,Ye,Ve[Se].width,Ve[Se].height,0,Q,ce,Ve[Se].data);for(let Xe=0;Xe<Fe.length;Xe++){let ot=Fe[Xe].image[Se].image;te?Be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe+1,0,0,ot.width,ot.height,Q,ce,ot.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe+1,Ye,ot.width,ot.height,0,Q,ce,ot.data)}}else{te?Be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,0,0,Q,ce,Ve[Se]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,Ye,Q,ce,Ve[Se]);for(let Xe=0;Xe<Fe.length;Xe++){let Je=Fe[Xe];te?Be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe+1,0,0,Q,ce,Je.image[Se]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Se,Xe+1,Ye,Q,ce,Je.image[Se])}}}y(R)&&v(t.TEXTURE_CUBE_MAP),ae.__version=he.version,R.onUpdate&&R.onUpdate(R)}W.__version=R.version}function le(W,R,Z,fe,he,ae){let je=s.convert(Z.format,Z.colorSpace),ze=s.convert(Z.type),Qe=b(Z.internalFormat,je,ze,Z.colorSpace),ct=i.get(R),Ae=i.get(Z);if(Ae.__renderTarget=R,!ct.__hasExternalTextures){let Ve=Math.max(1,R.width>>ae),Ue=Math.max(1,R.height>>ae);he===t.TEXTURE_3D||he===t.TEXTURE_2D_ARRAY?n.texImage3D(he,ae,Qe,Ve,Ue,R.depth,0,je,ze,null):n.texImage2D(he,ae,Qe,Ve,Ue,0,je,ze,null)}n.bindFramebuffer(t.FRAMEBUFFER,W),Ge(R)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,fe,he,Ae.__webglTexture,0,V(R)):(he===t.TEXTURE_2D||he>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&he<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,fe,he,Ae.__webglTexture,ae),n.bindFramebuffer(t.FRAMEBUFFER,null)}function Ee(W,R,Z){if(t.bindRenderbuffer(t.RENDERBUFFER,W),R.depthBuffer){let fe=R.depthTexture,he=fe&&fe.isDepthTexture?fe.type:null,ae=w(R.stencilBuffer,he),je=R.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;Ge(R)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,V(R),ae,R.width,R.height):Z?t.renderbufferStorageMultisample(t.RENDERBUFFER,V(R),ae,R.width,R.height):t.renderbufferStorage(t.RENDERBUFFER,ae,R.width,R.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,je,t.RENDERBUFFER,W)}else{let fe=R.textures;for(let he=0;he<fe.length;he++){let ae=fe[he],je=s.convert(ae.format,ae.colorSpace),ze=s.convert(ae.type),Qe=b(ae.internalFormat,je,ze,ae.colorSpace);Ge(R)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,V(R),Qe,R.width,R.height):Z?t.renderbufferStorageMultisample(t.RENDERBUFFER,V(R),Qe,R.width,R.height):t.renderbufferStorage(t.RENDERBUFFER,Qe,R.width,R.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ke(W,R,Z){let fe=R.isWebGLCubeRenderTarget===!0;if(n.bindFramebuffer(t.FRAMEBUFFER,W),!(R.depthTexture&&R.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let he=i.get(R.depthTexture);if(he.__renderTarget=R,(!he.__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),fe){if(he.__webglInit===void 0&&(he.__webglInit=!0,R.depthTexture.addEventListener("dispose",M)),he.__webglTexture===void 0){he.__webglTexture=t.createTexture(),n.bindTexture(t.TEXTURE_CUBE_MAP,he.__webglTexture),X(t.TEXTURE_CUBE_MAP,R.depthTexture);let ct=s.convert(R.depthTexture.format),Ae=s.convert(R.depthTexture.type),Ve;R.depthTexture.format===La?Ve=t.DEPTH_COMPONENT24:R.depthTexture.format===gc&&(Ve=t.DEPTH24_STENCIL8);for(let Ue=0;Ue<6;Ue++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,Ve,R.width,R.height,0,ct,Ae,null)}}else z(R.depthTexture,0);let ae=he.__webglTexture,je=V(R),ze=fe?t.TEXTURE_CUBE_MAP_POSITIVE_X+Z:t.TEXTURE_2D,Qe=R.depthTexture.format===gc?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(R.depthTexture.format===La)Ge(R)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Qe,ze,ae,0,je):t.framebufferTexture2D(t.FRAMEBUFFER,Qe,ze,ae,0);else if(R.depthTexture.format===gc)Ge(R)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Qe,ze,ae,0,je):t.framebufferTexture2D(t.FRAMEBUFFER,Qe,ze,ae,0);else throw new Error("Unknown depthTexture format")}function Pe(W){let R=i.get(W),Z=W.isWebGLCubeRenderTarget===!0;if(R.__boundDepthTexture!==W.depthTexture){let fe=W.depthTexture;if(R.__depthDisposeCallback&&R.__depthDisposeCallback(),fe){let he=()=>{delete R.__boundDepthTexture,delete R.__depthDisposeCallback,fe.removeEventListener("dispose",he)};fe.addEventListener("dispose",he),R.__depthDisposeCallback=he}R.__boundDepthTexture=fe}if(W.depthTexture&&!R.__autoAllocateDepthBuffer)if(Z)for(let fe=0;fe<6;fe++)ke(R.__webglFramebuffer[fe],W,fe);else{let fe=W.texture.mipmaps;fe&&fe.length>0?ke(R.__webglFramebuffer[0],W,0):ke(R.__webglFramebuffer,W,0)}else if(Z){R.__webglDepthbuffer=[];for(let fe=0;fe<6;fe++)if(n.bindFramebuffer(t.FRAMEBUFFER,R.__webglFramebuffer[fe]),R.__webglDepthbuffer[fe]===void 0)R.__webglDepthbuffer[fe]=t.createRenderbuffer(),Ee(R.__webglDepthbuffer[fe],W,!1);else{let he=W.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ae=R.__webglDepthbuffer[fe];t.bindRenderbuffer(t.RENDERBUFFER,ae),t.framebufferRenderbuffer(t.FRAMEBUFFER,he,t.RENDERBUFFER,ae)}}else{let fe=W.texture.mipmaps;if(fe&&fe.length>0?n.bindFramebuffer(t.FRAMEBUFFER,R.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,R.__webglFramebuffer),R.__webglDepthbuffer===void 0)R.__webglDepthbuffer=t.createRenderbuffer(),Ee(R.__webglDepthbuffer,W,!1);else{let he=W.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ae=R.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,ae),t.framebufferRenderbuffer(t.FRAMEBUFFER,he,t.RENDERBUFFER,ae)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function Te(W,R,Z){let fe=i.get(W);R!==void 0&&le(fe.__webglFramebuffer,W,W.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Z!==void 0&&Pe(W)}function De(W){let R=W.texture,Z=i.get(W),fe=i.get(R);W.addEventListener("dispose",L);let he=W.textures,ae=W.isWebGLCubeRenderTarget===!0,je=he.length>1;if(je||(fe.__webglTexture===void 0&&(fe.__webglTexture=t.createTexture()),fe.__version=R.version,o.memory.textures++),ae){Z.__webglFramebuffer=[];for(let ze=0;ze<6;ze++)if(R.mipmaps&&R.mipmaps.length>0){Z.__webglFramebuffer[ze]=[];for(let Qe=0;Qe<R.mipmaps.length;Qe++)Z.__webglFramebuffer[ze][Qe]=t.createFramebuffer()}else Z.__webglFramebuffer[ze]=t.createFramebuffer()}else{if(R.mipmaps&&R.mipmaps.length>0){Z.__webglFramebuffer=[];for(let ze=0;ze<R.mipmaps.length;ze++)Z.__webglFramebuffer[ze]=t.createFramebuffer()}else Z.__webglFramebuffer=t.createFramebuffer();if(je)for(let ze=0,Qe=he.length;ze<Qe;ze++){let ct=i.get(he[ze]);ct.__webglTexture===void 0&&(ct.__webglTexture=t.createTexture(),o.memory.textures++)}if(W.samples>0&&Ge(W)===!1){Z.__webglMultisampledFramebuffer=t.createFramebuffer(),Z.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,Z.__webglMultisampledFramebuffer);for(let ze=0;ze<he.length;ze++){let Qe=he[ze];Z.__webglColorRenderbuffer[ze]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Z.__webglColorRenderbuffer[ze]);let ct=s.convert(Qe.format,Qe.colorSpace),Ae=s.convert(Qe.type),Ve=b(Qe.internalFormat,ct,Ae,Qe.colorSpace,W.isXRRenderTarget===!0),Ue=V(W);t.renderbufferStorageMultisample(t.RENDERBUFFER,Ue,Ve,W.width,W.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ze,t.RENDERBUFFER,Z.__webglColorRenderbuffer[ze])}t.bindRenderbuffer(t.RENDERBUFFER,null),W.depthBuffer&&(Z.__webglDepthRenderbuffer=t.createRenderbuffer(),Ee(Z.__webglDepthRenderbuffer,W,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(ae){n.bindTexture(t.TEXTURE_CUBE_MAP,fe.__webglTexture),X(t.TEXTURE_CUBE_MAP,R);for(let ze=0;ze<6;ze++)if(R.mipmaps&&R.mipmaps.length>0)for(let Qe=0;Qe<R.mipmaps.length;Qe++)le(Z.__webglFramebuffer[ze][Qe],W,R,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Qe);else le(Z.__webglFramebuffer[ze],W,R,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0);y(R)&&v(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(je){for(let ze=0,Qe=he.length;ze<Qe;ze++){let ct=he[ze],Ae=i.get(ct),Ve=t.TEXTURE_2D;(W.isWebGL3DRenderTarget||W.isWebGLArrayRenderTarget)&&(Ve=W.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Ve,Ae.__webglTexture),X(Ve,ct),le(Z.__webglFramebuffer,W,ct,t.COLOR_ATTACHMENT0+ze,Ve,0),y(ct)&&v(Ve)}n.unbindTexture()}else{let ze=t.TEXTURE_2D;if((W.isWebGL3DRenderTarget||W.isWebGLArrayRenderTarget)&&(ze=W.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(ze,fe.__webglTexture),X(ze,R),R.mipmaps&&R.mipmaps.length>0)for(let Qe=0;Qe<R.mipmaps.length;Qe++)le(Z.__webglFramebuffer[Qe],W,R,t.COLOR_ATTACHMENT0,ze,Qe);else le(Z.__webglFramebuffer,W,R,t.COLOR_ATTACHMENT0,ze,0);y(R)&&v(ze),n.unbindTexture()}W.depthBuffer&&Pe(W)}function me(W){let R=W.textures;for(let Z=0,fe=R.length;Z<fe;Z++){let he=R[Z];if(y(he)){let ae=S(W),je=i.get(he).__webglTexture;n.bindTexture(ae,je),v(ae),n.unbindTexture()}}}let ve=[],ge=[];function Ie(W){if(W.samples>0){if(Ge(W)===!1){let R=W.textures,Z=W.width,fe=W.height,he=t.COLOR_BUFFER_BIT,ae=W.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,je=i.get(W),ze=R.length>1;if(ze)for(let ct=0;ct<R.length;ct++)n.bindFramebuffer(t.FRAMEBUFFER,je.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ct,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,je.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ct,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,je.__webglMultisampledFramebuffer);let Qe=W.texture.mipmaps;Qe&&Qe.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,je.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,je.__webglFramebuffer);for(let ct=0;ct<R.length;ct++){if(W.resolveDepthBuffer&&(W.depthBuffer&&(he|=t.DEPTH_BUFFER_BIT),W.stencilBuffer&&W.resolveStencilBuffer&&(he|=t.STENCIL_BUFFER_BIT)),ze){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,je.__webglColorRenderbuffer[ct]);let Ae=i.get(R[ct]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Ae,0)}t.blitFramebuffer(0,0,Z,fe,0,0,Z,fe,he,t.NEAREST),l===!0&&(ve.length=0,ge.length=0,ve.push(t.COLOR_ATTACHMENT0+ct),W.depthBuffer&&W.resolveDepthBuffer===!1&&(ve.push(ae),ge.push(ae),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,ge)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,ve))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),ze)for(let ct=0;ct<R.length;ct++){n.bindFramebuffer(t.FRAMEBUFFER,je.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ct,t.RENDERBUFFER,je.__webglColorRenderbuffer[ct]);let Ae=i.get(R[ct]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,je.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ct,t.TEXTURE_2D,Ae,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,je.__webglMultisampledFramebuffer)}else if(W.depthBuffer&&W.resolveDepthBuffer===!1&&l){let R=W.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[R])}}}function V(W){return Math.min(r.maxSamples,W.samples)}function Ge(W){let R=i.get(W);return W.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&R.__useRenderToTexture!==!1}function Me(W){let R=o.render.frame;u.get(W)!==R&&(u.set(W,R),W.update())}function _e(W,R){let Z=W.colorSpace,fe=W.format,he=W.type;return W.isCompressedTexture===!0||W.isVideoTexture===!0||Z!==yu&&Z!==pl&&(yn.getTransfer(Z)===Dn?(fe!==rr||he!==Or)&&ut("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):It("WebGLTextures: Unsupported texture color space:",Z)),R}function Ne(W){return typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement?(c.width=W.naturalWidth||W.width,c.height=W.naturalHeight||W.height):typeof VideoFrame<"u"&&W instanceof VideoFrame?(c.width=W.displayWidth,c.height=W.displayHeight):(c.width=W.width,c.height=W.height),c}this.allocateTextureUnit=B,this.resetTextureUnits=F,this.setTexture2D=z,this.setTexture2DArray=U,this.setTexture3D=G,this.setTextureCube=j,this.rebindTextures=Te,this.setupRenderTarget=De,this.updateRenderTargetMipmap=me,this.updateMultisampleRenderTarget=Ie,this.setupDepthRenderbuffer=Pe,this.setupFrameBufferTexture=le,this.useMultisampledRTT=Ge,this.isReversedDepthBuffer=function(){return n.buffers.depth.getReversed()}}function lB(t,e){function n(i,r=pl){let s,o=yn.getTransfer(r);if(i===Or)return t.UNSIGNED_BYTE;if(i===c0)return t.UNSIGNED_SHORT_4_4_4_4;if(i===u0)return t.UNSIGNED_SHORT_5_5_5_1;if(i===vb)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===_b)return t.UNSIGNED_INT_10F_11F_11F_REV;if(i===mb)return t.BYTE;if(i===gb)return t.SHORT;if(i===ld)return t.UNSIGNED_SHORT;if(i===l0)return t.INT;if(i===wo)return t.UNSIGNED_INT;if(i===Rr)return t.FLOAT;if(i===za)return t.HALF_FLOAT;if(i===yb)return t.ALPHA;if(i===xb)return t.RGB;if(i===rr)return t.RGBA;if(i===La)return t.DEPTH_COMPONENT;if(i===gc)return t.DEPTH_STENCIL;if(i===h0)return t.RED;if(i===Pp)return t.RED_INTEGER;if(i===Ru)return t.RG;if(i===d0)return t.RG_INTEGER;if(i===f0)return t.RGBA_INTEGER;if(i===Dp||i===Ip||i===Rp||i===Np)if(o===Dn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===Dp)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Ip)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Rp)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Np)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===Dp)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Ip)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Rp)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Np)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===p0||i===m0||i===g0||i===v0)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===p0)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===m0)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===g0)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===v0)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===_0||i===y0||i===x0||i===S0||i===b0||i===w0||i===E0)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===_0||i===y0)return o===Dn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===x0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(i===S0)return s.COMPRESSED_R11_EAC;if(i===b0)return s.COMPRESSED_SIGNED_R11_EAC;if(i===w0)return s.COMPRESSED_RG11_EAC;if(i===E0)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(i===C0||i===T0||i===M0||i===A0||i===k0||i===L0||i===P0||i===D0||i===I0||i===R0||i===N0||i===O0||i===B0||i===U0)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===C0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===T0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===M0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===A0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===k0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===L0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===P0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===D0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===I0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===R0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===N0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===O0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===B0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===U0)return o===Dn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===F0||i===z0||i===H0)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===F0)return o===Dn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===z0)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===H0)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===W0||i===V0||i===G0||i===j0)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===W0)return s.COMPRESSED_RED_RGTC1_EXT;if(i===V0)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===G0)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===j0)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===cd?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}function pY(t,e){function n(y,v){y.matrixAutoUpdate===!0&&y.updateMatrix(),v.value.copy(y.matrix)}function i(y,v){v.color.getRGB(y.fogColor.value,Z2(t)),v.isFog?(y.fogNear.value=v.near,y.fogFar.value=v.far):v.isFogExp2&&(y.fogDensity.value=v.density)}function r(y,v,S,b,w){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(y,v):v.isMeshToonMaterial?(s(y,v),d(y,v)):v.isMeshPhongMaterial?(s(y,v),u(y,v)):v.isMeshStandardMaterial?(s(y,v),p(y,v),v.isMeshPhysicalMaterial&&m(y,v,w)):v.isMeshMatcapMaterial?(s(y,v),g(y,v)):v.isMeshDepthMaterial?s(y,v):v.isMeshDistanceMaterial?(s(y,v),_(y,v)):v.isMeshNormalMaterial?s(y,v):v.isLineBasicMaterial?(o(y,v),v.isLineDashedMaterial&&a(y,v)):v.isPointsMaterial?l(y,v,S,b):v.isSpriteMaterial?c(y,v):v.isShadowMaterial?(y.color.value.copy(v.color),y.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(y,v){y.opacity.value=v.opacity,v.color&&y.diffuse.value.copy(v.color),v.emissive&&y.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(y.map.value=v.map,n(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.bumpMap&&(y.bumpMap.value=v.bumpMap,n(v.bumpMap,y.bumpMapTransform),y.bumpScale.value=v.bumpScale,v.side===es&&(y.bumpScale.value*=-1)),v.normalMap&&(y.normalMap.value=v.normalMap,n(v.normalMap,y.normalMapTransform),y.normalScale.value.copy(v.normalScale),v.side===es&&y.normalScale.value.negate()),v.displacementMap&&(y.displacementMap.value=v.displacementMap,n(v.displacementMap,y.displacementMapTransform),y.displacementScale.value=v.displacementScale,y.displacementBias.value=v.displacementBias),v.emissiveMap&&(y.emissiveMap.value=v.emissiveMap,n(v.emissiveMap,y.emissiveMapTransform)),v.specularMap&&(y.specularMap.value=v.specularMap,n(v.specularMap,y.specularMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest);let S=e.get(v),b=S.envMap,w=S.envMapRotation;b&&(y.envMap.value=b,dd.copy(w),dd.x*=-1,dd.y*=-1,dd.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(dd.y*=-1,dd.z*=-1),y.envMapRotation.value.setFromMatrix4(fY.makeRotationFromEuler(dd)),y.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=v.reflectivity,y.ior.value=v.ior,y.refractionRatio.value=v.refractionRatio),v.lightMap&&(y.lightMap.value=v.lightMap,y.lightMapIntensity.value=v.lightMapIntensity,n(v.lightMap,y.lightMapTransform)),v.aoMap&&(y.aoMap.value=v.aoMap,y.aoMapIntensity.value=v.aoMapIntensity,n(v.aoMap,y.aoMapTransform))}function o(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,v.map&&(y.map.value=v.map,n(v.map,y.mapTransform))}function a(y,v){y.dashSize.value=v.dashSize,y.totalSize.value=v.dashSize+v.gapSize,y.scale.value=v.scale}function l(y,v,S,b){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.size.value=v.size*S,y.scale.value=b*.5,v.map&&(y.map.value=v.map,n(v.map,y.uvTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function c(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.rotation.value=v.rotation,v.map&&(y.map.value=v.map,n(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function u(y,v){y.specular.value.copy(v.specular),y.shininess.value=Math.max(v.shininess,1e-4)}function d(y,v){v.gradientMap&&(y.gradientMap.value=v.gradientMap)}function p(y,v){y.metalness.value=v.metalness,v.metalnessMap&&(y.metalnessMap.value=v.metalnessMap,n(v.metalnessMap,y.metalnessMapTransform)),y.roughness.value=v.roughness,v.roughnessMap&&(y.roughnessMap.value=v.roughnessMap,n(v.roughnessMap,y.roughnessMapTransform)),v.envMap&&(y.envMapIntensity.value=v.envMapIntensity)}function m(y,v,S){y.ior.value=v.ior,v.sheen>0&&(y.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),y.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(y.sheenColorMap.value=v.sheenColorMap,n(v.sheenColorMap,y.sheenColorMapTransform)),v.sheenRoughnessMap&&(y.sheenRoughnessMap.value=v.sheenRoughnessMap,n(v.sheenRoughnessMap,y.sheenRoughnessMapTransform))),v.clearcoat>0&&(y.clearcoat.value=v.clearcoat,y.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(y.clearcoatMap.value=v.clearcoatMap,n(v.clearcoatMap,y.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,n(v.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(y.clearcoatNormalMap.value=v.clearcoatNormalMap,n(v.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===es&&y.clearcoatNormalScale.value.negate())),v.dispersion>0&&(y.dispersion.value=v.dispersion),v.iridescence>0&&(y.iridescence.value=v.iridescence,y.iridescenceIOR.value=v.iridescenceIOR,y.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(y.iridescenceMap.value=v.iridescenceMap,n(v.iridescenceMap,y.iridescenceMapTransform)),v.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=v.iridescenceThicknessMap,n(v.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),v.transmission>0&&(y.transmission.value=v.transmission,y.transmissionSamplerMap.value=S.texture,y.transmissionSamplerSize.value.set(S.width,S.height),v.transmissionMap&&(y.transmissionMap.value=v.transmissionMap,n(v.transmissionMap,y.transmissionMapTransform)),y.thickness.value=v.thickness,v.thicknessMap&&(y.thicknessMap.value=v.thicknessMap,n(v.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=v.attenuationDistance,y.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(y.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(y.anisotropyMap.value=v.anisotropyMap,n(v.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=v.specularIntensity,y.specularColor.value.copy(v.specularColor),v.specularColorMap&&(y.specularColorMap.value=v.specularColorMap,n(v.specularColorMap,y.specularColorMapTransform)),v.specularIntensityMap&&(y.specularIntensityMap.value=v.specularIntensityMap,n(v.specularIntensityMap,y.specularIntensityMapTransform))}function g(y,v){v.matcap&&(y.matcap.value=v.matcap)}function _(y,v){let S=e.get(v).light;y.referencePosition.value.setFromMatrixPosition(S.matrixWorld),y.nearDistance.value=S.shadow.camera.near,y.farDistance.value=S.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function mY(t,e,n,i){let r={},s={},o=[],a=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(S,b){let w=b.program;i.uniformBlockBinding(S,w)}function c(S,b){let w=r[S.id];w===void 0&&(g(S),w=u(S),r[S.id]=w,S.addEventListener("dispose",y));let C=b.program;i.updateUBOMapping(S,C);let M=e.render.frame;s[S.id]!==M&&(p(S),s[S.id]=M)}function u(S){let b=d();S.__bindingPointIndex=b;let w=t.createBuffer(),C=S.__size,M=S.usage;return t.bindBuffer(t.UNIFORM_BUFFER,w),t.bufferData(t.UNIFORM_BUFFER,C,M),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,b,w),w}function d(){for(let S=0;S<a;S++)if(o.indexOf(S)===-1)return o.push(S),S;return It("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(S){let b=r[S.id],w=S.uniforms,C=S.__cache;t.bindBuffer(t.UNIFORM_BUFFER,b);for(let M=0,L=w.length;M<L;M++){let P=Array.isArray(w[M])?w[M]:[w[M]];for(let T=0,A=P.length;T<A;T++){let I=P[T];if(m(I,M,T,C)===!0){let F=I.__offset,B=Array.isArray(I.value)?I.value:[I.value],O=0;for(let z=0;z<B.length;z++){let U=B[z],G=_(U);typeof U=="number"||typeof U=="boolean"?(I.__data[0]=U,t.bufferSubData(t.UNIFORM_BUFFER,F+O,I.__data)):U.isMatrix3?(I.__data[0]=U.elements[0],I.__data[1]=U.elements[1],I.__data[2]=U.elements[2],I.__data[3]=0,I.__data[4]=U.elements[3],I.__data[5]=U.elements[4],I.__data[6]=U.elements[5],I.__data[7]=0,I.__data[8]=U.elements[6],I.__data[9]=U.elements[7],I.__data[10]=U.elements[8],I.__data[11]=0):(U.toArray(I.__data,O),O+=G.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,F,I.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function m(S,b,w,C){let M=S.value,L=b+"_"+w;if(C[L]===void 0)return typeof M=="number"||typeof M=="boolean"?C[L]=M:C[L]=M.clone(),!0;{let P=C[L];if(typeof M=="number"||typeof M=="boolean"){if(P!==M)return C[L]=M,!0}else if(P.equals(M)===!1)return P.copy(M),!0}return!1}function g(S){let b=S.uniforms,w=0,C=16;for(let L=0,P=b.length;L<P;L++){let T=Array.isArray(b[L])?b[L]:[b[L]];for(let A=0,I=T.length;A<I;A++){let F=T[A],B=Array.isArray(F.value)?F.value:[F.value];for(let O=0,z=B.length;O<z;O++){let U=B[O],G=_(U),j=w%C,J=j%G.boundary,K=j+J;w+=J,K!==0&&C-K<G.storage&&(w+=C-K),F.__data=new Float32Array(G.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=w,w+=G.storage}}}let M=w%C;return M>0&&(w+=C-M),S.__size=w,S.__cache={},this}function _(S){let b={boundary:0,storage:0};return typeof S=="number"||typeof S=="boolean"?(b.boundary=4,b.storage=4):S.isVector2?(b.boundary=8,b.storage=8):S.isVector3||S.isColor?(b.boundary=16,b.storage=12):S.isVector4?(b.boundary=16,b.storage=16):S.isMatrix3?(b.boundary=48,b.storage=48):S.isMatrix4?(b.boundary=64,b.storage=64):S.isTexture?ut("WebGLRenderer: Texture samplers can not be part of an uniforms group."):ut("WebGLRenderer: Unsupported uniform value type.",S),b}function y(S){let b=S.target;b.removeEventListener("dispose",y);let w=o.indexOf(b.__bindingPointIndex);o.splice(w,1),t.deleteBuffer(r[b.id]),delete r[b.id],delete s[b.id]}function v(){for(let S in r)t.deleteBuffer(r[S]);o=[],r={},s={}}return{bind:l,update:c,dispose:v}}function vY(){return ml===null&&(ml=new Ss(gY,16,16,Ru,za),ml.name="DFG_LUT",ml.minFilter=Un,ml.magFilter=Un,ml.wrapS=xs,ml.wrapT=xs,ml.generateMipmaps=!1,ml.needsUpdate=!0),ml}var I9,R9,N9,O9,B9,U9,F9,z9,H9,W9,V9,G9,j9,X9,q9,Y9,K9,$9,J9,Z9,Q9,e7,t7,n7,i7,r7,s7,o7,a7,l7,c7,u7,h7,d7,f7,p7,m7,g7,v7,_7,y7,x7,S7,b7,w7,E7,C7,T7,M7,A7,k7,L7,P7,D7,I7,R7,N7,O7,B7,U7,F7,z7,H7,W7,V7,G7,j7,X7,q7,Y7,K7,$7,J7,Z7,Q7,ej,tj,nj,ij,rj,sj,oj,aj,lj,cj,uj,hj,dj,fj,pj,mj,gj,vj,_j,yj,xj,Sj,bj,wj,Ej,Cj,Tj,Mj,Aj,kj,Lj,Pj,Dj,Ij,Rj,Nj,Oj,Bj,Uj,Fj,zj,Hj,Wj,Vj,Gj,jj,Xj,qj,Yj,Kj,$j,Jj,Zj,Qj,eX,tX,nX,iX,rX,sX,oX,aX,lX,cX,uX,hX,Jt,pt,ea,Cb,hd,dX,Nu,N4,fd,yX,$0,O4,sA,oA,aA,lA,xX,Q0,PX,rB,hA,sB,oB,aB,z4,H4,W4,V4,G4,dA,fA,pA,cA,Bp,xq,Sq,q4,Cq,Tb,Pq,Dq,Rq,Oq,Uq,zq,Wq,Xq,gA,vA,Qq,iY,rY,sY,oY,nB,J0,uA,lY,hY,dY,_A,yA,dd,fY,gY,ml,e_,Ou=Hl(()=>{rA();rA();I9=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,R9=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,N9=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,O9=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,B9=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,U9=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,F9=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,z9=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,H9=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,W9=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,V9=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,G9=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,j9=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,X9=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,q9=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Y9=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,K9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,$9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,J9=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Z9=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Q9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,e7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,t7=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,n7=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,i7=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,r7=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,s7=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,o7=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,a7=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,l7=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,c7="gl_FragColor = linearToOutputTexel( gl_FragColor );",u7=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,h7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,d7=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,f7=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,p7=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,m7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,g7=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,v7=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,_7=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,y7=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,x7=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,S7=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,b7=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,w7=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,E7=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,C7=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,T7=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,M7=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,A7=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,k7=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,L7=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,P7=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,D7=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,I7=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,R7=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,N7=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,O7=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,B7=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,U7=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,F7=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,z7=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,H7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,W7=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,V7=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,G7=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,j7=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,X7=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,q7=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Y7=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,K7=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,$7=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,J7=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Z7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Q7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ej=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,tj=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,nj=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,ij=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,rj=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,sj=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,oj=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,aj=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,lj=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,cj=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,uj=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,hj=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,dj=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,fj=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,pj=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,mj=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,gj=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,vj=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,_j=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,yj=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,xj=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Sj=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,bj=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wj=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Ej=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Cj=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Tj=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Mj=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Aj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,kj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Lj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Pj=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Dj=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Ij=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Rj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Nj=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Oj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Bj=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Uj=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Fj=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,zj=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Hj=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,Wj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Vj=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Gj=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,jj=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Xj=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,qj=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yj=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Kj=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$j=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Jj=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zj=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Qj=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,eX=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,tX=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nX=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,iX=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rX=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sX=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oX=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,aX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,lX=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cX=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,uX=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Jt={alphahash_fragment:I9,alphahash_pars_fragment:R9,alphamap_fragment:N9,alphamap_pars_fragment:O9,alphatest_fragment:B9,alphatest_pars_fragment:U9,aomap_fragment:F9,aomap_pars_fragment:z9,batching_pars_vertex:H9,batching_vertex:W9,begin_vertex:V9,beginnormal_vertex:G9,bsdfs:j9,iridescence_fragment:X9,bumpmap_pars_fragment:q9,clipping_planes_fragment:Y9,clipping_planes_pars_fragment:K9,clipping_planes_pars_vertex:$9,clipping_planes_vertex:J9,color_fragment:Z9,color_pars_fragment:Q9,color_pars_vertex:e7,color_vertex:t7,common:n7,cube_uv_reflection_fragment:i7,defaultnormal_vertex:r7,displacementmap_pars_vertex:s7,displacementmap_vertex:o7,emissivemap_fragment:a7,emissivemap_pars_fragment:l7,colorspace_fragment:c7,colorspace_pars_fragment:u7,envmap_fragment:h7,envmap_common_pars_fragment:d7,envmap_pars_fragment:f7,envmap_pars_vertex:p7,envmap_physical_pars_fragment:C7,envmap_vertex:m7,fog_vertex:g7,fog_pars_vertex:v7,fog_fragment:_7,fog_pars_fragment:y7,gradientmap_pars_fragment:x7,lightmap_pars_fragment:S7,lights_lambert_fragment:b7,lights_lambert_pars_fragment:w7,lights_pars_begin:E7,lights_toon_fragment:T7,lights_toon_pars_fragment:M7,lights_phong_fragment:A7,lights_phong_pars_fragment:k7,lights_physical_fragment:L7,lights_physical_pars_fragment:P7,lights_fragment_begin:D7,lights_fragment_maps:I7,lights_fragment_end:R7,logdepthbuf_fragment:N7,logdepthbuf_pars_fragment:O7,logdepthbuf_pars_vertex:B7,logdepthbuf_vertex:U7,map_fragment:F7,map_pars_fragment:z7,map_particle_fragment:H7,map_particle_pars_fragment:W7,metalnessmap_fragment:V7,metalnessmap_pars_fragment:G7,morphinstance_vertex:j7,morphcolor_vertex:X7,morphnormal_vertex:q7,morphtarget_pars_vertex:Y7,morphtarget_vertex:K7,normal_fragment_begin:$7,normal_fragment_maps:J7,normal_pars_fragment:Z7,normal_pars_vertex:Q7,normal_vertex:ej,normalmap_pars_fragment:tj,clearcoat_normal_fragment_begin:nj,clearcoat_normal_fragment_maps:ij,clearcoat_pars_fragment:rj,iridescence_pars_fragment:sj,opaque_fragment:oj,packing:aj,premultiplied_alpha_fragment:lj,project_vertex:cj,dithering_fragment:uj,dithering_pars_fragment:hj,roughnessmap_fragment:dj,roughnessmap_pars_fragment:fj,shadowmap_pars_fragment:pj,shadowmap_pars_vertex:mj,shadowmap_vertex:gj,shadowmask_pars_fragment:vj,skinbase_vertex:_j,skinning_pars_vertex:yj,skinning_vertex:xj,skinnormal_vertex:Sj,specularmap_fragment:bj,specularmap_pars_fragment:wj,tonemapping_fragment:Ej,tonemapping_pars_fragment:Cj,transmission_fragment:Tj,transmission_pars_fragment:Mj,uv_pars_fragment:Aj,uv_pars_vertex:kj,uv_vertex:Lj,worldpos_vertex:Pj,background_vert:Dj,background_frag:Ij,backgroundCube_vert:Rj,backgroundCube_frag:Nj,cube_vert:Oj,cube_frag:Bj,depth_vert:Uj,depth_frag:Fj,distance_vert:zj,distance_frag:Hj,equirect_vert:Wj,equirect_frag:Vj,linedashed_vert:Gj,linedashed_frag:jj,meshbasic_vert:Xj,meshbasic_frag:qj,meshlambert_vert:Yj,meshlambert_frag:Kj,meshmatcap_vert:$j,meshmatcap_frag:Jj,meshnormal_vert:Zj,meshnormal_frag:Qj,meshphong_vert:eX,meshphong_frag:tX,meshphysical_vert:nX,meshphysical_frag:iX,meshtoon_vert:rX,meshtoon_frag:sX,points_vert:oX,points_frag:aX,shadow_vert:lX,shadow_frag:cX,sprite_vert:uX,sprite_frag:hX},pt={common:{diffuse:{value:new dt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Xt},alphaMap:{value:null},alphaMapTransform:{value:new Xt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Xt}},envmap:{envMap:{value:null},envMapRotation:{value:new Xt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Xt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Xt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Xt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Xt},normalScale:{value:new We(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Xt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Xt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Xt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Xt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new dt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new dt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Xt},alphaTest:{value:0},uvTransform:{value:new Xt}},sprite:{diffuse:{value:new dt(16777215)},opacity:{value:1},center:{value:new We(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Xt},alphaMap:{value:null},alphaMapTransform:{value:new Xt},alphaTest:{value:0}}},ea={basic:{uniforms:ns([pt.common,pt.specularmap,pt.envmap,pt.aomap,pt.lightmap,pt.fog]),vertexShader:Jt.meshbasic_vert,fragmentShader:Jt.meshbasic_frag},lambert:{uniforms:ns([pt.common,pt.specularmap,pt.envmap,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.fog,pt.lights,{emissive:{value:new dt(0)}}]),vertexShader:Jt.meshlambert_vert,fragmentShader:Jt.meshlambert_frag},phong:{uniforms:ns([pt.common,pt.specularmap,pt.envmap,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.fog,pt.lights,{emissive:{value:new dt(0)},specular:{value:new dt(1118481)},shininess:{value:30}}]),vertexShader:Jt.meshphong_vert,fragmentShader:Jt.meshphong_frag},standard:{uniforms:ns([pt.common,pt.envmap,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.roughnessmap,pt.metalnessmap,pt.fog,pt.lights,{emissive:{value:new dt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag},toon:{uniforms:ns([pt.common,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.gradientmap,pt.fog,pt.lights,{emissive:{value:new dt(0)}}]),vertexShader:Jt.meshtoon_vert,fragmentShader:Jt.meshtoon_frag},matcap:{uniforms:ns([pt.common,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.fog,{matcap:{value:null}}]),vertexShader:Jt.meshmatcap_vert,fragmentShader:Jt.meshmatcap_frag},points:{uniforms:ns([pt.points,pt.fog]),vertexShader:Jt.points_vert,fragmentShader:Jt.points_frag},dashed:{uniforms:ns([pt.common,pt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Jt.linedashed_vert,fragmentShader:Jt.linedashed_frag},depth:{uniforms:ns([pt.common,pt.displacementmap]),vertexShader:Jt.depth_vert,fragmentShader:Jt.depth_frag},normal:{uniforms:ns([pt.common,pt.bumpmap,pt.normalmap,pt.displacementmap,{opacity:{value:1}}]),vertexShader:Jt.meshnormal_vert,fragmentShader:Jt.meshnormal_frag},sprite:{uniforms:ns([pt.sprite,pt.fog]),vertexShader:Jt.sprite_vert,fragmentShader:Jt.sprite_frag},background:{uniforms:{uvTransform:{value:new Xt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Jt.background_vert,fragmentShader:Jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Xt}},vertexShader:Jt.backgroundCube_vert,fragmentShader:Jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Jt.cube_vert,fragmentShader:Jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Jt.equirect_vert,fragmentShader:Jt.equirect_frag},distance:{uniforms:ns([pt.common,pt.displacementmap,{referencePosition:{value:new Y},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Jt.distance_vert,fragmentShader:Jt.distance_frag},shadow:{uniforms:ns([pt.lights,pt.fog,{color:{value:new dt(0)},opacity:{value:1}}]),vertexShader:Jt.shadow_vert,fragmentShader:Jt.shadow_frag}};ea.physical={uniforms:ns([ea.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Xt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Xt},clearcoatNormalScale:{value:new We(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Xt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Xt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Xt},sheen:{value:0},sheenColor:{value:new dt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Xt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Xt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Xt},transmissionSamplerSize:{value:new We},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Xt},attenuationDistance:{value:0},attenuationColor:{value:new dt(0)},specularColor:{value:new dt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Xt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Xt},anisotropyVector:{value:new We},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Xt}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag};Cb={r:0,b:0,g:0},hd=new Vs,dX=new Ft;Nu=4,N4=[.125,.215,.35,.446,.526,.582],fd=20,yX=256,$0=new js,O4=new dt,sA=null,oA=0,aA=0,lA=!1,xX=new Y,Q0=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,n=0,i=.1,r=100,s={}){let{size:o=256,position:a=xX}=s;sA=this._renderer.getRenderTarget(),oA=this._renderer.getActiveCubeFace(),aA=this._renderer.getActiveMipmapLevel(),lA=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);let l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,r,l,a),n>0&&this._blur(l,0,0,n),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=F4(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=U4(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(sA,oA,aA),this._renderer.xr.enabled=lA,e.scissorTest=!1,Op(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Ua||e.mapping===mc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),sA=this._renderer.getRenderTarget(),oA=this._renderer.getActiveCubeFace(),aA=this._renderer.getActiveMipmapLevel(),lA=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:Un,minFilter:Un,generateMipmaps:!1,type:za,format:rr,colorSpace:yu,depthBuffer:!1},r=B4(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=B4(e,n,i);let{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=SX(s)),this._blurMaterial=wX(s,e,n),this._ggxMaterial=bX(s,e,n)}return r}_compileMaterial(e){let n=new zn(new Wt,e);this._renderer.compile(n,$0)}_sceneToCubeUV(e,n,i,r,s){let l=new Zn(90,1,n,i),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,p=d.autoClear,m=d.toneMapping;d.getClearColor(O4),d.toneMapping=Xs,d.autoClear=!1,d.state.buffers.depth.getReversed()&&(d.setRenderTarget(r),d.clearDepth(),d.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new zn(new Su,new So({name:"PMREM.Background",side:es,depthWrite:!1,depthTest:!1})));let _=this._backgroundBox,y=_.material,v=!1,S=e.background;S?S.isColor&&(y.color.copy(S),e.background=null,v=!0):(y.color.copy(O4),v=!0);for(let b=0;b<6;b++){let w=b%3;w===0?(l.up.set(0,c[b],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+u[b],s.y,s.z)):w===1?(l.up.set(0,0,c[b]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+u[b],s.z)):(l.up.set(0,c[b],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+u[b]));let C=this._cubeSize;Op(r,w*C,b>2?C:0,C,C),d.setRenderTarget(r),v&&d.render(_,l),d.render(e,l)}d.toneMapping=m,d.autoClear=p,e.background=S}_textureToCubeUV(e,n){let i=this._renderer,r=e.mapping===Ua||e.mapping===mc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=F4()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=U4());let s=r?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=s;let a=s.uniforms;a.envMap.value=e;let l=this._cubeSize;Op(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(o,$0)}_applyPMREM(e){let n=this._renderer,i=n.autoClear;n.autoClear=!1;let r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);n.autoClear=i}_applyGGXFilter(e,n,i){let r=this._renderer,s=this._pingPongRenderTarget,o=this._ggxMaterial,a=this._lodMeshes[i];a.material=o;let l=o.uniforms,c=i/(this._lodMeshes.length-1),u=n/(this._lodMeshes.length-1),d=Math.sqrt(c*c-u*u),p=0+c*1.25,m=d*p,{_lodMax:g}=this,_=this._sizeLods[i],y=3*_*(i>g-Nu?i-g+Nu:0),v=4*(this._cubeSize-_);l.envMap.value=e.texture,l.roughness.value=m,l.mipInt.value=g-n,Op(s,y,v,3*_,2*_),r.setRenderTarget(s),r.render(a,$0),l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=g-i,Op(e,y,v,3*_,2*_),r.setRenderTarget(e),r.render(a,$0)}_blur(e,n,i,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,o,a){let l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&It("blur direction must be either latitudinal or longitudinal!");let u=3,d=this._lodMeshes[r];d.material=c;let p=c.uniforms,m=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*fd-1),_=s/g,y=isFinite(s)?1+Math.floor(u*_):fd;y>fd&&ut(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${fd}`);let v=[],S=0;for(let L=0;L<fd;++L){let P=L/_,T=Math.exp(-P*P/2);v.push(T),L===0?S+=T:L<y&&(S+=2*T)}for(let L=0;L<v.length;L++)v[L]=v[L]/S;p.envMap.value=e.texture,p.samples.value=y,p.weights.value=v,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);let{_lodMax:b}=this;p.dTheta.value=g,p.mipInt.value=b-i;let w=this._sizeLods[r],C=3*w*(r>b-Nu?r-b+Nu:0),M=4*(this._cubeSize-w);Op(n,C,M,3*w,2*w),l.setRenderTarget(n),l.render(d,$0)}};PX={[lb]:"LINEAR_TONE_MAPPING",[cb]:"REINHARD_TONE_MAPPING",[ub]:"CINEON_TONE_MAPPING",[Mp]:"ACES_FILMIC_TONE_MAPPING",[db]:"AGX_TONE_MAPPING",[fb]:"NEUTRAL_TONE_MAPPING",[hb]:"CUSTOM_TONE_MAPPING"};rB=new bi,hA=new uc(1,1),sB=new jh,oB=new Xh,aB=new bu,z4=[],H4=[],W4=new Float32Array(16),V4=new Float32Array(9),G4=new Float32Array(4);dA=class{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=ZX(n.type)}},fA=class{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=_q(n.type)}},pA=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,n[a.id],i)}}},cA=/(\w+)(\])?(\[|\.)?/g;Bp=class{constructor(e,n){this.seq=[],this.map={};let i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let o=0;o<i;++o){let a=e.getActiveUniform(n,o),l=e.getUniformLocation(n,a.name);yq(a,l,this)}let r=[],s=[];for(let o of this.seq)o.type===e.SAMPLER_2D_SHADOW||o.type===e.SAMPLER_CUBE_SHADOW||o.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(o):s.push(o);r.length>0&&(this.seq=r.concat(s))}setValue(e,n,i,r){let s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){let r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,o=n.length;s!==o;++s){let a=n[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,n){let i=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in n&&i.push(o)}return i}};xq=37297,Sq=0;q4=new Xt;Cq={[lb]:"Linear",[cb]:"Reinhard",[ub]:"Cineon",[Mp]:"ACESFilmic",[db]:"AgX",[fb]:"Neutral",[hb]:"Custom"};Tb=new Y;Pq=/^[ \t]*#include +<([\w\d./]+)>/gm;Dq=new Map;Rq=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;Oq={[Iu]:"SHADOWMAP_TYPE_PCF",[pc]:"SHADOWMAP_TYPE_VSM"};Uq={[Ua]:"ENVMAP_TYPE_CUBE",[mc]:"ENVMAP_TYPE_CUBE",[od]:"ENVMAP_TYPE_CUBE_UV"};zq={[mc]:"ENVMAP_MODE_REFRACTION"};Wq={[Tp]:"ENVMAP_BLENDING_MULTIPLY",[R2]:"ENVMAP_BLENDING_MIX",[N2]:"ENVMAP_BLENDING_ADD"};Xq=0,gA=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let n=this.materialCache.get(e);for(let i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let n=this.materialCache,i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){let n=this.shaderCache,i=n.get(e);return i===void 0&&(i=new vA(e),n.set(e,i)),i}},vA=class{constructor(e){this.id=Xq++,this.code=e,this.usedTimes=0}};Qq=0;iY=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,rY=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,sY=[new Y(1,0,0),new Y(-1,0,0),new Y(0,1,0),new Y(0,-1,0),new Y(0,0,1),new Y(0,0,-1)],oY=[new Y(0,-1,0),new Y(0,-1,0),new Y(0,0,1),new Y(0,0,-1),new Y(0,-1,0),new Y(0,-1,0)],nB=new Ft,J0=new Y,uA=new Y;lY={[e0]:t0,[n0]:s0,[i0]:o0,[_u]:r0,[t0]:e0,[s0]:n0,[o0]:i0,[r0]:_u};hY=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,dY=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,_A=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n){if(this.texture===null){let i=new cp(e.texture);(e.depthNear!==n.depthNear||e.depthFar!==n.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){let n=e.cameras[0].viewport,i=new bs({vertexShader:hY,fragmentShader:dY,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new zn(new Na(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},yA=class extends xo{constructor(e,n){super();let i=this,r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,p=null,m=null,g=null,_=typeof XRWebGLBinding<"u",y=new _A,v={},S=n.getContextAttributes(),b=null,w=null,C=[],M=[],L=new We,P=null,T=new Zn;T.viewport=new Rn;let A=new Zn;A.viewport=new Rn;let I=[T,A],F=new $v,B=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($){let ie=C[$];return ie===void 0&&(ie=new qh,C[$]=ie),ie.getTargetRaySpace()},this.getControllerGrip=function($){let ie=C[$];return ie===void 0&&(ie=new qh,C[$]=ie),ie.getGripSpace()},this.getHand=function($){let ie=C[$];return ie===void 0&&(ie=new qh,C[$]=ie),ie.getHandSpace()};function z($){let ie=M.indexOf($.inputSource);if(ie===-1)return;let le=C[ie];le!==void 0&&(le.update($.inputSource,$.frame,c||o),le.dispatchEvent({type:$.type,data:$.inputSource}))}function U(){r.removeEventListener("select",z),r.removeEventListener("selectstart",z),r.removeEventListener("selectend",z),r.removeEventListener("squeeze",z),r.removeEventListener("squeezestart",z),r.removeEventListener("squeezeend",z),r.removeEventListener("end",U),r.removeEventListener("inputsourceschange",G);for(let $=0;$<C.length;$++){let ie=M[$];ie!==null&&(M[$]=null,C[$].disconnect(ie))}B=null,O=null,y.reset();for(let $ in v)delete v[$];e.setRenderTarget(b),m=null,p=null,d=null,r=null,w=null,re.stop(),i.isPresenting=!1,e.setPixelRatio(P),e.setSize(L.width,L.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function($){s=$,i.isPresenting===!0&&ut("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($){a=$,i.isPresenting===!0&&ut("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function($){c=$},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return d===null&&_&&(d=new XRWebGLBinding(r,n)),d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=async function($){if(r=$,r!==null){if(b=e.getRenderTarget(),r.addEventListener("select",z),r.addEventListener("selectstart",z),r.addEventListener("selectend",z),r.addEventListener("squeeze",z),r.addEventListener("squeezestart",z),r.addEventListener("squeezeend",z),r.addEventListener("end",U),r.addEventListener("inputsourceschange",G),S.xrCompatible!==!0&&await n.makeXRCompatible(),P=e.getPixelRatio(),e.getSize(L),_&&"createProjectionLayer"in XRWebGLBinding.prototype){let le=null,Ee=null,ke=null;S.depth&&(ke=S.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,le=S.stencil?gc:La,Ee=S.stencil?cd:wo);let Pe={colorFormat:n.RGBA8,depthFormat:ke,scaleFactor:s};d=this.getBinding(),p=d.createProjectionLayer(Pe),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),w=new Qr(p.textureWidth,p.textureHeight,{format:rr,type:Or,depthTexture:new uc(p.textureWidth,p.textureHeight,Ee,void 0,void 0,void 0,void 0,void 0,void 0,le),stencilBuffer:S.stencil,colorSpace:e.outputColorSpace,samples:S.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1})}else{let le={antialias:S.antialias,alpha:!0,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,n,le),r.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),w=new Qr(m.framebufferWidth,m.framebufferHeight,{format:rr,type:Or,colorSpace:e.outputColorSpace,stencilBuffer:S.stencil,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}w.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),re.setContext(r),re.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return y.getDepthTexture()};function G($){for(let ie=0;ie<$.removed.length;ie++){let le=$.removed[ie],Ee=M.indexOf(le);Ee>=0&&(M[Ee]=null,C[Ee].disconnect(le))}for(let ie=0;ie<$.added.length;ie++){let le=$.added[ie],Ee=M.indexOf(le);if(Ee===-1){for(let Pe=0;Pe<C.length;Pe++)if(Pe>=M.length){M.push(le),Ee=Pe;break}else if(M[Pe]===null){M[Pe]=le,Ee=Pe;break}if(Ee===-1)break}let ke=C[Ee];ke&&ke.connect(le)}}let j=new Y,J=new Y;function K($,ie,le){j.setFromMatrixPosition(ie.matrixWorld),J.setFromMatrixPosition(le.matrixWorld);let Ee=j.distanceTo(J),ke=ie.projectionMatrix.elements,Pe=le.projectionMatrix.elements,Te=ke[14]/(ke[10]-1),De=ke[14]/(ke[10]+1),me=(ke[9]+1)/ke[5],ve=(ke[9]-1)/ke[5],ge=(ke[8]-1)/ke[0],Ie=(Pe[8]+1)/Pe[0],V=Te*ge,Ge=Te*Ie,Me=Ee/(-ge+Ie),_e=Me*-ge;if(ie.matrixWorld.decompose($.position,$.quaternion,$.scale),$.translateX(_e),$.translateZ(Me),$.matrixWorld.compose($.position,$.quaternion,$.scale),$.matrixWorldInverse.copy($.matrixWorld).invert(),ke[10]===-1)$.projectionMatrix.copy(ie.projectionMatrix),$.projectionMatrixInverse.copy(ie.projectionMatrixInverse);else{let Ne=Te+Me,W=De+Me,R=V-_e,Z=Ge+(Ee-_e),fe=me*De/W*Ne,he=ve*De/W*Ne;$.projectionMatrix.makePerspective(R,Z,fe,he,Ne,W),$.projectionMatrixInverse.copy($.projectionMatrix).invert()}}function D($,ie){ie===null?$.matrixWorld.copy($.matrix):$.matrixWorld.multiplyMatrices(ie.matrixWorld,$.matrix),$.matrixWorldInverse.copy($.matrixWorld).invert()}this.updateCamera=function($){if(r===null)return;let ie=$.near,le=$.far;y.texture!==null&&(y.depthNear>0&&(ie=y.depthNear),y.depthFar>0&&(le=y.depthFar)),F.near=A.near=T.near=ie,F.far=A.far=T.far=le,(B!==F.near||O!==F.far)&&(r.updateRenderState({depthNear:F.near,depthFar:F.far}),B=F.near,O=F.far),F.layers.mask=$.layers.mask|6,T.layers.mask=F.layers.mask&3,A.layers.mask=F.layers.mask&5;let Ee=$.parent,ke=F.cameras;D(F,Ee);for(let Pe=0;Pe<ke.length;Pe++)D(ke[Pe],Ee);ke.length===2?K(F,T,A):F.projectionMatrix.copy(T.projectionMatrix),X($,F,Ee)};function X($,ie,le){le===null?$.matrix.copy(ie.matrixWorld):($.matrix.copy(le.matrixWorld),$.matrix.invert(),$.matrix.multiply(ie.matrixWorld)),$.matrix.decompose($.position,$.quaternion,$.scale),$.updateMatrixWorld(!0),$.projectionMatrix.copy(ie.projectionMatrix),$.projectionMatrixInverse.copy(ie.projectionMatrixInverse),$.isPerspectiveCamera&&($.fov=Gh*2*Math.atan(1/$.projectionMatrix.elements[5]),$.zoom=1)}this.getCamera=function(){return F},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function($){l=$,p!==null&&(p.fixedFoveation=$),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=$)},this.hasDepthSensing=function(){return y.texture!==null},this.getDepthSensingMesh=function(){return y.getMesh(F)},this.getCameraTexture=function($){return v[$]};let q=null;function ne($,ie){if(u=ie.getViewerPose(c||o),g=ie,u!==null){let le=u.views;m!==null&&(e.setRenderTargetFramebuffer(w,m.framebuffer),e.setRenderTarget(w));let Ee=!1;le.length!==F.cameras.length&&(F.cameras.length=0,Ee=!0);for(let De=0;De<le.length;De++){let me=le[De],ve=null;if(m!==null)ve=m.getViewport(me);else{let Ie=d.getViewSubImage(p,me);ve=Ie.viewport,De===0&&(e.setRenderTargetTextures(w,Ie.colorTexture,Ie.depthStencilTexture),e.setRenderTarget(w))}let ge=I[De];ge===void 0&&(ge=new Zn,ge.layers.enable(De),ge.viewport=new Rn,I[De]=ge),ge.matrix.fromArray(me.transform.matrix),ge.matrix.decompose(ge.position,ge.quaternion,ge.scale),ge.projectionMatrix.fromArray(me.projectionMatrix),ge.projectionMatrixInverse.copy(ge.projectionMatrix).invert(),ge.viewport.set(ve.x,ve.y,ve.width,ve.height),De===0&&(F.matrix.copy(ge.matrix),F.matrix.decompose(F.position,F.quaternion,F.scale)),Ee===!0&&F.cameras.push(ge)}let ke=r.enabledFeatures;if(ke&&ke.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&_){d=i.getBinding();let De=d.getDepthInformation(le[0]);De&&De.isValid&&De.texture&&y.init(De,r.renderState)}if(ke&&ke.includes("camera-access")&&_){e.state.unbindTexture(),d=i.getBinding();for(let De=0;De<le.length;De++){let me=le[De].camera;if(me){let ve=v[me];ve||(ve=new cp,v[me]=ve);let ge=d.getCameraImage(me);ve.sourceTexture=ge}}}}for(let le=0;le<C.length;le++){let Ee=M[le],ke=C[le];Ee!==null&&ke!==void 0&&ke.update(Ee,ie,c||o)}q&&q($,ie),ie.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ie}),g=null}let re=new iB;re.setAnimationLoop(ne),this.setAnimationLoop=function($){q=$},this.dispose=function(){}}},dd=new Vs,fY=new Ft;gY=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]),ml=null;e_=class{constructor(e={}){let{canvas:n=$2(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:p=!1,outputBufferType:m=Or}=e;this.isWebGLRenderer=!0;let g;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=i.getContextAttributes().alpha}else g=o;let _=m,y=new Set([f0,d0,Pp]),v=new Set([Or,wo,ld,cd,c0,u0]),S=new Uint32Array(4),b=new Int32Array(4),w=null,C=null,M=[],L=[],P=null;this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Xs,this.toneMappingExposure=1,this.transmissionResolutionScale=1;let T=this,A=!1;this._outputColorSpace=_s;let I=0,F=0,B=null,O=-1,z=null,U=new Rn,G=new Rn,j=null,J=new dt(0),K=0,D=n.width,X=n.height,q=1,ne=null,re=null,$=new Rn(0,0,D,X),ie=new Rn(0,0,D,X),le=!1,Ee=new cc,ke=!1,Pe=!1,Te=new Ft,De=new Y,me=new Rn,ve={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},ge=!1;function Ie(){return B===null?q:1}let V=i;function Ge(H,oe){return n.getContext(H,oe)}try{let H={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${"182"}`),n.addEventListener("webglcontextlost",Je,!1),n.addEventListener("webglcontextrestored",ot,!1),n.addEventListener("webglcontextcreationerror",kt,!1),V===null){let oe="webgl2";if(V=Ge(oe,H),V===null)throw Ge(oe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(H){throw It("WebGLRenderer: "+H.message),H}let Me,_e,Ne,W,R,Z,fe,he,ae,je,ze,Qe,ct,Ae,Ve,Ue,Q,ce,Ye,te,we,Be,it,Fe;function Se(){Me=new CX(V),Me.init(),Be=new lB(V,Me),_e=new gX(V,Me,e,Be),Ne=new cY(V,Me),_e.reversedDepthBuffer&&p&&Ne.buffers.depth.setReversed(!0),W=new AX(V),R=new Yq,Z=new uY(V,Me,Ne,R,_e,Be,W),fe=new _X(T),he=new EX(T),ae=new D9(V),it=new pX(V,ae),je=new TX(V,ae,W,it),ze=new LX(V,je,ae,W),Ye=new kX(V,_e,Z),Ue=new vX(R),Qe=new qq(T,fe,he,Me,_e,it,Ue),ct=new pY(T,R),Ae=new $q,Ve=new nY(Me),ce=new fX(T,fe,he,Ne,ze,g,l),Q=new aY(T,ze,_e),Fe=new mY(V,W,_e,Ne),te=new mX(V,Me,W),we=new MX(V,Me,W),W.programs=Qe.programs,T.capabilities=_e,T.extensions=Me,T.properties=R,T.renderLists=Ae,T.shadowMap=Q,T.state=Ne,T.info=W}Se(),_!==Or&&(P=new DX(_,n.width,n.height,r,s));let Xe=new yA(T,V);this.xr=Xe,this.getContext=function(){return V},this.getContextAttributes=function(){return V.getContextAttributes()},this.forceContextLoss=function(){let H=Me.get("WEBGL_lose_context");H&&H.loseContext()},this.forceContextRestore=function(){let H=Me.get("WEBGL_lose_context");H&&H.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(H){H!==void 0&&(q=H,this.setSize(D,X,!1))},this.getSize=function(H){return H.set(D,X)},this.setSize=function(H,oe,ye=!0){if(Xe.isPresenting){ut("WebGLRenderer: Can't change size while VR device is presenting.");return}D=H,X=oe,n.width=Math.floor(H*q),n.height=Math.floor(oe*q),ye===!0&&(n.style.width=H+"px",n.style.height=oe+"px"),P!==null&&P.setSize(n.width,n.height),this.setViewport(0,0,H,oe)},this.getDrawingBufferSize=function(H){return H.set(D*q,X*q).floor()},this.setDrawingBufferSize=function(H,oe,ye){D=H,X=oe,q=ye,n.width=Math.floor(H*ye),n.height=Math.floor(oe*ye),this.setViewport(0,0,H,oe)},this.setEffects=function(H){if(_===Or){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(H){for(let oe=0;oe<H.length;oe++)if(H[oe].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}P.setEffects(H||[])},this.getCurrentViewport=function(H){return H.copy(U)},this.getViewport=function(H){return H.copy($)},this.setViewport=function(H,oe,ye,xe){H.isVector4?$.set(H.x,H.y,H.z,H.w):$.set(H,oe,ye,xe),Ne.viewport(U.copy($).multiplyScalar(q).round())},this.getScissor=function(H){return H.copy(ie)},this.setScissor=function(H,oe,ye,xe){H.isVector4?ie.set(H.x,H.y,H.z,H.w):ie.set(H,oe,ye,xe),Ne.scissor(G.copy(ie).multiplyScalar(q).round())},this.getScissorTest=function(){return le},this.setScissorTest=function(H){Ne.setScissorTest(le=H)},this.setOpaqueSort=function(H){ne=H},this.setTransparentSort=function(H){re=H},this.getClearColor=function(H){return H.copy(ce.getClearColor())},this.setClearColor=function(){ce.setClearColor(...arguments)},this.getClearAlpha=function(){return ce.getClearAlpha()},this.setClearAlpha=function(){ce.setClearAlpha(...arguments)},this.clear=function(H=!0,oe=!0,ye=!0){let xe=0;if(H){let pe=!1;if(B!==null){let $e=B.texture.format;pe=y.has($e)}if(pe){let $e=B.texture.type,at=v.has($e),Ke=ce.getClearColor(),tt=ce.getClearAlpha(),xt=Ke.r,Tt=Ke.g,St=Ke.b;at?(S[0]=xt,S[1]=Tt,S[2]=St,S[3]=tt,V.clearBufferuiv(V.COLOR,0,S)):(b[0]=xt,b[1]=Tt,b[2]=St,b[3]=tt,V.clearBufferiv(V.COLOR,0,b))}else xe|=V.COLOR_BUFFER_BIT}oe&&(xe|=V.DEPTH_BUFFER_BIT),ye&&(xe|=V.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),V.clear(xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Je,!1),n.removeEventListener("webglcontextrestored",ot,!1),n.removeEventListener("webglcontextcreationerror",kt,!1),ce.dispose(),Ae.dispose(),Ve.dispose(),R.dispose(),fe.dispose(),he.dispose(),ze.dispose(),it.dispose(),Fe.dispose(),Qe.dispose(),Xe.dispose(),Xe.removeEventListener("sessionstart",Oi),Xe.removeEventListener("sessionend",Qi),Ti.stop()};function Je(H){H.preventDefault(),tp("WebGLRenderer: Context Lost."),A=!0}function ot(){tp("WebGLRenderer: Context Restored."),A=!1;let H=W.autoReset,oe=Q.enabled,ye=Q.autoUpdate,xe=Q.needsUpdate,pe=Q.type;Se(),W.autoReset=H,Q.enabled=oe,Q.autoUpdate=ye,Q.needsUpdate=xe,Q.type=pe}function kt(H){It("WebGLRenderer: A WebGL context could not be created. Reason: ",H.statusMessage)}function un(H){let oe=H.target;oe.removeEventListener("dispose",un),mn(oe)}function mn(H){qn(H),R.remove(H)}function qn(H){let oe=R.get(H).programs;oe!==void 0&&(oe.forEach(function(ye){Qe.releaseProgram(ye)}),H.isShaderMaterial&&Qe.releaseShaderCache(H))}this.renderBufferDirect=function(H,oe,ye,xe,pe,$e){oe===null&&(oe=ve);let at=pe.isMesh&&pe.matrixWorld.determinant()<0,Ke=Pt(H,oe,ye,xe,pe);Ne.setMaterial(xe,at);let tt=ye.index,xt=1;if(xe.wireframe===!0){if(tt=je.getWireframeAttribute(ye),tt===void 0)return;xt=2}let Tt=ye.drawRange,St=ye.attributes.position,zt=Tt.start*xt,tn=(Tt.start+Tt.count)*xt;$e!==null&&(zt=Math.max(zt,$e.start*xt),tn=Math.min(tn,($e.start+$e.count)*xt)),tt!==null?(zt=Math.max(zt,0),tn=Math.min(tn,tt.count)):St!=null&&(zt=Math.max(zt,0),tn=Math.min(tn,St.count));let nn=tn-zt;if(nn<0||nn===1/0)return;it.setup(pe,xe,Ke,ye,tt);let wn,En=te;if(tt!==null&&(wn=ae.get(tt),En=we,En.setIndex(wn)),pe.isMesh)xe.wireframe===!0?(Ne.setLineWidth(xe.wireframeLinewidth*Ie()),En.setMode(V.LINES)):En.setMode(V.TRIANGLES);else if(pe.isLine){let Dt=xe.linewidth;Dt===void 0&&(Dt=1),Ne.setLineWidth(Dt*Ie()),pe.isLineSegments?En.setMode(V.LINES):pe.isLineLoop?En.setMode(V.LINE_LOOP):En.setMode(V.LINE_STRIP)}else pe.isPoints?En.setMode(V.POINTS):pe.isSprite&&En.setMode(V.TRIANGLES);if(pe.isBatchedMesh)if(pe._multiDrawInstances!==null)Vh("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),En.renderMultiDrawInstances(pe._multiDrawStarts,pe._multiDrawCounts,pe._multiDrawCount,pe._multiDrawInstances);else if(Me.get("WEBGL_multi_draw"))En.renderMultiDraw(pe._multiDrawStarts,pe._multiDrawCounts,pe._multiDrawCount);else{let Dt=pe._multiDrawStarts,hn=pe._multiDrawCounts,jt=pe._multiDrawCount,Vn=tt?ae.get(tt).bytesPerElement:1,to=R.get(xe).currentProgram.getUniforms();for(let Bi=0;Bi<jt;Bi++)to.setValue(V,"_gl_DrawID",Bi),En.render(Dt[Bi]/Vn,hn[Bi])}else if(pe.isInstancedMesh)En.renderInstances(zt,nn,pe.count);else if(ye.isInstancedBufferGeometry){let Dt=ye._maxInstanceCount!==void 0?ye._maxInstanceCount:1/0,hn=Math.min(ye.instanceCount,Dt);En.renderInstances(zt,nn,hn)}else En.render(zt,nn)};function Zi(H,oe,ye){H.transparent===!0&&H.side===ts&&H.forceSinglePass===!1?(H.side=es,H.needsUpdate=!0,No(H,oe,ye),H.side=hl,H.needsUpdate=!0,No(H,oe,ye),H.side=ts):No(H,oe,ye)}this.compile=function(H,oe,ye=null){ye===null&&(ye=H),C=Ve.get(ye),C.init(oe),L.push(C),ye.traverseVisible(function(pe){pe.isLight&&pe.layers.test(oe.layers)&&(C.pushLight(pe),pe.castShadow&&C.pushShadow(pe))}),H!==ye&&H.traverseVisible(function(pe){pe.isLight&&pe.layers.test(oe.layers)&&(C.pushLight(pe),pe.castShadow&&C.pushShadow(pe))}),C.setupLights();let xe=new Set;return H.traverse(function(pe){if(!(pe.isMesh||pe.isPoints||pe.isLine||pe.isSprite))return;let $e=pe.material;if($e)if(Array.isArray($e))for(let at=0;at<$e.length;at++){let Ke=$e[at];Zi(Ke,ye,pe),xe.add(Ke)}else Zi($e,ye,pe),xe.add($e)}),C=L.pop(),xe},this.compileAsync=function(H,oe,ye=null){let xe=this.compile(H,oe,ye);return new Promise(pe=>{function $e(){if(xe.forEach(function(at){R.get(at).currentProgram.isReady()&&xe.delete(at)}),xe.size===0){pe(H);return}setTimeout($e,10)}Me.get("KHR_parallel_shader_compile")!==null?$e():setTimeout($e,10)})};let Mr=null;function Yn(H){Mr&&Mr(H)}function Oi(){Ti.stop()}function Qi(){Ti.start()}let Ti=new iB;Ti.setAnimationLoop(Yn),typeof self<"u"&&Ti.setContext(self),this.setAnimationLoop=function(H){Mr=H,Xe.setAnimationLoop(H),H===null?Ti.stop():Ti.start()},Xe.addEventListener("sessionstart",Oi),Xe.addEventListener("sessionend",Qi),this.render=function(H,oe){if(oe!==void 0&&oe.isCamera!==!0){It("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(A===!0)return;let ye=Xe.enabled===!0&&Xe.isPresenting===!0,xe=P!==null&&(B===null||ye)&&P.begin(T,B);if(H.matrixWorldAutoUpdate===!0&&H.updateMatrixWorld(),oe.parent===null&&oe.matrixWorldAutoUpdate===!0&&oe.updateMatrixWorld(),Xe.enabled===!0&&Xe.isPresenting===!0&&(P===null||P.isCompositing()===!1)&&(Xe.cameraAutoUpdate===!0&&Xe.updateCamera(oe),oe=Xe.getCamera()),H.isScene===!0&&H.onBeforeRender(T,H,oe,B),C=Ve.get(H,L.length),C.init(oe),L.push(C),Te.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),Ee.setFromProjectionMatrix(Te,Ws,oe.reversedDepth),Pe=this.localClippingEnabled,ke=Ue.init(this.clippingPlanes,Pe),w=Ae.get(H,M.length),w.init(),M.push(w),Xe.enabled===!0&&Xe.isPresenting===!0){let at=T.xr.getDepthSensingMesh();at!==null&&ni(at,oe,-1/0,T.sortObjects)}ni(H,oe,0,T.sortObjects),w.finish(),T.sortObjects===!0&&w.sort(ne,re),ge=Xe.enabled===!1||Xe.isPresenting===!1||Xe.hasDepthSensing()===!1,ge&&ce.addToRenderList(w,H),this.info.render.frame++,ke===!0&&Ue.beginShadows();let pe=C.state.shadowsArray;if(Q.render(pe,H,oe),ke===!0&&Ue.endShadows(),this.info.autoReset===!0&&this.info.reset(),(xe&&P.hasRenderPass())===!1){let at=w.opaque,Ke=w.transmissive;if(C.setupLights(),oe.isArrayCamera){let tt=oe.cameras;if(Ke.length>0)for(let xt=0,Tt=tt.length;xt<Tt;xt++){let St=tt[xt];Ar(at,Ke,H,St)}ge&&ce.render(H);for(let xt=0,Tt=tt.length;xt<Tt;xt++){let St=tt[xt];os(w,H,St,St.viewport)}}else Ke.length>0&&Ar(at,Ke,H,oe),ge&&ce.render(H),os(w,H,oe)}B!==null&&F===0&&(Z.updateMultisampleRenderTarget(B),Z.updateRenderTargetMipmap(B)),xe&&P.end(T),H.isScene===!0&&H.onAfterRender(T,H,oe),it.resetDefaultState(),O=-1,z=null,L.pop(),L.length>0?(C=L[L.length-1],ke===!0&&Ue.setGlobalState(T.clippingPlanes,C.state.camera)):C=null,M.pop(),M.length>0?w=M[M.length-1]:w=null};function ni(H,oe,ye,xe){if(H.visible===!1)return;if(H.layers.test(oe.layers)){if(H.isGroup)ye=H.renderOrder;else if(H.isLOD)H.autoUpdate===!0&&H.update(oe);else if(H.isLight)C.pushLight(H),H.castShadow&&C.pushShadow(H);else if(H.isSprite){if(!H.frustumCulled||Ee.intersectsSprite(H)){xe&&me.setFromMatrixPosition(H.matrixWorld).applyMatrix4(Te);let at=ze.update(H),Ke=H.material;Ke.visible&&w.push(H,at,Ke,ye,me.z,null)}}else if((H.isMesh||H.isLine||H.isPoints)&&(!H.frustumCulled||Ee.intersectsObject(H))){let at=ze.update(H),Ke=H.material;if(xe&&(H.boundingSphere!==void 0?(H.boundingSphere===null&&H.computeBoundingSphere(),me.copy(H.boundingSphere.center)):(at.boundingSphere===null&&at.computeBoundingSphere(),me.copy(at.boundingSphere.center)),me.applyMatrix4(H.matrixWorld).applyMatrix4(Te)),Array.isArray(Ke)){let tt=at.groups;for(let xt=0,Tt=tt.length;xt<Tt;xt++){let St=tt[xt],zt=Ke[St.materialIndex];zt&&zt.visible&&w.push(H,at,zt,ye,me.z,St)}}else Ke.visible&&w.push(H,at,Ke,ye,me.z,null)}}let $e=H.children;for(let at=0,Ke=$e.length;at<Ke;at++)ni($e[at],oe,ye,xe)}function os(H,oe,ye,xe){let{opaque:pe,transmissive:$e,transparent:at}=H;C.setupLightsView(ye),ke===!0&&Ue.setGlobalState(T.clippingPlanes,ye),xe&&Ne.viewport(U.copy(xe)),pe.length>0&&Qs(pe,oe,ye),$e.length>0&&Qs($e,oe,ye),at.length>0&&Qs(at,oe,ye),Ne.buffers.depth.setTest(!0),Ne.buffers.depth.setMask(!0),Ne.buffers.color.setMask(!0),Ne.setPolygonOffset(!1)}function Ar(H,oe,ye,xe){if((ye.isScene===!0?ye.overrideMaterial:null)!==null)return;if(C.state.transmissionRenderTarget[xe.id]===void 0){let zt=Me.has("EXT_color_buffer_half_float")||Me.has("EXT_color_buffer_float");C.state.transmissionRenderTarget[xe.id]=new Qr(1,1,{generateMipmaps:!0,type:zt?za:Or,minFilter:Fa,samples:_e.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:yn.workingColorSpace})}let $e=C.state.transmissionRenderTarget[xe.id],at=xe.viewport||U;$e.setSize(at.z*T.transmissionResolutionScale,at.w*T.transmissionResolutionScale);let Ke=T.getRenderTarget(),tt=T.getActiveCubeFace(),xt=T.getActiveMipmapLevel();T.setRenderTarget($e),T.getClearColor(J),K=T.getClearAlpha(),K<1&&T.setClearColor(16777215,.5),T.clear(),ge&&ce.render(ye);let Tt=T.toneMapping;T.toneMapping=Xs;let St=xe.viewport;if(xe.viewport!==void 0&&(xe.viewport=void 0),C.setupLightsView(xe),ke===!0&&Ue.setGlobalState(T.clippingPlanes,xe),Qs(H,ye,xe),Z.updateMultisampleRenderTarget($e),Z.updateRenderTargetMipmap($e),Me.has("WEBGL_multisampled_render_to_texture")===!1){let zt=!1;for(let tn=0,nn=oe.length;tn<nn;tn++){let wn=oe[tn],{object:En,geometry:Dt,material:hn,group:jt}=wn;if(hn.side===ts&&En.layers.test(xe.layers)){let Vn=hn.side;hn.side=es,hn.needsUpdate=!0,Il(En,ye,xe,Dt,hn,jt),hn.side=Vn,hn.needsUpdate=!0,zt=!0}}zt===!0&&(Z.updateMultisampleRenderTarget($e),Z.updateRenderTargetMipmap($e))}T.setRenderTarget(Ke,tt,xt),T.setClearColor(J,K),St!==void 0&&(xe.viewport=St),T.toneMapping=Tt}function Qs(H,oe,ye){let xe=oe.isScene===!0?oe.overrideMaterial:null;for(let pe=0,$e=H.length;pe<$e;pe++){let at=H[pe],{object:Ke,geometry:tt,group:xt}=at,Tt=at.material;Tt.allowOverride===!0&&xe!==null&&(Tt=xe),Ke.layers.test(ye.layers)&&Il(Ke,oe,ye,tt,Tt,xt)}}function Il(H,oe,ye,xe,pe,$e){H.onBeforeRender(T,oe,ye,xe,pe,$e),H.modelViewMatrix.multiplyMatrices(ye.matrixWorldInverse,H.matrixWorld),H.normalMatrix.getNormalMatrix(H.modelViewMatrix),pe.onBeforeRender(T,oe,ye,xe,H,$e),pe.transparent===!0&&pe.side===ts&&pe.forceSinglePass===!1?(pe.side=es,pe.needsUpdate=!0,T.renderBufferDirect(ye,oe,xe,pe,H,$e),pe.side=hl,pe.needsUpdate=!0,T.renderBufferDirect(ye,oe,xe,pe,H,$e),pe.side=ts):T.renderBufferDirect(ye,oe,xe,pe,H,$e),H.onAfterRender(T,oe,ye,xe,pe,$e)}function No(H,oe,ye){oe.isScene!==!0&&(oe=ve);let xe=R.get(H),pe=C.state.lights,$e=C.state.shadowsArray,at=pe.state.version,Ke=Qe.getParameters(H,pe.state,$e,oe,ye),tt=Qe.getProgramCacheKey(Ke),xt=xe.programs;xe.environment=H.isMeshStandardMaterial?oe.environment:null,xe.fog=oe.fog,xe.envMap=(H.isMeshStandardMaterial?he:fe).get(H.envMap||xe.environment),xe.envMapRotation=xe.environment!==null&&H.envMap===null?oe.environmentRotation:H.envMapRotation,xt===void 0&&(H.addEventListener("dispose",un),xt=new Map,xe.programs=xt);let Tt=xt.get(tt);if(Tt!==void 0){if(xe.currentProgram===Tt&&xe.lightsStateVersion===at)return Ya(H,Ke),Tt}else Ke.uniforms=Qe.getUniforms(H),H.onBeforeCompile(Ke,T),Tt=Qe.acquireProgram(Ke,tt),xt.set(tt,Tt),xe.uniforms=Ke.uniforms;let St=xe.uniforms;return(!H.isShaderMaterial&&!H.isRawShaderMaterial||H.clipping===!0)&&(St.clippingPlanes=Ue.uniform),Ya(H,Ke),xe.needsLights=Ze(H),xe.lightsStateVersion=at,xe.needsLights&&(St.ambientLightColor.value=pe.state.ambient,St.lightProbe.value=pe.state.probe,St.directionalLights.value=pe.state.directional,St.directionalLightShadows.value=pe.state.directionalShadow,St.spotLights.value=pe.state.spot,St.spotLightShadows.value=pe.state.spotShadow,St.rectAreaLights.value=pe.state.rectArea,St.ltc_1.value=pe.state.rectAreaLTC1,St.ltc_2.value=pe.state.rectAreaLTC2,St.pointLights.value=pe.state.point,St.pointLightShadows.value=pe.state.pointShadow,St.hemisphereLights.value=pe.state.hemi,St.directionalShadowMap.value=pe.state.directionalShadowMap,St.directionalShadowMatrix.value=pe.state.directionalShadowMatrix,St.spotShadowMap.value=pe.state.spotShadowMap,St.spotLightMatrix.value=pe.state.spotLightMatrix,St.spotLightMap.value=pe.state.spotLightMap,St.pointShadowMap.value=pe.state.pointShadowMap,St.pointShadowMatrix.value=pe.state.pointShadowMatrix),xe.currentProgram=Tt,xe.uniformsList=null,Tt}function eo(H){if(H.uniformsList===null){let oe=H.currentProgram.getUniforms();H.uniformsList=Bp.seqWithValue(oe.seq,H.uniforms)}return H.uniformsList}function Ya(H,oe){let ye=R.get(H);ye.outputColorSpace=oe.outputColorSpace,ye.batching=oe.batching,ye.batchingColor=oe.batchingColor,ye.instancing=oe.instancing,ye.instancingColor=oe.instancingColor,ye.instancingMorph=oe.instancingMorph,ye.skinning=oe.skinning,ye.morphTargets=oe.morphTargets,ye.morphNormals=oe.morphNormals,ye.morphColors=oe.morphColors,ye.morphTargetsCount=oe.morphTargetsCount,ye.numClippingPlanes=oe.numClippingPlanes,ye.numIntersection=oe.numClipIntersection,ye.vertexAlphas=oe.vertexAlphas,ye.vertexTangents=oe.vertexTangents,ye.toneMapping=oe.toneMapping}function Pt(H,oe,ye,xe,pe){oe.isScene!==!0&&(oe=ve),Z.resetTextureUnits();let $e=oe.fog,at=xe.isMeshStandardMaterial?oe.environment:null,Ke=B===null?T.outputColorSpace:B.isXRRenderTarget===!0?B.texture.colorSpace:yu,tt=(xe.isMeshStandardMaterial?he:fe).get(xe.envMap||at),xt=xe.vertexColors===!0&&!!ye.attributes.color&&ye.attributes.color.itemSize===4,Tt=!!ye.attributes.tangent&&(!!xe.normalMap||xe.anisotropy>0),St=!!ye.morphAttributes.position,zt=!!ye.morphAttributes.normal,tn=!!ye.morphAttributes.color,nn=Xs;xe.toneMapped&&(B===null||B.isXRRenderTarget===!0)&&(nn=T.toneMapping);let wn=ye.morphAttributes.position||ye.morphAttributes.normal||ye.morphAttributes.color,En=wn!==void 0?wn.length:0,Dt=R.get(xe),hn=C.state.lights;if(ke===!0&&(Pe===!0||H!==z)){let mi=H===z&&xe.id===O;Ue.setState(xe,H,mi)}let jt=!1;xe.version===Dt.__version?(Dt.needsLights&&Dt.lightsStateVersion!==hn.state.version||Dt.outputColorSpace!==Ke||pe.isBatchedMesh&&Dt.batching===!1||!pe.isBatchedMesh&&Dt.batching===!0||pe.isBatchedMesh&&Dt.batchingColor===!0&&pe.colorTexture===null||pe.isBatchedMesh&&Dt.batchingColor===!1&&pe.colorTexture!==null||pe.isInstancedMesh&&Dt.instancing===!1||!pe.isInstancedMesh&&Dt.instancing===!0||pe.isSkinnedMesh&&Dt.skinning===!1||!pe.isSkinnedMesh&&Dt.skinning===!0||pe.isInstancedMesh&&Dt.instancingColor===!0&&pe.instanceColor===null||pe.isInstancedMesh&&Dt.instancingColor===!1&&pe.instanceColor!==null||pe.isInstancedMesh&&Dt.instancingMorph===!0&&pe.morphTexture===null||pe.isInstancedMesh&&Dt.instancingMorph===!1&&pe.morphTexture!==null||Dt.envMap!==tt||xe.fog===!0&&Dt.fog!==$e||Dt.numClippingPlanes!==void 0&&(Dt.numClippingPlanes!==Ue.numPlanes||Dt.numIntersection!==Ue.numIntersection)||Dt.vertexAlphas!==xt||Dt.vertexTangents!==Tt||Dt.morphTargets!==St||Dt.morphNormals!==zt||Dt.morphColors!==tn||Dt.toneMapping!==nn||Dt.morphTargetsCount!==En)&&(jt=!0):(jt=!0,Dt.__version=xe.version);let Vn=Dt.currentProgram;jt===!0&&(Vn=No(xe,oe,pe));let to=!1,Bi=!1,Ka=!1,_n=Vn.getUniforms(),ci=Dt.uniforms;if(Ne.useProgram(Vn.program)&&(to=!0,Bi=!0,Ka=!0),xe.id!==O&&(O=xe.id,Bi=!0),to||z!==H){Ne.buffers.depth.getReversed()&&H.reversedDepth!==!0&&(H._reversedDepth=!0,H.updateProjectionMatrix()),_n.setValue(V,"projectionMatrix",H.projectionMatrix),_n.setValue(V,"viewMatrix",H.matrixWorldInverse);let er=_n.map.cameraPosition;er!==void 0&&er.setValue(V,De.setFromMatrixPosition(H.matrixWorld)),_e.logarithmicDepthBuffer&&_n.setValue(V,"logDepthBufFC",2/(Math.log(H.far+1)/Math.LN2)),(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial)&&_n.setValue(V,"isOrthographic",H.isOrthographicCamera===!0),z!==H&&(z=H,Bi=!0,Ka=!0)}if(Dt.needsLights&&(hn.state.directionalShadowMap.length>0&&_n.setValue(V,"directionalShadowMap",hn.state.directionalShadowMap,Z),hn.state.spotShadowMap.length>0&&_n.setValue(V,"spotShadowMap",hn.state.spotShadowMap,Z),hn.state.pointShadowMap.length>0&&_n.setValue(V,"pointShadowMap",hn.state.pointShadowMap,Z)),pe.isSkinnedMesh){_n.setOptional(V,pe,"bindMatrix"),_n.setOptional(V,pe,"bindMatrixInverse");let mi=pe.skeleton;mi&&(mi.boneTexture===null&&mi.computeBoneTexture(),_n.setValue(V,"boneTexture",mi.boneTexture,Z))}pe.isBatchedMesh&&(_n.setOptional(V,pe,"batchingTexture"),_n.setValue(V,"batchingTexture",pe._matricesTexture,Z),_n.setOptional(V,pe,"batchingIdTexture"),_n.setValue(V,"batchingIdTexture",pe._indirectTexture,Z),_n.setOptional(V,pe,"batchingColorTexture"),pe._colorsTexture!==null&&_n.setValue(V,"batchingColorTexture",pe._colorsTexture,Z));let Mi=ye.morphAttributes;if((Mi.position!==void 0||Mi.normal!==void 0||Mi.color!==void 0)&&Ye.update(pe,ye,Vn),(Bi||Dt.receiveShadow!==pe.receiveShadow)&&(Dt.receiveShadow=pe.receiveShadow,_n.setValue(V,"receiveShadow",pe.receiveShadow)),xe.isMeshGouraudMaterial&&xe.envMap!==null&&(ci.envMap.value=tt,ci.flipEnvMap.value=tt.isCubeTexture&&tt.isRenderTargetTexture===!1?-1:1),xe.isMeshStandardMaterial&&xe.envMap===null&&oe.environment!==null&&(ci.envMapIntensity.value=oe.environmentIntensity),ci.dfgLUT!==void 0&&(ci.dfgLUT.value=vY()),Bi&&(_n.setValue(V,"toneMappingExposure",T.toneMappingExposure),Dt.needsLights&&se(ci,Ka),$e&&xe.fog===!0&&ct.refreshFogUniforms(ci,$e),ct.refreshMaterialUniforms(ci,xe,q,X,C.state.transmissionRenderTarget[H.id]),Bp.upload(V,eo(Dt),ci,Z)),xe.isShaderMaterial&&xe.uniformsNeedUpdate===!0&&(Bp.upload(V,eo(Dt),ci,Z),xe.uniformsNeedUpdate=!1),xe.isSpriteMaterial&&_n.setValue(V,"center",pe.center),_n.setValue(V,"modelViewMatrix",pe.modelViewMatrix),_n.setValue(V,"normalMatrix",pe.normalMatrix),_n.setValue(V,"modelMatrix",pe.matrixWorld),xe.isShaderMaterial||xe.isRawShaderMaterial){let mi=xe.uniformsGroups;for(let er=0,Rl=mi.length;er<Rl;er++){let kr=mi[er];Fe.update(kr,Vn),Fe.bind(kr,Vn)}}return Vn}function se(H,oe){H.ambientLightColor.needsUpdate=oe,H.lightProbe.needsUpdate=oe,H.directionalLights.needsUpdate=oe,H.directionalLightShadows.needsUpdate=oe,H.pointLights.needsUpdate=oe,H.pointLightShadows.needsUpdate=oe,H.spotLights.needsUpdate=oe,H.spotLightShadows.needsUpdate=oe,H.rectAreaLights.needsUpdate=oe,H.hemisphereLights.needsUpdate=oe}function Ze(H){return H.isMeshLambertMaterial||H.isMeshToonMaterial||H.isMeshPhongMaterial||H.isMeshStandardMaterial||H.isShadowMaterial||H.isShaderMaterial&&H.lights===!0}this.getActiveCubeFace=function(){return I},this.getActiveMipmapLevel=function(){return F},this.getRenderTarget=function(){return B},this.setRenderTargetTextures=function(H,oe,ye){let xe=R.get(H);xe.__autoAllocateDepthBuffer=H.resolveDepthBuffer===!1,xe.__autoAllocateDepthBuffer===!1&&(xe.__useRenderToTexture=!1),R.get(H.texture).__webglTexture=oe,R.get(H.depthTexture).__webglTexture=xe.__autoAllocateDepthBuffer?void 0:ye,xe.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(H,oe){let ye=R.get(H);ye.__webglFramebuffer=oe,ye.__useDefaultFramebuffer=oe===void 0};let Et=V.createFramebuffer();this.setRenderTarget=function(H,oe=0,ye=0){B=H,I=oe,F=ye;let xe=null,pe=!1,$e=!1;if(H){let Ke=R.get(H);if(Ke.__useDefaultFramebuffer!==void 0){Ne.bindFramebuffer(V.FRAMEBUFFER,Ke.__webglFramebuffer),U.copy(H.viewport),G.copy(H.scissor),j=H.scissorTest,Ne.viewport(U),Ne.scissor(G),Ne.setScissorTest(j),O=-1;return}else if(Ke.__webglFramebuffer===void 0)Z.setupRenderTarget(H);else if(Ke.__hasExternalTextures)Z.rebindTextures(H,R.get(H.texture).__webglTexture,R.get(H.depthTexture).__webglTexture);else if(H.depthBuffer){let Tt=H.depthTexture;if(Ke.__boundDepthTexture!==Tt){if(Tt!==null&&R.has(Tt)&&(H.width!==Tt.image.width||H.height!==Tt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Z.setupDepthRenderbuffer(H)}}let tt=H.texture;(tt.isData3DTexture||tt.isDataArrayTexture||tt.isCompressedArrayTexture)&&($e=!0);let xt=R.get(H).__webglFramebuffer;H.isWebGLCubeRenderTarget?(Array.isArray(xt[oe])?xe=xt[oe][ye]:xe=xt[oe],pe=!0):H.samples>0&&Z.useMultisampledRTT(H)===!1?xe=R.get(H).__webglMultisampledFramebuffer:Array.isArray(xt)?xe=xt[ye]:xe=xt,U.copy(H.viewport),G.copy(H.scissor),j=H.scissorTest}else U.copy($).multiplyScalar(q).floor(),G.copy(ie).multiplyScalar(q).floor(),j=le;if(ye!==0&&(xe=Et),Ne.bindFramebuffer(V.FRAMEBUFFER,xe)&&Ne.drawBuffers(H,xe),Ne.viewport(U),Ne.scissor(G),Ne.setScissorTest(j),pe){let Ke=R.get(H.texture);V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Ke.__webglTexture,ye)}else if($e){let Ke=oe;for(let tt=0;tt<H.textures.length;tt++){let xt=R.get(H.textures[tt]);V.framebufferTextureLayer(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0+tt,xt.__webglTexture,ye,Ke)}}else if(H!==null&&ye!==0){let Ke=R.get(H.texture);V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,Ke.__webglTexture,ye)}O=-1},this.readRenderTargetPixels=function(H,oe,ye,xe,pe,$e,at,Ke=0){if(!(H&&H.isWebGLRenderTarget)){It("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let tt=R.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&at!==void 0&&(tt=tt[at]),tt){Ne.bindFramebuffer(V.FRAMEBUFFER,tt);try{let xt=H.textures[Ke],Tt=xt.format,St=xt.type;if(!_e.textureFormatReadable(Tt)){It("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!_e.textureTypeReadable(St)){It("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}oe>=0&&oe<=H.width-xe&&ye>=0&&ye<=H.height-pe&&(H.textures.length>1&&V.readBuffer(V.COLOR_ATTACHMENT0+Ke),V.readPixels(oe,ye,xe,pe,Be.convert(Tt),Be.convert(St),$e))}finally{let xt=B!==null?R.get(B).__webglFramebuffer:null;Ne.bindFramebuffer(V.FRAMEBUFFER,xt)}}},this.readRenderTargetPixelsAsync=async function(H,oe,ye,xe,pe,$e,at,Ke=0){if(!(H&&H.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let tt=R.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&at!==void 0&&(tt=tt[at]),tt)if(oe>=0&&oe<=H.width-xe&&ye>=0&&ye<=H.height-pe){Ne.bindFramebuffer(V.FRAMEBUFFER,tt);let xt=H.textures[Ke],Tt=xt.format,St=xt.type;if(!_e.textureFormatReadable(Tt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!_e.textureTypeReadable(St))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");let zt=V.createBuffer();V.bindBuffer(V.PIXEL_PACK_BUFFER,zt),V.bufferData(V.PIXEL_PACK_BUFFER,$e.byteLength,V.STREAM_READ),H.textures.length>1&&V.readBuffer(V.COLOR_ATTACHMENT0+Ke),V.readPixels(oe,ye,xe,pe,Be.convert(Tt),Be.convert(St),0);let tn=B!==null?R.get(B).__webglFramebuffer:null;Ne.bindFramebuffer(V.FRAMEBUFFER,tn);let nn=V.fenceSync(V.SYNC_GPU_COMMANDS_COMPLETE,0);return V.flush(),await C4(V,nn,4),V.bindBuffer(V.PIXEL_PACK_BUFFER,zt),V.getBufferSubData(V.PIXEL_PACK_BUFFER,0,$e),V.deleteBuffer(zt),V.deleteSync(nn),$e}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(H,oe=null,ye=0){let xe=Math.pow(2,-ye),pe=Math.floor(H.image.width*xe),$e=Math.floor(H.image.height*xe),at=oe!==null?oe.x:0,Ke=oe!==null?oe.y:0;Z.setTexture2D(H,0),V.copyTexSubImage2D(V.TEXTURE_2D,ye,0,0,at,Ke,pe,$e),Ne.unbindTexture()};let Mn=V.createFramebuffer(),ht=V.createFramebuffer();this.copyTextureToTexture=function(H,oe,ye=null,xe=null,pe=0,$e=null){$e===null&&(pe!==0?(Vh("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),$e=pe,pe=0):$e=0);let at,Ke,tt,xt,Tt,St,zt,tn,nn,wn=H.isCompressedTexture?H.mipmaps[$e]:H.image;if(ye!==null)at=ye.max.x-ye.min.x,Ke=ye.max.y-ye.min.y,tt=ye.isBox3?ye.max.z-ye.min.z:1,xt=ye.min.x,Tt=ye.min.y,St=ye.isBox3?ye.min.z:0;else{let Mi=Math.pow(2,-pe);at=Math.floor(wn.width*Mi),Ke=Math.floor(wn.height*Mi),H.isDataArrayTexture?tt=wn.depth:H.isData3DTexture?tt=Math.floor(wn.depth*Mi):tt=1,xt=0,Tt=0,St=0}xe!==null?(zt=xe.x,tn=xe.y,nn=xe.z):(zt=0,tn=0,nn=0);let En=Be.convert(oe.format),Dt=Be.convert(oe.type),hn;oe.isData3DTexture?(Z.setTexture3D(oe,0),hn=V.TEXTURE_3D):oe.isDataArrayTexture||oe.isCompressedArrayTexture?(Z.setTexture2DArray(oe,0),hn=V.TEXTURE_2D_ARRAY):(Z.setTexture2D(oe,0),hn=V.TEXTURE_2D),V.pixelStorei(V.UNPACK_FLIP_Y_WEBGL,oe.flipY),V.pixelStorei(V.UNPACK_PREMULTIPLY_ALPHA_WEBGL,oe.premultiplyAlpha),V.pixelStorei(V.UNPACK_ALIGNMENT,oe.unpackAlignment);let jt=V.getParameter(V.UNPACK_ROW_LENGTH),Vn=V.getParameter(V.UNPACK_IMAGE_HEIGHT),to=V.getParameter(V.UNPACK_SKIP_PIXELS),Bi=V.getParameter(V.UNPACK_SKIP_ROWS),Ka=V.getParameter(V.UNPACK_SKIP_IMAGES);V.pixelStorei(V.UNPACK_ROW_LENGTH,wn.width),V.pixelStorei(V.UNPACK_IMAGE_HEIGHT,wn.height),V.pixelStorei(V.UNPACK_SKIP_PIXELS,xt),V.pixelStorei(V.UNPACK_SKIP_ROWS,Tt),V.pixelStorei(V.UNPACK_SKIP_IMAGES,St);let _n=H.isDataArrayTexture||H.isData3DTexture,ci=oe.isDataArrayTexture||oe.isData3DTexture;if(H.isDepthTexture){let Mi=R.get(H),mi=R.get(oe),er=R.get(Mi.__renderTarget),Rl=R.get(mi.__renderTarget);Ne.bindFramebuffer(V.READ_FRAMEBUFFER,er.__webglFramebuffer),Ne.bindFramebuffer(V.DRAW_FRAMEBUFFER,Rl.__webglFramebuffer);for(let kr=0;kr<tt;kr++)_n&&(V.framebufferTextureLayer(V.READ_FRAMEBUFFER,V.COLOR_ATTACHMENT0,R.get(H).__webglTexture,pe,St+kr),V.framebufferTextureLayer(V.DRAW_FRAMEBUFFER,V.COLOR_ATTACHMENT0,R.get(oe).__webglTexture,$e,nn+kr)),V.blitFramebuffer(xt,Tt,at,Ke,zt,tn,at,Ke,V.DEPTH_BUFFER_BIT,V.NEAREST);Ne.bindFramebuffer(V.READ_FRAMEBUFFER,null),Ne.bindFramebuffer(V.DRAW_FRAMEBUFFER,null)}else if(pe!==0||H.isRenderTargetTexture||R.has(H)){let Mi=R.get(H),mi=R.get(oe);Ne.bindFramebuffer(V.READ_FRAMEBUFFER,Mn),Ne.bindFramebuffer(V.DRAW_FRAMEBUFFER,ht);for(let er=0;er<tt;er++)_n?V.framebufferTextureLayer(V.READ_FRAMEBUFFER,V.COLOR_ATTACHMENT0,Mi.__webglTexture,pe,St+er):V.framebufferTexture2D(V.READ_FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,Mi.__webglTexture,pe),ci?V.framebufferTextureLayer(V.DRAW_FRAMEBUFFER,V.COLOR_ATTACHMENT0,mi.__webglTexture,$e,nn+er):V.framebufferTexture2D(V.DRAW_FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,mi.__webglTexture,$e),pe!==0?V.blitFramebuffer(xt,Tt,at,Ke,zt,tn,at,Ke,V.COLOR_BUFFER_BIT,V.NEAREST):ci?V.copyTexSubImage3D(hn,$e,zt,tn,nn+er,xt,Tt,at,Ke):V.copyTexSubImage2D(hn,$e,zt,tn,xt,Tt,at,Ke);Ne.bindFramebuffer(V.READ_FRAMEBUFFER,null),Ne.bindFramebuffer(V.DRAW_FRAMEBUFFER,null)}else ci?H.isDataTexture||H.isData3DTexture?V.texSubImage3D(hn,$e,zt,tn,nn,at,Ke,tt,En,Dt,wn.data):oe.isCompressedArrayTexture?V.compressedTexSubImage3D(hn,$e,zt,tn,nn,at,Ke,tt,En,wn.data):V.texSubImage3D(hn,$e,zt,tn,nn,at,Ke,tt,En,Dt,wn):H.isDataTexture?V.texSubImage2D(V.TEXTURE_2D,$e,zt,tn,at,Ke,En,Dt,wn.data):H.isCompressedTexture?V.compressedTexSubImage2D(V.TEXTURE_2D,$e,zt,tn,wn.width,wn.height,En,wn.data):V.texSubImage2D(V.TEXTURE_2D,$e,zt,tn,at,Ke,En,Dt,wn);V.pixelStorei(V.UNPACK_ROW_LENGTH,jt),V.pixelStorei(V.UNPACK_IMAGE_HEIGHT,Vn),V.pixelStorei(V.UNPACK_SKIP_PIXELS,to),V.pixelStorei(V.UNPACK_SKIP_ROWS,Bi),V.pixelStorei(V.UNPACK_SKIP_IMAGES,Ka),$e===0&&oe.generateMipmaps&&V.generateMipmap(hn),Ne.unbindTexture()},this.initRenderTarget=function(H){R.get(H).__webglFramebuffer===void 0&&Z.setupRenderTarget(H)},this.initTexture=function(H){H.isCubeTexture?Z.setTextureCube(H,0):H.isData3DTexture?Z.setTexture3D(H,0):H.isDataArrayTexture||H.isCompressedArrayTexture?Z.setTexture2DArray(H,0):Z.setTexture2D(H,0),Ne.unbindTexture()},this.resetState=function(){I=0,F=0,B=null,Ne.reset(),it.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ws}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let n=this.getContext();n.drawingBufferColorSpace=yn._getDrawingBufferColorSpace(e),n.unpackColorSpace=yn._getUnpackColorSpace()}}});var cB=Kn(pd=>{"use strict";pd.ConcurrentRoot=1;pd.ContinuousEventPriority=4;pd.DefaultEventPriority=16;pd.DiscreteEventPriority=1;pd.IdleEventPriority=536870912;pd.LegacyRoot=0});var xA=Kn((Aie,uB)=>{"use strict";uB.exports=cB()});function _Y(t){let e,n=new Set,i=(c,u)=>{let d=typeof c=="function"?c(e):c;if(d!==e){let p=e;e=u?d:Object.assign({},e,d),n.forEach(m=>m(e,p))}},r=()=>e,s=(c,u=r,d=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let p=u(e);function m(){let g=u(e);if(!d(p,g)){let _=p;c(p=g,_)}}return n.add(m),()=>n.delete(m)},l={setState:i,getState:r,subscribe:(c,u,d)=>u||d?s(c,u,d):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(i,r,l),l}function dB(t){let e=typeof t=="function"?_Y(t):t,n=(i=e.getState,r=Object.is)=>{let[,s]=(0,Es.useReducer)(y=>y+1,0),o=e.getState(),a=(0,Es.useRef)(o),l=(0,Es.useRef)(i),c=(0,Es.useRef)(r),u=(0,Es.useRef)(!1),d=(0,Es.useRef)();d.current===void 0&&(d.current=i(o));let p,m=!1;(a.current!==o||l.current!==i||c.current!==r||u.current)&&(p=i(o),m=!r(d.current,p)),hB(()=>{m&&(d.current=p),a.current=o,l.current=i,c.current=r,u.current=!1});let g=(0,Es.useRef)(o);hB(()=>{let y=()=>{try{let S=e.getState(),b=l.current(S);c.current(d.current,b)||(a.current=S,d.current=b,s())}catch{u.current=!0,s()}},v=e.subscribe(y);return e.getState()!==g.current&&y(),v},[]);let _=m?p:d.current;return(0,Es.useDebugValue)(_),_};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let i=[n,e];return{next(){let r=i.length<=0;return{value:i.shift(),done:r}}}},n}var Es,yY,hB,fB=Hl(()=>{Es=mt(Ct());yY=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),hB=yY?Es.useEffect:Es.useLayoutEffect});function pB(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;let i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function mB(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(let s of md)if(pB(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!n)throw s.promise}let r={keys:e,equal:i.equal,remove:()=>{let s=md.indexOf(r);s!==-1&&md.splice(s,1)},promise:(xY(t)?t:t(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(md.push(r),!n)throw r.promise}var xY,md,kb,gB,vB,SA=Hl(()=>{xY=t=>typeof t=="object"&&typeof t.then=="function",md=[];kb=(t,e,n)=>mB(t,e,!1,n),gB=(t,e,n)=>{mB(t,e,!0,n)},vB=t=>{if(t===void 0||t.length===0)md.splice(0,md.length);else{let e=md.find(n=>pB(t,n.keys,n.equal));e&&e.remove()}}});var yB=Kn(Lb=>{"use strict";var SY=Ct(),bY=Symbol.for("react.element"),wY=Symbol.for("react.fragment"),EY=Object.prototype.hasOwnProperty,CY=SY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,TY={key:!0,ref:!0,__self:!0,__source:!0};function _B(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)EY.call(e,i)&&!TY.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:bY,type:t,key:s,ref:o,props:r,_owner:CY.current}}Lb.Fragment=wY;Lb.jsx=_B;Lb.jsxs=_B});var bA=Kn((Die,xB)=>{"use strict";xB.exports=yB()});var LB=Kn(Qn=>{"use strict";function TA(t,e){var n=t.length;t.push(e);e:for(;0<n;){var i=n-1>>>1,r=t[i];if(0<Pb(r,e))t[i]=e,t[n]=r,n=i;else break e}}function Ha(t){return t.length===0?null:t[0]}function Ib(t){if(t.length===0)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;e:for(var i=0,r=t.length,s=r>>>1;i<s;){var o=2*(i+1)-1,a=t[o],l=o+1,c=t[l];if(0>Pb(a,n))l<r&&0>Pb(c,a)?(t[i]=c,t[l]=n,i=l):(t[i]=a,t[o]=n,i=o);else if(l<r&&0>Pb(c,n))t[i]=c,t[l]=n,i=l;else break e}}return e}function Pb(t,e){var n=t.sortIndex-e.sortIndex;return n!==0?n:t.id-e.id}typeof performance=="object"&&typeof performance.now=="function"?(SB=performance,Qn.unstable_now=function(){return SB.now()}):(wA=Date,bB=wA.now(),Qn.unstable_now=function(){return wA.now()-bB});var SB,wA,bB,gl=[],Bu=[],MY=1,ta=null,is=3,Rb=!1,gd=!1,n_=!1,CB=typeof setTimeout=="function"?setTimeout:null,TB=typeof clearTimeout=="function"?clearTimeout:null,wB=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function MA(t){for(var e=Ha(Bu);e!==null;){if(e.callback===null)Ib(Bu);else if(e.startTime<=t)Ib(Bu),e.sortIndex=e.expirationTime,TA(gl,e);else break;e=Ha(Bu)}}function AA(t){if(n_=!1,MA(t),!gd)if(Ha(gl)!==null)gd=!0,LA(kA);else{var e=Ha(Bu);e!==null&&PA(AA,e.startTime-t)}}function kA(t,e){gd=!1,n_&&(n_=!1,TB(i_),i_=-1),Rb=!0;var n=is;try{for(MA(e),ta=Ha(gl);ta!==null&&(!(ta.expirationTime>e)||t&&!kB());){var i=ta.callback;if(typeof i=="function"){ta.callback=null,is=ta.priorityLevel;var r=i(ta.expirationTime<=e);e=Qn.unstable_now(),typeof r=="function"?ta.callback=r:ta===Ha(gl)&&Ib(gl),MA(e)}else Ib(gl);ta=Ha(gl)}if(ta!==null)var s=!0;else{var o=Ha(Bu);o!==null&&PA(AA,o.startTime-e),s=!1}return s}finally{ta=null,is=n,Rb=!1}}var Nb=!1,Db=null,i_=-1,MB=5,AB=-1;function kB(){return!(Qn.unstable_now()-AB<MB)}function EA(){if(Db!==null){var t=Qn.unstable_now();AB=t;var e=!0;try{e=Db(!0,t)}finally{e?t_():(Nb=!1,Db=null)}}else Nb=!1}var t_;typeof wB=="function"?t_=function(){wB(EA)}:typeof MessageChannel<"u"?(CA=new MessageChannel,EB=CA.port2,CA.port1.onmessage=EA,t_=function(){EB.postMessage(null)}):t_=function(){CB(EA,0)};var CA,EB;function LA(t){Db=t,Nb||(Nb=!0,t_())}function PA(t,e){i_=CB(function(){t(Qn.unstable_now())},e)}Qn.unstable_IdlePriority=5;Qn.unstable_ImmediatePriority=1;Qn.unstable_LowPriority=4;Qn.unstable_NormalPriority=3;Qn.unstable_Profiling=null;Qn.unstable_UserBlockingPriority=2;Qn.unstable_cancelCallback=function(t){t.callback=null};Qn.unstable_continueExecution=function(){gd||Rb||(gd=!0,LA(kA))};Qn.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):MB=0<t?Math.floor(1e3/t):5};Qn.unstable_getCurrentPriorityLevel=function(){return is};Qn.unstable_getFirstCallbackNode=function(){return Ha(gl)};Qn.unstable_next=function(t){switch(is){case 1:case 2:case 3:var e=3;break;default:e=is}var n=is;is=e;try{return t()}finally{is=n}};Qn.unstable_pauseExecution=function(){};Qn.unstable_requestPaint=function(){};Qn.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=is;is=t;try{return e()}finally{is=n}};Qn.unstable_scheduleCallback=function(t,e,n){var i=Qn.unstable_now();switch(typeof n=="object"&&n!==null?(n=n.delay,n=typeof n=="number"&&0<n?i+n:i):n=i,t){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return r=n+r,t={id:MY++,callback:e,priorityLevel:t,startTime:n,expirationTime:r,sortIndex:-1},n>i?(t.sortIndex=n,TA(Bu,t),Ha(gl)===null&&t===Ha(Bu)&&(n_?(TB(i_),i_=-1):n_=!0,PA(AA,n-i))):(t.sortIndex=r,TA(gl,t),gd||Rb||(gd=!0,LA(kA))),t};Qn.unstable_shouldYield=kB;Qn.unstable_wrapCallback=function(t){var e=is;return function(){var n=is;is=e;try{return t.apply(this,arguments)}finally{is=n}}}});var DB=Kn((Rie,PB)=>{"use strict";PB.exports=LB()});var RB=Kn((Nie,IB)=>{IB.exports=function(e){var n={},i=Ct(),r=DB(),s=Object.assign;function o(h){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+h,x=1;x<arguments.length;x++)f+="&args[]="+encodeURIComponent(arguments[x]);return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),g=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),C=Symbol.iterator;function M(h){return h===null||typeof h!="object"?null:(h=C&&h[C]||h["@@iterator"],typeof h=="function"?h:null)}function L(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case u:return"Fragment";case c:return"Portal";case p:return"Profiler";case d:return"StrictMode";case y:return"Suspense";case v:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case g:return(h.displayName||"Context")+".Consumer";case m:return(h._context.displayName||"Context")+".Provider";case _:var f=h.render;return h=h.displayName,h||(h=f.displayName||f.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case S:return f=h.displayName||null,f!==null?f:L(h.type)||"Memo";case b:f=h._payload,h=h._init;try{return L(h(f))}catch{}}return null}function P(h){var f=h.type;switch(h.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=f.render,h=h.displayName||h.name||"",f.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return L(f);case 8:return f===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function T(h){var f=h,x=h;if(h.alternate)for(;f.return;)f=f.return;else{h=f;do f=h,(f.flags&4098)!==0&&(x=f.return),h=f.return;while(h)}return f.tag===3?x:null}function A(h){if(T(h)!==h)throw Error(o(188))}function I(h){var f=h.alternate;if(!f){if(f=T(h),f===null)throw Error(o(188));return f!==h?null:h}for(var x=h,E=f;;){var k=x.return;if(k===null)break;var N=k.alternate;if(N===null){if(E=k.return,E!==null){x=E;continue}break}if(k.child===N.child){for(N=k.child;N;){if(N===x)return A(k),h;if(N===E)return A(k),f;N=N.sibling}throw Error(o(188))}if(x.return!==E.return)x=k,E=N;else{for(var ee=!1,ue=k.child;ue;){if(ue===x){ee=!0,x=k,E=N;break}if(ue===E){ee=!0,E=k,x=N;break}ue=ue.sibling}if(!ee){for(ue=N.child;ue;){if(ue===x){ee=!0,x=N,E=k;break}if(ue===E){ee=!0,E=N,x=k;break}ue=ue.sibling}if(!ee)throw Error(o(189))}}if(x.alternate!==E)throw Error(o(190))}if(x.tag!==3)throw Error(o(188));return x.stateNode.current===x?h:f}function F(h){return h=I(h),h!==null?B(h):null}function B(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var f=B(h);if(f!==null)return f;h=h.sibling}return null}function O(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){if(h.tag!==4){var f=O(h);if(f!==null)return f}h=h.sibling}return null}var z=Array.isArray,U=e.getPublicInstance,G=e.getRootHostContext,j=e.getChildHostContext,J=e.prepareForCommit,K=e.resetAfterCommit,D=e.createInstance,X=e.appendInitialChild,q=e.finalizeInitialChildren,ne=e.prepareUpdate,re=e.shouldSetTextContent,$=e.createTextInstance,ie=e.scheduleTimeout,le=e.cancelTimeout,Ee=e.noTimeout,ke=e.isPrimaryRenderer,Pe=e.supportsMutation,Te=e.supportsPersistence,De=e.supportsHydration,me=e.getInstanceFromNode,ve=e.preparePortalMount,ge=e.getCurrentEventPriority,Ie=e.detachDeletedInstance,V=e.supportsMicrotasks,Ge=e.scheduleMicrotask,Me=e.supportsTestSelectors,_e=e.findFiberRoot,Ne=e.getBoundingRect,W=e.getTextContent,R=e.isHiddenSubtree,Z=e.matchAccessibilityRole,fe=e.setFocusIfFocusable,he=e.setupIntersectionObserver,ae=e.appendChild,je=e.appendChildToContainer,ze=e.commitTextUpdate,Qe=e.commitMount,ct=e.commitUpdate,Ae=e.insertBefore,Ve=e.insertInContainerBefore,Ue=e.removeChild,Q=e.removeChildFromContainer,ce=e.resetTextContent,Ye=e.hideInstance,te=e.hideTextInstance,we=e.unhideInstance,Be=e.unhideTextInstance,it=e.clearContainer,Fe=e.cloneInstance,Se=e.createContainerChildSet,Xe=e.appendChildToContainerChildSet,Je=e.finalizeContainerChildren,ot=e.replaceContainerChildren,kt=e.cloneHiddenInstance,un=e.cloneHiddenTextInstance,mn=e.canHydrateInstance,qn=e.canHydrateTextInstance,Zi=e.canHydrateSuspenseInstance,Mr=e.isSuspenseInstancePending,Yn=e.isSuspenseInstanceFallback,Oi=e.registerSuspenseInstanceRetry,Qi=e.getNextHydratableSibling,Ti=e.getFirstHydratableChild,ni=e.getFirstHydratableChildWithinContainer,os=e.getFirstHydratableChildWithinSuspenseInstance,Ar=e.hydrateInstance,Qs=e.hydrateTextInstance,Il=e.hydrateSuspenseInstance,No=e.getNextHydratableInstanceAfterSuspenseInstance,eo=e.commitHydratedContainer,Ya=e.commitHydratedSuspenseInstance,Pt=e.clearSuspenseBoundary,se=e.clearSuspenseBoundaryFromContainer,Ze=e.shouldDeleteUnhydratedTailInstances,Et=e.didNotMatchHydratedContainerTextInstance,Mn=e.didNotMatchHydratedTextInstance,ht;function H(h){if(ht===void 0)try{throw Error()}catch(x){var f=x.stack.trim().match(/\n( *(at )?)/);ht=f&&f[1]||""}return`
`+ht+h}var oe=!1;function ye(h,f){if(!h||oe)return"";oe=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(rt){var E=rt}Reflect.construct(h,[],f)}else{try{f.call()}catch(rt){E=rt}h.call(f.prototype)}else{try{throw Error()}catch(rt){E=rt}h()}}catch(rt){if(rt&&E&&typeof rt.stack=="string"){for(var k=rt.stack.split(`
`),N=E.stack.split(`
`),ee=k.length-1,ue=N.length-1;1<=ee&&0<=ue&&k[ee]!==N[ue];)ue--;for(;1<=ee&&0<=ue;ee--,ue--)if(k[ee]!==N[ue]){if(ee!==1||ue!==1)do if(ee--,ue--,0>ue||k[ee]!==N[ue]){var He=`
`+k[ee].replace(" at new "," at ");return h.displayName&&He.includes("<anonymous>")&&(He=He.replace("<anonymous>",h.displayName)),He}while(1<=ee&&0<=ue);break}}}finally{oe=!1,Error.prepareStackTrace=x}return(h=h?h.displayName||h.name:"")?H(h):""}var xe=Object.prototype.hasOwnProperty,pe=[],$e=-1;function at(h){return{current:h}}function Ke(h){0>$e||(h.current=pe[$e],pe[$e]=null,$e--)}function tt(h,f){$e++,pe[$e]=h.current,h.current=f}var xt={},Tt=at(xt),St=at(!1),zt=xt;function tn(h,f){var x=h.type.contextTypes;if(!x)return xt;var E=h.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===f)return E.__reactInternalMemoizedMaskedChildContext;var k={},N;for(N in x)k[N]=f[N];return E&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=f,h.__reactInternalMemoizedMaskedChildContext=k),k}function nn(h){return h=h.childContextTypes,h!=null}function wn(){Ke(St),Ke(Tt)}function En(h,f,x){if(Tt.current!==xt)throw Error(o(168));tt(Tt,f),tt(St,x)}function Dt(h,f,x){var E=h.stateNode;if(f=f.childContextTypes,typeof E.getChildContext!="function")return x;E=E.getChildContext();for(var k in E)if(!(k in f))throw Error(o(108,P(h)||"Unknown",k));return s({},x,E)}function hn(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||xt,zt=Tt.current,tt(Tt,h),tt(St,St.current),!0}function jt(h,f,x){var E=h.stateNode;if(!E)throw Error(o(169));x?(h=Dt(h,f,zt),E.__reactInternalMemoizedMergedChildContext=h,Ke(St),Ke(Tt),tt(Tt,h)):Ke(St),tt(St,x)}var Vn=Math.clz32?Math.clz32:Ka,to=Math.log,Bi=Math.LN2;function Ka(h){return h>>>=0,h===0?32:31-(to(h)/Bi|0)|0}var _n=64,ci=4194304;function Mi(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function mi(h,f){var x=h.pendingLanes;if(x===0)return 0;var E=0,k=h.suspendedLanes,N=h.pingedLanes,ee=x&268435455;if(ee!==0){var ue=ee&~k;ue!==0?E=Mi(ue):(N&=ee,N!==0&&(E=Mi(N)))}else ee=x&~k,ee!==0?E=Mi(ee):N!==0&&(E=Mi(N));if(E===0)return 0;if(f!==0&&f!==E&&(f&k)===0&&(k=E&-E,N=f&-f,k>=N||k===16&&(N&4194240)!==0))return f;if((E&4)!==0&&(E|=x&16),f=h.entangledLanes,f!==0)for(h=h.entanglements,f&=E;0<f;)x=31-Vn(f),k=1<<x,E|=h[x],f&=~k;return E}function er(h,f){switch(h){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rl(h,f){for(var x=h.suspendedLanes,E=h.pingedLanes,k=h.expirationTimes,N=h.pendingLanes;0<N;){var ee=31-Vn(N),ue=1<<ee,He=k[ee];He===-1?((ue&x)===0||(ue&E)!==0)&&(k[ee]=er(ue,f)):He<=f&&(h.expiredLanes|=ue),N&=~ue}}function kr(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function Nd(h){for(var f=[],x=0;31>x;x++)f.push(h);return f}function $a(h,f,x){h.pendingLanes|=f,f!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,f=31-Vn(f),h[f]=x}function Lc(h,f){var x=h.pendingLanes&~f;h.pendingLanes=f,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=f,h.mutableReadLanes&=f,h.entangledLanes&=f,f=h.entanglements;var E=h.eventTimes;for(h=h.expirationTimes;0<x;){var k=31-Vn(x),N=1<<k;f[k]=0,E[k]=-1,h[k]=-1,x&=~N}}function Ja(h,f){var x=h.entangledLanes|=f;for(h=h.entanglements;x;){var E=31-Vn(x),k=1<<E;k&f|h[E]&f&&(h[E]|=f),x&=~k}}var dn=0;function hm(h){return h&=-h,1<h?4<h?(h&268435455)!==0?16:536870912:4:1}var Nl=r.unstable_scheduleCallback,Od=r.unstable_cancelCallback,dm=r.unstable_shouldYield,Z_=r.unstable_requestPaint,gi=r.unstable_now,Qu=r.unstable_ImmediatePriority,Q_=r.unstable_UserBlockingPriority,as=r.unstable_NormalPriority,fm=r.unstable_IdlePriority,eh=null,no=null;function pm(h){if(no&&typeof no.onCommitFiberRoot=="function")try{no.onCommitFiberRoot(eh,h,void 0,(h.current.flags&128)===128)}catch{}}function ey(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var io=typeof Object.is=="function"?Object.is:ey,ls=null,Za=!1,Oo=!1;function mm(h){ls===null?ls=[h]:ls.push(h)}function gm(h){Za=!0,mm(h)}function Ps(){if(!Oo&&ls!==null){Oo=!0;var h=0,f=dn;try{var x=ls;for(dn=1;h<x.length;h++){var E=x[h];do E=E(!0);while(E!==null)}ls=null,Za=!1}catch(k){throw ls!==null&&(ls=ls.slice(h+1)),Nl(Qu,Ps),k}finally{dn=f,Oo=!1}}return null}var th=a.ReactCurrentBatchConfig;function nh(h,f){if(io(h,f))return!0;if(typeof h!="object"||h===null||typeof f!="object"||f===null)return!1;var x=Object.keys(h),E=Object.keys(f);if(x.length!==E.length)return!1;for(E=0;E<x.length;E++){var k=x[E];if(!xe.call(f,k)||!io(h[k],f[k]))return!1}return!0}function ih(h){switch(h.tag){case 5:return H(h.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return h=ye(h.type,!1),h;case 11:return h=ye(h.type.render,!1),h;case 1:return h=ye(h.type,!0),h;default:return""}}function cs(h,f){if(h&&h.defaultProps){f=s({},f),h=h.defaultProps;for(var x in h)f[x]===void 0&&(f[x]=h[x]);return f}return f}var dr=at(null),Bd=null,pa=null,Pc=null;function Ud(){Pc=pa=Bd=null}function ty(h,f,x){ke?(tt(dr,f._currentValue),f._currentValue=x):(tt(dr,f._currentValue2),f._currentValue2=x)}function fr(h){var f=dr.current;Ke(dr),ke?h._currentValue=f:h._currentValue2=f}function us(h,f,x){for(;h!==null;){var E=h.alternate;if((h.childLanes&f)!==f?(h.childLanes|=f,E!==null&&(E.childLanes|=f)):E!==null&&(E.childLanes&f)!==f&&(E.childLanes|=f),h===x)break;h=h.return}}function Ui(h,f){Bd=h,Pc=pa=null,h=h.dependencies,h!==null&&h.firstContext!==null&&((h.lanes&f)!==0&&(ao=!0),h.firstContext=null)}function Fi(h){var f=ke?h._currentValue:h._currentValue2;if(Pc!==h)if(h={context:h,memoizedValue:f,next:null},pa===null){if(Bd===null)throw Error(o(308));pa=h,Bd.dependencies={lanes:0,firstContext:h}}else pa=pa.next=h;return f}var ro=null,Dc=!1;function oE(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bL(h,f){h=h.updateQueue,f.updateQueue===h&&(f.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function Ol(h,f){return{eventTime:h,lane:f,tag:0,payload:null,callback:null,next:null}}function Ic(h,f){var x=h.updateQueue;x!==null&&(x=x.shared,Gi!==null&&(h.mode&1)!==0&&(ln&2)===0?(h=x.interleaved,h===null?(f.next=f,ro===null?ro=[x]:ro.push(x)):(f.next=h.next,h.next=f),x.interleaved=f):(h=x.pending,h===null?f.next=f:(f.next=h.next,h.next=f),x.pending=f))}function ny(h,f,x){if(f=f.updateQueue,f!==null&&(f=f.shared,(x&4194240)!==0)){var E=f.lanes;E&=h.pendingLanes,x|=E,f.lanes=x,Ja(h,x)}}function wL(h,f){var x=h.updateQueue,E=h.alternate;if(E!==null&&(E=E.updateQueue,x===E)){var k=null,N=null;if(x=x.firstBaseUpdate,x!==null){do{var ee={eventTime:x.eventTime,lane:x.lane,tag:x.tag,payload:x.payload,callback:x.callback,next:null};N===null?k=N=ee:N=N.next=ee,x=x.next}while(x!==null);N===null?k=N=f:N=N.next=f}else k=N=f;x={baseState:E.baseState,firstBaseUpdate:k,lastBaseUpdate:N,shared:E.shared,effects:E.effects},h.updateQueue=x;return}h=x.lastBaseUpdate,h===null?x.firstBaseUpdate=f:h.next=f,x.lastBaseUpdate=f}function iy(h,f,x,E){var k=h.updateQueue;Dc=!1;var N=k.firstBaseUpdate,ee=k.lastBaseUpdate,ue=k.shared.pending;if(ue!==null){k.shared.pending=null;var He=ue,rt=He.next;He.next=null,ee===null?N=rt:ee.next=rt,ee=He;var Lt=h.alternate;Lt!==null&&(Lt=Lt.updateQueue,ue=Lt.lastBaseUpdate,ue!==ee&&(ue===null?Lt.firstBaseUpdate=rt:ue.next=rt,Lt.lastBaseUpdate=He))}if(N!==null){var Kt=k.baseState;ee=0,Lt=rt=He=null,ue=N;do{var Bt=ue.lane,Gn=ue.eventTime;if((E&Bt)===Bt){Lt!==null&&(Lt=Lt.next={eventTime:Gn,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var Nt=h,Gr=ue;switch(Bt=f,Gn=x,Gr.tag){case 1:if(Nt=Gr.payload,typeof Nt=="function"){Kt=Nt.call(Gn,Kt,Bt);break e}Kt=Nt;break e;case 3:Nt.flags=Nt.flags&-65537|128;case 0:if(Nt=Gr.payload,Bt=typeof Nt=="function"?Nt.call(Gn,Kt,Bt):Nt,Bt==null)break e;Kt=s({},Kt,Bt);break e;case 2:Dc=!0}}ue.callback!==null&&ue.lane!==0&&(h.flags|=64,Bt=k.effects,Bt===null?k.effects=[ue]:Bt.push(ue))}else Gn={eventTime:Gn,lane:Bt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},Lt===null?(rt=Lt=Gn,He=Kt):Lt=Lt.next=Gn,ee|=Bt;if(ue=ue.next,ue===null){if(ue=k.shared.pending,ue===null)break;Bt=ue,ue=Bt.next,Bt.next=null,k.lastBaseUpdate=Bt,k.shared.pending=null}}while(!0);if(Lt===null&&(He=Kt),k.baseState=He,k.firstBaseUpdate=rt,k.lastBaseUpdate=Lt,f=k.shared.interleaved,f!==null){k=f;do ee|=k.lane,k=k.next;while(k!==f)}else N===null&&(k.shared.lanes=0);qd|=ee,h.lanes=ee,h.memoizedState=Kt}}function EL(h,f,x){if(h=f.effects,f.effects=null,h!==null)for(f=0;f<h.length;f++){var E=h[f],k=E.callback;if(k!==null){if(E.callback=null,E=x,typeof k!="function")throw Error(o(191,k));k.call(E)}}}var CL=new i.Component().refs;function aE(h,f,x,E){f=h.memoizedState,x=x(E,f),x=x==null?f:s({},f,x),h.memoizedState=x,h.lanes===0&&(h.updateQueue.baseState=x)}var ry={isMounted:function(h){return(h=h._reactInternals)?T(h)===h:!1},enqueueSetState:function(h,f,x){h=h._reactInternals;var E=ds(),k=Oc(h),N=Ol(E,k);N.payload=f,x!=null&&(N.callback=x),Ic(h,N),f=Ho(h,k,E),f!==null&&ny(f,h,k)},enqueueReplaceState:function(h,f,x){h=h._reactInternals;var E=ds(),k=Oc(h),N=Ol(E,k);N.tag=1,N.payload=f,x!=null&&(N.callback=x),Ic(h,N),f=Ho(h,k,E),f!==null&&ny(f,h,k)},enqueueForceUpdate:function(h,f){h=h._reactInternals;var x=ds(),E=Oc(h),k=Ol(x,E);k.tag=2,f!=null&&(k.callback=f),Ic(h,k),f=Ho(h,E,x),f!==null&&ny(f,h,E)}};function TL(h,f,x,E,k,N,ee){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(E,N,ee):f.prototype&&f.prototype.isPureReactComponent?!nh(x,E)||!nh(k,N):!0}function ML(h,f,x){var E=!1,k=xt,N=f.contextType;return typeof N=="object"&&N!==null?N=Fi(N):(k=nn(f)?zt:Tt.current,E=f.contextTypes,N=(E=E!=null)?tn(h,k):xt),f=new f(x,N),h.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=ry,h.stateNode=f,f._reactInternals=h,E&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=k,h.__reactInternalMemoizedMaskedChildContext=N),f}function AL(h,f,x,E){h=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(x,E),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(x,E),f.state!==h&&ry.enqueueReplaceState(f,f.state,null)}function lE(h,f,x,E){var k=h.stateNode;k.props=x,k.state=h.memoizedState,k.refs=CL,oE(h);var N=f.contextType;typeof N=="object"&&N!==null?k.context=Fi(N):(N=nn(f)?zt:Tt.current,k.context=tn(h,N)),k.state=h.memoizedState,N=f.getDerivedStateFromProps,typeof N=="function"&&(aE(h,f,N,x),k.state=h.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(f=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),f!==k.state&&ry.enqueueReplaceState(k,k.state,null),iy(h,x,k,E),k.state=h.memoizedState),typeof k.componentDidMount=="function"&&(h.flags|=4194308)}var Fd=[],zd=0,sy=null,oy=0,Bo=[],Uo=0,rh=null,Bl=1,Ul="";function sh(h,f){Fd[zd++]=oy,Fd[zd++]=sy,sy=h,oy=f}function kL(h,f,x){Bo[Uo++]=Bl,Bo[Uo++]=Ul,Bo[Uo++]=rh,rh=h;var E=Bl;h=Ul;var k=32-Vn(E)-1;E&=~(1<<k),x+=1;var N=32-Vn(f)+k;if(30<N){var ee=k-k%5;N=(E&(1<<ee)-1).toString(32),E>>=ee,k-=ee,Bl=1<<32-Vn(f)+k|x<<k|E,Ul=N+h}else Bl=1<<N|x<<k|E,Ul=h}function cE(h){h.return!==null&&(sh(h,1),kL(h,1,0))}function uE(h){for(;h===sy;)sy=Fd[--zd],Fd[zd]=null,oy=Fd[--zd],Fd[zd]=null;for(;h===rh;)rh=Bo[--Uo],Bo[Uo]=null,Ul=Bo[--Uo],Bo[Uo]=null,Bl=Bo[--Uo],Bo[Uo]=null}var so=null,oo=null,ui=!1,vm=!1,ma=null;function LL(h,f){var x=Wo(5,null,null,0);x.elementType="DELETED",x.stateNode=f,x.return=h,f=h.deletions,f===null?(h.deletions=[x],h.flags|=16):f.push(x)}function PL(h,f){switch(h.tag){case 5:return f=mn(f,h.type,h.pendingProps),f!==null?(h.stateNode=f,so=h,oo=Ti(f),!0):!1;case 6:return f=qn(f,h.pendingProps),f!==null?(h.stateNode=f,so=h,oo=null,!0):!1;case 13:if(f=Zi(f),f!==null){var x=rh!==null?{id:Bl,overflow:Ul}:null;return h.memoizedState={dehydrated:f,treeContext:x,retryLane:1073741824},x=Wo(18,null,null,0),x.stateNode=f,x.return=h,h.child=x,so=h,oo=null,!0}return!1;default:return!1}}function hE(h){return(h.mode&1)!==0&&(h.flags&128)===0}function dE(h){if(ui){var f=oo;if(f){var x=f;if(!PL(h,f)){if(hE(h))throw Error(o(418));f=Qi(x);var E=so;f&&PL(h,f)?LL(E,x):(h.flags=h.flags&-4097|2,ui=!1,so=h)}}else{if(hE(h))throw Error(o(418));h.flags=h.flags&-4097|2,ui=!1,so=h}}}function DL(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;so=h}function _m(h){if(!De||h!==so)return!1;if(!ui)return DL(h),ui=!0,!1;if(h.tag!==3&&(h.tag!==5||Ze(h.type)&&!re(h.type,h.memoizedProps))){var f=oo;if(f){if(hE(h)){for(h=oo;h;)h=Qi(h);throw Error(o(418))}for(;f;)LL(h,f),f=Qi(f)}}if(DL(h),h.tag===13){if(!De)throw Error(o(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(o(317));oo=No(h)}else oo=so?Qi(h.stateNode):null;return!0}function Hd(){De&&(oo=so=null,vm=ui=!1)}function fE(h){ma===null?ma=[h]:ma.push(h)}function ym(h,f,x){if(h=x.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(x._owner){if(x=x._owner,x){if(x.tag!==1)throw Error(o(309));var E=x.stateNode}if(!E)throw Error(o(147,h));var k=E,N=""+h;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===N?f.ref:(f=function(ee){var ue=k.refs;ue===CL&&(ue=k.refs={}),ee===null?delete ue[N]:ue[N]=ee},f._stringRef=N,f)}if(typeof h!="string")throw Error(o(284));if(!x._owner)throw Error(o(290,h))}return h}function ay(h,f){throw h=Object.prototype.toString.call(f),Error(o(31,h==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":h))}function IL(h){var f=h._init;return f(h._payload)}function RL(h){function f(be,de){if(h){var Re=be.deletions;Re===null?(be.deletions=[de],be.flags|=16):Re.push(de)}}function x(be,de){if(!h)return null;for(;de!==null;)f(be,de),de=de.sibling;return null}function E(be,de){for(be=new Map;de!==null;)de.key!==null?be.set(de.key,de):be.set(de.index,de),de=de.sibling;return be}function k(be,de){return be=Uc(be,de),be.index=0,be.sibling=null,be}function N(be,de,Re){return be.index=Re,h?(Re=be.alternate,Re!==null?(Re=Re.index,Re<de?(be.flags|=2,de):Re):(be.flags|=2,de)):(be.flags|=1048576,de)}function ee(be){return h&&be.alternate===null&&(be.flags|=2),be}function ue(be,de,Re,yt){return de===null||de.tag!==6?(de=$E(Re,be.mode,yt),de.return=be,de):(de=k(de,Re),de.return=be,de)}function He(be,de,Re,yt){var Rt=Re.type;return Rt===u?Lt(be,de,Re.props.children,yt,Re.key):de!==null&&(de.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===b&&IL(Rt)===de.type)?(yt=k(de,Re.props),yt.ref=ym(be,de,Re),yt.return=be,yt):(yt=Uy(Re.type,Re.key,Re.props,null,be.mode,yt),yt.ref=ym(be,de,Re),yt.return=be,yt)}function rt(be,de,Re,yt){return de===null||de.tag!==4||de.stateNode.containerInfo!==Re.containerInfo||de.stateNode.implementation!==Re.implementation?(de=JE(Re,be.mode,yt),de.return=be,de):(de=k(de,Re.children||[]),de.return=be,de)}function Lt(be,de,Re,yt,Rt){return de===null||de.tag!==7?(de=dh(Re,be.mode,yt,Rt),de.return=be,de):(de=k(de,Re),de.return=be,de)}function Kt(be,de,Re){if(typeof de=="string"&&de!==""||typeof de=="number")return de=$E(""+de,be.mode,Re),de.return=be,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case l:return Re=Uy(de.type,de.key,de.props,null,be.mode,Re),Re.ref=ym(be,null,de),Re.return=be,Re;case c:return de=JE(de,be.mode,Re),de.return=be,de;case b:var yt=de._init;return Kt(be,yt(de._payload),Re)}if(z(de)||M(de))return de=dh(de,be.mode,Re,null),de.return=be,de;ay(be,de)}return null}function Bt(be,de,Re,yt){var Rt=de!==null?de.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number")return Rt!==null?null:ue(be,de,""+Re,yt);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case l:return Re.key===Rt?He(be,de,Re,yt):null;case c:return Re.key===Rt?rt(be,de,Re,yt):null;case b:return Rt=Re._init,Bt(be,de,Rt(Re._payload),yt)}if(z(Re)||M(Re))return Rt!==null?null:Lt(be,de,Re,yt,null);ay(be,Re)}return null}function Gn(be,de,Re,yt,Rt){if(typeof yt=="string"&&yt!==""||typeof yt=="number")return be=be.get(Re)||null,ue(de,be,""+yt,Rt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case l:return be=be.get(yt.key===null?Re:yt.key)||null,He(de,be,yt,Rt);case c:return be=be.get(yt.key===null?Re:yt.key)||null,rt(de,be,yt,Rt);case b:var sn=yt._init;return Gn(be,de,Re,sn(yt._payload),Rt)}if(z(yt)||M(yt))return be=be.get(Re)||null,Lt(de,be,yt,Rt,null);ay(de,yt)}return null}function Nt(be,de,Re,yt){for(var Rt=null,sn=null,$t=de,An=de=0,mr=null;$t!==null&&An<Re.length;An++){$t.index>An?(mr=$t,$t=null):mr=$t.sibling;var kn=Bt(be,$t,Re[An],yt);if(kn===null){$t===null&&($t=mr);break}h&&$t&&kn.alternate===null&&f(be,$t),de=N(kn,de,An),sn===null?Rt=kn:sn.sibling=kn,sn=kn,$t=mr}if(An===Re.length)return x(be,$t),ui&&sh(be,An),Rt;if($t===null){for(;An<Re.length;An++)$t=Kt(be,Re[An],yt),$t!==null&&(de=N($t,de,An),sn===null?Rt=$t:sn.sibling=$t,sn=$t);return ui&&sh(be,An),Rt}for($t=E(be,$t);An<Re.length;An++)mr=Gn($t,be,An,Re[An],yt),mr!==null&&(h&&mr.alternate!==null&&$t.delete(mr.key===null?An:mr.key),de=N(mr,de,An),sn===null?Rt=mr:sn.sibling=mr,sn=mr);return h&&$t.forEach(function(Fc){return f(be,Fc)}),ui&&sh(be,An),Rt}function Gr(be,de,Re,yt){var Rt=M(Re);if(typeof Rt!="function")throw Error(o(150));if(Re=Rt.call(Re),Re==null)throw Error(o(151));for(var sn=Rt=null,$t=de,An=de=0,mr=null,kn=Re.next();$t!==null&&!kn.done;An++,kn=Re.next()){$t.index>An?(mr=$t,$t=null):mr=$t.sibling;var Fc=Bt(be,$t,kn.value,yt);if(Fc===null){$t===null&&($t=mr);break}h&&$t&&Fc.alternate===null&&f(be,$t),de=N(Fc,de,An),sn===null?Rt=Fc:sn.sibling=Fc,sn=Fc,$t=mr}if(kn.done)return x(be,$t),ui&&sh(be,An),Rt;if($t===null){for(;!kn.done;An++,kn=Re.next())kn=Kt(be,kn.value,yt),kn!==null&&(de=N(kn,de,An),sn===null?Rt=kn:sn.sibling=kn,sn=kn);return ui&&sh(be,An),Rt}for($t=E(be,$t);!kn.done;An++,kn=Re.next())kn=Gn($t,be,An,kn.value,yt),kn!==null&&(h&&kn.alternate!==null&&$t.delete(kn.key===null?An:kn.key),de=N(kn,de,An),sn===null?Rt=kn:sn.sibling=kn,sn=kn);return h&&$t.forEach(function(mH){return f(be,mH)}),ui&&sh(be,An),Rt}function Vo(be,de,Re,yt){if(typeof Re=="object"&&Re!==null&&Re.type===u&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case l:e:{for(var Rt=Re.key,sn=de;sn!==null;){if(sn.key===Rt){if(Rt=Re.type,Rt===u){if(sn.tag===7){x(be,sn.sibling),de=k(sn,Re.props.children),de.return=be,be=de;break e}}else if(sn.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===b&&IL(Rt)===sn.type){x(be,sn.sibling),de=k(sn,Re.props),de.ref=ym(be,sn,Re),de.return=be,be=de;break e}x(be,sn);break}else f(be,sn);sn=sn.sibling}Re.type===u?(de=dh(Re.props.children,be.mode,yt,Re.key),de.return=be,be=de):(yt=Uy(Re.type,Re.key,Re.props,null,be.mode,yt),yt.ref=ym(be,de,Re),yt.return=be,be=yt)}return ee(be);case c:e:{for(sn=Re.key;de!==null;){if(de.key===sn)if(de.tag===4&&de.stateNode.containerInfo===Re.containerInfo&&de.stateNode.implementation===Re.implementation){x(be,de.sibling),de=k(de,Re.children||[]),de.return=be,be=de;break e}else{x(be,de);break}else f(be,de);de=de.sibling}de=JE(Re,be.mode,yt),de.return=be,be=de}return ee(be);case b:return sn=Re._init,Vo(be,de,sn(Re._payload),yt)}if(z(Re))return Nt(be,de,Re,yt);if(M(Re))return Gr(be,de,Re,yt);ay(be,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"?(Re=""+Re,de!==null&&de.tag===6?(x(be,de.sibling),de=k(de,Re),de.return=be,be=de):(x(be,de),de=$E(Re,be.mode,yt),de.return=be,be=de),ee(be)):x(be,de)}return Vo}var Wd=RL(!0),NL=RL(!1),xm={},Fo=at(xm),Sm=at(xm),Vd=at(xm);function Qa(h){if(h===xm)throw Error(o(174));return h}function pE(h,f){tt(Vd,f),tt(Sm,h),tt(Fo,xm),h=G(f),Ke(Fo),tt(Fo,h)}function Gd(){Ke(Fo),Ke(Sm),Ke(Vd)}function OL(h){var f=Qa(Vd.current),x=Qa(Fo.current);f=j(x,h.type,f),x!==f&&(tt(Sm,h),tt(Fo,f))}function mE(h){Sm.current===h&&(Ke(Fo),Ke(Sm))}var vi=at(0);function ly(h){for(var f=h;f!==null;){if(f.tag===13){var x=f.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||Mr(x)||Yn(x)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var gE=[];function vE(){for(var h=0;h<gE.length;h++){var f=gE[h];ke?f._workInProgressVersionPrimary=null:f._workInProgressVersionSecondary=null}gE.length=0}var cy=a.ReactCurrentDispatcher,zo=a.ReactCurrentBatchConfig,jd=0,Ai=null,Hr=null,pr=null,uy=!1,bm=!1,wm=0,z8=0;function Wr(){throw Error(o(321))}function _E(h,f){if(f===null)return!1;for(var x=0;x<f.length&&x<h.length;x++)if(!io(h[x],f[x]))return!1;return!0}function yE(h,f,x,E,k,N){if(jd=N,Ai=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,cy.current=h===null||h.memoizedState===null?G8:j8,h=x(E,k),bm){N=0;do{if(bm=!1,wm=0,25<=N)throw Error(o(301));N+=1,pr=Hr=null,f.updateQueue=null,cy.current=X8,h=x(E,k)}while(bm)}if(cy.current=my,f=Hr!==null&&Hr.next!==null,jd=0,pr=Hr=Ai=null,uy=!1,f)throw Error(o(300));return h}function xE(){var h=wm!==0;return wm=0,h}function Fl(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?Ai.memoizedState=pr=h:pr=pr.next=h,pr}function el(){if(Hr===null){var h=Ai.alternate;h=h!==null?h.memoizedState:null}else h=Hr.next;var f=pr===null?Ai.memoizedState:pr.next;if(f!==null)pr=f,Hr=h;else{if(h===null)throw Error(o(310));Hr=h,h={memoizedState:Hr.memoizedState,baseState:Hr.baseState,baseQueue:Hr.baseQueue,queue:Hr.queue,next:null},pr===null?Ai.memoizedState=pr=h:pr=pr.next=h}return pr}function oh(h,f){return typeof f=="function"?f(h):f}function hy(h){var f=el(),x=f.queue;if(x===null)throw Error(o(311));x.lastRenderedReducer=h;var E=Hr,k=E.baseQueue,N=x.pending;if(N!==null){if(k!==null){var ee=k.next;k.next=N.next,N.next=ee}E.baseQueue=k=N,x.pending=null}if(k!==null){N=k.next,E=E.baseState;var ue=ee=null,He=null,rt=N;do{var Lt=rt.lane;if((jd&Lt)===Lt)He!==null&&(He=He.next={lane:0,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),E=rt.hasEagerState?rt.eagerState:h(E,rt.action);else{var Kt={lane:Lt,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null};He===null?(ue=He=Kt,ee=E):He=He.next=Kt,Ai.lanes|=Lt,qd|=Lt}rt=rt.next}while(rt!==null&&rt!==N);He===null?ee=E:He.next=ue,io(E,f.memoizedState)||(ao=!0),f.memoizedState=E,f.baseState=ee,f.baseQueue=He,x.lastRenderedState=E}if(h=x.interleaved,h!==null){k=h;do N=k.lane,Ai.lanes|=N,qd|=N,k=k.next;while(k!==h)}else k===null&&(x.lanes=0);return[f.memoizedState,x.dispatch]}function dy(h){var f=el(),x=f.queue;if(x===null)throw Error(o(311));x.lastRenderedReducer=h;var E=x.dispatch,k=x.pending,N=f.memoizedState;if(k!==null){x.pending=null;var ee=k=k.next;do N=h(N,ee.action),ee=ee.next;while(ee!==k);io(N,f.memoizedState)||(ao=!0),f.memoizedState=N,f.baseQueue===null&&(f.baseState=N),x.lastRenderedState=N}return[N,E]}function BL(){}function UL(h,f){var x=Ai,E=el(),k=f(),N=!io(E.memoizedState,k);if(N&&(E.memoizedState=k,ao=!0),E=E.queue,Cm(HL.bind(null,x,E,h),[h]),E.getSnapshot!==f||N||pr!==null&&pr.memoizedState.tag&1){if(x.flags|=2048,Em(9,zL.bind(null,x,E,k,f),void 0,null),Gi===null)throw Error(o(349));(jd&30)!==0||FL(x,f,k)}return k}function FL(h,f,x){h.flags|=16384,h={getSnapshot:f,value:x},f=Ai.updateQueue,f===null?(f={lastEffect:null,stores:null},Ai.updateQueue=f,f.stores=[h]):(x=f.stores,x===null?f.stores=[h]:x.push(h))}function zL(h,f,x,E){f.value=x,f.getSnapshot=E,WL(f)&&Ho(h,1,-1)}function HL(h,f,x){return x(function(){WL(f)&&Ho(h,1,-1)})}function WL(h){var f=h.getSnapshot;h=h.value;try{var x=f();return!io(h,x)}catch{return!0}}function SE(h){var f=Fl();return typeof h=="function"&&(h=h()),f.memoizedState=f.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oh,lastRenderedState:h},f.queue=h,h=h.dispatch=V8.bind(null,Ai,h),[f.memoizedState,h]}function Em(h,f,x,E){return h={tag:h,create:f,destroy:x,deps:E,next:null},f=Ai.updateQueue,f===null?(f={lastEffect:null,stores:null},Ai.updateQueue=f,f.lastEffect=h.next=h):(x=f.lastEffect,x===null?f.lastEffect=h.next=h:(E=x.next,x.next=h,h.next=E,f.lastEffect=h)),h}function VL(){return el().memoizedState}function fy(h,f,x,E){var k=Fl();Ai.flags|=h,k.memoizedState=Em(1|f,x,void 0,E===void 0?null:E)}function py(h,f,x,E){var k=el();E=E===void 0?null:E;var N=void 0;if(Hr!==null){var ee=Hr.memoizedState;if(N=ee.destroy,E!==null&&_E(E,ee.deps)){k.memoizedState=Em(f,x,N,E);return}}Ai.flags|=h,k.memoizedState=Em(1|f,x,N,E)}function bE(h,f){return fy(8390656,8,h,f)}function Cm(h,f){return py(2048,8,h,f)}function GL(h,f){return py(4,2,h,f)}function jL(h,f){return py(4,4,h,f)}function XL(h,f){if(typeof f=="function")return h=h(),f(h),function(){f(null)};if(f!=null)return h=h(),f.current=h,function(){f.current=null}}function qL(h,f,x){return x=x!=null?x.concat([h]):null,py(4,4,XL.bind(null,f,h),x)}function wE(){}function YL(h,f){var x=el();f=f===void 0?null:f;var E=x.memoizedState;return E!==null&&f!==null&&_E(f,E[1])?E[0]:(x.memoizedState=[h,f],h)}function KL(h,f){var x=el();f=f===void 0?null:f;var E=x.memoizedState;return E!==null&&f!==null&&_E(f,E[1])?E[0]:(h=h(),x.memoizedState=[h,f],h)}function H8(h,f){var x=dn;dn=x!==0&&4>x?x:4,h(!0);var E=zo.transition;zo.transition={};try{h(!1),f()}finally{dn=x,zo.transition=E}}function $L(){return el().memoizedState}function W8(h,f,x){var E=Oc(h);x={lane:E,action:x,hasEagerState:!1,eagerState:null,next:null},JL(h)?ZL(f,x):(QL(h,f,x),x=ds(),h=Ho(h,E,x),h!==null&&eP(h,f,E))}function V8(h,f,x){var E=Oc(h),k={lane:E,action:x,hasEagerState:!1,eagerState:null,next:null};if(JL(h))ZL(f,k);else{QL(h,f,k);var N=h.alternate;if(h.lanes===0&&(N===null||N.lanes===0)&&(N=f.lastRenderedReducer,N!==null))try{var ee=f.lastRenderedState,ue=N(ee,x);if(k.hasEagerState=!0,k.eagerState=ue,io(ue,ee))return}catch{}x=ds(),h=Ho(h,E,x),h!==null&&eP(h,f,E)}}function JL(h){var f=h.alternate;return h===Ai||f!==null&&f===Ai}function ZL(h,f){bm=uy=!0;var x=h.pending;x===null?f.next=f:(f.next=x.next,x.next=f),h.pending=f}function QL(h,f,x){Gi!==null&&(h.mode&1)!==0&&(ln&2)===0?(h=f.interleaved,h===null?(x.next=x,ro===null?ro=[f]:ro.push(f)):(x.next=h.next,h.next=x),f.interleaved=x):(h=f.pending,h===null?x.next=x:(x.next=h.next,h.next=x),f.pending=x)}function eP(h,f,x){if((x&4194240)!==0){var E=f.lanes;E&=h.pendingLanes,x|=E,f.lanes=x,Ja(h,x)}}var my={readContext:Fi,useCallback:Wr,useContext:Wr,useEffect:Wr,useImperativeHandle:Wr,useInsertionEffect:Wr,useLayoutEffect:Wr,useMemo:Wr,useReducer:Wr,useRef:Wr,useState:Wr,useDebugValue:Wr,useDeferredValue:Wr,useTransition:Wr,useMutableSource:Wr,useSyncExternalStore:Wr,useId:Wr,unstable_isNewReconciler:!1},G8={readContext:Fi,useCallback:function(h,f){return Fl().memoizedState=[h,f===void 0?null:f],h},useContext:Fi,useEffect:bE,useImperativeHandle:function(h,f,x){return x=x!=null?x.concat([h]):null,fy(4194308,4,XL.bind(null,f,h),x)},useLayoutEffect:function(h,f){return fy(4194308,4,h,f)},useInsertionEffect:function(h,f){return fy(4,2,h,f)},useMemo:function(h,f){var x=Fl();return f=f===void 0?null:f,h=h(),x.memoizedState=[h,f],h},useReducer:function(h,f,x){var E=Fl();return f=x!==void 0?x(f):f,E.memoizedState=E.baseState=f,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:f},E.queue=h,h=h.dispatch=W8.bind(null,Ai,h),[E.memoizedState,h]},useRef:function(h){var f=Fl();return h={current:h},f.memoizedState=h},useState:SE,useDebugValue:wE,useDeferredValue:function(h){var f=SE(h),x=f[0],E=f[1];return bE(function(){var k=zo.transition;zo.transition={};try{E(h)}finally{zo.transition=k}},[h]),x},useTransition:function(){var h=SE(!1),f=h[0];return h=H8.bind(null,h[1]),Fl().memoizedState=h,[f,h]},useMutableSource:function(){},useSyncExternalStore:function(h,f,x){var E=Ai,k=Fl();if(ui){if(x===void 0)throw Error(o(407));x=x()}else{if(x=f(),Gi===null)throw Error(o(349));(jd&30)!==0||FL(E,f,x)}k.memoizedState=x;var N={value:x,getSnapshot:f};return k.queue=N,bE(HL.bind(null,E,N,h),[h]),E.flags|=2048,Em(9,zL.bind(null,E,N,x,f),void 0,null),x},useId:function(){var h=Fl(),f=Gi.identifierPrefix;if(ui){var x=Ul,E=Bl;x=(E&~(1<<32-Vn(E)-1)).toString(32)+x,f=":"+f+"R"+x,x=wm++,0<x&&(f+="H"+x.toString(32)),f+=":"}else x=z8++,f=":"+f+"r"+x.toString(32)+":";return h.memoizedState=f},unstable_isNewReconciler:!1},j8={readContext:Fi,useCallback:YL,useContext:Fi,useEffect:Cm,useImperativeHandle:qL,useInsertionEffect:GL,useLayoutEffect:jL,useMemo:KL,useReducer:hy,useRef:VL,useState:function(){return hy(oh)},useDebugValue:wE,useDeferredValue:function(h){var f=hy(oh),x=f[0],E=f[1];return Cm(function(){var k=zo.transition;zo.transition={};try{E(h)}finally{zo.transition=k}},[h]),x},useTransition:function(){var h=hy(oh)[0],f=el().memoizedState;return[h,f]},useMutableSource:BL,useSyncExternalStore:UL,useId:$L,unstable_isNewReconciler:!1},X8={readContext:Fi,useCallback:YL,useContext:Fi,useEffect:Cm,useImperativeHandle:qL,useInsertionEffect:GL,useLayoutEffect:jL,useMemo:KL,useReducer:dy,useRef:VL,useState:function(){return dy(oh)},useDebugValue:wE,useDeferredValue:function(h){var f=dy(oh),x=f[0],E=f[1];return Cm(function(){var k=zo.transition;zo.transition={};try{E(h)}finally{zo.transition=k}},[h]),x},useTransition:function(){var h=dy(oh)[0],f=el().memoizedState;return[h,f]},useMutableSource:BL,useSyncExternalStore:UL,useId:$L,unstable_isNewReconciler:!1};function EE(h,f){try{var x="",E=f;do x+=ih(E),E=E.return;while(E);var k=x}catch(N){k=`
Error generating stack: `+N.message+`
`+N.stack}return{value:h,source:f,stack:k}}function CE(h,f){try{console.error(f.value)}catch(x){setTimeout(function(){throw x})}}var q8=typeof WeakMap=="function"?WeakMap:Map;function tP(h,f,x){x=Ol(-1,x),x.tag=3,x.payload={element:null};var E=f.value;return x.callback=function(){Py||(Py=!0,VE=E),CE(h,f)},x}function nP(h,f,x){x=Ol(-1,x),x.tag=3;var E=h.type.getDerivedStateFromError;if(typeof E=="function"){var k=f.value;x.payload=function(){return E(k)},x.callback=function(){CE(h,f)}}var N=h.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(x.callback=function(){CE(h,f),typeof E!="function"&&(Rc===null?Rc=new Set([this]):Rc.add(this));var ee=f.stack;this.componentDidCatch(f.value,{componentStack:ee!==null?ee:""})}),x}function iP(h,f,x){var E=h.pingCache;if(E===null){E=h.pingCache=new q8;var k=new Set;E.set(f,k)}else k=E.get(f),k===void 0&&(k=new Set,E.set(f,k));k.has(x)||(k.add(x),h=aH.bind(null,h,f,x),f.then(h,h))}function rP(h){do{var f;if((f=h.tag===13)&&(f=h.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return h;h=h.return}while(h!==null);return null}function sP(h,f,x,E,k){return(h.mode&1)===0?(h===f?h.flags|=65536:(h.flags|=128,x.flags|=131072,x.flags&=-52805,x.tag===1&&(x.alternate===null?x.tag=17:(f=Ol(-1,1),f.tag=2,Ic(x,f))),x.lanes|=1),h):(h.flags|=65536,h.lanes=k,h)}function tl(h){h.flags|=4}function oP(h,f){if(h!==null&&h.child===f.child)return!0;if((f.flags&16)!==0)return!1;for(h=f.child;h!==null;){if((h.flags&12854)!==0||(h.subtreeFlags&12854)!==0)return!1;h=h.sibling}return!0}var Tm,Mm,gy,vy;if(Pe)Tm=function(h,f){for(var x=f.child;x!==null;){if(x.tag===5||x.tag===6)X(h,x.stateNode);else if(x.tag!==4&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===f)break;for(;x.sibling===null;){if(x.return===null||x.return===f)return;x=x.return}x.sibling.return=x.return,x=x.sibling}},Mm=function(){},gy=function(h,f,x,E,k){if(h=h.memoizedProps,h!==E){var N=f.stateNode,ee=Qa(Fo.current);x=ne(N,x,h,E,k,ee),(f.updateQueue=x)&&tl(f)}},vy=function(h,f,x,E){x!==E&&tl(f)};else if(Te){Tm=function(h,f,x,E){for(var k=f.child;k!==null;){if(k.tag===5){var N=k.stateNode;x&&E&&(N=kt(N,k.type,k.memoizedProps,k)),X(h,N)}else if(k.tag===6)N=k.stateNode,x&&E&&(N=un(N,k.memoizedProps,k)),X(h,N);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)N=k.child,N!==null&&(N.return=k),Tm(h,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===f)break;for(;k.sibling===null;){if(k.return===null||k.return===f)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};var aP=function(h,f,x,E){for(var k=f.child;k!==null;){if(k.tag===5){var N=k.stateNode;x&&E&&(N=kt(N,k.type,k.memoizedProps,k)),Xe(h,N)}else if(k.tag===6)N=k.stateNode,x&&E&&(N=un(N,k.memoizedProps,k)),Xe(h,N);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)N=k.child,N!==null&&(N.return=k),aP(h,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===f)break;for(;k.sibling===null;){if(k.return===null||k.return===f)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};Mm=function(h,f){var x=f.stateNode;if(!oP(h,f)){h=x.containerInfo;var E=Se(h);aP(E,f,!1,!1),x.pendingChildren=E,tl(f),Je(h,E)}},gy=function(h,f,x,E,k){var N=h.stateNode,ee=h.memoizedProps;if((h=oP(h,f))&&ee===E)f.stateNode=N;else{var ue=f.stateNode,He=Qa(Fo.current),rt=null;ee!==E&&(rt=ne(ue,x,ee,E,k,He)),h&&rt===null?f.stateNode=N:(N=Fe(N,rt,x,ee,E,f,h,ue),q(N,x,E,k,He)&&tl(f),f.stateNode=N,h?tl(f):Tm(N,f,!1,!1))}},vy=function(h,f,x,E){x!==E?(h=Qa(Vd.current),x=Qa(Fo.current),f.stateNode=$(E,h,x,f),tl(f)):f.stateNode=h.stateNode}}else Mm=function(){},gy=function(){},vy=function(){};function Am(h,f){if(!ui)switch(h.tailMode){case"hidden":f=h.tail;for(var x=null;f!==null;)f.alternate!==null&&(x=f),f=f.sibling;x===null?h.tail=null:x.sibling=null;break;case"collapsed":x=h.tail;for(var E=null;x!==null;)x.alternate!==null&&(E=x),x=x.sibling;E===null?f||h.tail===null?h.tail=null:h.tail.sibling=null:E.sibling=null}}function Vr(h){var f=h.alternate!==null&&h.alternate.child===h.child,x=0,E=0;if(f)for(var k=h.child;k!==null;)x|=k.lanes|k.childLanes,E|=k.subtreeFlags&14680064,E|=k.flags&14680064,k.return=h,k=k.sibling;else for(k=h.child;k!==null;)x|=k.lanes|k.childLanes,E|=k.subtreeFlags,E|=k.flags,k.return=h,k=k.sibling;return h.subtreeFlags|=E,h.childLanes=x,f}function Y8(h,f,x){var E=f.pendingProps;switch(uE(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(f),null;case 1:return nn(f.type)&&wn(),Vr(f),null;case 3:return E=f.stateNode,Gd(),Ke(St),Ke(Tt),vE(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(h===null||h.child===null)&&(_m(f)?tl(f):h===null||h.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,ma!==null&&(XE(ma),ma=null))),Mm(h,f),Vr(f),null;case 5:mE(f),x=Qa(Vd.current);var k=f.type;if(h!==null&&f.stateNode!=null)gy(h,f,k,E,x),h.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!E){if(f.stateNode===null)throw Error(o(166));return Vr(f),null}if(h=Qa(Fo.current),_m(f)){if(!De)throw Error(o(175));h=Ar(f.stateNode,f.type,f.memoizedProps,x,h,f,!vm),f.updateQueue=h,h!==null&&tl(f)}else{var N=D(k,E,x,h,f);Tm(N,f,!1,!1),f.stateNode=N,q(N,k,E,x,h)&&tl(f)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return Vr(f),null;case 6:if(h&&f.stateNode!=null)vy(h,f,h.memoizedProps,E);else{if(typeof E!="string"&&f.stateNode===null)throw Error(o(166));if(h=Qa(Vd.current),x=Qa(Fo.current),_m(f)){if(!De)throw Error(o(176));if(h=f.stateNode,E=f.memoizedProps,(x=Qs(h,E,f,!vm))&&(k=so,k!==null))switch(N=(k.mode&1)!==0,k.tag){case 3:Et(k.stateNode.containerInfo,h,E,N);break;case 5:Mn(k.type,k.memoizedProps,k.stateNode,h,E,N)}x&&tl(f)}else f.stateNode=$(E,h,x,f)}return Vr(f),null;case 13:if(Ke(vi),E=f.memoizedState,ui&&oo!==null&&(f.mode&1)!==0&&(f.flags&128)===0){for(h=oo;h;)h=Qi(h);return Hd(),f.flags|=98560,f}if(E!==null&&E.dehydrated!==null){if(E=_m(f),h===null){if(!E)throw Error(o(318));if(!De)throw Error(o(344));if(h=f.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(o(317));Il(h,f)}else Hd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;return Vr(f),null}return ma!==null&&(XE(ma),ma=null),(f.flags&128)!==0?(f.lanes=x,f):(E=E!==null,x=!1,h===null?_m(f):x=h.memoizedState!==null,E&&!x&&(f.child.flags|=8192,(f.mode&1)!==0&&(h===null||(vi.current&1)!==0?tr===0&&(tr=3):YE())),f.updateQueue!==null&&(f.flags|=4),Vr(f),null);case 4:return Gd(),Mm(h,f),h===null&&ve(f.stateNode.containerInfo),Vr(f),null;case 10:return fr(f.type._context),Vr(f),null;case 17:return nn(f.type)&&wn(),Vr(f),null;case 19:if(Ke(vi),k=f.memoizedState,k===null)return Vr(f),null;if(E=(f.flags&128)!==0,N=k.rendering,N===null)if(E)Am(k,!1);else{if(tr!==0||h!==null&&(h.flags&128)!==0)for(h=f.child;h!==null;){if(N=ly(h),N!==null){for(f.flags|=128,Am(k,!1),h=N.updateQueue,h!==null&&(f.updateQueue=h,f.flags|=4),f.subtreeFlags=0,h=x,E=f.child;E!==null;)x=E,k=h,x.flags&=14680066,N=x.alternate,N===null?(x.childLanes=0,x.lanes=k,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=N.childLanes,x.lanes=N.lanes,x.child=N.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=N.memoizedProps,x.memoizedState=N.memoizedState,x.updateQueue=N.updateQueue,x.type=N.type,k=N.dependencies,x.dependencies=k===null?null:{lanes:k.lanes,firstContext:k.firstContext}),E=E.sibling;return tt(vi,vi.current&1|2),f.child}h=h.sibling}k.tail!==null&&gi()>WE&&(f.flags|=128,E=!0,Am(k,!1),f.lanes=4194304)}else{if(!E)if(h=ly(N),h!==null){if(f.flags|=128,E=!0,h=h.updateQueue,h!==null&&(f.updateQueue=h,f.flags|=4),Am(k,!0),k.tail===null&&k.tailMode==="hidden"&&!N.alternate&&!ui)return Vr(f),null}else 2*gi()-k.renderingStartTime>WE&&x!==1073741824&&(f.flags|=128,E=!0,Am(k,!1),f.lanes=4194304);k.isBackwards?(N.sibling=f.child,f.child=N):(h=k.last,h!==null?h.sibling=N:f.child=N,k.last=N)}return k.tail!==null?(f=k.tail,k.rendering=f,k.tail=f.sibling,k.renderingStartTime=gi(),f.sibling=null,h=vi.current,tt(vi,E?h&1|2:h&1),f):(Vr(f),null);case 22:case 23:return qE(),E=f.memoizedState!==null,h!==null&&h.memoizedState!==null!==E&&(f.flags|=8192),E&&(f.mode&1)!==0?(lo&1073741824)!==0&&(Vr(f),Pe&&f.subtreeFlags&6&&(f.flags|=8192)):Vr(f),null;case 24:return null;case 25:return null}throw Error(o(156,f.tag))}var K8=a.ReactCurrentOwner,ao=!1;function hs(h,f,x,E){f.child=h===null?NL(f,null,x,E):Wd(f,h.child,x,E)}function lP(h,f,x,E,k){x=x.render;var N=f.ref;return Ui(f,k),E=yE(h,f,x,E,N,k),x=xE(),h!==null&&!ao?(f.updateQueue=h.updateQueue,f.flags&=-2053,h.lanes&=~k,zl(h,f,k)):(ui&&x&&cE(f),f.flags|=1,hs(h,f,E,k),f.child)}function cP(h,f,x,E,k){if(h===null){var N=x.type;return typeof N=="function"&&!KE(N)&&N.defaultProps===void 0&&x.compare===null&&x.defaultProps===void 0?(f.tag=15,f.type=N,uP(h,f,N,E,k)):(h=Uy(x.type,null,E,f,f.mode,k),h.ref=f.ref,h.return=f,f.child=h)}if(N=h.child,(h.lanes&k)===0){var ee=N.memoizedProps;if(x=x.compare,x=x!==null?x:nh,x(ee,E)&&h.ref===f.ref)return zl(h,f,k)}return f.flags|=1,h=Uc(N,E),h.ref=f.ref,h.return=f,f.child=h}function uP(h,f,x,E,k){if(h!==null&&nh(h.memoizedProps,E)&&h.ref===f.ref)if(ao=!1,(h.lanes&k)!==0)(h.flags&131072)!==0&&(ao=!0);else return f.lanes=h.lanes,zl(h,f,k);return TE(h,f,x,E,k)}function hP(h,f,x){var E=f.pendingProps,k=E.children,N=h!==null?h.memoizedState:null;if(E.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null},tt(Xd,lo),lo|=x;else if((x&1073741824)!==0)f.memoizedState={baseLanes:0,cachePool:null},E=N!==null?N.baseLanes:x,tt(Xd,lo),lo|=E;else return h=N!==null?N.baseLanes|x:x,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:h,cachePool:null},f.updateQueue=null,tt(Xd,lo),lo|=h,null;else N!==null?(E=N.baseLanes|x,f.memoizedState=null):E=x,tt(Xd,lo),lo|=E;return hs(h,f,k,x),f.child}function dP(h,f){var x=f.ref;(h===null&&x!==null||h!==null&&h.ref!==x)&&(f.flags|=512,f.flags|=2097152)}function TE(h,f,x,E,k){var N=nn(x)?zt:Tt.current;return N=tn(f,N),Ui(f,k),x=yE(h,f,x,E,N,k),E=xE(),h!==null&&!ao?(f.updateQueue=h.updateQueue,f.flags&=-2053,h.lanes&=~k,zl(h,f,k)):(ui&&E&&cE(f),f.flags|=1,hs(h,f,x,k),f.child)}function fP(h,f,x,E,k){if(nn(x)){var N=!0;hn(f)}else N=!1;if(Ui(f,k),f.stateNode===null)h!==null&&(h.alternate=null,f.alternate=null,f.flags|=2),ML(f,x,E),lE(f,x,E,k),E=!0;else if(h===null){var ee=f.stateNode,ue=f.memoizedProps;ee.props=ue;var He=ee.context,rt=x.contextType;typeof rt=="object"&&rt!==null?rt=Fi(rt):(rt=nn(x)?zt:Tt.current,rt=tn(f,rt));var Lt=x.getDerivedStateFromProps,Kt=typeof Lt=="function"||typeof ee.getSnapshotBeforeUpdate=="function";Kt||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(ue!==E||He!==rt)&&AL(f,ee,E,rt),Dc=!1;var Bt=f.memoizedState;ee.state=Bt,iy(f,E,ee,k),He=f.memoizedState,ue!==E||Bt!==He||St.current||Dc?(typeof Lt=="function"&&(aE(f,x,Lt,E),He=f.memoizedState),(ue=Dc||TL(f,x,ue,E,Bt,He,rt))?(Kt||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount()),typeof ee.componentDidMount=="function"&&(f.flags|=4194308)):(typeof ee.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=E,f.memoizedState=He),ee.props=E,ee.state=He,ee.context=rt,E=ue):(typeof ee.componentDidMount=="function"&&(f.flags|=4194308),E=!1)}else{ee=f.stateNode,bL(h,f),ue=f.memoizedProps,rt=f.type===f.elementType?ue:cs(f.type,ue),ee.props=rt,Kt=f.pendingProps,Bt=ee.context,He=x.contextType,typeof He=="object"&&He!==null?He=Fi(He):(He=nn(x)?zt:Tt.current,He=tn(f,He));var Gn=x.getDerivedStateFromProps;(Lt=typeof Gn=="function"||typeof ee.getSnapshotBeforeUpdate=="function")||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(ue!==Kt||Bt!==He)&&AL(f,ee,E,He),Dc=!1,Bt=f.memoizedState,ee.state=Bt,iy(f,E,ee,k);var Nt=f.memoizedState;ue!==Kt||Bt!==Nt||St.current||Dc?(typeof Gn=="function"&&(aE(f,x,Gn,E),Nt=f.memoizedState),(rt=Dc||TL(f,x,rt,E,Bt,Nt,He)||!1)?(Lt||typeof ee.UNSAFE_componentWillUpdate!="function"&&typeof ee.componentWillUpdate!="function"||(typeof ee.componentWillUpdate=="function"&&ee.componentWillUpdate(E,Nt,He),typeof ee.UNSAFE_componentWillUpdate=="function"&&ee.UNSAFE_componentWillUpdate(E,Nt,He)),typeof ee.componentDidUpdate=="function"&&(f.flags|=4),typeof ee.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof ee.componentDidUpdate!="function"||ue===h.memoizedProps&&Bt===h.memoizedState||(f.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||ue===h.memoizedProps&&Bt===h.memoizedState||(f.flags|=1024),f.memoizedProps=E,f.memoizedState=Nt),ee.props=E,ee.state=Nt,ee.context=He,E=rt):(typeof ee.componentDidUpdate!="function"||ue===h.memoizedProps&&Bt===h.memoizedState||(f.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||ue===h.memoizedProps&&Bt===h.memoizedState||(f.flags|=1024),E=!1)}return ME(h,f,x,E,N,k)}function ME(h,f,x,E,k,N){dP(h,f);var ee=(f.flags&128)!==0;if(!E&&!ee)return k&&jt(f,x,!1),zl(h,f,N);E=f.stateNode,K8.current=f;var ue=ee&&typeof x.getDerivedStateFromError!="function"?null:E.render();return f.flags|=1,h!==null&&ee?(f.child=Wd(f,h.child,null,N),f.child=Wd(f,null,ue,N)):hs(h,f,ue,N),f.memoizedState=E.state,k&&jt(f,x,!0),f.child}function pP(h){var f=h.stateNode;f.pendingContext?En(h,f.pendingContext,f.pendingContext!==f.context):f.context&&En(h,f.context,!1),pE(h,f.containerInfo)}function mP(h,f,x,E,k){return Hd(),fE(k),f.flags|=256,hs(h,f,x,E),f.child}var _y={dehydrated:null,treeContext:null,retryLane:0};function yy(h){return{baseLanes:h,cachePool:null}}function gP(h,f,x){var E=f.pendingProps,k=vi.current,N=!1,ee=(f.flags&128)!==0,ue;if((ue=ee)||(ue=h!==null&&h.memoizedState===null?!1:(k&2)!==0),ue?(N=!0,f.flags&=-129):(h===null||h.memoizedState!==null)&&(k|=1),tt(vi,k&1),h===null)return dE(f),h=f.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?((f.mode&1)===0?f.lanes=1:Yn(h)?f.lanes=8:f.lanes=1073741824,null):(k=E.children,h=E.fallback,N?(E=f.mode,N=f.child,k={mode:"hidden",children:k},(E&1)===0&&N!==null?(N.childLanes=0,N.pendingProps=k):N=Fy(k,E,0,null),h=dh(h,E,x,null),N.return=f,h.return=f,N.sibling=h,f.child=N,f.child.memoizedState=yy(x),f.memoizedState=_y,h):AE(f,k));if(k=h.memoizedState,k!==null){if(ue=k.dehydrated,ue!==null){if(ee)return f.flags&256?(f.flags&=-257,xy(h,f,x,Error(o(422)))):f.memoizedState!==null?(f.child=h.child,f.flags|=128,null):(N=E.fallback,k=f.mode,E=Fy({mode:"visible",children:E.children},k,0,null),N=dh(N,k,x,null),N.flags|=2,E.return=f,N.return=f,E.sibling=N,f.child=E,(f.mode&1)!==0&&Wd(f,h.child,null,x),f.child.memoizedState=yy(x),f.memoizedState=_y,N);if((f.mode&1)===0)f=xy(h,f,x,null);else if(Yn(ue))f=xy(h,f,x,Error(o(419)));else if(E=(x&h.childLanes)!==0,ao||E){if(E=Gi,E!==null){switch(x&-x){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}E=(N&(E.suspendedLanes|x))!==0?0:N,E!==0&&E!==k.retryLane&&(k.retryLane=E,Ho(h,E,-1))}YE(),f=xy(h,f,x,Error(o(421)))}else Mr(ue)?(f.flags|=128,f.child=h.child,f=lH.bind(null,h),Oi(ue,f),f=null):(x=k.treeContext,De&&(oo=os(ue),so=f,ui=!0,ma=null,vm=!1,x!==null&&(Bo[Uo++]=Bl,Bo[Uo++]=Ul,Bo[Uo++]=rh,Bl=x.id,Ul=x.overflow,rh=f)),f=AE(f,f.pendingProps.children),f.flags|=4096);return f}return N?(E=_P(h,f,E.children,E.fallback,x),N=f.child,k=h.child.memoizedState,N.memoizedState=k===null?yy(x):{baseLanes:k.baseLanes|x,cachePool:null},N.childLanes=h.childLanes&~x,f.memoizedState=_y,E):(x=vP(h,f,E.children,x),f.memoizedState=null,x)}return N?(E=_P(h,f,E.children,E.fallback,x),N=f.child,k=h.child.memoizedState,N.memoizedState=k===null?yy(x):{baseLanes:k.baseLanes|x,cachePool:null},N.childLanes=h.childLanes&~x,f.memoizedState=_y,E):(x=vP(h,f,E.children,x),f.memoizedState=null,x)}function AE(h,f){return f=Fy({mode:"visible",children:f},h.mode,0,null),f.return=h,h.child=f}function vP(h,f,x,E){var k=h.child;return h=k.sibling,x=Uc(k,{mode:"visible",children:x}),(f.mode&1)===0&&(x.lanes=E),x.return=f,x.sibling=null,h!==null&&(E=f.deletions,E===null?(f.deletions=[h],f.flags|=16):E.push(h)),f.child=x}function _P(h,f,x,E,k){var N=f.mode;h=h.child;var ee=h.sibling,ue={mode:"hidden",children:x};return(N&1)===0&&f.child!==h?(x=f.child,x.childLanes=0,x.pendingProps=ue,f.deletions=null):(x=Uc(h,ue),x.subtreeFlags=h.subtreeFlags&14680064),ee!==null?E=Uc(ee,E):(E=dh(E,N,k,null),E.flags|=2),E.return=f,x.return=f,x.sibling=E,f.child=x,E}function xy(h,f,x,E){return E!==null&&fE(E),Wd(f,h.child,null,x),h=AE(f,f.pendingProps.children),h.flags|=2,f.memoizedState=null,h}function yP(h,f,x){h.lanes|=f;var E=h.alternate;E!==null&&(E.lanes|=f),us(h.return,f,x)}function kE(h,f,x,E,k){var N=h.memoizedState;N===null?h.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:E,tail:x,tailMode:k}:(N.isBackwards=f,N.rendering=null,N.renderingStartTime=0,N.last=E,N.tail=x,N.tailMode=k)}function xP(h,f,x){var E=f.pendingProps,k=E.revealOrder,N=E.tail;if(hs(h,f,E.children,x),E=vi.current,(E&2)!==0)E=E&1|2,f.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=f.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&yP(h,x,f);else if(h.tag===19)yP(h,x,f);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===f)break e;for(;h.sibling===null;){if(h.return===null||h.return===f)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}E&=1}if(tt(vi,E),(f.mode&1)===0)f.memoizedState=null;else switch(k){case"forwards":for(x=f.child,k=null;x!==null;)h=x.alternate,h!==null&&ly(h)===null&&(k=x),x=x.sibling;x=k,x===null?(k=f.child,f.child=null):(k=x.sibling,x.sibling=null),kE(f,!1,k,x,N);break;case"backwards":for(x=null,k=f.child,f.child=null;k!==null;){if(h=k.alternate,h!==null&&ly(h)===null){f.child=k;break}h=k.sibling,k.sibling=x,x=k,k=h}kE(f,!0,x,null,N);break;case"together":kE(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function zl(h,f,x){if(h!==null&&(f.dependencies=h.dependencies),qd|=f.lanes,(x&f.childLanes)===0)return null;if(h!==null&&f.child!==h.child)throw Error(o(153));if(f.child!==null){for(h=f.child,x=Uc(h,h.pendingProps),f.child=x,x.return=f;h.sibling!==null;)h=h.sibling,x=x.sibling=Uc(h,h.pendingProps),x.return=f;x.sibling=null}return f.child}function $8(h,f,x){switch(f.tag){case 3:pP(f),Hd();break;case 5:OL(f);break;case 1:nn(f.type)&&hn(f);break;case 4:pE(f,f.stateNode.containerInfo);break;case 10:ty(f,f.type._context,f.memoizedProps.value);break;case 13:var E=f.memoizedState;if(E!==null)return E.dehydrated!==null?(tt(vi,vi.current&1),f.flags|=128,null):(x&f.child.childLanes)!==0?gP(h,f,x):(tt(vi,vi.current&1),h=zl(h,f,x),h!==null?h.sibling:null);tt(vi,vi.current&1);break;case 19:if(E=(x&f.childLanes)!==0,(h.flags&128)!==0){if(E)return xP(h,f,x);f.flags|=128}var k=f.memoizedState;if(k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),tt(vi,vi.current),E)break;return null;case 22:case 23:return f.lanes=0,hP(h,f,x)}return zl(h,f,x)}function J8(h,f){switch(uE(f),f.tag){case 1:return nn(f.type)&&wn(),h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 3:return Gd(),Ke(St),Ke(Tt),vE(),h=f.flags,(h&65536)!==0&&(h&128)===0?(f.flags=h&-65537|128,f):null;case 5:return mE(f),null;case 13:if(Ke(vi),h=f.memoizedState,h!==null&&h.dehydrated!==null){if(f.alternate===null)throw Error(o(340));Hd()}return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 19:return Ke(vi),null;case 4:return Gd(),null;case 10:return fr(f.type._context),null;case 22:case 23:return qE(),null;case 24:return null;default:return null}}var Sy=!1,ah=!1,Z8=typeof WeakSet=="function"?WeakSet:Set,vt=null;function by(h,f){var x=h.ref;if(x!==null)if(typeof x=="function")try{x(null)}catch(E){Rs(h,f,E)}else x.current=null}function LE(h,f,x){try{x()}catch(E){Rs(h,f,E)}}var SP=!1;function Q8(h,f){for(J(h.containerInfo),vt=f;vt!==null;)if(h=vt,f=h.child,(h.subtreeFlags&1028)!==0&&f!==null)f.return=h,vt=f;else for(;vt!==null;){h=vt;try{var x=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var E=x.memoizedProps,k=x.memoizedState,N=h.stateNode,ee=N.getSnapshotBeforeUpdate(h.elementType===h.type?E:cs(h.type,E),k);N.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:Pe&&it(h.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(ue){Rs(h,h.return,ue)}if(f=h.sibling,f!==null){f.return=h.return,vt=f;break}vt=h.return}return x=SP,SP=!1,x}function lh(h,f,x){var E=f.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var k=E=E.next;do{if((k.tag&h)===h){var N=k.destroy;k.destroy=void 0,N!==void 0&&LE(f,x,N)}k=k.next}while(k!==E)}}function km(h,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var x=f=f.next;do{if((x.tag&h)===h){var E=x.create;x.destroy=E()}x=x.next}while(x!==f)}}function PE(h){var f=h.ref;if(f!==null){var x=h.stateNode;h.tag===5?h=U(x):h=x,typeof f=="function"?f(h):f.current=h}}function bP(h,f,x){if(no&&typeof no.onCommitFiberUnmount=="function")try{no.onCommitFiberUnmount(eh,f)}catch{}switch(f.tag){case 0:case 11:case 14:case 15:if(h=f.updateQueue,h!==null&&(h=h.lastEffect,h!==null)){var E=h=h.next;do{var k=E,N=k.destroy;k=k.tag,N!==void 0&&((k&2)!==0||(k&4)!==0)&&LE(f,x,N),E=E.next}while(E!==h)}break;case 1:if(by(f,x),h=f.stateNode,typeof h.componentWillUnmount=="function")try{h.props=f.memoizedProps,h.state=f.memoizedState,h.componentWillUnmount()}catch(ee){Rs(f,x,ee)}break;case 5:by(f,x);break;case 4:Pe?AP(h,f,x):Te&&Te&&(f=f.stateNode.containerInfo,x=Se(f),ot(f,x))}}function wP(h,f,x){for(var E=f;;)if(bP(h,E,x),E.child===null||Pe&&E.tag===4){if(E===f)break;for(;E.sibling===null;){if(E.return===null||E.return===f)return;E=E.return}E.sibling.return=E.return,E=E.sibling}else E.child.return=E,E=E.child}function EP(h){var f=h.alternate;f!==null&&(h.alternate=null,EP(f)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(f=h.stateNode,f!==null&&Ie(f)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function CP(h){return h.tag===5||h.tag===3||h.tag===4}function TP(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||CP(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function MP(h){if(Pe){e:{for(var f=h.return;f!==null;){if(CP(f))break e;f=f.return}throw Error(o(160))}var x=f;switch(x.tag){case 5:f=x.stateNode,x.flags&32&&(ce(f),x.flags&=-33),x=TP(h),IE(h,x,f);break;case 3:case 4:f=x.stateNode.containerInfo,x=TP(h),DE(h,x,f);break;default:throw Error(o(161))}}}function DE(h,f,x){var E=h.tag;if(E===5||E===6)h=h.stateNode,f?Ve(x,h,f):je(x,h);else if(E!==4&&(h=h.child,h!==null))for(DE(h,f,x),h=h.sibling;h!==null;)DE(h,f,x),h=h.sibling}function IE(h,f,x){var E=h.tag;if(E===5||E===6)h=h.stateNode,f?Ae(x,h,f):ae(x,h);else if(E!==4&&(h=h.child,h!==null))for(IE(h,f,x),h=h.sibling;h!==null;)IE(h,f,x),h=h.sibling}function AP(h,f,x){for(var E=f,k=!1,N,ee;;){if(!k){k=E.return;e:for(;;){if(k===null)throw Error(o(160));switch(N=k.stateNode,k.tag){case 5:ee=!1;break e;case 3:N=N.containerInfo,ee=!0;break e;case 4:N=N.containerInfo,ee=!0;break e}k=k.return}k=!0}if(E.tag===5||E.tag===6)wP(h,E,x),ee?Q(N,E.stateNode):Ue(N,E.stateNode);else if(E.tag===18)ee?se(N,E.stateNode):Pt(N,E.stateNode);else if(E.tag===4){if(E.child!==null){N=E.stateNode.containerInfo,ee=!0,E.child.return=E,E=E.child;continue}}else if(bP(h,E,x),E.child!==null){E.child.return=E,E=E.child;continue}if(E===f)break;for(;E.sibling===null;){if(E.return===null||E.return===f)return;E=E.return,E.tag===4&&(k=!1)}E.sibling.return=E.return,E=E.sibling}}function RE(h,f){if(Pe){switch(f.tag){case 0:case 11:case 14:case 15:lh(3,f,f.return),km(3,f),lh(5,f,f.return);return;case 1:return;case 5:var x=f.stateNode;if(x!=null){var E=f.memoizedProps;h=h!==null?h.memoizedProps:E;var k=f.type,N=f.updateQueue;f.updateQueue=null,N!==null&&ct(x,N,k,h,E,f)}return;case 6:if(f.stateNode===null)throw Error(o(162));x=f.memoizedProps,ze(f.stateNode,h!==null?h.memoizedProps:x,x);return;case 3:De&&h!==null&&h.memoizedState.isDehydrated&&eo(f.stateNode.containerInfo);return;case 12:return;case 13:wy(f);return;case 19:wy(f);return;case 17:return}throw Error(o(163))}switch(f.tag){case 0:case 11:case 14:case 15:lh(3,f,f.return),km(3,f),lh(5,f,f.return);return;case 12:return;case 13:wy(f);return;case 19:wy(f);return;case 3:De&&h!==null&&h.memoizedState.isDehydrated&&eo(f.stateNode.containerInfo);break;case 22:case 23:return}e:if(Te){switch(f.tag){case 1:case 5:case 6:break e;case 3:case 4:f=f.stateNode,ot(f.containerInfo,f.pendingChildren);break e}throw Error(o(163))}}function wy(h){var f=h.updateQueue;if(f!==null){h.updateQueue=null;var x=h.stateNode;x===null&&(x=h.stateNode=new Z8),f.forEach(function(E){var k=cH.bind(null,h,E);x.has(E)||(x.add(E),E.then(k,k))})}}function eH(h,f){for(vt=f;vt!==null;){f=vt;var x=f.deletions;if(x!==null)for(var E=0;E<x.length;E++){var k=x[E];try{var N=h;Pe?AP(N,k,f):wP(N,k,f);var ee=k.alternate;ee!==null&&(ee.return=null),k.return=null}catch(Rt){Rs(k,f,Rt)}}if(x=f.child,(f.subtreeFlags&12854)!==0&&x!==null)x.return=f,vt=x;else for(;vt!==null;){f=vt;try{var ue=f.flags;if(ue&32&&Pe&&ce(f.stateNode),ue&512){var He=f.alternate;if(He!==null){var rt=He.ref;rt!==null&&(typeof rt=="function"?rt(null):rt.current=null)}}if(ue&8192)switch(f.tag){case 13:if(f.memoizedState!==null){var Lt=f.alternate;(Lt===null||Lt.memoizedState===null)&&(HE=gi())}break;case 22:var Kt=f.memoizedState!==null,Bt=f.alternate,Gn=Bt!==null&&Bt.memoizedState!==null;if(x=f,Pe){e:if(E=x,k=Kt,N=null,Pe)for(var Nt=E;;){if(Nt.tag===5){if(N===null){N=Nt;var Gr=Nt.stateNode;k?Ye(Gr):we(Nt.stateNode,Nt.memoizedProps)}}else if(Nt.tag===6){if(N===null){var Vo=Nt.stateNode;k?te(Vo):Be(Vo,Nt.memoizedProps)}}else if((Nt.tag!==22&&Nt.tag!==23||Nt.memoizedState===null||Nt===E)&&Nt.child!==null){Nt.child.return=Nt,Nt=Nt.child;continue}if(Nt===E)break;for(;Nt.sibling===null;){if(Nt.return===null||Nt.return===E)break e;N===Nt&&(N=null),Nt=Nt.return}N===Nt&&(N=null),Nt.sibling.return=Nt.return,Nt=Nt.sibling}}if(Kt&&!Gn&&(x.mode&1)!==0){vt=x;for(var be=x.child;be!==null;){for(x=vt=be;vt!==null;){E=vt;var de=E.child;switch(E.tag){case 0:case 11:case 14:case 15:lh(4,E,E.return);break;case 1:by(E,E.return);var Re=E.stateNode;if(typeof Re.componentWillUnmount=="function"){var yt=E.return;try{Re.props=E.memoizedProps,Re.state=E.memoizedState,Re.componentWillUnmount()}catch(Rt){Rs(E,yt,Rt)}}break;case 5:by(E,E.return);break;case 22:if(E.memoizedState!==null){PP(x);continue}}de!==null?(de.return=E,vt=de):PP(x)}be=be.sibling}}}switch(ue&4102){case 2:MP(f),f.flags&=-3;break;case 6:MP(f),f.flags&=-3,RE(f.alternate,f);break;case 4096:f.flags&=-4097;break;case 4100:f.flags&=-4097,RE(f.alternate,f);break;case 4:RE(f.alternate,f)}}catch(Rt){Rs(f,f.return,Rt)}if(x=f.sibling,x!==null){x.return=f.return,vt=x;break}vt=f.return}}}function tH(h,f,x){vt=h,kP(h,f,x)}function kP(h,f,x){for(var E=(h.mode&1)!==0;vt!==null;){var k=vt,N=k.child;if(k.tag===22&&E){var ee=k.memoizedState!==null||Sy;if(!ee){var ue=k.alternate,He=ue!==null&&ue.memoizedState!==null||ah;ue=Sy;var rt=ah;if(Sy=ee,(ah=He)&&!rt)for(vt=k;vt!==null;)ee=vt,He=ee.child,ee.tag===22&&ee.memoizedState!==null?DP(k):He!==null?(He.return=ee,vt=He):DP(k);for(;N!==null;)vt=N,kP(N,f,x),N=N.sibling;vt=k,Sy=ue,ah=rt}LP(h,f,x)}else(k.subtreeFlags&8772)!==0&&N!==null?(N.return=k,vt=N):LP(h,f,x)}}function LP(h){for(;vt!==null;){var f=vt;if((f.flags&8772)!==0){var x=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:ah||km(5,f);break;case 1:var E=f.stateNode;if(f.flags&4&&!ah)if(x===null)E.componentDidMount();else{var k=f.elementType===f.type?x.memoizedProps:cs(f.type,x.memoizedProps);E.componentDidUpdate(k,x.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var N=f.updateQueue;N!==null&&EL(f,N,E);break;case 3:var ee=f.updateQueue;if(ee!==null){if(x=null,f.child!==null)switch(f.child.tag){case 5:x=U(f.child.stateNode);break;case 1:x=f.child.stateNode}EL(f,ee,x)}break;case 5:var ue=f.stateNode;x===null&&f.flags&4&&Qe(ue,f.type,f.memoizedProps,f);break;case 6:break;case 4:break;case 12:break;case 13:if(De&&f.memoizedState===null){var He=f.alternate;if(He!==null){var rt=He.memoizedState;if(rt!==null){var Lt=rt.dehydrated;Lt!==null&&Ya(Lt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}ah||f.flags&512&&PE(f)}catch(Kt){Rs(f,f.return,Kt)}}if(f===h){vt=null;break}if(x=f.sibling,x!==null){x.return=f.return,vt=x;break}vt=f.return}}function PP(h){for(;vt!==null;){var f=vt;if(f===h){vt=null;break}var x=f.sibling;if(x!==null){x.return=f.return,vt=x;break}vt=f.return}}function DP(h){for(;vt!==null;){var f=vt;try{switch(f.tag){case 0:case 11:case 15:var x=f.return;try{km(4,f)}catch(He){Rs(f,x,He)}break;case 1:var E=f.stateNode;if(typeof E.componentDidMount=="function"){var k=f.return;try{E.componentDidMount()}catch(He){Rs(f,k,He)}}var N=f.return;try{PE(f)}catch(He){Rs(f,N,He)}break;case 5:var ee=f.return;try{PE(f)}catch(He){Rs(f,ee,He)}}}catch(He){Rs(f,f.return,He)}if(f===h){vt=null;break}var ue=f.sibling;if(ue!==null){ue.return=f.return,vt=ue;break}vt=f.return}}var Ey=0,Cy=1,Ty=2,My=3,Ay=4;if(typeof Symbol=="function"&&Symbol.for){var Lm=Symbol.for;Ey=Lm("selector.component"),Cy=Lm("selector.has_pseudo_class"),Ty=Lm("selector.role"),My=Lm("selector.test_id"),Ay=Lm("selector.text")}function NE(h){var f=me(h);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(o(364));return f}if(h=_e(h),h===null)throw Error(o(362));return h.stateNode.current}function OE(h,f){switch(f.$$typeof){case Ey:if(h.type===f.value)return!0;break;case Cy:e:{f=f.value,h=[h,0];for(var x=0;x<h.length;){var E=h[x++],k=h[x++],N=f[k];if(E.tag!==5||!R(E)){for(;N!=null&&OE(E,N);)k++,N=f[k];if(k===f.length){f=!0;break e}else for(E=E.child;E!==null;)h.push(E,k),E=E.sibling}}f=!1}return f;case Ty:if(h.tag===5&&Z(h.stateNode,f.value))return!0;break;case Ay:if((h.tag===5||h.tag===6)&&(h=W(h),h!==null&&0<=h.indexOf(f.value)))return!0;break;case My:if(h.tag===5&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function BE(h){switch(h.$$typeof){case Ey:return"<"+(L(h.value)||"Unknown")+">";case Cy:return":has("+(BE(h)||"")+")";case Ty:return'[role="'+h.value+'"]';case Ay:return'"'+h.value+'"';case My:return'[data-testname="'+h.value+'"]';default:throw Error(o(365))}}function IP(h,f){var x=[];h=[h,0];for(var E=0;E<h.length;){var k=h[E++],N=h[E++],ee=f[N];if(k.tag!==5||!R(k)){for(;ee!=null&&OE(k,ee);)N++,ee=f[N];if(N===f.length)x.push(k);else for(k=k.child;k!==null;)h.push(k,N),k=k.sibling}}return x}function UE(h,f){if(!Me)throw Error(o(363));h=NE(h),h=IP(h,f),f=[],h=Array.from(h);for(var x=0;x<h.length;){var E=h[x++];if(E.tag===5)R(E)||f.push(E.stateNode);else for(E=E.child;E!==null;)h.push(E),E=E.sibling}return f}var nH=Math.ceil,ky=a.ReactCurrentDispatcher,FE=a.ReactCurrentOwner,zi=a.ReactCurrentBatchConfig,ln=0,Gi=null,ji=null,Lr=0,lo=0,Xd=at(0),tr=0,Pm=null,qd=0,Ly=0,zE=0,Dm=null,Ds=null,HE=0,WE=1/0;function Yd(){WE=gi()+500}var Py=!1,VE=null,Rc=null,Dy=!1,Nc=null,Iy=0,Im=0,GE=null,Ry=-1,Ny=0;function ds(){return(ln&6)!==0?gi():Ry!==-1?Ry:Ry=gi()}function Oc(h){return(h.mode&1)===0?1:(ln&2)!==0&&Lr!==0?Lr&-Lr:th.transition!==null?(Ny===0&&(h=_n,_n<<=1,(_n&4194240)===0&&(_n=64),Ny=h),Ny):(h=dn,h!==0?h:ge())}function Ho(h,f,x){if(50<Im)throw Im=0,GE=null,Error(o(185));var E=Oy(h,f);return E===null?null:($a(E,f,x),((ln&2)===0||E!==Gi)&&(E===Gi&&((ln&2)===0&&(Ly|=f),tr===4&&Bc(E,Lr)),Is(E,x),f===1&&ln===0&&(h.mode&1)===0&&(Yd(),Za&&Ps())),E)}function Oy(h,f){h.lanes|=f;var x=h.alternate;for(x!==null&&(x.lanes|=f),x=h,h=h.return;h!==null;)h.childLanes|=f,x=h.alternate,x!==null&&(x.childLanes|=f),x=h,h=h.return;return x.tag===3?x.stateNode:null}function Is(h,f){var x=h.callbackNode;Rl(h,f);var E=mi(h,h===Gi?Lr:0);if(E===0)x!==null&&Od(x),h.callbackNode=null,h.callbackPriority=0;else if(f=E&-E,h.callbackPriority!==f){if(x!=null&&Od(x),f===1)h.tag===0?gm(NP.bind(null,h)):mm(NP.bind(null,h)),V?Ge(function(){ln===0&&Ps()}):Nl(Qu,Ps),x=null;else{switch(hm(E)){case 1:x=Qu;break;case 4:x=Q_;break;case 16:x=as;break;case 536870912:x=fm;break;default:x=as}x=GP(x,RP.bind(null,h))}h.callbackPriority=f,h.callbackNode=x}}function RP(h,f){if(Ry=-1,Ny=0,(ln&6)!==0)throw Error(o(327));var x=h.callbackNode;if(hh()&&h.callbackNode!==x)return null;var E=mi(h,h===Gi?Lr:0);if(E===0)return null;if((E&30)!==0||(E&h.expiredLanes)!==0||f)f=By(h,E);else{f=E;var k=ln;ln|=2;var N=UP();(Gi!==h||Lr!==f)&&(Yd(),ch(h,f));do try{sH();break}catch(ue){BP(h,ue)}while(!0);Ud(),ky.current=N,ln=k,ji!==null?f=0:(Gi=null,Lr=0,f=tr)}if(f!==0){if(f===2&&(k=kr(h),k!==0&&(E=k,f=jE(h,k))),f===1)throw x=Pm,ch(h,0),Bc(h,E),Is(h,gi()),x;if(f===6)Bc(h,E);else{if(k=h.current.alternate,(E&30)===0&&!iH(k)&&(f=By(h,E),f===2&&(N=kr(h),N!==0&&(E=N,f=jE(h,N))),f===1))throw x=Pm,ch(h,0),Bc(h,E),Is(h,gi()),x;switch(h.finishedWork=k,h.finishedLanes=E,f){case 0:case 1:throw Error(o(345));case 2:uh(h,Ds);break;case 3:if(Bc(h,E),(E&130023424)===E&&(f=HE+500-gi(),10<f)){if(mi(h,0)!==0)break;if(k=h.suspendedLanes,(k&E)!==E){ds(),h.pingedLanes|=h.suspendedLanes&k;break}h.timeoutHandle=ie(uh.bind(null,h,Ds),f);break}uh(h,Ds);break;case 4:if(Bc(h,E),(E&4194240)===E)break;for(f=h.eventTimes,k=-1;0<E;){var ee=31-Vn(E);N=1<<ee,ee=f[ee],ee>k&&(k=ee),E&=~N}if(E=k,E=gi()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*nH(E/1960))-E,10<E){h.timeoutHandle=ie(uh.bind(null,h,Ds),E);break}uh(h,Ds);break;case 5:uh(h,Ds);break;default:throw Error(o(329))}}}return Is(h,gi()),h.callbackNode===x?RP.bind(null,h):null}function jE(h,f){var x=Dm;return h.current.memoizedState.isDehydrated&&(ch(h,f).flags|=256),h=By(h,f),h!==2&&(f=Ds,Ds=x,f!==null&&XE(f)),h}function XE(h){Ds===null?Ds=h:Ds.push.apply(Ds,h)}function iH(h){for(var f=h;;){if(f.flags&16384){var x=f.updateQueue;if(x!==null&&(x=x.stores,x!==null))for(var E=0;E<x.length;E++){var k=x[E],N=k.getSnapshot;k=k.value;try{if(!io(N(),k))return!1}catch{return!1}}}if(x=f.child,f.subtreeFlags&16384&&x!==null)x.return=f,f=x;else{if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Bc(h,f){for(f&=~zE,f&=~Ly,h.suspendedLanes|=f,h.pingedLanes&=~f,h=h.expirationTimes;0<f;){var x=31-Vn(f),E=1<<x;h[x]=-1,f&=~E}}function NP(h){if((ln&6)!==0)throw Error(o(327));hh();var f=mi(h,0);if((f&1)===0)return Is(h,gi()),null;var x=By(h,f);if(h.tag!==0&&x===2){var E=kr(h);E!==0&&(f=E,x=jE(h,E))}if(x===1)throw x=Pm,ch(h,0),Bc(h,f),Is(h,gi()),x;if(x===6)throw Error(o(345));return h.finishedWork=h.current.alternate,h.finishedLanes=f,uh(h,Ds),Is(h,gi()),null}function OP(h){Nc!==null&&Nc.tag===0&&(ln&6)===0&&hh();var f=ln;ln|=1;var x=zi.transition,E=dn;try{if(zi.transition=null,dn=1,h)return h()}finally{dn=E,zi.transition=x,ln=f,(ln&6)===0&&Ps()}}function qE(){lo=Xd.current,Ke(Xd)}function ch(h,f){h.finishedWork=null,h.finishedLanes=0;var x=h.timeoutHandle;if(x!==Ee&&(h.timeoutHandle=Ee,le(x)),ji!==null)for(x=ji.return;x!==null;){var E=x;switch(uE(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&wn();break;case 3:Gd(),Ke(St),Ke(Tt),vE();break;case 5:mE(E);break;case 4:Gd();break;case 13:Ke(vi);break;case 19:Ke(vi);break;case 10:fr(E.type._context);break;case 22:case 23:qE()}x=x.return}if(Gi=h,ji=h=Uc(h.current,null),Lr=lo=f,tr=0,Pm=null,zE=Ly=qd=0,Ds=Dm=null,ro!==null){for(f=0;f<ro.length;f++)if(x=ro[f],E=x.interleaved,E!==null){x.interleaved=null;var k=E.next,N=x.pending;if(N!==null){var ee=N.next;N.next=k,E.next=ee}x.pending=E}ro=null}return h}function BP(h,f){do{var x=ji;try{if(Ud(),cy.current=my,uy){for(var E=Ai.memoizedState;E!==null;){var k=E.queue;k!==null&&(k.pending=null),E=E.next}uy=!1}if(jd=0,pr=Hr=Ai=null,bm=!1,wm=0,FE.current=null,x===null||x.return===null){tr=1,Pm=f,ji=null;break}e:{var N=h,ee=x.return,ue=x,He=f;if(f=Lr,ue.flags|=32768,He!==null&&typeof He=="object"&&typeof He.then=="function"){var rt=He,Lt=ue,Kt=Lt.tag;if((Lt.mode&1)===0&&(Kt===0||Kt===11||Kt===15)){var Bt=Lt.alternate;Bt?(Lt.updateQueue=Bt.updateQueue,Lt.memoizedState=Bt.memoizedState,Lt.lanes=Bt.lanes):(Lt.updateQueue=null,Lt.memoizedState=null)}var Gn=rP(ee);if(Gn!==null){Gn.flags&=-257,sP(Gn,ee,ue,N,f),Gn.mode&1&&iP(N,rt,f),f=Gn,He=rt;var Nt=f.updateQueue;if(Nt===null){var Gr=new Set;Gr.add(He),f.updateQueue=Gr}else Nt.add(He);break e}else{if((f&1)===0){iP(N,rt,f),YE();break e}He=Error(o(426))}}else if(ui&&ue.mode&1){var Vo=rP(ee);if(Vo!==null){(Vo.flags&65536)===0&&(Vo.flags|=256),sP(Vo,ee,ue,N,f),fE(He);break e}}N=He,tr!==4&&(tr=2),Dm===null?Dm=[N]:Dm.push(N),He=EE(He,ue),ue=ee;do{switch(ue.tag){case 3:ue.flags|=65536,f&=-f,ue.lanes|=f;var be=tP(ue,He,f);wL(ue,be);break e;case 1:N=He;var de=ue.type,Re=ue.stateNode;if((ue.flags&128)===0&&(typeof de.getDerivedStateFromError=="function"||Re!==null&&typeof Re.componentDidCatch=="function"&&(Rc===null||!Rc.has(Re)))){ue.flags|=65536,f&=-f,ue.lanes|=f;var yt=nP(ue,N,f);wL(ue,yt);break e}}ue=ue.return}while(ue!==null)}zP(x)}catch(Rt){f=Rt,ji===x&&x!==null&&(ji=x=x.return);continue}break}while(!0)}function UP(){var h=ky.current;return ky.current=my,h===null?my:h}function YE(){(tr===0||tr===3||tr===2)&&(tr=4),Gi===null||(qd&268435455)===0&&(Ly&268435455)===0||Bc(Gi,Lr)}function By(h,f){var x=ln;ln|=2;var E=UP();Gi===h&&Lr===f||ch(h,f);do try{rH();break}catch(k){BP(h,k)}while(!0);if(Ud(),ln=x,ky.current=E,ji!==null)throw Error(o(261));return Gi=null,Lr=0,tr}function rH(){for(;ji!==null;)FP(ji)}function sH(){for(;ji!==null&&!dm();)FP(ji)}function FP(h){var f=VP(h.alternate,h,lo);h.memoizedProps=h.pendingProps,f===null?zP(h):ji=f,FE.current=null}function zP(h){var f=h;do{var x=f.alternate;if(h=f.return,(f.flags&32768)===0){if(x=Y8(x,f,lo),x!==null){ji=x;return}}else{if(x=J8(x,f),x!==null){x.flags&=32767,ji=x;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{tr=6,ji=null;return}}if(f=f.sibling,f!==null){ji=f;return}ji=f=h}while(f!==null);tr===0&&(tr=5)}function uh(h,f){var x=dn,E=zi.transition;try{zi.transition=null,dn=1,oH(h,f,x)}finally{zi.transition=E,dn=x}return null}function oH(h,f,x){do hh();while(Nc!==null);if((ln&6)!==0)throw Error(o(327));var E=h.finishedWork,k=h.finishedLanes;if(E===null)return null;if(h.finishedWork=null,h.finishedLanes=0,E===h.current)throw Error(o(177));h.callbackNode=null,h.callbackPriority=0;var N=E.lanes|E.childLanes;if(Lc(h,N),h===Gi&&(ji=Gi=null,Lr=0),(E.subtreeFlags&2064)===0&&(E.flags&2064)===0||Dy||(Dy=!0,GP(as,function(){return hh(),null})),N=(E.flags&15990)!==0,(E.subtreeFlags&15990)!==0||N){N=zi.transition,zi.transition=null;var ee=dn;dn=1;var ue=ln;ln|=4,FE.current=null,Q8(h,E),eH(h,E,k),K(h.containerInfo),h.current=E,tH(E,h,k),Z_(),ln=ue,dn=ee,zi.transition=N}else h.current=E;if(Dy&&(Dy=!1,Nc=h,Iy=k),N=h.pendingLanes,N===0&&(Rc=null),pm(E.stateNode,x),Is(h,gi()),f!==null)for(x=h.onRecoverableError,E=0;E<f.length;E++)x(f[E]);if(Py)throw Py=!1,h=VE,VE=null,h;return(Iy&1)!==0&&h.tag!==0&&hh(),N=h.pendingLanes,(N&1)!==0?h===GE?Im++:(Im=0,GE=h):Im=0,Ps(),null}function hh(){if(Nc!==null){var h=hm(Iy),f=zi.transition,x=dn;try{if(zi.transition=null,dn=16>h?16:h,Nc===null)var E=!1;else{if(h=Nc,Nc=null,Iy=0,(ln&6)!==0)throw Error(o(331));var k=ln;for(ln|=4,vt=h.current;vt!==null;){var N=vt,ee=N.child;if((vt.flags&16)!==0){var ue=N.deletions;if(ue!==null){for(var He=0;He<ue.length;He++){var rt=ue[He];for(vt=rt;vt!==null;){var Lt=vt;switch(Lt.tag){case 0:case 11:case 15:lh(8,Lt,N)}var Kt=Lt.child;if(Kt!==null)Kt.return=Lt,vt=Kt;else for(;vt!==null;){Lt=vt;var Bt=Lt.sibling,Gn=Lt.return;if(EP(Lt),Lt===rt){vt=null;break}if(Bt!==null){Bt.return=Gn,vt=Bt;break}vt=Gn}}}var Nt=N.alternate;if(Nt!==null){var Gr=Nt.child;if(Gr!==null){Nt.child=null;do{var Vo=Gr.sibling;Gr.sibling=null,Gr=Vo}while(Gr!==null)}}vt=N}}if((N.subtreeFlags&2064)!==0&&ee!==null)ee.return=N,vt=ee;else e:for(;vt!==null;){if(N=vt,(N.flags&2048)!==0)switch(N.tag){case 0:case 11:case 15:lh(9,N,N.return)}var be=N.sibling;if(be!==null){be.return=N.return,vt=be;break e}vt=N.return}}var de=h.current;for(vt=de;vt!==null;){ee=vt;var Re=ee.child;if((ee.subtreeFlags&2064)!==0&&Re!==null)Re.return=ee,vt=Re;else e:for(ee=de;vt!==null;){if(ue=vt,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:km(9,ue)}}catch(Rt){Rs(ue,ue.return,Rt)}if(ue===ee){vt=null;break e}var yt=ue.sibling;if(yt!==null){yt.return=ue.return,vt=yt;break e}vt=ue.return}}if(ln=k,Ps(),no&&typeof no.onPostCommitFiberRoot=="function")try{no.onPostCommitFiberRoot(eh,h)}catch{}E=!0}return E}finally{dn=x,zi.transition=f}}return!1}function HP(h,f,x){f=EE(x,f),f=tP(h,f,1),Ic(h,f),f=ds(),h=Oy(h,1),h!==null&&($a(h,1,f),Is(h,f))}function Rs(h,f,x){if(h.tag===3)HP(h,h,x);else for(;f!==null;){if(f.tag===3){HP(f,h,x);break}else if(f.tag===1){var E=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Rc===null||!Rc.has(E))){h=EE(x,h),h=nP(f,h,1),Ic(f,h),h=ds(),f=Oy(f,1),f!==null&&($a(f,1,h),Is(f,h));break}}f=f.return}}function aH(h,f,x){var E=h.pingCache;E!==null&&E.delete(f),f=ds(),h.pingedLanes|=h.suspendedLanes&x,Gi===h&&(Lr&x)===x&&(tr===4||tr===3&&(Lr&130023424)===Lr&&500>gi()-HE?ch(h,0):zE|=x),Is(h,f)}function WP(h,f){f===0&&((h.mode&1)===0?f=1:(f=ci,ci<<=1,(ci&130023424)===0&&(ci=4194304)));var x=ds();h=Oy(h,f),h!==null&&($a(h,f,x),Is(h,x))}function lH(h){var f=h.memoizedState,x=0;f!==null&&(x=f.retryLane),WP(h,x)}function cH(h,f){var x=0;switch(h.tag){case 13:var E=h.stateNode,k=h.memoizedState;k!==null&&(x=k.retryLane);break;case 19:E=h.stateNode;break;default:throw Error(o(314))}E!==null&&E.delete(f),WP(h,x)}var VP;VP=function(h,f,x){if(h!==null)if(h.memoizedProps!==f.pendingProps||St.current)ao=!0;else{if((h.lanes&x)===0&&(f.flags&128)===0)return ao=!1,$8(h,f,x);ao=(h.flags&131072)!==0}else ao=!1,ui&&(f.flags&1048576)!==0&&kL(f,oy,f.index);switch(f.lanes=0,f.tag){case 2:var E=f.type;h!==null&&(h.alternate=null,f.alternate=null,f.flags|=2),h=f.pendingProps;var k=tn(f,Tt.current);Ui(f,x),k=yE(null,f,E,h,k,x);var N=xE();return f.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,nn(E)?(N=!0,hn(f)):N=!1,f.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,oE(f),k.updater=ry,f.stateNode=k,k._reactInternals=f,lE(f,E,h,x),f=ME(null,f,E,!0,N,x)):(f.tag=0,ui&&N&&cE(f),hs(null,f,k,x),f=f.child),f;case 16:E=f.elementType;e:{switch(h!==null&&(h.alternate=null,f.alternate=null,f.flags|=2),h=f.pendingProps,k=E._init,E=k(E._payload),f.type=E,k=f.tag=hH(E),h=cs(E,h),k){case 0:f=TE(null,f,E,h,x);break e;case 1:f=fP(null,f,E,h,x);break e;case 11:f=lP(null,f,E,h,x);break e;case 14:f=cP(null,f,E,cs(E.type,h),x);break e}throw Error(o(306,E,""))}return f;case 0:return E=f.type,k=f.pendingProps,k=f.elementType===E?k:cs(E,k),TE(h,f,E,k,x);case 1:return E=f.type,k=f.pendingProps,k=f.elementType===E?k:cs(E,k),fP(h,f,E,k,x);case 3:e:{if(pP(f),h===null)throw Error(o(387));E=f.pendingProps,N=f.memoizedState,k=N.element,bL(h,f),iy(f,E,null,x);var ee=f.memoizedState;if(E=ee.element,De&&N.isDehydrated)if(N={element:E,isDehydrated:!1,cache:ee.cache,transitions:ee.transitions},f.updateQueue.baseState=N,f.memoizedState=N,f.flags&256){k=Error(o(423)),f=mP(h,f,E,x,k);break e}else if(E!==k){k=Error(o(424)),f=mP(h,f,E,x,k);break e}else for(De&&(oo=ni(f.stateNode.containerInfo),so=f,ui=!0,ma=null,vm=!1),x=NL(f,null,E,x),f.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(Hd(),E===k){f=zl(h,f,x);break e}hs(h,f,E,x)}f=f.child}return f;case 5:return OL(f),h===null&&dE(f),E=f.type,k=f.pendingProps,N=h!==null?h.memoizedProps:null,ee=k.children,re(E,k)?ee=null:N!==null&&re(E,N)&&(f.flags|=32),dP(h,f),hs(h,f,ee,x),f.child;case 6:return h===null&&dE(f),null;case 13:return gP(h,f,x);case 4:return pE(f,f.stateNode.containerInfo),E=f.pendingProps,h===null?f.child=Wd(f,null,E,x):hs(h,f,E,x),f.child;case 11:return E=f.type,k=f.pendingProps,k=f.elementType===E?k:cs(E,k),lP(h,f,E,k,x);case 7:return hs(h,f,f.pendingProps,x),f.child;case 8:return hs(h,f,f.pendingProps.children,x),f.child;case 12:return hs(h,f,f.pendingProps.children,x),f.child;case 10:e:{if(E=f.type._context,k=f.pendingProps,N=f.memoizedProps,ee=k.value,ty(f,E,ee),N!==null)if(io(N.value,ee)){if(N.children===k.children&&!St.current){f=zl(h,f,x);break e}}else for(N=f.child,N!==null&&(N.return=f);N!==null;){var ue=N.dependencies;if(ue!==null){ee=N.child;for(var He=ue.firstContext;He!==null;){if(He.context===E){if(N.tag===1){He=Ol(-1,x&-x),He.tag=2;var rt=N.updateQueue;if(rt!==null){rt=rt.shared;var Lt=rt.pending;Lt===null?He.next=He:(He.next=Lt.next,Lt.next=He),rt.pending=He}}N.lanes|=x,He=N.alternate,He!==null&&(He.lanes|=x),us(N.return,x,f),ue.lanes|=x;break}He=He.next}}else if(N.tag===10)ee=N.type===f.type?null:N.child;else if(N.tag===18){if(ee=N.return,ee===null)throw Error(o(341));ee.lanes|=x,ue=ee.alternate,ue!==null&&(ue.lanes|=x),us(ee,x,f),ee=N.sibling}else ee=N.child;if(ee!==null)ee.return=N;else for(ee=N;ee!==null;){if(ee===f){ee=null;break}if(N=ee.sibling,N!==null){N.return=ee.return,ee=N;break}ee=ee.return}N=ee}hs(h,f,k.children,x),f=f.child}return f;case 9:return k=f.type,E=f.pendingProps.children,Ui(f,x),k=Fi(k),E=E(k),f.flags|=1,hs(h,f,E,x),f.child;case 14:return E=f.type,k=cs(E,f.pendingProps),k=cs(E.type,k),cP(h,f,E,k,x);case 15:return uP(h,f,f.type,f.pendingProps,x);case 17:return E=f.type,k=f.pendingProps,k=f.elementType===E?k:cs(E,k),h!==null&&(h.alternate=null,f.alternate=null,f.flags|=2),f.tag=1,nn(E)?(h=!0,hn(f)):h=!1,Ui(f,x),ML(f,E,k),lE(f,E,k,x),ME(null,f,E,!0,h,x);case 19:return xP(h,f,x);case 22:return hP(h,f,x)}throw Error(o(156,f.tag))};function GP(h,f){return Nl(h,f)}function uH(h,f,x,E){this.tag=h,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wo(h,f,x,E){return new uH(h,f,x,E)}function KE(h){return h=h.prototype,!(!h||!h.isReactComponent)}function hH(h){if(typeof h=="function")return KE(h)?1:0;if(h!=null){if(h=h.$$typeof,h===_)return 11;if(h===S)return 14}return 2}function Uc(h,f){var x=h.alternate;return x===null?(x=Wo(h.tag,f,h.key,h.mode),x.elementType=h.elementType,x.type=h.type,x.stateNode=h.stateNode,x.alternate=h,h.alternate=x):(x.pendingProps=f,x.type=h.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=h.flags&14680064,x.childLanes=h.childLanes,x.lanes=h.lanes,x.child=h.child,x.memoizedProps=h.memoizedProps,x.memoizedState=h.memoizedState,x.updateQueue=h.updateQueue,f=h.dependencies,x.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},x.sibling=h.sibling,x.index=h.index,x.ref=h.ref,x}function Uy(h,f,x,E,k,N){var ee=2;if(E=h,typeof h=="function")KE(h)&&(ee=1);else if(typeof h=="string")ee=5;else e:switch(h){case u:return dh(x.children,k,N,f);case d:ee=8,k|=8;break;case p:return h=Wo(12,x,f,k|2),h.elementType=p,h.lanes=N,h;case y:return h=Wo(13,x,f,k),h.elementType=y,h.lanes=N,h;case v:return h=Wo(19,x,f,k),h.elementType=v,h.lanes=N,h;case w:return Fy(x,k,N,f);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case m:ee=10;break e;case g:ee=9;break e;case _:ee=11;break e;case S:ee=14;break e;case b:ee=16,E=null;break e}throw Error(o(130,h==null?h:typeof h,""))}return f=Wo(ee,x,f,k),f.elementType=h,f.type=E,f.lanes=N,f}function dh(h,f,x,E){return h=Wo(7,h,E,f),h.lanes=x,h}function Fy(h,f,x,E){return h=Wo(22,h,E,f),h.elementType=w,h.lanes=x,h.stateNode={},h}function $E(h,f,x){return h=Wo(6,h,null,f),h.lanes=x,h}function JE(h,f,x){return f=Wo(4,h.children!==null?h.children:[],h.key,f),f.lanes=x,f.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},f}function dH(h,f,x,E,k){this.tag=f,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ee,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nd(0),this.expirationTimes=Nd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nd(0),this.identifierPrefix=E,this.onRecoverableError=k,De&&(this.mutableSourceEagerHydrationData=null)}function jP(h,f,x,E,k,N,ee,ue,He){return h=new dH(h,f,x,ue,He),f===1?(f=1,N===!0&&(f|=8)):f=0,N=Wo(3,null,null,f),h.current=N,N.stateNode=h,N.memoizedState={element:E,isDehydrated:x,cache:null,transitions:null},oE(N),h}function XP(h){if(!h)return xt;h=h._reactInternals;e:{if(T(h)!==h||h.tag!==1)throw Error(o(170));var f=h;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(nn(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(o(171))}if(h.tag===1){var x=h.type;if(nn(x))return Dt(h,x,f)}return f}function qP(h){var f=h._reactInternals;if(f===void 0)throw typeof h.render=="function"?Error(o(188)):(h=Object.keys(h).join(","),Error(o(268,h)));return h=F(f),h===null?null:h.stateNode}function YP(h,f){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var x=h.retryLane;h.retryLane=x!==0&&x<f?x:f}}function ZE(h,f){YP(h,f),(h=h.alternate)&&YP(h,f)}function fH(h){return h=F(h),h===null?null:h.stateNode}function pH(){return null}return n.attemptContinuousHydration=function(h){if(h.tag===13){var f=ds();Ho(h,134217728,f),ZE(h,134217728)}},n.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13){var f=ds(),x=Oc(h);Ho(h,x,f),ZE(h,x)}},n.attemptSynchronousHydration=function(h){switch(h.tag){case 3:var f=h.stateNode;if(f.current.memoizedState.isDehydrated){var x=Mi(f.pendingLanes);x!==0&&(Ja(f,x|1),Is(f,gi()),(ln&6)===0&&(Yd(),Ps()))}break;case 13:var E=ds();OP(function(){return Ho(h,1,E)}),ZE(h,1)}},n.batchedUpdates=function(h,f){var x=ln;ln|=1;try{return h(f)}finally{ln=x,ln===0&&(Yd(),Za&&Ps())}},n.createComponentSelector=function(h){return{$$typeof:Ey,value:h}},n.createContainer=function(h,f,x,E,k,N,ee){return jP(h,f,!1,null,x,E,k,N,ee)},n.createHasPseudoClassSelector=function(h){return{$$typeof:Cy,value:h}},n.createHydrationContainer=function(h,f,x,E,k,N,ee,ue,He){return h=jP(x,E,!0,h,k,N,ee,ue,He),h.context=XP(null),x=h.current,E=ds(),k=Oc(x),N=Ol(E,k),N.callback=f??null,Ic(x,N),h.current.lanes=k,$a(h,k,E),Is(h,E),h},n.createPortal=function(h,f,x){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:E==null?null:""+E,children:h,containerInfo:f,implementation:x}},n.createRoleSelector=function(h){return{$$typeof:Ty,value:h}},n.createTestNameSelector=function(h){return{$$typeof:My,value:h}},n.createTextSelector=function(h){return{$$typeof:Ay,value:h}},n.deferredUpdates=function(h){var f=dn,x=zi.transition;try{return zi.transition=null,dn=16,h()}finally{dn=f,zi.transition=x}},n.discreteUpdates=function(h,f,x,E,k){var N=dn,ee=zi.transition;try{return zi.transition=null,dn=1,h(f,x,E,k)}finally{dn=N,zi.transition=ee,ln===0&&Yd()}},n.findAllNodes=UE,n.findBoundingRects=function(h,f){if(!Me)throw Error(o(363));f=UE(h,f),h=[];for(var x=0;x<f.length;x++)h.push(Ne(f[x]));for(f=h.length-1;0<f;f--){x=h[f];for(var E=x.x,k=E+x.width,N=x.y,ee=N+x.height,ue=f-1;0<=ue;ue--)if(f!==ue){var He=h[ue],rt=He.x,Lt=rt+He.width,Kt=He.y,Bt=Kt+He.height;if(E>=rt&&N>=Kt&&k<=Lt&&ee<=Bt){h.splice(f,1);break}else if(E!==rt||x.width!==He.width||Bt<N||Kt>ee){if(!(N!==Kt||x.height!==He.height||Lt<E||rt>k)){rt>E&&(He.width+=rt-E,He.x=E),Lt<k&&(He.width=k-rt),h.splice(f,1);break}}else{Kt>N&&(He.height+=Kt-N,He.y=N),Bt<ee&&(He.height=ee-Kt),h.splice(f,1);break}}}return h},n.findHostInstance=qP,n.findHostInstanceWithNoPortals=function(h){return h=I(h),h=h!==null?O(h):null,h===null?null:h.stateNode},n.findHostInstanceWithWarning=function(h){return qP(h)},n.flushControlled=function(h){var f=ln;ln|=1;var x=zi.transition,E=dn;try{zi.transition=null,dn=1,h()}finally{dn=E,zi.transition=x,ln=f,ln===0&&(Yd(),Ps())}},n.flushPassiveEffects=hh,n.flushSync=OP,n.focusWithin=function(h,f){if(!Me)throw Error(o(363));for(h=NE(h),f=IP(h,f),f=Array.from(f),h=0;h<f.length;){var x=f[h++];if(!R(x)){if(x.tag===5&&fe(x.stateNode))return!0;for(x=x.child;x!==null;)f.push(x),x=x.sibling}}return!1},n.getCurrentUpdatePriority=function(){return dn},n.getFindAllNodesFailureDescription=function(h,f){if(!Me)throw Error(o(363));var x=0,E=[];h=[NE(h),0];for(var k=0;k<h.length;){var N=h[k++],ee=h[k++],ue=f[ee];if((N.tag!==5||!R(N))&&(OE(N,ue)&&(E.push(BE(ue)),ee++,ee>x&&(x=ee)),ee<f.length))for(N=N.child;N!==null;)h.push(N,ee),N=N.sibling}if(x<f.length){for(h=[];x<f.length;x++)h.push(BE(f[x]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},n.getPublicRootInstance=function(h){return h=h.current,h.child?h.child.tag===5?U(h.child.stateNode):h.child.stateNode:null},n.injectIntoDevTools=function(h){if(h={bundleType:h.bundleType,version:h.version,rendererPackageName:h.rendererPackageName,rendererConfig:h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:fH,findFiberByHostInstance:h.findFiberByHostInstance||pH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)h=!0;else{try{eh=f.inject(h),no=f}catch{}h=!!f.checkDCE}}return h},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(h,f,x,E){if(!Me)throw Error(o(363));h=UE(h,f);var k=he(h,x,E).disconnect;return{disconnect:function(){k()}}},n.registerMutableSourceForHydration=function(h,f){var x=f._getVersion;x=x(f._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[f,x]:h.mutableSourceEagerHydrationData.push(f,x)},n.runWithPriority=function(h,f){var x=dn;try{return dn=h,f()}finally{dn=x}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(h,f,x,E){var k=f.current,N=ds(),ee=Oc(k);return x=XP(x),f.context===null?f.context=x:f.pendingContext=x,f=Ol(N,ee),f.payload={element:h},E=E===void 0?null:E,E!==null&&(f.callback=E),Ic(k,f),h=Ho(k,ee,N),h!==null&&ny(h,k,ee),ee},n}});var DA=Kn((Oie,NB)=>{"use strict";NB.exports=RB()});var jB=Kn(ei=>{"use strict";function OA(t,e){var n=t.length;t.push(e);e:for(;0<n;){var i=n-1>>>1,r=t[i];if(0<Ob(r,e))t[i]=e,t[n]=r,n=i;else break e}}function Wa(t){return t.length===0?null:t[0]}function Ub(t){if(t.length===0)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;e:for(var i=0,r=t.length,s=r>>>1;i<s;){var o=2*(i+1)-1,a=t[o],l=o+1,c=t[l];if(0>Ob(a,n))l<r&&0>Ob(c,a)?(t[i]=c,t[l]=n,i=l):(t[i]=a,t[o]=n,i=o);else if(l<r&&0>Ob(c,n))t[i]=c,t[l]=n,i=l;else break e}}return e}function Ob(t,e){var n=t.sortIndex-e.sortIndex;return n!==0?n:t.id-e.id}typeof performance=="object"&&typeof performance.now=="function"?(OB=performance,ei.unstable_now=function(){return OB.now()}):(IA=Date,BB=IA.now(),ei.unstable_now=function(){return IA.now()-BB});var OB,IA,BB,vl=[],Uu=[],AY=1,na=null,rs=3,Fb=!1,vd=!1,s_=!1,zB=typeof setTimeout=="function"?setTimeout:null,HB=typeof clearTimeout=="function"?clearTimeout:null,UB=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function BA(t){for(var e=Wa(Uu);e!==null;){if(e.callback===null)Ub(Uu);else if(e.startTime<=t)Ub(Uu),e.sortIndex=e.expirationTime,OA(vl,e);else break;e=Wa(Uu)}}function UA(t){if(s_=!1,BA(t),!vd)if(Wa(vl)!==null)vd=!0,zA(FA);else{var e=Wa(Uu);e!==null&&HA(UA,e.startTime-t)}}function FA(t,e){vd=!1,s_&&(s_=!1,HB(o_),o_=-1),Fb=!0;var n=rs;try{for(BA(e),na=Wa(vl);na!==null&&(!(na.expirationTime>e)||t&&!GB());){var i=na.callback;if(typeof i=="function"){na.callback=null,rs=na.priorityLevel;var r=i(na.expirationTime<=e);e=ei.unstable_now(),typeof r=="function"?na.callback=r:na===Wa(vl)&&Ub(vl),BA(e)}else Ub(vl);na=Wa(vl)}if(na!==null)var s=!0;else{var o=Wa(Uu);o!==null&&HA(UA,o.startTime-e),s=!1}return s}finally{na=null,rs=n,Fb=!1}}var zb=!1,Bb=null,o_=-1,WB=5,VB=-1;function GB(){return!(ei.unstable_now()-VB<WB)}function RA(){if(Bb!==null){var t=ei.unstable_now();VB=t;var e=!0;try{e=Bb(!0,t)}finally{e?r_():(zb=!1,Bb=null)}}else zb=!1}var r_;typeof UB=="function"?r_=function(){UB(RA)}:typeof MessageChannel<"u"?(NA=new MessageChannel,FB=NA.port2,NA.port1.onmessage=RA,r_=function(){FB.postMessage(null)}):r_=function(){zB(RA,0)};var NA,FB;function zA(t){Bb=t,zb||(zb=!0,r_())}function HA(t,e){o_=zB(function(){t(ei.unstable_now())},e)}ei.unstable_IdlePriority=5;ei.unstable_ImmediatePriority=1;ei.unstable_LowPriority=4;ei.unstable_NormalPriority=3;ei.unstable_Profiling=null;ei.unstable_UserBlockingPriority=2;ei.unstable_cancelCallback=function(t){t.callback=null};ei.unstable_continueExecution=function(){vd||Fb||(vd=!0,zA(FA))};ei.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):WB=0<t?Math.floor(1e3/t):5};ei.unstable_getCurrentPriorityLevel=function(){return rs};ei.unstable_getFirstCallbackNode=function(){return Wa(vl)};ei.unstable_next=function(t){switch(rs){case 1:case 2:case 3:var e=3;break;default:e=rs}var n=rs;rs=e;try{return t()}finally{rs=n}};ei.unstable_pauseExecution=function(){};ei.unstable_requestPaint=function(){};ei.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=rs;rs=t;try{return e()}finally{rs=n}};ei.unstable_scheduleCallback=function(t,e,n){var i=ei.unstable_now();switch(typeof n=="object"&&n!==null?(n=n.delay,n=typeof n=="number"&&0<n?i+n:i):n=i,t){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return r=n+r,t={id:AY++,callback:e,priorityLevel:t,startTime:n,expirationTime:r,sortIndex:-1},n>i?(t.sortIndex=n,OA(Uu,t),Wa(vl)===null&&t===Wa(Uu)&&(s_?(HB(o_),o_=-1):s_=!0,HA(UA,n-i))):(t.sortIndex=r,OA(vl,t),vd||Fb||(vd=!0,zA(FA))),t};ei.unstable_shouldYield=GB;ei.unstable_wrapCallback=function(t){var e=rs;return function(){var n=rs;rs=e;try{return t.apply(this,arguments)}finally{rs=n}}}});var WA=Kn((Uie,XB)=>{"use strict";XB.exports=jB()});function kY(t,e){function n(u,{args:d=[],attach:p,...m},g){let _=`${u[0].toUpperCase()}${u.slice(1)}`,y;if(u==="primitive"){if(m.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");let v=m.object;y=Wp(v,{type:u,root:g,attach:p,primitive:!0})}else{let v=t3[_];if(!v)throw new Error(`R3F: ${_} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(d))throw new Error("R3F: The args prop must be an array!");y=Wp(new v(...d),{type:u,root:g,attach:p,memoizedProps:{args:d}})}return y.__r3f.attach===void 0&&(y.isBufferGeometry?y.__r3f.attach="geometry":y.isMaterial&&(y.__r3f.attach="material")),_!=="inject"&&jA(y,m),y}function i(u,d){let p=!1;if(d){var m,g;(m=d.__r3f)!=null&&m.attach?GA(u,d,d.__r3f.attach):d.isObject3D&&u.isObject3D&&(u.add(d),p=!0),p||(g=u.__r3f)==null||g.objects.push(d),d.__r3f||Wp(d,{}),d.__r3f.parent=u,ZA(d),Vp(d)}}function r(u,d,p){let m=!1;if(d){var g,_;if((g=d.__r3f)!=null&&g.attach)GA(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){d.parent=u,d.dispatchEvent({type:"added"}),u.dispatchEvent({type:"childadded",child:d});let y=u.children.filter(S=>S!==d),v=y.indexOf(p);u.children=[...y.slice(0,v),d,...y.slice(v)],m=!0}m||(_=u.__r3f)==null||_.objects.push(d),d.__r3f||Wp(d,{}),d.__r3f.parent=u,ZA(d),Vp(d)}}function s(u,d,p=!1){u&&[...u].forEach(m=>o(d,m,p))}function o(u,d,p){if(d){var m,g,_;if(d.__r3f&&(d.__r3f.parent=null),(m=u.__r3f)!=null&&m.objects&&(u.__r3f.objects=u.__r3f.objects.filter(w=>w!==d)),(g=d.__r3f)!=null&&g.attach)JB(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){var y;u.remove(d),(y=d.__r3f)!=null&&y.root&&RY(Vb(d),d)}let S=(_=d.__r3f)==null?void 0:_.primitive,b=!S&&(p===void 0?d.dispose!==null:p);if(!S){var v;s((v=d.__r3f)==null?void 0:v.objects,d,b),s(d.children,d,b)}if(delete d.__r3f,b&&d.dispose&&d.type!=="Scene"){let w=()=>{try{d.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?(0,jb.unstable_scheduleCallback)(jb.unstable_IdlePriority,w):w()}Vp(u)}}function a(u,d,p,m){var g;let _=(g=u.__r3f)==null?void 0:g.parent;if(!_)return;let y=n(d,p,u.__r3f.root);if(u.children){for(let v of u.children)v.__r3f&&i(y,v);u.children=u.children.filter(v=>!v.__r3f)}u.__r3f.objects.forEach(v=>i(y,v)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(_,u),y.parent&&(y.__r3f.autoRemovedBeforeAppend=!0),i(_,y),y.raycast&&y.__r3f.eventCount&&Vb(y).getState().internal.interaction.push(y),[m,m.alternate].forEach(v=>{v!==null&&(v.stateNode=y,v.ref&&(typeof v.ref=="function"?v.ref(y):v.ref.current=y))})}let l=()=>{};return{reconciler:(0,QB.default)({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,d)=>{if(!d)return;let p=u.getState().scene;p.__r3f&&(p.__r3f.root=u,i(p,d))},removeChildFromContainer:(u,d)=>{d&&o(u.getState().scene,d)},insertInContainerBefore:(u,d,p)=>{if(!d||!p)return;let m=u.getState().scene;m.__r3f&&r(m,d,p)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var d;return!!((d=u?.__r3f)!=null?d:{}).handlers},prepareUpdate(u,d,p,m){var g;if(((g=u?.__r3f)!=null?g:{}).primitive&&m.object&&m.object!==u)return[!0];{let{args:y=[],children:v,...S}=m,{args:b=[],children:w,...C}=p;if(!Array.isArray(y))throw new Error("R3F: the args prop must be an array!");if(y.some((L,P)=>L!==b[P]))return[!0];let M=lU(u,S,C,!0);return M.changes.length?[!1,M]:null}},commitUpdate(u,[d,p],m,g,_,y){d?a(u,m,_,y):jA(u,p)},commitMount(u,d,p,m){var g;let _=(g=u.__r3f)!=null?g:{};u.raycast&&_.handlers&&_.eventCount&&Vb(u).getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>Wp(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var d;let{attach:p,parent:m}=(d=u.__r3f)!=null?d:{};p&&m&&JB(m,u,p),u.isObject3D&&(u.visible=!1),Vp(u)},unhideInstance(u,d){var p;let{attach:m,parent:g}=(p=u.__r3f)!=null?p:{};m&&g&&GA(g,u,m),(u.isObject3D&&d.visible==null||d.visible)&&(u.visible=!0),Vp(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():_l.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&ti.fun(performance.now)?performance.now:ti.fun(Date.now)?Date.now:()=>0,scheduleTimeout:ti.fun(setTimeout)?setTimeout:void 0,cancelTimeout:ti.fun(clearTimeout)?clearTimeout:void 0}),applyProps:jA}}function i3(t){let e=Ki.useRef(t);return jp(()=>{e.current=t},[t]),e}function iU({set:t}){return jp(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}function sU(t){var e;let n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}function Vb(t){let e=t.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}function oU(t){let e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function aU(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(let e in t)e.dispose==null||e.dispose(),delete t[e]}function Wp(t,e){let n=t;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function JA(t,e){let n=t;if(e.includes("-")){let i=e.split("-"),r=i.pop();return n=i.reduce((s,o)=>s[o],t),{target:n,key:r}}else return{target:n,key:e}}function GA(t,e,n){if(ti.str(n)){if($B.test(n)){let s=n.replace($B,""),{target:o,key:a}=JA(t,s);Array.isArray(o[a])||(o[a]=[])}let{target:i,key:r}=JA(t,n);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=n(t,e)}function JB(t,e,n){var i,r;if(ti.str(n)){let{target:s,key:o}=JA(t,n),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function lU(t,{children:e,key:n,ref:i,...r},{children:s,key:o,ref:a,...l}={},c=!1){let u=t.__r3f,d=Object.entries(r),p=[];if(c){let g=Object.keys(l);for(let _=0;_<g.length;_++)r.hasOwnProperty(g[_])||d.unshift([g[_],rU+"remove"])}d.forEach(([g,_])=>{var y;if((y=t.__r3f)!=null&&y.primitive&&g==="object"||ti.equ(_,l[g]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(g))return p.push([g,_,!0,[]]);let v=[];g.includes("-")&&(v=g.split("-")),p.push([g,_,!1,v]);for(let S in r){let b=r[S];S.startsWith(`${g}-`)&&p.push([S,b,!1,S.split("-")])}});let m={...r};return u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.args&&(m.args=u.memoizedProps.args),u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.attach&&(m.attach=u.memoizedProps.attach),{memoized:m,changes:p}}function jA(t,e){var n;let i=t.__r3f,r=i?.root,s=r==null||r.getState==null?void 0:r.getState(),{memoized:o,changes:a}=LY(e)?e:lU(t,e),l=i?.eventCount;t.__r3f&&(t.__r3f.memoizedProps=o);for(let p=0;p<a.length;p++){let[m,g,_,y]=a[p];if(VA(t)){let w="srgb",C="srgb-linear";m==="encoding"?(m="colorSpace",g=g===3001?w:C):m==="outputEncoding"&&(m="outputColorSpace",g=g===3001?w:C)}let v=t,S=v[m];if(y.length&&(S=y.reduce((b,w)=>b[w],t),!(S&&S.set))){let[b,...w]=y.reverse();v=w.reverse().reduce((C,M)=>C[M],t),m=b}if(g===rU+"remove")if(v.constructor){let b=KB.get(v.constructor);b||(b=new v.constructor,KB.set(v.constructor,b)),g=b[m]}else g=0;if(_&&i)g?i.handlers[m]=g:delete i.handlers[m],i.eventCount=Object.keys(i.handlers).length;else if(S&&S.set&&(S.copy||S instanceof Da)){if(Array.isArray(g))S.fromArray?S.fromArray(g):S.set(...g);else if(S.copy&&g&&g.constructor&&(PY?S.constructor.name===g.constructor.name:S.constructor===g.constructor))S.copy(g);else if(g!==void 0){var c;let b=(c=S)==null?void 0:c.isColor;!b&&S.setScalar?S.setScalar(g):S instanceof Da&&g instanceof Da?S.mask=g.mask:S.set(g),!eU()&&s&&!s.linear&&b&&S.convertSRGBToLinear()}}else{var u;if(v[m]=g,(u=v[m])!=null&&u.isTexture&&v[m].format===rr&&v[m].type===Or&&s){let b=v[m];VA(b)&&VA(s.gl)?b.colorSpace=s.gl.outputColorSpace:b.encoding=s.gl.outputEncoding}}Vp(t)}if(i&&i.parent&&t.raycast&&l!==i.eventCount){let p=Vb(t).getState().internal,m=p.interaction.indexOf(t);m>-1&&p.interaction.splice(m,1),i.eventCount&&p.interaction.push(t)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(n=t.__r3f)!=null&&n.parent&&ZA(t),t}function Vp(t){var e,n;let i=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function ZA(t){t.onUpdate==null||t.onUpdate(t)}function DY(t,e){t.manual||(tU(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function Hb(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function IY(){var t;let e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return _l.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return _l.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return _l.ContinuousEventPriority;default:return _l.DefaultEventPriority}}function cU(t,e,n,i){let r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function RY(t,e){let{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{cU(n.capturedMap,e,i,r)})}function uU(t){function e(l){let{internal:c}=t.getState(),u=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}function n(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var d;return(d=c.__r3f)==null?void 0:d.handlers["onPointer"+u]}))}function i(l,c){let u=t.getState(),d=new Set,p=[],m=c?c(u.internal.interaction):u.internal.interaction;for(let v=0;v<m.length;v++){let S=Hp(m[v]);S&&(S.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function g(v){let S=Hp(v);if(!S||!S.events.enabled||S.raycaster.camera===null)return[];if(S.raycaster.camera===void 0){var b;S.events.compute==null||S.events.compute(l,S,(b=S.previousRoot)==null?void 0:b.getState()),S.raycaster.camera===void 0&&(S.raycaster.camera=null)}return S.raycaster.camera?S.raycaster.intersectObject(v,!0):[]}let _=m.flatMap(g).sort((v,S)=>{let b=Hp(v.object),w=Hp(S.object);return!b||!w?v.distance-S.distance:w.events.priority-b.events.priority||v.distance-S.distance}).filter(v=>{let S=Hb(v);return d.has(S)?!1:(d.add(S),!0)});u.events.filter&&(_=u.events.filter(_,u));for(let v of _){let S=v.object;for(;S;){var y;(y=S.__r3f)!=null&&y.eventCount&&p.push({...v,eventObject:S}),S=S.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let v of u.internal.capturedMap.get(l.pointerId).values())d.has(Hb(v.intersection))||p.push(v.intersection);return p}function r(l,c,u,d){let p=t.getState();if(l.length){let m={stopped:!1};for(let g of l){let _=Hp(g.object)||p,{raycaster:y,pointer:v,camera:S,internal:b}=_,w=new Y(v.x,v.y,0).unproject(S),C=A=>{var I,F;return(I=(F=b.capturedMap.get(A))==null?void 0:F.has(g.eventObject))!=null?I:!1},M=A=>{let I={intersection:g,target:c.target};b.capturedMap.has(A)?b.capturedMap.get(A).set(g.eventObject,I):b.capturedMap.set(A,new Map([[g.eventObject,I]])),c.target.setPointerCapture(A)},L=A=>{let I=b.capturedMap.get(A);I&&cU(b.capturedMap,g.eventObject,I,A)},P={};for(let A in c){let I=c[A];typeof I!="function"&&(P[A]=I)}let T={...g,...P,pointer:v,intersections:l,stopped:m.stopped,delta:u,unprojectedPoint:w,ray:y.ray,camera:S,stopPropagation(){let A="pointerId"in c&&b.capturedMap.get(c.pointerId);if((!A||A.has(g.eventObject))&&(T.stopped=m.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(I=>I.eventObject===g.eventObject))){let I=l.slice(0,l.indexOf(g));s([...I,g])}},target:{hasPointerCapture:C,setPointerCapture:M,releasePointerCapture:L},currentTarget:{hasPointerCapture:C,setPointerCapture:M,releasePointerCapture:L},nativeEvent:c};if(d(T),m.stopped===!0)break}}return l}function s(l){let{internal:c}=t.getState();for(let u of c.hovered.values())if(!l.length||!l.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){let p=u.eventObject.__r3f,m=p?.handlers;if(c.hovered.delete(Hb(u)),p!=null&&p.eventCount){let g={...u,intersections:l};m.onPointerOut==null||m.onPointerOut(g),m.onPointerLeave==null||m.onPointerLeave(g)}}}function o(l,c){for(let u=0;u<c.length;u++){let d=c[u].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{let{internal:u}=t.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){let{onPointerMissed:d,internal:p}=t.getState();p.lastEvent.current=u;let m=l==="onPointerMove",g=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",y=i(u,m?n:void 0),v=g?e(u):0;l==="onPointerDown"&&(p.initialClick=[u.offsetX,u.offsetY],p.initialHits=y.map(b=>b.eventObject)),g&&!y.length&&v<=2&&(o(u,p.interaction),d&&d(u)),m&&s(y);function S(b){let w=b.eventObject,C=w.__r3f,M=C?.handlers;if(C!=null&&C.eventCount)if(m){if(M.onPointerOver||M.onPointerEnter||M.onPointerOut||M.onPointerLeave){let L=Hb(b),P=p.hovered.get(L);P?P.stopped&&b.stopPropagation():(p.hovered.set(L,b),M.onPointerOver==null||M.onPointerOver(b),M.onPointerEnter==null||M.onPointerEnter(b))}M.onPointerMove==null||M.onPointerMove(b)}else{let L=M[l];L?(!g||p.initialHits.includes(w))&&(o(u,p.interaction.filter(P=>!p.initialHits.includes(P))),L(b)):g&&p.initialHits.includes(w)&&o(u,p.interaction.filter(P=>!p.initialHits.includes(P)))}}r(y,u,v,S)}}return{handlePointer:a}}function XA(t,e){if(t.size)for(let{callback:n}of t.values())n(e)}function Gp(t,e){switch(t){case"before":return XA(OY,e);case"after":return XA(BY,e);case"tail":return XA(UY,e)}}function KA(t,e,n){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),qA=e.internal.subscribers,Wb=0;Wb<qA.length;Wb++)YA=qA[Wb],YA.ref.current(YA.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function FY(t){let e=!1,n=!1,i,r,s;function o(c){r=requestAnimationFrame(o),e=!0,i=0,Gp("before",c),n=!0;for(let d of t.values()){var u;s=d.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((u=s.gl.xr)!=null&&u.isPresenting)&&(i+=KA(c,s))}if(n=!1,Gp("after",c),i===0)return Gp("tail",c),e=!1,cancelAnimationFrame(r)}function a(c,u=1){var d;if(!c)return t.forEach(p=>a(p.store.getState(),u));(d=c.gl.xr)!=null&&d.isPresenting||!c.internal.active||c.frameloop==="never"||(u>1?c.internal.frames=Math.min(60,c.internal.frames+u):n?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(c,u=!0,d,p){if(u&&Gp("before",c),d)KA(c,d,p);else for(let m of t.values())KA(c,m.store.getState());u&&Gp("after",c)}return{loop:o,invalidate:a,advance:l}}function s3(){let t=Ki.useContext(r3);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function ia(t=n=>n,e){return s3()(t,e)}function _c(t,e=0){let n=s3(),i=n.getState().internal.subscribe,r=i3(t);return jp(()=>i(r,e,n),[e,i,n]),null}function dU(t,e){return function(n,...i){let r=ZB.get(n);return r||(r=new n,ZB.set(n,r)),t&&t(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,oU(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l?.message}`))))))}}function o3(t,e,n,i){let r=Array.isArray(e)?e:[e],s=kb(dU(n,i),[t,...r],{equal:ti.equ});return Array.isArray(e)?s:s[0]}function HY(t,e){let n=typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement;if(e){let{width:i,height:r,top:s,left:o,updateStyle:a=n}=e;return{width:i,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){let{width:i,height:r,top:s,left:o}=t.parentElement.getBoundingClientRect();return{width:i,height:r,top:s,left:o,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function a3(t){let e=yd.get(t),n=e?.fiber,i=e?.store;e&&console.warn("R3F.createRoot should only be called once!");let r=typeof reportError=="function"?reportError:console.error,s=i||NY(QA,e3),o=n||l_.createContainer(s,_l.ConcurrentRoot,null,!1,null,"",r,null);e||yd.set(t,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:d,size:p,scene:m,events:g,onCreated:_,shadows:y=!1,linear:v=!1,flat:S=!1,legacy:b=!1,orthographic:w=!1,frameloop:C="always",dpr:M=[1,2],performance:L,raycaster:P,camera:T,onPointerMissed:A}=u,I=s.getState(),F=I.gl;I.gl||I.set({gl:F=zY(d,t)});let B=I.raycaster;B||I.set({raycaster:B=new Cp});let{params:O,...z}=P||{};if(ti.equ(z,B,zp)||_d(B,{...z}),ti.equ(O,B.params,zp)||_d(B,{params:{...B.params,...O}}),!I.camera||I.camera===c&&!ti.equ(c,T,zp)){c=T;let K=T instanceof lc,D=K?T:w?new js(0,0,0,0,.1,1e3):new Zn(75,0,.1,1e3);K||(D.position.z=5,T&&(_d(D,T),("aspect"in T||"left"in T||"right"in T||"bottom"in T||"top"in T)&&(D.manual=!0,D.updateProjectionMatrix())),!I.camera&&!(T!=null&&T.rotation)&&D.lookAt(0,0,0)),I.set({camera:D}),B.camera=D}if(!I.scene){let K;m!=null&&m.isScene?K=m:(K=new Yh,m&&_d(K,m)),I.set({scene:Wp(K)})}if(!I.xr){var U;let K=(q,ne)=>{let re=s.getState();re.frameloop!=="never"&&e3(q,!0,re,ne)},D=()=>{let q=s.getState();q.gl.xr.enabled=q.gl.xr.isPresenting,q.gl.xr.setAnimationLoop(q.gl.xr.isPresenting?K:null),q.gl.xr.isPresenting||QA(q)},X={connect(){let q=s.getState().gl;q.xr.addEventListener("sessionstart",D),q.xr.addEventListener("sessionend",D)},disconnect(){let q=s.getState().gl;q.xr.removeEventListener("sessionstart",D),q.xr.removeEventListener("sessionend",D)}};typeof((U=F.xr)==null?void 0:U.addEventListener)=="function"&&X.connect(),I.set({xr:X})}if(F.shadowMap){let K=F.shadowMap.enabled,D=F.shadowMap.type;if(F.shadowMap.enabled=!!y,ti.boo(y))F.shadowMap.type=sd;else if(ti.str(y)){var G;let X={basic:rb,percentage:Iu,soft:sd,variance:pc};F.shadowMap.type=(G=X[y])!=null?G:sd}else ti.obj(y)&&Object.assign(F.shadowMap,y);(K!==F.shadowMap.enabled||D!==F.shadowMap.type)&&(F.shadowMap.needsUpdate=!0)}let j=eU();j&&("enabled"in j?j.enabled=!b:"legacyMode"in j&&(j.legacyMode=b)),l||_d(F,{outputEncoding:v?3e3:3001,toneMapping:S?Xs:Mp}),I.legacy!==b&&I.set(()=>({legacy:b})),I.linear!==v&&I.set(()=>({linear:v})),I.flat!==S&&I.set(()=>({flat:S})),d&&!ti.fun(d)&&!hU(d)&&!ti.equ(d,F,zp)&&_d(F,d),g&&!I.events.handlers&&I.set({events:g(s)});let J=HY(t,p);return ti.equ(J,I.size,zp)||I.setSize(J.width,J.height,J.updateStyle,J.top,J.left),M&&I.viewport.dpr!==sU(M)&&I.setDpr(M),I.frameloop!==C&&I.setFrameloop(C),I.onPointerMissed||I.set({onPointerMissed:A}),L&&!ti.equ(L,I.performance,zp)&&I.set(K=>({performance:{...K.performance,...L}})),a=_,l=!0,this},render(u){return l||this.configure(),l_.updateContainer((0,Gb.jsx)(WY,{store:s,children:u,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){Xb(t)}}}function WY({store:t,children:e,onCreated:n,rootElement:i}){return jp(()=>{let r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),(0,Gb.jsx)(r3.Provider,{value:t,children:e})}function Xb(t,e){let n=yd.get(t),i=n?.fiber;if(i){let r=n?.store.getState();r&&(r.internal.active=!1),l_.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),aU(r),yd.delete(t),e&&e(t)}catch{}},500)})}}function qb(t){let{handlePointer:e}=uU(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys($A).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;let{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{var i;let{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:n}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{let[l,c]=$A[o];n.addEventListener(l,a,{passive:c})})},disconnect:()=>{let{set:n,events:i}=t.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){let[a]=$A[s];i.connected.removeEventListener(a,o)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}var Ki,_l,Gb,QB,jb,t3,n3,qB,YB,VA,eU,tU,nU,jp,a_,rU,KB,LY,Hp,ti,$B,PY,hU,r3,NY,Wb,OY,BY,UY,qA,YA,ZB,yd,QA,e3,l_,_d,zp,zY,$A,l3=Hl(()=>{Ou();Ki=mt(Ct()),_l=mt(xA());fB();SA();Gb=mt(bA()),QB=mt(DA()),jb=mt(WA()),t3={},n3=t=>{Object.assign(t3,t)};VA=t=>"colorSpace"in t||"outputColorSpace"in t,eU=()=>{var t;return(t=t3.ColorManagement)!=null?t:null},tU=t=>t&&t.isOrthographicCamera,nU=t=>t&&t.hasOwnProperty("current"),jp=typeof window<"u"&&((qB=window.document)!=null&&qB.createElement||((YB=window.navigator)==null?void 0:YB.product)==="ReactNative")?Ki.useLayoutEffect:Ki.useEffect;a_=class extends Ki.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}};a_.getDerivedStateFromError=()=>({error:!0});rU="__default",KB=new Map,LY=t=>t&&!!t.memoized&&!!t.changes;Hp=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()};ti={obj:t=>t===Object(t)&&!ti.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(ti.str(t)||ti.num(t)||ti.boo(t))return t===e;let s=ti.obj(t);if(s&&i==="reference")return t===e;let o=ti.arr(t);if(o&&n==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(a in r?e:t)if(!ti.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if(ti.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};$B=/-\d+$/;PY=typeof process<"u"&&!1;hU=t=>!!(t!=null&&t.render),r3=Ki.createContext(null),NY=(t,e)=>{let n=dB((a,l)=>{let c=new Y,u=new Y,d=new Y;function p(v=l().camera,S=u,b=l().size){let{width:w,height:C,top:M,left:L}=b,P=w/C;S.isVector3?d.copy(S):d.set(...S);let T=v.getWorldPosition(c).distanceTo(d);if(tU(v))return{width:w/v.zoom,height:C/v.zoom,top:M,left:L,factor:1,distance:T,aspect:P};{let A=v.fov*Math.PI/180,I=2*Math.tan(A/2)*T,F=I*(w/C);return{width:F,height:I,top:M,left:L,factor:w/F,distance:T,aspect:P}}}let m,g=v=>a(S=>({performance:{...S.performance,current:v}})),_=new We;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(v=1)=>t(l(),v),advance:(v,S)=>e(v,S,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new id,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let v=l();m&&clearTimeout(m),v.performance.current!==v.performance.min&&g(v.performance.min),m=setTimeout(()=>g(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:p},setEvents:v=>a(S=>({...S,events:{...S.events,...v}})),setSize:(v,S,b,w,C)=>{let M=l().camera,L={width:v,height:S,top:w||0,left:C||0,updateStyle:b};a(P=>({size:L,viewport:{...P.viewport,...p(M,u,L)}}))},setDpr:v=>a(S=>{let b=sU(v);return{viewport:{...S.viewport,dpr:b,initialDpr:S.viewport.initialDpr||b}}}),setFrameloop:(v="always")=>{let S=l().clock;S.stop(),S.elapsedTime=0,v!=="never"&&(S.start(),S.elapsedTime=0),a(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:Ki.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,S,b)=>{let w=l().internal;return w.priority=w.priority+(S>0?1:0),w.subscribers.push({ref:v,priority:S,store:b}),w.subscribers=w.subscribers.sort((C,M)=>C.priority-M.priority),()=>{let C=l().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(S>0?1:0),C.subscribers=C.subscribers.filter(M=>M.ref!==v))}}}}}),i=n.getState(),r=i.size,s=i.viewport.dpr,o=i.camera;return n.subscribe(()=>{let{camera:a,size:l,viewport:c,gl:u,set:d}=n.getState();if(l.width!==r.width||l.height!==r.height||c.dpr!==s){var p;r=l,s=c.dpr,DY(a,l),u.setPixelRatio(c.dpr);let m=(p=l.updateStyle)!=null?p:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,m)}a!==o&&(o=a,d(m=>({viewport:{...m.viewport,...m.viewport.getCurrentViewport(a)}})))}),n.subscribe(a=>t(a)),n},OY=new Set,BY=new Set,UY=new Set;ZB=new WeakMap;o3.preload=function(t,e,n){let i=Array.isArray(e)?e:[e];return gB(dU(n),[t,...i])};o3.clear=function(t,e){let n=Array.isArray(e)?e:[e];return vB([t,...n])};yd=new Map,{invalidate:QA,advance:e3}=FY(yd),{reconciler:l_,applyProps:_d}=kY(yd,IY),zp={objects:"shallow",strict:!1},zY=(t,e)=>{let n=typeof t=="function"?t(e):t;return hU(n)?n:new e_({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};l_.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:Ki.version});$A={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]}});function fU(t,e){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...i),e)}}function pU({debounce:t,scroll:e,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){let r=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[s,o]=(0,Eo.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=(0,Eo.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=t?typeof t=="number"?t:t.scroll:null,c=t?typeof t=="number"?t:t.resize:null,u=(0,Eo.useRef)(!1);(0,Eo.useEffect)(()=>(u.current=!0,()=>{u.current=!1}));let[d,p,m]=(0,Eo.useMemo)(()=>{let v=()=>{if(!a.current.element)return;let{left:S,top:b,width:w,height:C,bottom:M,right:L,x:P,y:T}=a.current.element.getBoundingClientRect(),A={left:S,top:b,width:w,height:C,bottom:M,right:L,x:P,y:T};a.current.element instanceof HTMLElement&&i&&(A.height=a.current.element.offsetHeight,A.width=a.current.element.offsetWidth),Object.freeze(A),u.current&&!XY(a.current.lastBounds,A)&&o(a.current.lastBounds=A)};return[v,c?fU(v,c):v,l?fU(v,l):v]},[o,i,l,c]);function g(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",m,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function _(){a.current.element&&(a.current.resizeObserver=new r(m),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(v=>v.addEventListener("scroll",m,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}let y=v=>{!v||v===a.current.element||(g(),a.current.element=v,a.current.scrollContainers=mU(v),_())};return GY(m,!!e),VY(p),(0,Eo.useEffect)(()=>{g(),_()},[e,m,p]),(0,Eo.useEffect)(()=>g,[]),[y,s,d]}function VY(t){(0,Eo.useEffect)(()=>{let e=t;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[t])}function GY(t,e){(0,Eo.useEffect)(()=>{if(e){let n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",n,!0)}}},[t,e])}function mU(t){let e=[];if(!t||t===document.body)return e;let{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...mU(t.parentElement)]}var Eo,jY,XY,gU=Hl(()=>{Eo=mt(Ct(),1);jY=["x","y","top","bottom","left","right","width","height"],XY=(t,e)=>jY.every(n=>t[n]===e[n])});function wU(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){let r=wU(i,e,n);if(r)return r;i=e?null:i.sibling}}function EU(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}function QY(){let t=di.useContext(c3);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");let e=di.useId();return di.useMemo(()=>{for(let i of[t,t?.alternate]){if(!i)continue;let r=wU(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[t,e])}function eK(){let t=QY(),[e]=di.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){let r=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;r&&r!==c3&&!e.has(r)&&e.set(r,di.useContext(EU(r)))}n=n.return}return e}function CU(){let t=eK();return di.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>di.createElement(e,null,di.createElement(n.Provider,ZY(yU({},i),{value:t.get(n)}))),e=>di.createElement(c_,yU({},e))),[t])}var di,qY,YY,KY,vU,$Y,JY,_U,yU,ZY,xU,SU,Gie,bU,c3,c_,TU=Hl(()=>{di=mt(Ct(),1),qY=Object.defineProperty,YY=Object.defineProperties,KY=Object.getOwnPropertyDescriptors,vU=Object.getOwnPropertySymbols,$Y=Object.prototype.hasOwnProperty,JY=Object.prototype.propertyIsEnumerable,_U=(t,e,n)=>e in t?qY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yU=(t,e)=>{for(var n in e||(e={}))$Y.call(e,n)&&_U(t,n,e[n]);if(vU)for(var n of vU(e))JY.call(e,n)&&_U(t,n,e[n]);return t},ZY=(t,e)=>YY(t,KY(e)),Gie=typeof window<"u"&&((xU=window.document)!=null&&xU.createElement||((SU=window.navigator)==null?void 0:SU.product)==="ReactNative")?di.useLayoutEffect:di.useEffect;bU=console.error;console.error=function(){let t=[...arguments].join("");if(t?.startsWith("Warning:")&&t.includes("useContext")){console.error=bU;return}return bU.apply(this,arguments)};c3=EU(di.createContext(null)),c_=class extends di.Component{render(){return di.createElement(c3.Provider,{value:this._reactInternals},this.props.children)}}});var xr,yl,sre,ore,are,tK,Yb,u_=Hl(()=>{l3();l3();xr=mt(Ct());Ou();gU();TU();yl=mt(bA()),sre=mt(xA()),ore=mt(DA()),are=mt(WA()),tK=xr.forwardRef(function({children:e,fallback:n,resize:i,style:r,gl:s,events:o=qb,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:d,legacy:p,orthographic:m,frameloop:g,dpr:_,performance:y,raycaster:v,camera:S,scene:b,onPointerMissed:w,onCreated:C,...M},L){xr.useMemo(()=>n3(Fp),[]);let P=CU(),[T,A]=pU({scroll:!0,debounce:{scroll:50,resize:0},...i}),I=xr.useRef(null),F=xr.useRef(null);xr.useImperativeHandle(L,()=>I.current);let B=i3(w),[O,z]=xr.useState(!1),[U,G]=xr.useState(!1);if(O)throw O;if(U)throw U;let j=xr.useRef(null);return jp(()=>{let K=I.current;A.width>0&&A.height>0&&K&&(j.current||(j.current=a3(K)),j.current.configure({gl:s,events:o,shadows:c,linear:u,flat:d,legacy:p,orthographic:m,frameloop:g,dpr:_,performance:y,raycaster:v,camera:S,scene:b,size:A,onPointerMissed:(...D)=>B.current==null?void 0:B.current(...D),onCreated:D=>{D.events.connect==null||D.events.connect(a?nU(a)?a.current:a:F.current),l&&D.setEvents({compute:(X,q)=>{let ne=X[l+"X"],re=X[l+"Y"];q.pointer.set(ne/q.size.width*2-1,-(re/q.size.height)*2+1),q.raycaster.setFromCamera(q.pointer,q.camera)}}),C?.(D)}}),j.current.render((0,yl.jsx)(P,{children:(0,yl.jsx)(a_,{set:G,children:(0,yl.jsx)(xr.Suspense,{fallback:(0,yl.jsx)(iU,{set:z}),children:e??null})})})))}),xr.useEffect(()=>{let K=I.current;if(K)return()=>Xb(K)},[]),(0,yl.jsx)("div",{ref:F,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:a?"none":"auto",...r},...M,children:(0,yl.jsx)("div",{ref:T,style:{width:"100%",height:"100%"},children:(0,yl.jsx)("canvas",{ref:I,style:{display:"block"},children:n})})})}),Yb=xr.forwardRef(function(e,n){return(0,yl.jsx)(c_,{children:(0,yl.jsx)(tK,{...e,ref:n})})})});var kU={};KP(kU,{default:()=>AU});function MU({side:t}){let e=(0,Nn.useRef)(null),n=t==="left",i=(0,Nn.useMemo)(()=>{let r=new Eu(.85,32,24,n?Math.PI/2:0,Math.PI,0,Math.PI),s=r.attributes.position;for(let o=0;o<s.count;o++){let a=s.getX(o),l=s.getY(o),c=s.getZ(o),u=Math.sin(l*6)*.04,d=Math.sin(l*3+a*2)*.03,p=Math.cos(c*4+l*2)*.025,m=Math.sqrt(a*a+l*l+c*c);if(m>0){let _=1+(u+d+p)/m;s.setXYZ(o,a*_,l*_,c*_)}}return r.computeVertexNormals(),r},[n]);return Nn.default.createElement("mesh",{ref:e,geometry:i,position:[n?-.08:.08,0,0]},Nn.default.createElement("meshStandardMaterial",{color:"#e0e0e0",roughness:.65,metalness:.15,transparent:!0,opacity:n?.92:.85,side:ts}))}function iK({start:t,end:e,index:n}){let i=(0,Nn.useRef)(null),r=(0,Nn.useMemo)(()=>{let s=new Wt,o=[new Y(...t),new Y(...e)];return s.setFromPoints(o),s},[t,e]);return _c(({clock:s})=>{if(i.current){let o=i.current.material,a=s.getElapsedTime();o.opacity=.12+Math.sin(a*1.5+n*.7)*.08}}),Nn.default.createElement("line",{ref:i,geometry:r},Nn.default.createElement("lineBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.15}))}function rK({position:t,radius:e}){let n=(0,Nn.useRef)(null);return Nn.default.createElement("mesh",{ref:n,position:t},Nn.default.createElement("sphereGeometry",{args:[e,12,12]}),Nn.default.createElement("meshStandardMaterial",{color:"#ffffff",emissive:"#ffffff",emissiveIntensity:.3,transparent:!0,opacity:.8}))}function sK(){let t=(0,Nn.useRef)(null);return _c(({clock:e})=>{if(t.current){let n=t.current.material,i=e.getElapsedTime();n.emissiveIntensity=.4+Math.sin(i*2)*.2}}),Nn.default.createElement("mesh",{ref:t,position:[0,0,0]},Nn.default.createElement("sphereGeometry",{args:[.08,16,16]}),Nn.default.createElement("meshStandardMaterial",{color:"#ffffff",emissive:"#ffffff",emissiveIntensity:.5,transparent:!0,opacity:.95}))}function oK({isProcessing:t}){let e=(0,Nn.useRef)(null);return _c(()=>{if(e.current){let n=t?.012:.003;e.current.rotation.y+=n}}),Nn.default.createElement("group",{ref:e},Nn.default.createElement(MU,{side:"left"}),Nn.default.createElement(MU,{side:"right"}),nK.map(([n,i],r)=>Nn.default.createElement(iK,{key:`conn-${r}`,start:u3[n],end:u3[i],index:r})),u3.map((n,i)=>Nn.default.createElement(rK,{key:`node-${i}`,position:n,radius:i<6?.04:.03})),Nn.default.createElement(sK,null))}function AU({isProcessing:t}){return Nn.default.createElement(Yb,{camera:{position:[0,0,2.8],fov:40},style:{background:"transparent"},gl:{alpha:!0,antialias:!0},dpr:[1,2]},Nn.default.createElement("ambientLight",{intensity:.4}),Nn.default.createElement("directionalLight",{position:[2,2,3],intensity:.8,color:"#ffffff"}),Nn.default.createElement("directionalLight",{position:[-2,-1,2],intensity:.4,color:"#cccccc"}),Nn.default.createElement(oK,{isProcessing:t}))}var Nn,u3,nK,LU=Hl(()=>{"use strict";Nn=mt(Ct(),1);u_();Ou();u3=[[-.8,.8,.3],[.8,.8,.3],[-1,0,.2],[1,0,.2],[-.8,-.8,.3],[.8,-.8,.3],[-.5,.4,-.4],[.5,.4,-.4],[-.5,-.4,-.4],[.5,-.4,-.4],[0,.6,.5],[0,-.6,.5]],nK=[[0,6],[1,7],[2,8],[3,9],[4,8],[5,9],[6,7],[8,9],[0,10],[1,10],[10,11],[4,11],[5,11],[6,8],[7,9],[2,6],[3,7],[0,2],[1,3],[2,4],[3,5]]});var f3=Kn((Gre,vK)=>{vK.exports={Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",amp:"&",AMP:"&",andand:"\u2A55",And:"\u2A53",and:"\u2227",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angmsd:"\u2221",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",apacir:"\u2A6F",ap:"\u2248",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",barwed:"\u2305",Barwed:"\u2306",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",because:"\u2235",Because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxdl:"\u2510",boxdL:"\u2555",boxDl:"\u2556",boxDL:"\u2557",boxdr:"\u250C",boxdR:"\u2552",boxDr:"\u2553",boxDR:"\u2554",boxh:"\u2500",boxH:"\u2550",boxhd:"\u252C",boxHd:"\u2564",boxhD:"\u2565",boxHD:"\u2566",boxhu:"\u2534",boxHu:"\u2567",boxhU:"\u2568",boxHU:"\u2569",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxul:"\u2518",boxuL:"\u255B",boxUl:"\u255C",boxUL:"\u255D",boxur:"\u2514",boxuR:"\u2558",boxUr:"\u2559",boxUR:"\u255A",boxv:"\u2502",boxV:"\u2551",boxvh:"\u253C",boxvH:"\u256A",boxVh:"\u256B",boxVH:"\u256C",boxvl:"\u2524",boxvL:"\u2561",boxVl:"\u2562",boxVL:"\u2563",boxvr:"\u251C",boxvR:"\u255E",boxVr:"\u255F",boxVR:"\u2560",bprime:"\u2035",breve:"\u02D8",Breve:"\u02D8",brvbar:"\xA6",bscr:"\u{1D4B7}",Bscr:"\u212C",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsolb:"\u29C5",bsol:"\\",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",cap:"\u2229",Cap:"\u22D2",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",centerdot:"\xB7",CenterDot:"\xB7",cfr:"\u{1D520}",Cfr:"\u212D",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cir:"\u25CB",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",colon:":",Colon:"\u2237",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",conint:"\u222E",Conint:"\u222F",ContourIntegral:"\u222E",copf:"\u{1D554}",Copf:"\u2102",coprod:"\u2210",Coproduct:"\u2210",copy:"\xA9",COPY:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",cross:"\u2717",Cross:"\u2A2F",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",cupbrcap:"\u2A48",cupcap:"\u2A46",CupCap:"\u224D",cup:"\u222A",Cup:"\u22D3",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",dagger:"\u2020",Dagger:"\u2021",daleth:"\u2138",darr:"\u2193",Darr:"\u21A1",dArr:"\u21D3",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",ddagger:"\u2021",ddarr:"\u21CA",DD:"\u2145",dd:"\u2146",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",diamond:"\u22C4",Diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrowBar:"\u2913",downarrow:"\u2193",DownArrow:"\u2193",Downarrow:"\u21D3",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVectorBar:"\u2956",DownLeftVector:"\u21BD",DownRightTeeVector:"\u295F",DownRightVectorBar:"\u2957",DownRightVector:"\u21C1",DownTeeArrow:"\u21A7",DownTee:"\u22A4",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",Ecirc:"\xCA",ecirc:"\xEA",ecir:"\u2256",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",edot:"\u0117",eDot:"\u2251",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp13:"\u2004",emsp14:"\u2005",emsp:"\u2003",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",escr:"\u212F",Escr:"\u2130",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",exponentiale:"\u2147",ExponentialE:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",forall:"\u2200",ForAll:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",fscr:"\u{1D4BB}",Fscr:"\u2131",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",ge:"\u2265",gE:"\u2267",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",gescc:"\u2AA9",ges:"\u2A7E",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",gg:"\u226B",Gg:"\u22D9",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gla:"\u2AA5",gl:"\u2277",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gne:"\u2A88",gnE:"\u2269",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",gtcc:"\u2AA7",gtcir:"\u2A7A",gt:">",GT:">",Gt:"\u226B",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",harrcir:"\u2948",harr:"\u2194",hArr:"\u21D4",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",hfr:"\u{1D525}",Hfr:"\u210C",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",hopf:"\u{1D559}",Hopf:"\u210D",horbar:"\u2015",HorizontalLine:"\u2500",hscr:"\u{1D4BD}",Hscr:"\u210B",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",ifr:"\u{1D526}",Ifr:"\u2111",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",Im:"\u2111",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",incare:"\u2105",in:"\u2208",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",intcal:"\u22BA",int:"\u222B",Int:"\u222C",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",iscr:"\u{1D4BE}",Iscr:"\u2110",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",lang:"\u27E8",Lang:"\u27EA",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",larrb:"\u21E4",larrbfs:"\u291F",larr:"\u2190",Larr:"\u219E",lArr:"\u21D0",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",latail:"\u2919",lAtail:"\u291B",lat:"\u2AAB",late:"\u2AAD",lates:"\u2AAD\uFE00",lbarr:"\u290C",lBarr:"\u290E",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",le:"\u2264",lE:"\u2266",LeftAngleBracket:"\u27E8",LeftArrowBar:"\u21E4",leftarrow:"\u2190",LeftArrow:"\u2190",Leftarrow:"\u21D0",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVectorBar:"\u2959",LeftDownVector:"\u21C3",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",leftrightarrow:"\u2194",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTeeArrow:"\u21A4",LeftTee:"\u22A3",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangleBar:"\u29CF",LeftTriangle:"\u22B2",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVectorBar:"\u2958",LeftUpVector:"\u21BF",LeftVectorBar:"\u2952",LeftVector:"\u21BC",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",lescc:"\u2AA8",les:"\u2A7D",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",llarr:"\u21C7",ll:"\u226A",Ll:"\u22D8",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoustache:"\u23B0",lmoust:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lne:"\u2A87",lnE:"\u2268",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",longleftarrow:"\u27F5",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftrightarrow:"\u27F7",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longmapsto:"\u27FC",longrightarrow:"\u27F6",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",lscr:"\u{1D4C1}",Lscr:"\u2112",lsh:"\u21B0",Lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",ltcc:"\u2AA6",ltcir:"\u2A79",lt:"<",LT:"<",Lt:"\u226A",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",midast:"*",midcir:"\u2AF0",mid:"\u2223",middot:"\xB7",minusb:"\u229F",minus:"\u2212",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",mscr:"\u{1D4C2}",Mscr:"\u2133",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natural:"\u266E",naturals:"\u2115",natur:"\u266E",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",nearhk:"\u2924",nearr:"\u2197",neArr:"\u21D7",nearrow:"\u2197",ne:"\u2260",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nharr:"\u21AE",nhArr:"\u21CE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlarr:"\u219A",nlArr:"\u21CD",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nleftarrow:"\u219A",nLeftarrow:"\u21CD",nleftrightarrow:"\u21AE",nLeftrightarrow:"\u21CE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",nopf:"\u{1D55F}",Nopf:"\u2115",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangle:"\u22EA",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangle:"\u22EB",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",nparallel:"\u2226",npar:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",nprec:"\u2280",npreceq:"\u2AAF\u0338",npre:"\u2AAF\u0338",nrarrc:"\u2933\u0338",nrarr:"\u219B",nrArr:"\u21CF",nrarrw:"\u219D\u0338",nrightarrow:"\u219B",nRightarrow:"\u21CF",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nvdash:"\u22AC",nvDash:"\u22AD",nVdash:"\u22AE",nVDash:"\u22AF",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwarr:"\u2196",nwArr:"\u21D6",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",Ocirc:"\xD4",ocirc:"\xF4",ocir:"\u229A",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",orarr:"\u21BB",Or:"\u2A54",or:"\u2228",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",otimesas:"\u2A36",Otimes:"\u2A37",otimes:"\u2297",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",para:"\xB6",parallel:"\u2225",par:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plus:"+",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",popf:"\u{1D561}",Popf:"\u2119",pound:"\xA3",prap:"\u2AB7",Pr:"\u2ABB",pr:"\u227A",prcue:"\u227C",precapprox:"\u2AB7",prec:"\u227A",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",pre:"\u2AAF",prE:"\u2AB3",precsim:"\u227E",prime:"\u2032",Prime:"\u2033",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportional:"\u221D",Proportion:"\u2237",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",qopf:"\u{1D562}",Qopf:"\u211A",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",quot:'"',QUOT:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",rang:"\u27E9",Rang:"\u27EB",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarr:"\u2192",Rarr:"\u21A0",rArr:"\u21D2",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",ratail:"\u291A",rAtail:"\u291C",ratio:"\u2236",rationals:"\u211A",rbarr:"\u290D",rBarr:"\u290F",RBarr:"\u2910",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",Re:"\u211C",rect:"\u25AD",reg:"\xAE",REG:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",rfr:"\u{1D52F}",Rfr:"\u211C",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrowBar:"\u21E5",rightarrow:"\u2192",RightArrow:"\u2192",Rightarrow:"\u21D2",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVectorBar:"\u2955",RightDownVector:"\u21C2",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTeeArrow:"\u21A6",RightTee:"\u22A2",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangleBar:"\u29D0",RightTriangle:"\u22B3",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVectorBar:"\u2954",RightUpVector:"\u21BE",RightVectorBar:"\u2953",RightVector:"\u21C0",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoustache:"\u23B1",rmoust:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",ropf:"\u{1D563}",Ropf:"\u211D",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",rscr:"\u{1D4C7}",Rscr:"\u211B",rsh:"\u21B1",Rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",Sc:"\u2ABC",sc:"\u227B",sccue:"\u227D",sce:"\u2AB0",scE:"\u2AB4",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdotb:"\u22A1",sdot:"\u22C5",sdote:"\u2A66",searhk:"\u2925",searr:"\u2198",seArr:"\u21D8",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",solbar:"\u233F",solb:"\u29C4",sol:"/",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",square:"\u25A1",Square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squ:"\u25A1",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",sub:"\u2282",Sub:"\u22D0",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",subset:"\u2282",Subset:"\u22D0",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succapprox:"\u2AB8",succ:"\u227B",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",sum:"\u2211",Sum:"\u2211",sung:"\u266A",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",sup:"\u2283",Sup:"\u22D1",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",supset:"\u2283",Supset:"\u22D1",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swarr:"\u2199",swArr:"\u21D9",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",therefore:"\u2234",Therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",ThinSpace:"\u2009",thinsp:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",tilde:"\u02DC",Tilde:"\u223C",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",timesbar:"\u2A31",timesb:"\u22A0",times:"\xD7",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",topbot:"\u2336",topcir:"\u2AF1",top:"\u22A4",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",trade:"\u2122",TRADE:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",uarr:"\u2191",Uarr:"\u219F",uArr:"\u21D1",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrowBar:"\u2912",uparrow:"\u2191",UpArrow:"\u2191",Uparrow:"\u21D1",UpArrowDownArrow:"\u21C5",updownarrow:"\u2195",UpDownArrow:"\u2195",Updownarrow:"\u21D5",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",upsi:"\u03C5",Upsi:"\u03D2",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTeeArrow:"\u21A5",UpTee:"\u22A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",varr:"\u2195",vArr:"\u21D5",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",vBar:"\u2AE8",Vbar:"\u2AEB",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",vdash:"\u22A2",vDash:"\u22A8",Vdash:"\u22A9",VDash:"\u22AB",Vdashl:"\u2AE6",veebar:"\u22BB",vee:"\u2228",Vee:"\u22C1",veeeq:"\u225A",vellip:"\u22EE",verbar:"|",Verbar:"\u2016",vert:"|",Vert:"\u2016",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",wedge:"\u2227",Wedge:"\u22C0",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xharr:"\u27F7",xhArr:"\u27FA",Xi:"\u039E",xi:"\u03BE",xlarr:"\u27F5",xlArr:"\u27F8",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrarr:"\u27F6",xrArr:"\u27F9",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",yuml:"\xFF",Yuml:"\u0178",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",zfr:"\u{1D537}",Zfr:"\u2128",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",zopf:"\u{1D56B}",Zopf:"\u2124",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"}});var YU=Kn((jre,_K)=>{_K.exports={Aacute:"\xC1",aacute:"\xE1",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",AElig:"\xC6",aelig:"\xE6",Agrave:"\xC0",agrave:"\xE0",amp:"&",AMP:"&",Aring:"\xC5",aring:"\xE5",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",brvbar:"\xA6",Ccedil:"\xC7",ccedil:"\xE7",cedil:"\xB8",cent:"\xA2",copy:"\xA9",COPY:"\xA9",curren:"\xA4",deg:"\xB0",divide:"\xF7",Eacute:"\xC9",eacute:"\xE9",Ecirc:"\xCA",ecirc:"\xEA",Egrave:"\xC8",egrave:"\xE8",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",frac12:"\xBD",frac14:"\xBC",frac34:"\xBE",gt:">",GT:">",Iacute:"\xCD",iacute:"\xED",Icirc:"\xCE",icirc:"\xEE",iexcl:"\xA1",Igrave:"\xCC",igrave:"\xEC",iquest:"\xBF",Iuml:"\xCF",iuml:"\xEF",laquo:"\xAB",lt:"<",LT:"<",macr:"\xAF",micro:"\xB5",middot:"\xB7",nbsp:"\xA0",not:"\xAC",Ntilde:"\xD1",ntilde:"\xF1",Oacute:"\xD3",oacute:"\xF3",Ocirc:"\xD4",ocirc:"\xF4",Ograve:"\xD2",ograve:"\xF2",ordf:"\xAA",ordm:"\xBA",Oslash:"\xD8",oslash:"\xF8",Otilde:"\xD5",otilde:"\xF5",Ouml:"\xD6",ouml:"\xF6",para:"\xB6",plusmn:"\xB1",pound:"\xA3",quot:'"',QUOT:'"',raquo:"\xBB",reg:"\xAE",REG:"\xAE",sect:"\xA7",shy:"\xAD",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",szlig:"\xDF",THORN:"\xDE",thorn:"\xFE",times:"\xD7",Uacute:"\xDA",uacute:"\xFA",Ucirc:"\xDB",ucirc:"\xFB",Ugrave:"\xD9",ugrave:"\xF9",uml:"\xA8",Uuml:"\xDC",uuml:"\xFC",Yacute:"\xDD",yacute:"\xFD",yen:"\xA5",yuml:"\xFF"}});var p3=Kn((Xre,yK)=>{yK.exports={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}});var KU=Kn((qre,xK)=>{xK.exports={"0":65533,"128":8364,"130":8218,"131":402,"132":8222,"133":8230,"134":8224,"135":8225,"136":710,"137":8240,"138":352,"139":8249,"140":338,"142":381,"145":8216,"146":8217,"147":8220,"148":8221,"149":8226,"150":8211,"151":8212,"152":732,"153":8482,"154":353,"155":8250,"156":339,"158":382,"159":376}});var JU=Kn(d_=>{"use strict";var SK=d_&&d_.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(d_,"__esModule",{value:!0});var $U=SK(KU()),bK=String.fromCodePoint||function(t){var e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function wK(t){return t>=55296&&t<=57343||t>1114111?"\uFFFD":(t in $U.default&&(t=$U.default[t]),bK(t))}d_.default=wK});var g3=Kn(Sl=>{"use strict";var Kb=Sl&&Sl.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Sl,"__esModule",{value:!0});Sl.decodeHTML=Sl.decodeHTMLStrict=Sl.decodeXML=void 0;var m3=Kb(f3()),EK=Kb(YU()),CK=Kb(p3()),ZU=Kb(JU()),TK=/&(?:[a-zA-Z0-9]+|#[xX][\da-fA-F]+|#\d+);/g;Sl.decodeXML=eF(CK.default);Sl.decodeHTMLStrict=eF(m3.default);function eF(t){var e=tF(t);return function(n){return String(n).replace(TK,e)}}var QU=function(t,e){return t<e?1:-1};Sl.decodeHTML=(function(){for(var t=Object.keys(EK.default).sort(QU),e=Object.keys(m3.default).sort(QU),n=0,i=0;n<e.length;n++)t[i]===e[n]?(e[n]+=";?",i++):e[n]+=";";var r=new RegExp("&(?:"+e.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),s=tF(m3.default);function o(a){return a.substr(-1)!==";"&&(a+=";"),s(a)}return function(a){return String(a).replace(r,o)}})();function tF(t){return function(n){if(n.charAt(1)==="#"){var i=n.charAt(2);return i==="X"||i==="x"?ZU.default(parseInt(n.substr(3),16)):ZU.default(parseInt(n.substr(2),10))}return t[n.slice(1,-1)]||n}}});var _3=Kn(qs=>{"use strict";var nF=qs&&qs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(qs,"__esModule",{value:!0});qs.escapeUTF8=qs.escape=qs.encodeNonAsciiHTML=qs.encodeHTML=qs.encodeXML=void 0;var MK=nF(p3()),iF=sF(MK.default),rF=oF(iF);qs.encodeXML=cF(iF);var AK=nF(f3()),v3=sF(AK.default),kK=oF(v3);qs.encodeHTML=PK(v3,kK);qs.encodeNonAsciiHTML=cF(v3);function sF(t){return Object.keys(t).sort().reduce(function(e,n){return e[t[n]]="&"+n+";",e},{})}function oF(t){for(var e=[],n=[],i=0,r=Object.keys(t);i<r.length;i++){var s=r[i];s.length===1?e.push("\\"+s):n.push(s)}e.sort();for(var o=0;o<e.length-1;o++){for(var a=o;a<e.length-1&&e[a].charCodeAt(1)+1===e[a+1].charCodeAt(1);)a+=1;var l=1+a-o;l<3||e.splice(o,l,e[o]+"-"+e[a])}return n.unshift("["+e.join("")+"]"),new RegExp(n.join("|"),"g")}var aF=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,LK=String.prototype.codePointAt!=null?function(t){return t.codePointAt(0)}:function(t){return(t.charCodeAt(0)-55296)*1024+t.charCodeAt(1)-56320+65536};function $b(t){return"&#x"+(t.length>1?LK(t):t.charCodeAt(0)).toString(16).toUpperCase()+";"}function PK(t,e){return function(n){return n.replace(e,function(i){return t[i]}).replace(aF,$b)}}var lF=new RegExp(rF.source+"|"+aF.source,"g");function DK(t){return t.replace(lF,$b)}qs.escape=DK;function IK(t){return t.replace(rF,$b)}qs.escapeUTF8=IK;function cF(t){return function(e){return e.replace(lF,function(n){return t[n]||$b(n)})}}});var hF=Kn(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.decodeXMLStrict=fn.decodeHTML5Strict=fn.decodeHTML4Strict=fn.decodeHTML5=fn.decodeHTML4=fn.decodeHTMLStrict=fn.decodeHTML=fn.decodeXML=fn.encodeHTML5=fn.encodeHTML4=fn.escapeUTF8=fn.escape=fn.encodeNonAsciiHTML=fn.encodeHTML=fn.encodeXML=fn.encode=fn.decodeStrict=fn.decode=void 0;var Jb=g3(),uF=_3();function RK(t,e){return(!e||e<=0?Jb.decodeXML:Jb.decodeHTML)(t)}fn.decode=RK;function NK(t,e){return(!e||e<=0?Jb.decodeXML:Jb.decodeHTMLStrict)(t)}fn.decodeStrict=NK;function OK(t,e){return(!e||e<=0?uF.encodeXML:uF.encodeHTML)(t)}fn.encode=OK;var xd=_3();Object.defineProperty(fn,"encodeXML",{enumerable:!0,get:function(){return xd.encodeXML}});Object.defineProperty(fn,"encodeHTML",{enumerable:!0,get:function(){return xd.encodeHTML}});Object.defineProperty(fn,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return xd.encodeNonAsciiHTML}});Object.defineProperty(fn,"escape",{enumerable:!0,get:function(){return xd.escape}});Object.defineProperty(fn,"escapeUTF8",{enumerable:!0,get:function(){return xd.escapeUTF8}});Object.defineProperty(fn,"encodeHTML4",{enumerable:!0,get:function(){return xd.encodeHTML}});Object.defineProperty(fn,"encodeHTML5",{enumerable:!0,get:function(){return xd.encodeHTML}});var Wu=g3();Object.defineProperty(fn,"decodeXML",{enumerable:!0,get:function(){return Wu.decodeXML}});Object.defineProperty(fn,"decodeHTML",{enumerable:!0,get:function(){return Wu.decodeHTML}});Object.defineProperty(fn,"decodeHTMLStrict",{enumerable:!0,get:function(){return Wu.decodeHTMLStrict}});Object.defineProperty(fn,"decodeHTML4",{enumerable:!0,get:function(){return Wu.decodeHTML}});Object.defineProperty(fn,"decodeHTML5",{enumerable:!0,get:function(){return Wu.decodeHTML}});Object.defineProperty(fn,"decodeHTML4Strict",{enumerable:!0,get:function(){return Wu.decodeHTMLStrict}});Object.defineProperty(fn,"decodeHTML5Strict",{enumerable:!0,get:function(){return Wu.decodeHTMLStrict}});Object.defineProperty(fn,"decodeXMLStrict",{enumerable:!0,get:function(){return Wu.decodeXML}})});var bF=Kn((Zre,SF)=>{"use strict";function BK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dF(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function UK(t,e,n){return e&&dF(t.prototype,e),n&&dF(t,n),t}function _F(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=FK(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(c){throw c},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return s=c.done,c},e:function(c){o=!0,a=c},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(o)throw a}}}}function FK(t,e){if(t){if(typeof t=="string")return fF(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fF(t,e)}}function fF(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var zK=hF(),pF={fg:"#FFF",bg:"#000",newline:!1,escapeXML:!1,stream:!1,colors:HK()};function HK(){var t={0:"#000",1:"#A00",2:"#0A0",3:"#A50",4:"#00A",5:"#A0A",6:"#0AA",7:"#AAA",8:"#555",9:"#F55",10:"#5F5",11:"#FF5",12:"#55F",13:"#F5F",14:"#5FF",15:"#FFF"};return Zb(0,5).forEach(function(e){Zb(0,5).forEach(function(n){Zb(0,5).forEach(function(i){return WK(e,n,i,t)})})}),Zb(0,23).forEach(function(e){var n=e+232,i=yF(e*10+8);t[n]="#"+i+i+i}),t}function WK(t,e,n,i){var r=16+t*36+e*6+n,s=t>0?t*40+55:0,o=e>0?e*40+55:0,a=n>0?n*40+55:0;i[r]=VK([s,o,a])}function yF(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e}function VK(t){var e=[],n=_F(t),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;e.push(yF(r))}}catch(s){n.e(s)}finally{n.f()}return"#"+e.join("")}function mF(t,e,n,i){var r;return e==="text"?r=qK(n,i):e==="display"?r=jK(t,n,i):e==="xterm256Foreground"?r=ew(t,i.colors[n]):e==="xterm256Background"?r=tw(t,i.colors[n]):e==="rgb"&&(r=GK(t,n)),r}function GK(t,e){e=e.substring(2).slice(0,-1);var n=+e.substr(0,2),i=e.substring(5).split(";"),r=i.map(function(s){return("0"+Number(s).toString(16)).substr(-2)}).join("");return Qb(t,(n===38?"color:#":"background-color:#")+r)}function jK(t,e,n){e=parseInt(e,10);var i={"-1":function(){return"<br/>"},0:function(){return t.length&&xF(t)},1:function(){return Vu(t,"b")},3:function(){return Vu(t,"i")},4:function(){return Vu(t,"u")},8:function(){return Qb(t,"display:none")},9:function(){return Vu(t,"strike")},22:function(){return Qb(t,"font-weight:normal;text-decoration:none;font-style:normal")},23:function(){return vF(t,"i")},24:function(){return vF(t,"u")},39:function(){return ew(t,n.fg)},49:function(){return tw(t,n.bg)},53:function(){return Qb(t,"text-decoration:overline")}},r;return i[e]?r=i[e]():4<e&&e<7?r=Vu(t,"blink"):29<e&&e<38?r=ew(t,n.colors[e-30]):39<e&&e<48?r=tw(t,n.colors[e-40]):89<e&&e<98?r=ew(t,n.colors[8+(e-90)]):99<e&&e<108&&(r=tw(t,n.colors[8+(e-100)])),r}function xF(t){var e=t.slice(0);return t.length=0,e.reverse().map(function(n){return"</"+n+">"}).join("")}function Zb(t,e){for(var n=[],i=t;i<=e;i++)n.push(i);return n}function XK(t){return function(e){return(t===null||e.category!==t)&&t!=="all"}}function gF(t){t=parseInt(t,10);var e=null;return t===0?e="all":t===1?e="bold":2<t&&t<5?e="underline":4<t&&t<7?e="blink":t===8?e="hide":t===9?e="strike":29<t&&t<38||t===39||89<t&&t<98?e="foreground-color":(39<t&&t<48||t===49||99<t&&t<108)&&(e="background-color"),e}function qK(t,e){return e.escapeXML?zK.encodeXML(t):t}function Vu(t,e,n){return n||(n=""),t.push(e),"<".concat(e).concat(n?' style="'.concat(n,'"'):"",">")}function Qb(t,e){return Vu(t,"span",e)}function ew(t,e){return Vu(t,"span","color:"+e)}function tw(t,e){return Vu(t,"span","background-color:"+e)}function vF(t,e){var n;if(t.slice(-1)[0]===e&&(n=t.pop()),n)return"</"+e+">"}function YK(t,e,n){var i=!1,r=3;function s(){return""}function o(C,M){return n("xterm256Foreground",M),""}function a(C,M){return n("xterm256Background",M),""}function l(C){return e.newline?n("display",-1):n("text",C),""}function c(C,M){i=!0,M.trim().length===0&&(M="0"),M=M.trimRight(";").split(";");var L=_F(M),P;try{for(L.s();!(P=L.n()).done;){var T=P.value;n("display",T)}}catch(A){L.e(A)}finally{L.f()}return""}function u(C){return n("text",C),""}function d(C){return n("rgb",C),""}var p=[{pattern:/^\x08+/,sub:s},{pattern:/^\x1b\[[012]?K/,sub:s},{pattern:/^\x1b\[\(B/,sub:s},{pattern:/^\x1b\[[34]8;2;\d+;\d+;\d+m/,sub:d},{pattern:/^\x1b\[38;5;(\d+)m/,sub:o},{pattern:/^\x1b\[48;5;(\d+)m/,sub:a},{pattern:/^\n/,sub:l},{pattern:/^\r+\n/,sub:l},{pattern:/^\r/,sub:l},{pattern:/^\x1b\[((?:\d{1,3};?)+|)m/,sub:c},{pattern:/^\x1b\[\d?J/,sub:s},{pattern:/^\x1b\[\d{0,3};\d{0,3}f/,sub:s},{pattern:/^\x1b\[?[\d;]{0,3}/,sub:s},{pattern:/^(([^\x1b\x08\r\n])+)/,sub:u}];function m(C,M){M>r&&i||(i=!1,t=t.replace(C.pattern,C.sub))}var g=[],_=t,y=_.length;e:for(;y>0;){for(var v=0,S=0,b=p.length;S<b;v=++S){var w=p[v];if(m(w,v),t.length!==y){y=t.length;continue e}}if(t.length===y)break;g.push(0),y=t.length}return g}function KK(t,e,n){return e!=="text"&&(t=t.filter(XK(gF(n))),t.push({token:e,data:n,category:gF(n)})),t}var $K=(function(){function t(e){BK(this,t),e=e||{},e.colors&&(e.colors=Object.assign({},pF.colors,e.colors)),this.options=Object.assign({},pF,e),this.stack=[],this.stickyStack=[]}return UK(t,[{key:"toHtml",value:function(n){var i=this;n=typeof n=="string"?[n]:n;var r=this.stack,s=this.options,o=[];return this.stickyStack.forEach(function(a){var l=mF(r,a.token,a.data,s);l&&o.push(l)}),YK(n.join(""),s,function(a,l){var c=mF(r,a,l,s);c&&o.push(c),s.stream&&(i.stickyStack=KK(i.stickyStack,a,l))}),r.length&&o.push(xF(r)),o.join("")}}]),t})();SF.exports=$K});var SL=mt(Ct(),1),U8=mt(LN(),1);var Ot=mt(Ct(),1);var vn=mt(Ct(),1);var Vt=mt(Ct(),1);var aK=Vt.default.lazy(()=>Promise.resolve().then(()=>(LU(),kU)));function h3({isProcessing:t}){return Vt.default.createElement("svg",{className:`logomark ${t?"spinning":""}`,width:"80",height:"80",viewBox:"0 0 200 200",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Vt.default.createElement("defs",null,Vt.default.createElement("linearGradient",{id:"ub-brain-grad",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},Vt.default.createElement("stop",{offset:"0%",stopColor:"#ffffff"}),Vt.default.createElement("stop",{offset:"50%",stopColor:"#cccccc"}),Vt.default.createElement("stop",{offset:"100%",stopColor:"#999999"})),Vt.default.createElement("linearGradient",{id:"ub-node-glow",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},Vt.default.createElement("stop",{offset:"0%",stopColor:"#ffffff"}),Vt.default.createElement("stop",{offset:"100%",stopColor:"#cccccc"}))),Vt.default.createElement("path",{d:"M 93 20 C 58 20, 16 52, 16 100 C 16 148, 58 180, 93 180 Z",fill:"url(#ub-brain-grad)",opacity:"0.95"}),Vt.default.createElement("path",{d:"M 107 20 C 142 20, 184 52, 184 100 C 184 148, 142 180, 107 180 Z",fill:"url(#ub-brain-grad)",opacity:"0.88"}),Vt.default.createElement("path",{d:"M 30 62 Q 54 73, 87 66",fill:"none",stroke:"white",strokeWidth:"2.2",strokeLinecap:"round",opacity:"0.30"}),Vt.default.createElement("path",{d:"M 26 100 Q 50 113, 87 104",fill:"none",stroke:"white",strokeWidth:"2.2",strokeLinecap:"round",opacity:"0.30"}),Vt.default.createElement("path",{d:"M 30 138 Q 54 148, 87 142",fill:"none",stroke:"white",strokeWidth:"2.2",strokeLinecap:"round",opacity:"0.30"}),Vt.default.createElement("path",{d:"M 170 62 Q 146 73, 113 66",fill:"none",stroke:"white",strokeWidth:"2.2",strokeLinecap:"round",opacity:"0.30"}),Vt.default.createElement("path",{d:"M 174 100 Q 150 113, 113 104",fill:"none",stroke:"white",strokeWidth:"2.2",strokeLinecap:"round",opacity:"0.30"}),Vt.default.createElement("path",{d:"M 170 138 Q 146 148, 113 142",fill:"none",stroke:"white",strokeWidth:"2.2",strokeLinecap:"round",opacity:"0.30"}),Vt.default.createElement("line",{x1:"54",y1:"54",x2:"100",y2:"100",stroke:"white",strokeWidth:"1.2",opacity:"0.18"}),Vt.default.createElement("line",{x1:"146",y1:"54",x2:"100",y2:"100",stroke:"white",strokeWidth:"1.2",opacity:"0.18"}),Vt.default.createElement("line",{x1:"46",y1:"100",x2:"100",y2:"100",stroke:"white",strokeWidth:"1.2",opacity:"0.18"}),Vt.default.createElement("line",{x1:"154",y1:"100",x2:"100",y2:"100",stroke:"white",strokeWidth:"1.2",opacity:"0.18"}),Vt.default.createElement("line",{x1:"54",y1:"146",x2:"100",y2:"100",stroke:"white",strokeWidth:"1.2",opacity:"0.15"}),Vt.default.createElement("line",{x1:"146",y1:"146",x2:"100",y2:"100",stroke:"white",strokeWidth:"1.2",opacity:"0.15"}),Vt.default.createElement("circle",{cx:"54",cy:"54",r:"4.5",fill:"url(#ub-node-glow)",opacity:"0.85"}),Vt.default.createElement("circle",{cx:"146",cy:"54",r:"4.5",fill:"url(#ub-node-glow)",opacity:"0.85"}),Vt.default.createElement("circle",{cx:"46",cy:"100",r:"3.5",fill:"url(#ub-node-glow)",opacity:"0.75"}),Vt.default.createElement("circle",{cx:"154",cy:"100",r:"3.5",fill:"url(#ub-node-glow)",opacity:"0.75"}),Vt.default.createElement("circle",{cx:"54",cy:"146",r:"3.5",fill:"url(#ub-node-glow)",opacity:"0.70"}),Vt.default.createElement("circle",{cx:"146",cy:"146",r:"3.5",fill:"url(#ub-node-glow)",opacity:"0.70"}),Vt.default.createElement("circle",{cx:"100",cy:"100",r:"6",fill:"white",opacity:"0.92"}),Vt.default.createElement("circle",{cx:"100",cy:"100",r:"3.5",fill:"url(#ub-brain-grad)",opacity:"0.6"}))}var d3=class extends Vt.default.Component{constructor(){super(...arguments);$P(this,"state",{hasError:!1})}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?this.fallback:this.props.children}get fallback(){return this.props.fallback}};function PU({isProcessing:t,size:e=120}){let[n,i]=(0,Vt.useState)(!0);return(0,Vt.useEffect)(()=>{try{let r=document.createElement("canvas");r.getContext("webgl2")||r.getContext("webgl")||i(!1)}catch{i(!1)}},[]),n?Vt.default.createElement(d3,{fallback:Vt.default.createElement(h3,{isProcessing:t})},Vt.default.createElement(Vt.Suspense,{fallback:Vt.default.createElement(h3,{isProcessing:t})},Vt.default.createElement("div",{className:"brain-3d-container",style:{width:e,height:e}},Vt.default.createElement(aK,{isProcessing:t})))):Vt.default.createElement(h3,{isProcessing:t})}var xl=mt(Ct(),1);var Fu=mt(Ct(),1);function DU(t,e){let[n,i]=(0,Fu.useState)(null),[r,s]=(0,Fu.useState)(!0),[o,a]=(0,Fu.useState)(null),l=(0,Fu.useCallback)(async()=>{try{s(!0),a(null);let c=await fetch(`https://api.github.com/repos/${t}/${e}`);if(!c.ok)throw new Error(`GitHub API error: ${c.status}`);let u=await c.json();i(u.stargazers_count)}catch(c){console.error("Failed to fetch GitHub stars:",c),a(c instanceof Error?c:new Error("Unknown error"))}finally{s(!1)}},[t,e]);return(0,Fu.useEffect)(()=>{l()},[l]),{stars:n,isLoading:r,error:o}}function IU(t){return t<1e3?t.toString():t<1e6?`${(t/1e3).toFixed(1)}k`:`${(t/1e6).toFixed(1)}M`}function RU({username:t,repo:e,className:n=""}){let{stars:i,isLoading:r,error:s}=DU(t,e),o=`https://github.com/${t}/${e}`;return s?xl.default.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer",title:"GitHub",className:"icon-link"},xl.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},xl.default.createElement("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"}))):xl.default.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:`github-stars-btn ${n}`,title:`Star us on GitHub${i!==null?` (${i.toLocaleString()} stars)`:""}`},xl.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"6px"}},xl.default.createElement("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})),xl.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"4px"}},xl.default.createElement("path",{d:"M12 .587l3.668 7.431 8.2 1.192-5.934 5.787 1.4 8.166L12 18.896l-7.334 3.867 1.4-8.166-5.934-5.787 8.2-1.192z"})),xl.default.createElement("span",{className:r?"stars-loading":"stars-count"},r?"...":i!==null?IU(i):"\u2014"))}var zu=mt(Ct(),1);function NU(t){let e=(0,zu.useRef)(null),n=(0,zu.useRef)(null),i=(0,zu.useRef)(null),r=(0,zu.useRef)(0),s=(0,zu.useRef)(null);(0,zu.useEffect)(()=>{if(n.current||(n.current=document.createElement("canvas"),n.current.width=32,n.current.height=32),i.current||(i.current=new Image,i.current.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cpath d='M14.8 3.8C10 3.8 3.5 8.2 3.5 16s6.5 12.2 11.3 12.2Z' fill='%23fff' opacity='.95'/%3E%3Cpath d='M17.2 3.8C22 3.8 28.5 8.2 28.5 16s-6.5 12.2-11.3 12.2Z' fill='%23fff' opacity='.85'/%3E%3Cpath d='M5 9.7q3.6 1.2 9 .4M4.5 16q3.6 1.4 9 .5M5 22.3q3.6 1.1 9 .3M27 9.7q-3.6 1.2-9 .4M27.5 16q-3.6 1.4-9 .5M27 22.3q-3.6 1.1-9 .3' fill='none' stroke='%23000' stroke-width='.4' opacity='.1'/%3E%3Ccircle cx='9' cy='9' r='.9' fill='%23fff' opacity='.5'/%3E%3Ccircle cx='23' cy='9' r='.9' fill='%23fff' opacity='.5'/%3E%3Ccircle cx='16' cy='16' r='1.2' fill='%23fff'/%3E%3C/svg%3E"),!s.current){let d=document.querySelector('link[rel="icon"]');d&&(s.current=d.href)}let o=n.current,a=o.getContext("2d"),l=i.current;if(!a)return;let c=d=>{let p=document.querySelector('link[rel="icon"]');p||(p=document.createElement("link"),p.rel="icon",document.head.appendChild(p)),p.href=d},u=()=>{if(!l.complete){e.current=requestAnimationFrame(u);return}r.current+=2*Math.PI/90,a.clearRect(0,0,32,32),a.save(),a.translate(16,16),a.rotate(r.current),a.drawImage(l,-16,-16,32,32),a.restore(),c(o.toDataURL("image/png")),e.current=requestAnimationFrame(u)};return t?(r.current=0,u()):(e.current&&(cancelAnimationFrame(e.current),e.current=null),s.current&&c(s.current)),()=>{e.current&&(cancelAnimationFrame(e.current),e.current=null)}},[t])}function OU({isConnected:t,isProcessing:e,queueDepth:n,onContextPreviewToggle:i}){NU(e);let r=(0,vn.useRef)(null),[s,o]=(0,vn.useState)(!1);(0,vn.useEffect)(()=>{if(window.matchMedia("(display-mode: standalone)").matches)return;let l=c=>{c.preventDefault(),r.current=c,o(!0)};return window.addEventListener("beforeinstallprompt",l),()=>window.removeEventListener("beforeinstallprompt",l)},[]);let a=(0,vn.useCallback)(async()=>{if(!r.current)return;r.current.prompt(),(await r.current.userChoice).outcome==="accepted"&&o(!1),r.current=null},[]);return vn.default.createElement("div",{className:"header"},vn.default.createElement("div",{className:"iconnet-placeholder"},vn.default.createElement("img",{src:"assets/econlab_logo.png",alt:"EconLab",className:"econlab-logo"})),vn.default.createElement("div",{className:"brain-wrapper"},vn.default.createElement(PU,{isProcessing:e,size:120}),n>0&&vn.default.createElement("div",{className:"queue-bubble"},n)),vn.default.createElement("div",{className:"logo-text-group"},vn.default.createElement("span",{className:"logo-text"},"ULTRABRAIN"),vn.default.createElement("span",{className:"logo-version"},"v1.0")),vn.default.createElement("div",{className:"header-social-row"},vn.default.createElement("a",{href:"https://x.com/Econlab_DE",target:"_blank",rel:"noopener noreferrer",className:"header-social-icon",title:"Follow @Econlab_DE on X"},vn.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},vn.default.createElement("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"}))),vn.default.createElement("span",{className:"header-social-divider"},"\xB7"),vn.default.createElement(RU,{username:"EconLab-AI",repo:"Ultrabrain"}),s&&vn.default.createElement(vn.default.Fragment,null,vn.default.createElement("span",{className:"header-social-divider"},"\xB7"),vn.default.createElement("button",{className:"header-social-icon pwa-install-btn",onClick:a,title:"Install as App"},vn.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},vn.default.createElement("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),vn.default.createElement("polyline",{points:"7 10 12 15 17 10"}),vn.default.createElement("line",{x1:"12",y1:"15",x2:"12",y2:"3"})))),vn.default.createElement("span",{className:"header-social-divider"},"\xB7"),vn.default.createElement("button",{className:"header-social-icon",onClick:i,title:"Settings"},vn.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},vn.default.createElement("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),vn.default.createElement("circle",{cx:"12",cy:"12",r:"3"})))))}var Hn=mt(Ct(),1);var xn=mt(Ct(),1);function Xp(t){return new Date(t).toLocaleString()}function BU(t){let e=["/Scripts/","/src/","/plugin/","/docs/"];for(let r of e){let s=t.indexOf(r);if(s!==-1)return t.substring(s+1)}let n=t.indexOf("ultrabrain/");if(n!==-1)return t.substring(n+11);let i=t.split("/");return i.length>3?i.slice(-3).join("/"):t}function UU({observation:t}){let[e,n]=(0,xn.useState)(!1),[i,r]=(0,xn.useState)(!1),s=Xp(t.created_at_epoch),o=t.facts?JSON.parse(t.facts):[],a=t.concepts?JSON.parse(t.concepts):[],l=t.files_read?JSON.parse(t.files_read).map(BU):[],c=t.files_modified?JSON.parse(t.files_modified).map(BU):[],u=o.length>0||a.length>0||l.length>0||c.length>0;return xn.default.createElement("div",{className:"card"},xn.default.createElement("div",{className:"card-header"},xn.default.createElement("div",{className:"card-header-left"},xn.default.createElement("span",{className:`card-type type-${t.type}`},t.type),xn.default.createElement("span",{className:"card-project"},t.project)),xn.default.createElement("div",{className:"view-mode-toggles"},u&&xn.default.createElement("button",{className:`view-mode-toggle ${e?"active":""}`,onClick:()=>{n(!e),e||r(!1)}},xn.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},xn.default.createElement("polyline",{points:"9 11 12 14 22 4"}),xn.default.createElement("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})),xn.default.createElement("span",null,"facts")),t.narrative&&xn.default.createElement("button",{className:`view-mode-toggle ${i?"active":""}`,onClick:()=>{r(!i),i||n(!1)}},xn.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},xn.default.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),xn.default.createElement("polyline",{points:"14 2 14 8 20 8"}),xn.default.createElement("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),xn.default.createElement("line",{x1:"16",y1:"17",x2:"8",y2:"17"})),xn.default.createElement("span",null,"narrative")))),xn.default.createElement("div",{className:"card-title"},t.title||"Untitled"),xn.default.createElement("div",{className:"view-mode-content"},!e&&!i&&t.subtitle&&xn.default.createElement("div",{className:"card-subtitle"},t.subtitle),e&&o.length>0&&xn.default.createElement("ul",{className:"facts-list"},o.map((d,p)=>xn.default.createElement("li",{key:p},d))),i&&t.narrative&&xn.default.createElement("div",{className:"narrative"},t.narrative)),xn.default.createElement("div",{className:"card-meta"},xn.default.createElement("span",{className:"meta-date"},"#",t.id," \u2022 ",s),e&&(a.length>0||l.length>0||c.length>0)&&xn.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"}},a.map((d,p)=>xn.default.createElement("span",{key:p,style:{padding:"2px 8px",background:"var(--color-type-badge-bg)",color:"var(--color-type-badge-text)",borderRadius:"3px",fontWeight:"500",fontSize:"10px"}},d)),l.length>0&&xn.default.createElement("span",{className:"meta-files"},xn.default.createElement("span",{className:"file-label"},"read:")," ",l.join(", ")),c.length>0&&xn.default.createElement("span",{className:"meta-files"},xn.default.createElement("span",{className:"file-label"},"modified:")," ",c.join(", ")))))}var Br=mt(Ct(),1);function FU({summary:t}){let e=Xp(t.created_at_epoch),n=[{key:"investigated",label:"Investigated",content:t.investigated,icon:"/icon-thick-investigated.svg"},{key:"learned",label:"Learned",content:t.learned,icon:"/icon-thick-learned.svg"},{key:"completed",label:"Completed",content:t.completed,icon:"/icon-thick-completed.svg"},{key:"next_steps",label:"Next Steps",content:t.next_steps,icon:"/icon-thick-next-steps.svg"}].filter(i=>i.content);return Br.default.createElement("article",{className:"card summary-card"},Br.default.createElement("header",{className:"summary-card-header"},Br.default.createElement("div",{className:"summary-badge-row"},Br.default.createElement("span",{className:"card-type summary-badge"},"Session Summary"),Br.default.createElement("span",{className:"summary-project-badge"},t.project)),t.request&&Br.default.createElement("h2",{className:"summary-title"},t.request)),Br.default.createElement("div",{className:"summary-sections"},n.map((i,r)=>Br.default.createElement("section",{key:i.key,className:"summary-section",style:{animationDelay:`${r*50}ms`}},Br.default.createElement("div",{className:"summary-section-header"},Br.default.createElement("img",{src:i.icon,alt:i.label,className:`summary-section-icon summary-section-icon--${i.key}`}),Br.default.createElement("h3",{className:"summary-section-label"},i.label)),Br.default.createElement("div",{className:"summary-section-content"},i.content)))),Br.default.createElement("footer",{className:"summary-card-footer"},Br.default.createElement("span",{className:"summary-meta-id"},"Session #",t.id),Br.default.createElement("span",{className:"summary-meta-divider"},"\u2022"),Br.default.createElement("time",{className:"summary-meta-date",dateTime:new Date(t.created_at_epoch).toISOString()},e)))}var yc=mt(Ct(),1);function zU({prompt:t}){let e=Xp(t.created_at_epoch);return yc.default.createElement("div",{className:"card prompt-card"},yc.default.createElement("div",{className:"card-header"},yc.default.createElement("div",{className:"card-header-left"},yc.default.createElement("span",{className:"card-type"},"Prompt"),yc.default.createElement("span",{className:"card-project"},t.project))),yc.default.createElement("div",{className:"card-content"},t.prompt_text),yc.default.createElement("div",{className:"card-meta"},yc.default.createElement("span",{className:"meta-date"},"#",t.id," \u2022 ",e)))}var Hu=mt(Ct(),1);function HU({targetRef:t}){let[e,n]=(0,Hu.useState)(!1);(0,Hu.useEffect)(()=>{let r=()=>{let o=t.current;o&&n(o.scrollTop>300)},s=t.current;if(s)return s.addEventListener("scroll",r),()=>s.removeEventListener("scroll",r)},[]);let i=()=>{let r=t.current;r&&r.scrollTo({top:0,behavior:"smooth"})};return e?Hu.default.createElement("button",{onClick:i,className:"scroll-to-top","aria-label":"Scroll to top"},Hu.default.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Hu.default.createElement("polyline",{points:"18 15 12 9 6 15"}))):null}var h_={PAGINATION_PAGE_SIZE:50,LOAD_MORE_THRESHOLD:.1};function WU({observations:t,summaries:e,prompts:n,onLoadMore:i,isLoading:r,hasMore:s,projects:o,currentFilter:a,onFilterChange:l}){let c=(0,Hn.useRef)(null),u=(0,Hn.useRef)(null),d=(0,Hn.useRef)(i),[p,m]=(0,Hn.useState)([]);(0,Hn.useEffect)(()=>{fetch("/api/projects/stats?source=claude-code").then(_=>_.json()).then(_=>{let y=Array.isArray(_)?_:_.projects||[];m(y.map(v=>v.name||v.project).filter(Boolean))}).catch(()=>m(o))},[]),(0,Hn.useEffect)(()=>{d.current=i},[i]),(0,Hn.useEffect)(()=>{let _=c.current;if(!_)return;let y=new IntersectionObserver(v=>{v[0].isIntersecting&&s&&!r&&d.current?.()},{threshold:h_.LOAD_MORE_THRESHOLD});return y.observe(_),()=>{_&&y.unobserve(_),y.disconnect()}},[s,r]);let g=(0,Hn.useMemo)(()=>[...t.map(y=>({...y,itemType:"observation"})),...e.map(y=>({...y,itemType:"summary"})),...n.map(y=>({...y,itemType:"prompt"}))].sort((y,v)=>v.created_at_epoch-y.created_at_epoch),[t,e,n]);return Hn.default.createElement("div",{className:"feed",ref:u},Hn.default.createElement(HU,{targetRef:u}),Hn.default.createElement("div",{className:"feed-content"},p.length>0&&Hn.default.createElement("div",{className:"feed-project-filter"},Hn.default.createElement("select",{value:a,onChange:_=>l(_.target.value)},Hn.default.createElement("option",{value:""},"All Projects"),p.map(_=>Hn.default.createElement("option",{key:_,value:_},_)))),g.map(_=>{let y=`${_.itemType}-${_.id}`;return _.itemType==="observation"?Hn.default.createElement(UU,{key:y,observation:_}):_.itemType==="summary"?Hn.default.createElement(FU,{key:y,summary:_}):Hn.default.createElement(zU,{key:y,prompt:_})}),g.length===0&&!r&&Hn.default.createElement("div",{style:{textAlign:"center",padding:"40px",color:"#8b949e"}},"No items to display"),r&&Hn.default.createElement("div",{style:{textAlign:"center",padding:"20px",color:"#8b949e"}},Hn.default.createElement("div",{className:"spinner",style:{display:"inline-block",marginRight:"10px"}}),"Loading more..."),s&&!r&&g.length>0&&Hn.default.createElement("div",{ref:c,style:{height:"20px",margin:"10px 0"}}),!s&&g.length>0&&Hn.default.createElement("div",{style:{textAlign:"center",padding:"20px",color:"#8b949e",fontSize:"14px"}},"No more items to load")))}var Oe=mt(Ct(),1),lK=[{view:"pm-overview",label:"Overview",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),Oe.default.createElement("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),Oe.default.createElement("line",{x1:"9",y1:"21",x2:"9",y2:"9"}))},{view:"current-state",label:"Current State",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),Oe.default.createElement("polyline",{points:"12 6 12 12 16 14"}))},{view:"pm-bugs",label:"Bugs & Fixes",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),Oe.default.createElement("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),Oe.default.createElement("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"}))},{view:"pm-todos",label:"Todos",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("polyline",{points:"9 11 12 14 22 4"}),Oe.default.createElement("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"}))},{view:"pm-ideas",label:"Ideas",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("line",{x1:"9",y1:"18",x2:"15",y2:"18"}),Oe.default.createElement("line",{x1:"10",y1:"22",x2:"14",y2:"22"}),Oe.default.createElement("path",{d:"M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"}))},{view:"pm-learnings",label:"Learnings",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),Oe.default.createElement("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"}))},{view:"pm-tags",label:"Tags",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),Oe.default.createElement("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"}))},{view:"kanban",label:"Kanban",icon:Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("rect",{x:"3",y:"3",width:"7",height:"7"}),Oe.default.createElement("rect",{x:"14",y:"3",width:"7",height:"7"}),Oe.default.createElement("rect",{x:"3",y:"14",width:"7",height:"7"}),Oe.default.createElement("rect",{x:"14",y:"14",width:"7",height:"7"}))}];function VU({isOpen:t,onToggle:e,currentView:n,onViewChange:i}){let[r,s]=(0,Oe.useState)(()=>{try{let a=localStorage.getItem("ub-pm-expanded");return a?JSON.parse(a):!1}catch{return!1}});(0,Oe.useEffect)(()=>{localStorage.setItem("ub-sidebar-open",JSON.stringify(t))},[t]),(0,Oe.useEffect)(()=>{localStorage.setItem("ub-pm-expanded",JSON.stringify(r))},[r]);let o=n.startsWith("pm-")||n==="kanban"||n==="current-state";return(0,Oe.useEffect)(()=>{o&&!r&&s(!0)},[o]),Oe.default.createElement(Oe.default.Fragment,null,t&&Oe.default.createElement("div",{className:"left-sidebar-backdrop",onClick:e}),Oe.default.createElement("nav",{className:`left-sidebar ${t?"open":""}`},Oe.default.createElement("div",{className:"left-sidebar-header"},Oe.default.createElement("span",{className:"left-sidebar-title"},"NAV")),Oe.default.createElement("div",{className:"left-sidebar-nav"},Oe.default.createElement("button",{className:`left-sidebar-item ${n==="projects"?"active":""}`,onClick:()=>i("projects")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Projects")),n==="feed"&&Oe.default.createElement("button",{className:"left-sidebar-item left-sidebar-sub-item active",style:{paddingLeft:"2rem"}},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("line",{x1:"17",y1:"10",x2:"3",y2:"10"}),Oe.default.createElement("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),Oe.default.createElement("line",{x1:"21",y1:"14",x2:"3",y2:"14"}),Oe.default.createElement("line",{x1:"17",y1:"18",x2:"3",y2:"18"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Feed")),Oe.default.createElement("div",{className:"left-sidebar-divider"}),Oe.default.createElement("button",{className:`left-sidebar-item ${o?"active":""}`,onClick:()=>{s(!r),o||i("pm-overview")}},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("path",{d:"M12 20V10"}),Oe.default.createElement("path",{d:"M18 20V4"}),Oe.default.createElement("path",{d:"M6 20v-4"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Project Management"),Oe.default.createElement("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginLeft:"auto",transform:r?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s ease",opacity:.5}},Oe.default.createElement("polyline",{points:"9 18 15 12 9 6"}))),r&&lK.map(a=>Oe.default.createElement("button",{key:a.view,className:`left-sidebar-item left-sidebar-sub-item ${n===a.view?"active":""}`,onClick:()=>i(a.view),style:{paddingLeft:"2rem"}},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},a.icon),Oe.default.createElement("span",{className:"left-sidebar-item-label"},a.label))),Oe.default.createElement("div",{className:"left-sidebar-divider"}),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="claude-md"?"active":""}`,onClick:()=>i("claude-md")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),Oe.default.createElement("polyline",{points:"14 2 14 8 20 8"}),Oe.default.createElement("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),Oe.default.createElement("line",{x1:"16",y1:"17",x2:"8",y2:"17"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"CLAUDE.md")),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="claude-desktop"?"active":""}`,onClick:()=>i("claude-desktop")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),Oe.default.createElement("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),Oe.default.createElement("line",{x1:"12",y1:"17",x2:"12",y2:"21"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Claude Desktop")),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="loop"?"active":""}`,onClick:()=>i("loop")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("polyline",{points:"23 4 23 10 17 10"}),Oe.default.createElement("polyline",{points:"1 20 1 14 7 14"}),Oe.default.createElement("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Ralph Loop")),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="teams"?"active":""}`,onClick:()=>i("teams")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),Oe.default.createElement("circle",{cx:"9",cy:"7",r:"4"}),Oe.default.createElement("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),Oe.default.createElement("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Agent Teams")),Oe.default.createElement("div",{className:"left-sidebar-divider"}),Oe.default.createElement("div",{style:{padding:"4px 16px 2px",fontSize:"10px",color:"#5a5a7a",textTransform:"uppercase",letterSpacing:"0.05em"}},"Ops Center"),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="terminal"?"active":""}`,onClick:()=>i("terminal")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("rect",{x:"2",y:"3",width:"20",height:"18",rx:"2"}),Oe.default.createElement("polyline",{points:"7 10 10 13 7 16"}),Oe.default.createElement("line",{x1:"13",y1:"16",x2:"17",y2:"16"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Terminal")),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="automation"?"active":""}`,onClick:()=>i("automation")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("circle",{cx:"12",cy:"12",r:"3"}),Oe.default.createElement("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Automation")),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="analytics"?"active":""}`,onClick:()=>i("analytics")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),Oe.default.createElement("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),Oe.default.createElement("line",{x1:"6",y1:"20",x2:"6",y2:"14"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Analytics")),Oe.default.createElement("button",{className:`left-sidebar-item ${n==="graph"?"active":""}`,onClick:()=>i("graph")},Oe.default.createElement("span",{className:"left-sidebar-item-icon"},Oe.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Oe.default.createElement("circle",{cx:"12",cy:"5",r:"3"}),Oe.default.createElement("circle",{cx:"5",cy:"19",r:"3"}),Oe.default.createElement("circle",{cx:"19",cy:"19",r:"3"}),Oe.default.createElement("line",{x1:"12",y1:"8",x2:"5",y2:"16"}),Oe.default.createElement("line",{x1:"12",y1:"8",x2:"19",y2:"16"}))),Oe.default.createElement("span",{className:"left-sidebar-item-label"},"Knowledge Graph"))),Oe.default.createElement("button",{className:"sidebar-handle",onClick:e,title:t?"Collapse sidebar":"Expand sidebar"},Oe.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:`sidebar-handle-arrow ${t?"open":""}`},Oe.default.createElement("polyline",{points:"9 18 15 12 9 6"})))))}var Fn=mt(Ct(),1);function cK(t){let e=Date.now()-t,n=Math.floor(e/6e4);if(n<1)return"just now";if(n<60)return`${n}m ago`;let i=Math.floor(n/60);if(i<24)return`${i}h ago`;let r=Math.floor(i/24);return r<30?`${r}d ago`:new Date(t).toLocaleDateString()}function GU({onSelectProject:t}){let[e,n]=(0,Fn.useState)([]),[i,r]=(0,Fn.useState)(!0);return(0,Fn.useEffect)(()=>{fetch("/api/projects/stats").then(s=>s.json()).then(s=>{n(s.projects||[]),r(!1)}).catch(()=>r(!1))},[]),i?Fn.default.createElement("div",{className:"projects-container"},Fn.default.createElement("div",{className:"projects-header"},Fn.default.createElement("h2",{className:"projects-title"},"Projects")),Fn.default.createElement("div",{className:"projects-grid"},[1,2,3,4].map(s=>Fn.default.createElement("div",{key:s,className:"project-card skeleton"},Fn.default.createElement("div",{className:"skeleton-line skeleton-title"}),Fn.default.createElement("div",{className:"skeleton-line skeleton-subtitle"}))))):Fn.default.createElement("div",{className:"projects-container"},Fn.default.createElement("div",{className:"projects-header"},Fn.default.createElement("h2",{className:"projects-title"},"Projects"),Fn.default.createElement("span",{className:"projects-count"},e.length," projects")),e.length===0?Fn.default.createElement("div",{className:"projects-empty"},"No projects found. Start using UltraBrain to see your projects here."):Fn.default.createElement("div",{className:"projects-grid"},e.map(s=>Fn.default.createElement("button",{key:s.name,className:"project-card",onClick:()=>t(s.name)},Fn.default.createElement("div",{className:"project-card-icon"},Fn.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Fn.default.createElement("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}))),Fn.default.createElement("div",{className:"project-card-name"},s.name),Fn.default.createElement("div",{className:"project-card-stats"},Fn.default.createElement("span",null,s.observationCount," obs"),Fn.default.createElement("span",{className:"project-card-dot"},"\xB7"),Fn.default.createElement("span",null,s.summaryCount," sum")),Fn.default.createElement("div",{className:"project-card-activity"},cK(s.lastActivity))))))}var et=mt(Ct(),1),jU={bug:"#ef4444",feature:"#10b981",task:"#3b82f6"},uK=[{id:"todo",label:"TODO"},{id:"in_progress",label:"IN PROGRESS"},{id:"stale",label:"STALE"},{id:"done",label:"DONE"}],hK={high:"priority-high",medium:"priority-medium",low:"priority-low"};function XU({currentProject:t,projects:e}){let[n,i]=(0,et.useState)([]),[r,s]=(0,et.useState)(!1),[o,a]=(0,et.useState)(""),[l,c]=(0,et.useState)(""),[u,d]=(0,et.useState)(t||e[0]||""),[p,m]=(0,et.useState)(null),[g,_]=(0,et.useState)(null),[y,v]=(0,et.useState)(null),[S,b]=(0,et.useState)(null),[w,C]=(0,et.useState)(null),M=(0,et.useRef)(null),L=(0,et.useCallback)(()=>{let X=t?`/api/tasks?project=${encodeURIComponent(t)}`:"/api/tasks";fetch(X).then(q=>q.json()).then(q=>i(q.tasks||[])).catch(q=>console.error("Failed to fetch tasks:",q))},[t]);(0,et.useEffect)(()=>{L()},[L]),(0,et.useEffect)(()=>{r&&M.current&&M.current.focus()},[r]);let P=(0,et.useCallback)(()=>{if(!o.trim())return;let X=u||t||e[0]||"default";fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:o.trim(),description:l.trim()||void 0,project:X})}).then(q=>q.json()).then(()=>{a(""),c(""),s(!1),L()}).catch(q=>console.error("Failed to create task:",q))},[o,l,u,t,e,L]),T=(0,et.useCallback)((X,q)=>{fetch(`/api/tasks/${X}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:q})}).then(()=>L()).catch(ne=>console.error("Failed to update task:",ne))},[L]),A=(0,et.useCallback)((X,q)=>{fetch(`/api/tasks/${X}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)}).then(()=>{L(),v(null)}).catch(ne=>console.error("Failed to update task:",ne))},[L]),I=(0,et.useCallback)(X=>{fetch(`/api/tasks/${X}`,{method:"DELETE"}).then(()=>{L(),v(null)}).catch(q=>console.error("Failed to delete task:",q))},[L]),F=(0,et.useCallback)(async()=>{let X=t||e[0];if(X){b("Populating...");try{let ne=await(await fetch(`/api/tasks/backfill?project=${encodeURIComponent(X)}`,{method:"POST"})).json();b(`Created ${ne.created} tasks${ne.tagsApplied?`, applied ${ne.tagsApplied} tags`:""}`),L()}catch{b("Backfill failed")}}},[t,e,L]),B=(0,et.useCallback)(async()=>{let X=t||e[0];if(X){C("Marking stale...");try{let ne=await(await fetch("/api/tasks/bulk-stale",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:X,staleDays:30})})).json();C(`Marked ${ne.marked} task(s) as stale`),L()}catch{C("Mark stale failed")}}},[t,e,L]),O=(0,et.useCallback)(async()=>{let X=t||e[0];if(X){C("Closing stale...");try{let ne=await(await fetch("/api/tasks/bulk-close",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:X,status:"stale"})})).json();C(`Closed ${ne.closed} stale task(s)`),L()}catch{C("Close stale failed")}}},[t,e,L]),z=(0,et.useCallback)(async()=>{let X=t||e[0];if(X){C("Finding duplicates...");try{let re=(await(await fetch("/api/tasks/deduplicate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:X,dryRun:!0})})).json()).duplicates?.length||0;if(re===0){C("No duplicates found");return}if(!confirm(`Found ${re} duplicate(s). Close them?`)){C(`Found ${re} duplicate(s) \u2014 cancelled`);return}let ie=await(await fetch("/api/tasks/deduplicate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:X,dryRun:!1})})).json();C(`Closed ${ie.totalClosed} duplicate(s)`),L()}catch{C("Deduplicate failed")}}},[t,e,L]),U=(X,q)=>{m(q),X.dataTransfer.effectAllowed="move",X.dataTransfer.setData("text/plain",String(q.id)),requestAnimationFrame(()=>{let ne=document.getElementById(`task-${q.id}`);ne&&ne.classList.add("dragging")})},G=()=>{m(null),_(null),document.querySelectorAll(".dragging").forEach(X=>X.classList.remove("dragging"))},j=(X,q)=>{X.preventDefault(),X.dataTransfer.dropEffect="move",_(q)},J=()=>{_(null)},K=(X,q)=>{X.preventDefault(),_(null),p&&p.status!==q&&T(p.id,q),m(null)},D=X=>n.filter(q=>q.status===X);return et.default.createElement("div",{className:"kanban-container"},et.default.createElement("div",{className:"kanban-header"},et.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},et.default.createElement("h2",{className:"kanban-title"},"Kanban Board")),et.default.createElement("div",{className:"kanban-controls",style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"}},(S||w)&&et.default.createElement("span",{style:{fontSize:"0.72rem",opacity:.6,marginRight:"4px"}},w||S),et.default.createElement("button",{onClick:F,style:{background:"none",border:"1px solid var(--border-color, #333)",borderRadius:"6px",padding:"4px 10px",fontSize:"0.72rem",cursor:"pointer",color:"var(--text-muted, #888)"},title:"Create tasks from tagged observations"},"Populate"),et.default.createElement("button",{onClick:B,style:{background:"none",border:"1px solid var(--border-color, #333)",borderRadius:"6px",padding:"4px 10px",fontSize:"0.72rem",cursor:"pointer",color:"#f59e0b"},title:"Mark todos older than 30 days as stale"},"Mark Stale"),et.default.createElement("button",{onClick:O,style:{background:"none",border:"1px solid var(--border-color, #333)",borderRadius:"6px",padding:"4px 10px",fontSize:"0.72rem",cursor:"pointer",color:"#ef4444"},title:"Close all stale tasks"},"Close Stale"),et.default.createElement("button",{onClick:z,style:{background:"none",border:"1px solid var(--border-color, #333)",borderRadius:"6px",padding:"4px 10px",fontSize:"0.72rem",cursor:"pointer",color:"#8b5cf6"},title:"Find and close duplicate tasks"},"Deduplicate"))),et.default.createElement("div",{className:"kanban-board"},uK.map(X=>{let q=D(X.id);return et.default.createElement("div",{key:X.id,className:`kanban-column ${g===X.id?"drag-over":""}`,onDragOver:ne=>j(ne,X.id),onDragLeave:J,onDrop:ne=>K(ne,X.id)},et.default.createElement("div",{className:"kanban-column-header"},et.default.createElement("span",{className:"kanban-column-title"},X.label),et.default.createElement("span",{className:"kanban-column-count"},q.length),X.id==="todo"&&et.default.createElement("button",{className:"kanban-add-btn",onClick:()=>s(!r),title:"Add task"},"+")),X.id==="todo"&&r&&et.default.createElement("div",{className:"kanban-add-form"},et.default.createElement("input",{ref:M,type:"text",className:"kanban-add-input",placeholder:"Task title...",value:o,onChange:ne=>a(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&P(),ne.key==="Escape"&&s(!1)}}),et.default.createElement("textarea",{className:"kanban-add-textarea",placeholder:"Description (optional)",value:l,onChange:ne=>c(ne.target.value),rows:2}),e.length>1&&et.default.createElement("select",{className:"kanban-add-project",value:u,onChange:ne=>d(ne.target.value)},e.map(ne=>et.default.createElement("option",{key:ne,value:ne},ne))),et.default.createElement("div",{className:"kanban-add-actions"},et.default.createElement("button",{className:"kanban-add-submit",onClick:P},"Add"),et.default.createElement("button",{className:"kanban-add-cancel",onClick:()=>s(!1)},"Cancel"))),et.default.createElement("div",{className:"kanban-column-tasks"},q.map(ne=>et.default.createElement("div",{key:ne.id,id:`task-${ne.id}`,className:"kanban-task-card",draggable:!0,onDragStart:re=>U(re,ne),onDragEnd:G,onClick:()=>v(ne)},et.default.createElement("div",{className:"kanban-task-top"},et.default.createElement("span",{className:`kanban-priority-dot ${hK[ne.priority]||""}`,title:ne.priority}),et.default.createElement("span",{className:"kanban-task-title"},ne.title),et.default.createElement("button",{className:"kanban-task-delete",onClick:re=>{re.stopPropagation(),I(ne.id)},title:"Delete"},"\xD7")),ne.description&&et.default.createElement("div",{className:"kanban-task-desc"},ne.description),et.default.createElement("div",{className:"kanban-task-meta"},et.default.createElement("span",{className:"kanban-category-badge",style:{background:`${jU[ne.category]||"#6366f1"}20`,color:jU[ne.category]||"#6366f1"}},ne.category),ne.observation_id&&et.default.createElement("span",{className:"kanban-obs-link",style:{fontSize:"0.65rem",opacity:.5,cursor:"pointer"},title:`Linked to observation #${ne.observation_id}`},"obs#",ne.observation_id),!t&&et.default.createElement("span",{className:"kanban-project-tag"},ne.project))))))})),y&&et.default.createElement(dK,{task:y,onSave:X=>A(y.id,X),onDelete:()=>I(y.id),onClose:()=>v(null)}))}function dK({task:t,onSave:e,onDelete:n,onClose:i}){let[r,s]=(0,et.useState)(t.title),[o,a]=(0,et.useState)(t.description||""),[l,c]=(0,et.useState)(t.status),[u,d]=(0,et.useState)(t.priority),p=()=>{e({title:r,description:o||null,status:l,priority:u})};return et.default.createElement("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:i},et.default.createElement("div",{style:{background:"var(--color-bg-secondary, #1a1a2e)",borderRadius:"12px",border:"1px solid var(--border-color, #333)",padding:"24px",width:"480px",maxWidth:"90vw",maxHeight:"80vh",overflowY:"auto"},onClick:m=>m.stopPropagation()},et.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"}},et.default.createElement("span",{style:{fontSize:"0.7rem",opacity:.4}},"Task #",t.id),et.default.createElement("button",{onClick:i,style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-muted, #888)",fontSize:"1.2rem"}},"\xD7")),et.default.createElement("input",{type:"text",value:r,onChange:m=>s(m.target.value),style:{width:"100%",padding:"8px 10px",fontSize:"1rem",fontWeight:600,borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--color-bg-primary, #0f0f1a)",color:"inherit",marginBottom:"12px",boxSizing:"border-box"}}),et.default.createElement("textarea",{value:o,onChange:m=>a(m.target.value),placeholder:"Description...",rows:4,style:{width:"100%",padding:"8px 10px",fontSize:"0.85rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--color-bg-primary, #0f0f1a)",color:"inherit",marginBottom:"12px",resize:"vertical",boxSizing:"border-box"}}),et.default.createElement("div",{style:{display:"flex",gap:"12px",marginBottom:"12px"}},et.default.createElement("div",{style:{flex:1}},et.default.createElement("label",{style:{fontSize:"0.7rem",opacity:.5,display:"block",marginBottom:"4px"}},"Status"),et.default.createElement("select",{value:l,onChange:m=>c(m.target.value),style:{width:"100%",padding:"6px 8px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--color-bg-primary, #0f0f1a)",color:"inherit"}},et.default.createElement("option",{value:"todo"},"Todo"),et.default.createElement("option",{value:"in_progress"},"In Progress"),et.default.createElement("option",{value:"stale"},"Stale"),et.default.createElement("option",{value:"done"},"Done"))),et.default.createElement("div",{style:{flex:1}},et.default.createElement("label",{style:{fontSize:"0.7rem",opacity:.5,display:"block",marginBottom:"4px"}},"Priority"),et.default.createElement("select",{value:u,onChange:m=>d(m.target.value),style:{width:"100%",padding:"6px 8px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--color-bg-primary, #0f0f1a)",color:"inherit"}},et.default.createElement("option",{value:"high"},"High"),et.default.createElement("option",{value:"medium"},"Medium"),et.default.createElement("option",{value:"low"},"Low")))),et.default.createElement("div",{style:{fontSize:"0.75rem",opacity:.5,marginBottom:"16px"}},et.default.createElement("div",null,"Category: ",t.category),t.observation_id&&et.default.createElement("div",null,"Linked observation: #",t.observation_id),et.default.createElement("div",null,"Created: ",new Date(t.created_at_epoch).toLocaleString())),et.default.createElement("div",{style:{display:"flex",gap:"8px",justifyContent:"space-between"}},et.default.createElement("button",{onClick:n,style:{padding:"6px 14px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid #ef444440",background:"#ef444410",color:"#ef4444",cursor:"pointer"}},"Delete"),et.default.createElement("div",{style:{display:"flex",gap:"8px"}},et.default.createElement("button",{onClick:i,style:{padding:"6px 14px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"none",color:"var(--text-muted, #888)",cursor:"pointer"}},"Cancel"),et.default.createElement("button",{onClick:p,style:{padding:"6px 14px",fontSize:"0.8rem",borderRadius:"6px",border:"none",background:"var(--accent-color, #6366f1)",color:"#fff",cursor:"pointer"}},"Save")))))}var lt=mt(Ct(),1);function fK(t){return new Date(t).toLocaleString()}function pK(t){let e=Date.now()-t,n=Math.floor(e/6e4);if(n<1)return"just now";if(n<60)return`${n}m ago`;let i=Math.floor(n/60);if(i<24)return`${i}h ago`;let r=Math.floor(i/24);return r<30?`${r}d ago`:new Date(t).toLocaleDateString()}function mK(t,e){if(!e)return"ongoing";let n=e-t,i=Math.floor(n/1e3);if(i<60)return`${i}s`;let r=Math.floor(i/60);return r<60?`${r}m ${i%60}s`:`${Math.floor(r/60)}h ${r%60}m`}var gK={active:"cd-status-active",completed:"cd-status-completed",failed:"cd-status-failed"};function qU({projects:t}){let[e,n]=(0,lt.useState)([]),[i,r]=(0,lt.useState)(!0),[s,o]=(0,lt.useState)(""),[a,l]=(0,lt.useState)(null),[c,u]=(0,lt.useState)([]),[d,p]=(0,lt.useState)(!1),[m,g]=(0,lt.useState)(null),_=(0,lt.useCallback)(()=>{let b=s?`/api/claude-desktop/sessions?project=${encodeURIComponent(s)}`:"/api/claude-desktop/sessions";fetch(b).then(w=>w.json()).then(w=>{n(w.sessions||[]),r(!1)}).catch(()=>r(!1))},[s]);(0,lt.useEffect)(()=>{_();let b=setInterval(_,1e4);return()=>clearInterval(b)},[_]);let y=(0,lt.useCallback)(b=>{if(a===b.id){l(null),u([]);return}l(b.id),u([]),fetch(`/api/claude-desktop/sessions/${encodeURIComponent(b.content_session_id)}/prompts`).then(w=>w.json()).then(w=>{u(w.prompts||[])}).catch(()=>{})},[a]),v=(0,lt.useCallback)(async()=>{p(!0),g(null);try{let w=await(await fetch("/api/claude-desktop/import",{method:"POST"})).json();g(`Imported ${w.sessionsImported||0} sessions, ${w.promptsImported||0} prompts`),_()}catch{g("Import failed")}finally{p(!1)}},[_]),S=[...new Set(e.map(b=>b.project))].sort();return i?lt.default.createElement("div",{className:"cd-container"},lt.default.createElement("div",{className:"cd-header"},lt.default.createElement("h2",{className:"cd-title"},"Claude Desktop")),lt.default.createElement("div",{className:"cd-sessions"},[1,2,3].map(b=>lt.default.createElement("div",{key:b,className:"cd-session-card skeleton"},lt.default.createElement("div",{className:"skeleton-line skeleton-title"}),lt.default.createElement("div",{className:"skeleton-line skeleton-subtitle"}))))):lt.default.createElement("div",{className:"cd-container"},lt.default.createElement("div",{className:"cd-header"},lt.default.createElement("div",{className:"cd-header-left"},lt.default.createElement("h2",{className:"cd-title"},"Claude Desktop"),lt.default.createElement("span",{className:"cd-subtitle"},e.length," sessions received")),lt.default.createElement("div",{className:"cd-controls"},lt.default.createElement("select",{className:"cd-project-filter",value:s,onChange:b=>o(b.target.value)},lt.default.createElement("option",{value:""},"All Projects"),S.map(b=>lt.default.createElement("option",{key:b,value:b},b))),lt.default.createElement("button",{className:"cd-refresh-btn",onClick:v,disabled:d,title:"Re-import from Claude Desktop",style:{opacity:d?.5:1}},lt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},lt.default.createElement("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),lt.default.createElement("polyline",{points:"7 10 12 15 17 10"}),lt.default.createElement("line",{x1:"12",y1:"15",x2:"12",y2:"3"}))),lt.default.createElement("button",{className:"cd-refresh-btn",onClick:_,title:"Refresh"},lt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},lt.default.createElement("polyline",{points:"23 4 23 10 17 10"}),lt.default.createElement("polyline",{points:"1 20 1 14 7 14"}),lt.default.createElement("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}))))),m&&lt.default.createElement("div",{style:{padding:"8px 12px",marginBottom:"12px",fontSize:"0.8rem",background:"var(--bg-secondary, #1a1a2e)",borderRadius:"6px",border:"1px solid var(--border-color, #333)"}},m),e.length===0?lt.default.createElement("div",{className:"cd-empty"},lt.default.createElement("div",null,"No Claude Desktop sessions imported yet."),lt.default.createElement("div",{style:{fontSize:"0.8rem",opacity:.6,marginTop:"8px"}},"Claude Desktop stores conversations on Anthropic's servers. Local agent mode sessions (if available) can be imported automatically."),lt.default.createElement("button",{onClick:v,disabled:d,style:{marginTop:"12px",padding:"6px 16px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--accent-color, #6366f1)",color:"#fff",cursor:d?"wait":"pointer",opacity:d?.6:1}},d?"Importing...":"Import Now")):lt.default.createElement("div",{className:"cd-sessions"},e.map(b=>lt.default.createElement("div",{key:b.id,className:"cd-session-card"},lt.default.createElement("button",{className:"cd-session-row",onClick:()=>y(b)},lt.default.createElement("div",{className:"cd-session-main"},lt.default.createElement("span",{className:`cd-status-dot ${gK[b.status]||""}`}),lt.default.createElement("div",{className:"cd-session-info"},lt.default.createElement("div",{className:"cd-session-prompt"},b.user_prompt?b.user_prompt.length>120?b.user_prompt.slice(0,120)+"...":b.user_prompt:"Session #"+b.id),lt.default.createElement("div",{className:"cd-session-meta-row"},lt.default.createElement("span",{className:"cd-project-badge"},b.project),lt.default.createElement("span",{className:"cd-session-time"},pK(b.started_at_epoch)),lt.default.createElement("span",{className:"cd-session-duration"},mK(b.started_at_epoch,b.completed_at_epoch))))),lt.default.createElement("div",{className:"cd-session-counts"},lt.default.createElement("span",{className:"cd-count-badge",title:"Conversation messages"},b.prompt_count||0," prompts"),lt.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`cd-expand-arrow ${a===b.id?"expanded":""}`},lt.default.createElement("polyline",{points:"6 9 12 15 18 9"})))),a===b.id&&lt.default.createElement("div",{className:"cd-session-detail"},lt.default.createElement("div",{className:"cd-detail-section"},lt.default.createElement("div",{className:"cd-detail-label"},"Session ID"),lt.default.createElement("div",{className:"cd-detail-value cd-monospace"},b.content_session_id)),b.memory_session_id&&lt.default.createElement("div",{className:"cd-detail-section"},lt.default.createElement("div",{className:"cd-detail-label"},"Memory Session"),lt.default.createElement("div",{className:"cd-detail-value cd-monospace"},b.memory_session_id)),lt.default.createElement("div",{className:"cd-detail-section"},lt.default.createElement("div",{className:"cd-detail-label"},"Started"),lt.default.createElement("div",{className:"cd-detail-value"},fK(b.started_at_epoch))),b.user_prompt&&lt.default.createElement("div",{className:"cd-detail-section"},lt.default.createElement("div",{className:"cd-detail-label"},"User Prompt"),lt.default.createElement("div",{className:"cd-detail-value cd-prompt-full"},b.user_prompt)),c.length>0&&lt.default.createElement("div",{className:"cd-detail-section"},lt.default.createElement("div",{className:"cd-detail-label"},"Conversation (",c.length," messages)"),lt.default.createElement("div",{className:"cd-obs-list"},c.map(w=>lt.default.createElement("div",{key:w.id,className:"cd-obs-item"},lt.default.createElement("span",{className:"cd-obs-type"},"#",w.prompt_number),lt.default.createElement("span",{className:"cd-obs-title"},w.prompt_text.length>200?w.prompt_text.slice(0,200)+"...":w.prompt_text))))),c.length===0&&a===b.id&&lt.default.createElement("div",{className:"cd-detail-section"},lt.default.createElement("div",{className:"cd-detail-label"},"Conversation"),lt.default.createElement("div",{className:"cd-detail-value",style:{opacity:.5}},"No conversation messages imported yet. Try re-importing.")))))))}var Le=mt(Ct(),1);var lr=mt(Ct(),1),OF=mt(bF(),1);var{entries:PF,setPrototypeOf:wF,isFrozen:JK,getPrototypeOf:ZK,getOwnPropertyDescriptor:QK}=Object,{freeze:Ts,seal:ra,create:C3}=Object,{apply:T3,construct:M3}=typeof Reflect<"u"&&Reflect;Ts||(Ts=function(e){return e});ra||(ra=function(e){return e});T3||(T3=function(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return e.apply(n,r)});M3||(M3=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return new e(...i)});var nw=Ms(Array.prototype.forEach),e$=Ms(Array.prototype.lastIndexOf),EF=Ms(Array.prototype.pop),f_=Ms(Array.prototype.push),t$=Ms(Array.prototype.splice),rw=Ms(String.prototype.toLowerCase),y3=Ms(String.prototype.toString),x3=Ms(String.prototype.match),p_=Ms(String.prototype.replace),n$=Ms(String.prototype.indexOf),i$=Ms(String.prototype.trim),Va=Ms(Object.prototype.hasOwnProperty),Cs=Ms(RegExp.prototype.test),m_=r$(TypeError);function Ms(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return T3(t,e,i)}}function r$(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return M3(t,n)}}function pn(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rw;wF&&wF(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){let s=n(r);s!==r&&(JK(e)||(e[i]=s),r=s)}t[r]=!0}return t}function s$(t){for(let e=0;e<t.length;e++)Va(t,e)||(t[e]=null);return t}function bl(t){let e=C3(null);for(let[n,i]of PF(t))Va(t,n)&&(Array.isArray(i)?e[n]=s$(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=bl(i):e[n]=i);return e}function g_(t,e){for(;t!==null;){let i=QK(t,e);if(i){if(i.get)return Ms(i.get);if(typeof i.value=="function")return Ms(i.value)}t=ZK(t)}function n(){return null}return n}var CF=Ts(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),S3=Ts(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),b3=Ts(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),o$=Ts(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),w3=Ts(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),a$=Ts(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),TF=Ts(["#text"]),MF=Ts(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),E3=Ts(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),AF=Ts(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),iw=Ts(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),l$=ra(/\{\{[\w\W]*|[\w\W]*\}\}/gm),c$=ra(/<%[\w\W]*|[\w\W]*%>/gm),u$=ra(/\$\{[\w\W]*/gm),h$=ra(/^data-[\-\w.\u00B7-\uFFFF]+$/),d$=ra(/^aria-[\-\w]+$/),DF=ra(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),f$=ra(/^(?:\w+script|data):/i),p$=ra(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),IF=ra(/^html$/i),m$=ra(/^[a-z][.\w]*(-[.\w]+)+$/i),kF=Object.freeze({__proto__:null,ARIA_ATTR:d$,ATTR_WHITESPACE:p$,CUSTOM_ELEMENT:m$,DATA_ATTR:h$,DOCTYPE_NAME:IF,ERB_EXPR:c$,IS_ALLOWED_URI:DF,IS_SCRIPT_OR_DATA:f$,MUSTACHE_EXPR:l$,TMPLIT_EXPR:u$}),v_={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},g$=function(){return typeof window>"u"?null:window},v$=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null,r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));let s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},LF=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function RF(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g$(),e=Pt=>RF(Pt);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==v_.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t,i=n,r=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:p,trustedTypes:m}=t,g=l.prototype,_=g_(g,"cloneNode"),y=g_(g,"remove"),v=g_(g,"nextSibling"),S=g_(g,"childNodes"),b=g_(g,"parentNode");if(typeof o=="function"){let Pt=n.createElement("template");Pt.content&&Pt.content.ownerDocument&&(n=Pt.content.ownerDocument)}let w,C="",{implementation:M,createNodeIterator:L,createDocumentFragment:P,getElementsByTagName:T}=n,{importNode:A}=i,I=LF();e.isSupported=typeof PF=="function"&&typeof b=="function"&&M&&M.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:F,ERB_EXPR:B,TMPLIT_EXPR:O,DATA_ATTR:z,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:G,ATTR_WHITESPACE:j,CUSTOM_ELEMENT:J}=kF,{IS_ALLOWED_URI:K}=kF,D=null,X=pn({},[...CF,...S3,...b3,...w3,...TF]),q=null,ne=pn({},[...MF,...E3,...AF,...iw]),re=Object.seal(C3(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),$=null,ie=null,le=Object.seal(C3(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}})),Ee=!0,ke=!0,Pe=!1,Te=!0,De=!1,me=!0,ve=!1,ge=!1,Ie=!1,V=!1,Ge=!1,Me=!1,_e=!0,Ne=!1,W="user-content-",R=!0,Z=!1,fe={},he=null,ae=pn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),je=null,ze=pn({},["audio","video","img","source","image","track"]),Qe=null,ct=pn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ae="http://www.w3.org/1998/Math/MathML",Ve="http://www.w3.org/2000/svg",Ue="http://www.w3.org/1999/xhtml",Q=Ue,ce=!1,Ye=null,te=pn({},[Ae,Ve,Ue],y3),we=pn({},["mi","mo","mn","ms","mtext"]),Be=pn({},["annotation-xml"]),it=pn({},["title","style","font","a","script"]),Fe=null,Se=["application/xhtml+xml","text/html"],Xe="text/html",Je=null,ot=null,kt=n.createElement("form"),un=function(se){return se instanceof RegExp||se instanceof Function},mn=function(){let se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ot&&ot===se)){if((!se||typeof se!="object")&&(se={}),se=bl(se),Fe=Se.indexOf(se.PARSER_MEDIA_TYPE)===-1?Xe:se.PARSER_MEDIA_TYPE,Je=Fe==="application/xhtml+xml"?y3:rw,D=Va(se,"ALLOWED_TAGS")?pn({},se.ALLOWED_TAGS,Je):X,q=Va(se,"ALLOWED_ATTR")?pn({},se.ALLOWED_ATTR,Je):ne,Ye=Va(se,"ALLOWED_NAMESPACES")?pn({},se.ALLOWED_NAMESPACES,y3):te,Qe=Va(se,"ADD_URI_SAFE_ATTR")?pn(bl(ct),se.ADD_URI_SAFE_ATTR,Je):ct,je=Va(se,"ADD_DATA_URI_TAGS")?pn(bl(ze),se.ADD_DATA_URI_TAGS,Je):ze,he=Va(se,"FORBID_CONTENTS")?pn({},se.FORBID_CONTENTS,Je):ae,$=Va(se,"FORBID_TAGS")?pn({},se.FORBID_TAGS,Je):bl({}),ie=Va(se,"FORBID_ATTR")?pn({},se.FORBID_ATTR,Je):bl({}),fe=Va(se,"USE_PROFILES")?se.USE_PROFILES:!1,Ee=se.ALLOW_ARIA_ATTR!==!1,ke=se.ALLOW_DATA_ATTR!==!1,Pe=se.ALLOW_UNKNOWN_PROTOCOLS||!1,Te=se.ALLOW_SELF_CLOSE_IN_ATTR!==!1,De=se.SAFE_FOR_TEMPLATES||!1,me=se.SAFE_FOR_XML!==!1,ve=se.WHOLE_DOCUMENT||!1,V=se.RETURN_DOM||!1,Ge=se.RETURN_DOM_FRAGMENT||!1,Me=se.RETURN_TRUSTED_TYPE||!1,Ie=se.FORCE_BODY||!1,_e=se.SANITIZE_DOM!==!1,Ne=se.SANITIZE_NAMED_PROPS||!1,R=se.KEEP_CONTENT!==!1,Z=se.IN_PLACE||!1,K=se.ALLOWED_URI_REGEXP||DF,Q=se.NAMESPACE||Ue,we=se.MATHML_TEXT_INTEGRATION_POINTS||we,Be=se.HTML_INTEGRATION_POINTS||Be,re=se.CUSTOM_ELEMENT_HANDLING||{},se.CUSTOM_ELEMENT_HANDLING&&un(se.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(re.tagNameCheck=se.CUSTOM_ELEMENT_HANDLING.tagNameCheck),se.CUSTOM_ELEMENT_HANDLING&&un(se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(re.attributeNameCheck=se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),se.CUSTOM_ELEMENT_HANDLING&&typeof se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(re.allowCustomizedBuiltInElements=se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(ke=!1),Ge&&(V=!0),fe&&(D=pn({},TF),q=[],fe.html===!0&&(pn(D,CF),pn(q,MF)),fe.svg===!0&&(pn(D,S3),pn(q,E3),pn(q,iw)),fe.svgFilters===!0&&(pn(D,b3),pn(q,E3),pn(q,iw)),fe.mathMl===!0&&(pn(D,w3),pn(q,AF),pn(q,iw))),se.ADD_TAGS&&(typeof se.ADD_TAGS=="function"?le.tagCheck=se.ADD_TAGS:(D===X&&(D=bl(D)),pn(D,se.ADD_TAGS,Je))),se.ADD_ATTR&&(typeof se.ADD_ATTR=="function"?le.attributeCheck=se.ADD_ATTR:(q===ne&&(q=bl(q)),pn(q,se.ADD_ATTR,Je))),se.ADD_URI_SAFE_ATTR&&pn(Qe,se.ADD_URI_SAFE_ATTR,Je),se.FORBID_CONTENTS&&(he===ae&&(he=bl(he)),pn(he,se.FORBID_CONTENTS,Je)),se.ADD_FORBID_CONTENTS&&(he===ae&&(he=bl(he)),pn(he,se.ADD_FORBID_CONTENTS,Je)),R&&(D["#text"]=!0),ve&&pn(D,["html","head","body"]),D.table&&(pn(D,["tbody"]),delete $.tbody),se.TRUSTED_TYPES_POLICY){if(typeof se.TRUSTED_TYPES_POLICY.createHTML!="function")throw m_('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof se.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw m_('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=se.TRUSTED_TYPES_POLICY,C=w.createHTML("")}else w===void 0&&(w=v$(m,r)),w!==null&&typeof C=="string"&&(C=w.createHTML(""));Ts&&Ts(se),ot=se}},qn=pn({},[...S3,...b3,...o$]),Zi=pn({},[...w3,...a$]),Mr=function(se){let Ze=b(se);(!Ze||!Ze.tagName)&&(Ze={namespaceURI:Q,tagName:"template"});let Et=rw(se.tagName),Mn=rw(Ze.tagName);return Ye[se.namespaceURI]?se.namespaceURI===Ve?Ze.namespaceURI===Ue?Et==="svg":Ze.namespaceURI===Ae?Et==="svg"&&(Mn==="annotation-xml"||we[Mn]):!!qn[Et]:se.namespaceURI===Ae?Ze.namespaceURI===Ue?Et==="math":Ze.namespaceURI===Ve?Et==="math"&&Be[Mn]:!!Zi[Et]:se.namespaceURI===Ue?Ze.namespaceURI===Ve&&!Be[Mn]||Ze.namespaceURI===Ae&&!we[Mn]?!1:!Zi[Et]&&(it[Et]||!qn[Et]):!!(Fe==="application/xhtml+xml"&&Ye[se.namespaceURI]):!1},Yn=function(se){f_(e.removed,{element:se});try{b(se).removeChild(se)}catch{y(se)}},Oi=function(se,Ze){try{f_(e.removed,{attribute:Ze.getAttributeNode(se),from:Ze})}catch{f_(e.removed,{attribute:null,from:Ze})}if(Ze.removeAttribute(se),se==="is")if(V||Ge)try{Yn(Ze)}catch{}else try{Ze.setAttribute(se,"")}catch{}},Qi=function(se){let Ze=null,Et=null;if(Ie)se="<remove></remove>"+se;else{let H=x3(se,/^[\r\n\t ]+/);Et=H&&H[0]}Fe==="application/xhtml+xml"&&Q===Ue&&(se='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+se+"</body></html>");let Mn=w?w.createHTML(se):se;if(Q===Ue)try{Ze=new p().parseFromString(Mn,Fe)}catch{}if(!Ze||!Ze.documentElement){Ze=M.createDocument(Q,"template",null);try{Ze.documentElement.innerHTML=ce?C:Mn}catch{}}let ht=Ze.body||Ze.documentElement;return se&&Et&&ht.insertBefore(n.createTextNode(Et),ht.childNodes[0]||null),Q===Ue?T.call(Ze,ve?"html":"body")[0]:ve?Ze.documentElement:ht},Ti=function(se){return L.call(se.ownerDocument||se,se,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},ni=function(se){return se instanceof d&&(typeof se.nodeName!="string"||typeof se.textContent!="string"||typeof se.removeChild!="function"||!(se.attributes instanceof u)||typeof se.removeAttribute!="function"||typeof se.setAttribute!="function"||typeof se.namespaceURI!="string"||typeof se.insertBefore!="function"||typeof se.hasChildNodes!="function")},os=function(se){return typeof a=="function"&&se instanceof a};function Ar(Pt,se,Ze){nw(Pt,Et=>{Et.call(e,se,Ze,ot)})}let Qs=function(se){let Ze=null;if(Ar(I.beforeSanitizeElements,se,null),ni(se))return Yn(se),!0;let Et=Je(se.nodeName);if(Ar(I.uponSanitizeElement,se,{tagName:Et,allowedTags:D}),me&&se.hasChildNodes()&&!os(se.firstElementChild)&&Cs(/<[/\w!]/g,se.innerHTML)&&Cs(/<[/\w!]/g,se.textContent)||se.nodeType===v_.progressingInstruction||me&&se.nodeType===v_.comment&&Cs(/<[/\w]/g,se.data))return Yn(se),!0;if(!(le.tagCheck instanceof Function&&le.tagCheck(Et))&&(!D[Et]||$[Et])){if(!$[Et]&&No(Et)&&(re.tagNameCheck instanceof RegExp&&Cs(re.tagNameCheck,Et)||re.tagNameCheck instanceof Function&&re.tagNameCheck(Et)))return!1;if(R&&!he[Et]){let Mn=b(se)||se.parentNode,ht=S(se)||se.childNodes;if(ht&&Mn){let H=ht.length;for(let oe=H-1;oe>=0;--oe){let ye=_(ht[oe],!0);ye.__removalCount=(se.__removalCount||0)+1,Mn.insertBefore(ye,v(se))}}}return Yn(se),!0}return se instanceof l&&!Mr(se)||(Et==="noscript"||Et==="noembed"||Et==="noframes")&&Cs(/<\/no(script|embed|frames)/i,se.innerHTML)?(Yn(se),!0):(De&&se.nodeType===v_.text&&(Ze=se.textContent,nw([F,B,O],Mn=>{Ze=p_(Ze,Mn," ")}),se.textContent!==Ze&&(f_(e.removed,{element:se.cloneNode()}),se.textContent=Ze)),Ar(I.afterSanitizeElements,se,null),!1)},Il=function(se,Ze,Et){if(_e&&(Ze==="id"||Ze==="name")&&(Et in n||Et in kt))return!1;if(!(ke&&!ie[Ze]&&Cs(z,Ze))){if(!(Ee&&Cs(U,Ze))){if(!(le.attributeCheck instanceof Function&&le.attributeCheck(Ze,se))){if(!q[Ze]||ie[Ze]){if(!(No(se)&&(re.tagNameCheck instanceof RegExp&&Cs(re.tagNameCheck,se)||re.tagNameCheck instanceof Function&&re.tagNameCheck(se))&&(re.attributeNameCheck instanceof RegExp&&Cs(re.attributeNameCheck,Ze)||re.attributeNameCheck instanceof Function&&re.attributeNameCheck(Ze,se))||Ze==="is"&&re.allowCustomizedBuiltInElements&&(re.tagNameCheck instanceof RegExp&&Cs(re.tagNameCheck,Et)||re.tagNameCheck instanceof Function&&re.tagNameCheck(Et))))return!1}else if(!Qe[Ze]){if(!Cs(K,p_(Et,j,""))){if(!((Ze==="src"||Ze==="xlink:href"||Ze==="href")&&se!=="script"&&n$(Et,"data:")===0&&je[se])){if(!(Pe&&!Cs(G,p_(Et,j,"")))){if(Et)return!1}}}}}}}return!0},No=function(se){return se!=="annotation-xml"&&x3(se,J)},eo=function(se){Ar(I.beforeSanitizeAttributes,se,null);let{attributes:Ze}=se;if(!Ze||ni(se))return;let Et={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q,forceKeepAttr:void 0},Mn=Ze.length;for(;Mn--;){let ht=Ze[Mn],{name:H,namespaceURI:oe,value:ye}=ht,xe=Je(H),pe=ye,$e=H==="value"?pe:i$(pe);if(Et.attrName=xe,Et.attrValue=$e,Et.keepAttr=!0,Et.forceKeepAttr=void 0,Ar(I.uponSanitizeAttribute,se,Et),$e=Et.attrValue,Ne&&(xe==="id"||xe==="name")&&(Oi(H,se),$e=W+$e),me&&Cs(/((--!?|])>)|<\/(style|title|textarea)/i,$e)){Oi(H,se);continue}if(xe==="attributename"&&x3($e,"href")){Oi(H,se);continue}if(Et.forceKeepAttr)continue;if(!Et.keepAttr){Oi(H,se);continue}if(!Te&&Cs(/\/>/i,$e)){Oi(H,se);continue}De&&nw([F,B,O],Ke=>{$e=p_($e,Ke," ")});let at=Je(se.nodeName);if(!Il(at,xe,$e)){Oi(H,se);continue}if(w&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!oe)switch(m.getAttributeType(at,xe)){case"TrustedHTML":{$e=w.createHTML($e);break}case"TrustedScriptURL":{$e=w.createScriptURL($e);break}}if($e!==pe)try{oe?se.setAttributeNS(oe,H,$e):se.setAttribute(H,$e),ni(se)?Yn(se):EF(e.removed)}catch{Oi(H,se)}}Ar(I.afterSanitizeAttributes,se,null)},Ya=function Pt(se){let Ze=null,Et=Ti(se);for(Ar(I.beforeSanitizeShadowDOM,se,null);Ze=Et.nextNode();)Ar(I.uponSanitizeShadowNode,Ze,null),Qs(Ze),eo(Ze),Ze.content instanceof s&&Pt(Ze.content);Ar(I.afterSanitizeShadowDOM,se,null)};return e.sanitize=function(Pt){let se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ze=null,Et=null,Mn=null,ht=null;if(ce=!Pt,ce&&(Pt="<!-->"),typeof Pt!="string"&&!os(Pt))if(typeof Pt.toString=="function"){if(Pt=Pt.toString(),typeof Pt!="string")throw m_("dirty is not a string, aborting")}else throw m_("toString is not a function");if(!e.isSupported)return Pt;if(ge||mn(se),e.removed=[],typeof Pt=="string"&&(Z=!1),Z){if(Pt.nodeName){let ye=Je(Pt.nodeName);if(!D[ye]||$[ye])throw m_("root node is forbidden and cannot be sanitized in-place")}}else if(Pt instanceof a)Ze=Qi("<!---->"),Et=Ze.ownerDocument.importNode(Pt,!0),Et.nodeType===v_.element&&Et.nodeName==="BODY"||Et.nodeName==="HTML"?Ze=Et:Ze.appendChild(Et);else{if(!V&&!De&&!ve&&Pt.indexOf("<")===-1)return w&&Me?w.createHTML(Pt):Pt;if(Ze=Qi(Pt),!Ze)return V?null:Me?C:""}Ze&&Ie&&Yn(Ze.firstChild);let H=Ti(Z?Pt:Ze);for(;Mn=H.nextNode();)Qs(Mn),eo(Mn),Mn.content instanceof s&&Ya(Mn.content);if(Z)return Pt;if(V){if(Ge)for(ht=P.call(Ze.ownerDocument);Ze.firstChild;)ht.appendChild(Ze.firstChild);else ht=Ze;return(q.shadowroot||q.shadowrootmode)&&(ht=A.call(i,ht,!0)),ht}let oe=ve?Ze.outerHTML:Ze.innerHTML;return ve&&D["!doctype"]&&Ze.ownerDocument&&Ze.ownerDocument.doctype&&Ze.ownerDocument.doctype.name&&Cs(IF,Ze.ownerDocument.doctype.name)&&(oe="<!DOCTYPE "+Ze.ownerDocument.doctype.name+`>
`+oe),De&&nw([F,B,O],ye=>{oe=p_(oe,ye," ")}),w&&Me?w.createHTML(oe):oe},e.setConfig=function(){let Pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mn(Pt),ge=!0},e.clearConfig=function(){ot=null,ge=!1},e.isValidAttribute=function(Pt,se,Ze){ot||mn({});let Et=Je(Pt),Mn=Je(se);return Il(Et,Mn,Ze)},e.addHook=function(Pt,se){typeof se=="function"&&f_(I[Pt],se)},e.removeHook=function(Pt,se){if(se!==void 0){let Ze=e$(I[Pt],se);return Ze===-1?void 0:t$(I[Pt],Ze,1)[0]}return EF(I[Pt])},e.removeHooks=function(Pt){I[Pt]=[]},e.removeAllHooks=function(){I=LF()},e}var NF=RF();var _$=new OF.default({fg:"#dcd6cc",bg:"#252320",newline:!1,escapeXML:!0,stream:!1});function BF({content:t,isLoading:e=!1,className:n=""}){let i=(0,lr.useRef)(null),r=(0,lr.useRef)(0),[s,o]=(0,lr.useState)(!0),a=(0,lr.useMemo)(()=>{if(i.current&&(r.current=i.current.scrollTop),!t)return"";let c=_$.toHtml(t);return NF.sanitize(c,{ALLOWED_TAGS:["span","div","br"],ALLOWED_ATTR:["style","class"],ALLOW_DATA_ATTR:!1})},[t]);return(0,lr.useLayoutEffect)(()=>{i.current&&r.current>0&&(i.current.scrollTop=r.current)},[a]),lr.default.createElement("div",{className:n,style:{backgroundColor:"var(--color-bg-card)",border:"1px solid var(--color-border-primary)",borderRadius:"8px",overflow:"hidden",height:"100%",display:"flex",flexDirection:"column",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.4), 0 4px 12px rgba(0, 0, 0, 0.3)"}},lr.default.createElement("div",{style:{padding:"12px",borderBottom:"1px solid var(--color-border-primary)",display:"flex",gap:"6px",alignItems:"center",backgroundColor:"var(--color-bg-header)"}},lr.default.createElement("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:"#ff5f57"}}),lr.default.createElement("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:"#ffbd2e"}}),lr.default.createElement("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:"#28c840"}}),lr.default.createElement("button",{onClick:()=>o(!s),style:{marginLeft:"auto",padding:"4px 8px",fontSize:"11px",fontWeight:500,color:s?"var(--color-text-secondary)":"var(--color-accent-primary)",backgroundColor:"transparent",border:"1px solid",borderColor:s?"var(--color-border-primary)":"var(--color-accent-primary)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:c=>{c.currentTarget.style.borderColor="var(--color-accent-primary)",c.currentTarget.style.color="var(--color-accent-primary)"},onMouseLeave:c=>{c.currentTarget.style.borderColor=s?"var(--color-border-primary)":"var(--color-accent-primary)",c.currentTarget.style.color=s?"var(--color-text-secondary)":"var(--color-accent-primary)"},title:s?"Disable word wrap (scroll horizontally)":"Enable word wrap"},s?"\u2922 Wrap":"\u21C4 Scroll")),e?lr.default.createElement("div",{style:{padding:"16px",fontFamily:"var(--font-terminal)",fontSize:"12px",color:"var(--color-text-secondary)"}},"Loading preview..."):lr.default.createElement("div",{style:{position:"relative",flex:1,overflow:"hidden"}},lr.default.createElement("pre",{ref:i,style:{padding:"16px",margin:0,fontFamily:"var(--font-terminal)",fontSize:"12px",lineHeight:"1.6",overflow:"auto",color:"var(--color-text-primary)",backgroundColor:"var(--color-bg-card)",whiteSpace:s?"pre-wrap":"pre",wordBreak:s?"break-word":"normal",position:"absolute",inset:0},dangerouslySetInnerHTML:{__html:a}})))}var Ga=mt(Ct(),1);function UF(t){let[e,n]=(0,Ga.useState)(""),[i,r]=(0,Ga.useState)(!1),[s,o]=(0,Ga.useState)(null),[a,l]=(0,Ga.useState)([]),[c,u]=(0,Ga.useState)(null);(0,Ga.useEffect)(()=>{async function p(){try{let g=await(await fetch("/api/projects")).json();g.projects&&g.projects.length>0&&(l(g.projects),u(g.projects[0]))}catch(m){console.error("Failed to fetch projects:",m)}}p()},[]);let d=(0,Ga.useCallback)(async()=>{if(!c){n("No project selected");return}r(!0),o(null);let p=new URLSearchParams({project:c}),m=await fetch(`/api/context/preview?${p}`),g=await m.text();m.ok?n(g):o("Failed to load preview"),r(!1)},[c]);return(0,Ga.useEffect)(()=>{let p=setTimeout(()=>{d()},300);return()=>clearTimeout(p)},[t,d]),{preview:e,isLoading:i,error:s,refresh:d,projects:a,selectedProject:c,setSelectedProject:u}}function sw({title:t,description:e,children:n,defaultOpen:i=!0}){let[r,s]=(0,Le.useState)(i);return Le.default.createElement("div",{className:`settings-section-collapsible ${r?"open":""}`},Le.default.createElement("button",{className:"section-header-btn",onClick:()=>s(!r),type:"button"},Le.default.createElement("div",{className:"section-header-content"},Le.default.createElement("span",{className:"section-title"},t),e&&Le.default.createElement("span",{className:"section-description"},e)),Le.default.createElement("svg",{className:`chevron-icon ${r?"rotated":""}`,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},Le.default.createElement("polyline",{points:"6 9 12 15 18 9"}))),r&&Le.default.createElement("div",{className:"section-content"},n))}function FF({label:t,options:e,selectedValues:n,onToggle:i,onSelectAll:r,onSelectNone:s}){let o=e.every(l=>n.includes(l)),a=e.every(l=>!n.includes(l));return Le.default.createElement("div",{className:"chip-group"},Le.default.createElement("div",{className:"chip-group-header"},Le.default.createElement("span",{className:"chip-group-label"},t),Le.default.createElement("div",{className:"chip-group-actions"},Le.default.createElement("button",{type:"button",className:`chip-action ${o?"active":""}`,onClick:r},"All"),Le.default.createElement("button",{type:"button",className:`chip-action ${a?"active":""}`,onClick:s},"None"))),Le.default.createElement("div",{className:"chips-container"},e.map(l=>Le.default.createElement("button",{key:l,type:"button",className:`chip ${n.includes(l)?"selected":""}`,onClick:()=>i(l)},l))))}function Ur({label:t,tooltip:e,children:n}){return Le.default.createElement("div",{className:"form-field"},Le.default.createElement("label",{className:"form-field-label"},t,e&&Le.default.createElement("span",{className:"tooltip-trigger",title:e},Le.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},Le.default.createElement("circle",{cx:"12",cy:"12",r:"10"}),Le.default.createElement("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),Le.default.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})))),n)}function qp({id:t,label:e,description:n,checked:i,onChange:r,disabled:s}){return Le.default.createElement("div",{className:"toggle-row"},Le.default.createElement("div",{className:"toggle-info"},Le.default.createElement("label",{htmlFor:t,className:"toggle-label"},e),n&&Le.default.createElement("span",{className:"toggle-description"},n)),Le.default.createElement("button",{type:"button",id:t,role:"switch","aria-checked":i,className:`toggle-switch ${i?"on":""} ${s?"disabled":""}`,onClick:()=>!s&&r(!i),disabled:s},Le.default.createElement("span",{className:"toggle-knob"})))}function zF({isOpen:t,onClose:e,settings:n,onSave:i,isSaving:r,saveStatus:s}){let[o,a]=(0,Le.useState)(n);(0,Le.useEffect)(()=>{a(n)},[n]);let{preview:l,isLoading:c,error:u,projects:d,selectedProject:p,setSelectedProject:m}=UF(o),g=(0,Le.useCallback)((M,L)=>{let P={...o,[M]:L};a(P)},[o]),_=(0,Le.useCallback)(()=>{i(o)},[o,i]),y=(0,Le.useCallback)(M=>{let P=o[M]==="true"?"false":"true";g(M,P)},[o,g]),v=(0,Le.useCallback)((M,L)=>{let P=o[M]||"",T=P?P.split(","):[],A=T.includes(L)?T.filter(I=>I!==L):[...T,L];g(M,A.join(","))},[o,g]),S=(0,Le.useCallback)(M=>{let L=o[M]||"";return L?L.split(","):[]},[o]),b=(0,Le.useCallback)((M,L)=>{g(M,L.join(","))},[g]);if((0,Le.useEffect)(()=>{let M=L=>{L.key==="Escape"&&e()};if(t)return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[t,e]),!t)return null;let w=["bugfix","feature","refactor","discovery","decision","change"],C=["how-it-works","why-it-exists","what-changed","problem-solution","gotcha","pattern","trade-off"];return Le.default.createElement("div",{className:"modal-backdrop",onClick:e},Le.default.createElement("div",{className:"context-settings-modal",onClick:M=>M.stopPropagation()},Le.default.createElement("div",{className:"modal-header"},Le.default.createElement("h2",null,"Settings"),Le.default.createElement("div",{className:"header-controls"},Le.default.createElement("label",{className:"preview-selector"},"Preview for:",Le.default.createElement("select",{value:p||"",onChange:M=>m(M.target.value)},d.map(M=>Le.default.createElement("option",{key:M,value:M},M)))),Le.default.createElement("button",{onClick:e,className:"modal-close-btn",title:"Close (Esc)"},Le.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},Le.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Le.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))))),Le.default.createElement("div",{className:"modal-body"},Le.default.createElement("div",{className:"preview-column"},Le.default.createElement("div",{className:"preview-content"},u?Le.default.createElement("div",{style:{color:"#ff6b6b"}},"Error loading preview: ",u):Le.default.createElement(BF,{content:l,isLoading:c}))),Le.default.createElement("div",{className:"settings-column"},Le.default.createElement(sw,{title:"Loading",description:"How many observations to inject"},Le.default.createElement(Ur,{label:"Observations",tooltip:"Number of recent observations to include in context (1-200)"},Le.default.createElement("input",{type:"number",min:"1",max:"200",value:o.ULTRABRAIN_CONTEXT_OBSERVATIONS||"50",onChange:M=>g("ULTRABRAIN_CONTEXT_OBSERVATIONS",M.target.value)})),Le.default.createElement(Ur,{label:"Sessions",tooltip:"Number of recent sessions to pull observations from (1-50)"},Le.default.createElement("input",{type:"number",min:"1",max:"50",value:o.ULTRABRAIN_CONTEXT_SESSION_COUNT||"10",onChange:M=>g("ULTRABRAIN_CONTEXT_SESSION_COUNT",M.target.value)}))),Le.default.createElement(sw,{title:"Filters",description:"Which observation types to include"},Le.default.createElement(FF,{label:"Type",options:w,selectedValues:S("ULTRABRAIN_CONTEXT_OBSERVATION_TYPES"),onToggle:M=>v("ULTRABRAIN_CONTEXT_OBSERVATION_TYPES",M),onSelectAll:()=>b("ULTRABRAIN_CONTEXT_OBSERVATION_TYPES",w),onSelectNone:()=>b("ULTRABRAIN_CONTEXT_OBSERVATION_TYPES",[])}),Le.default.createElement(FF,{label:"Concept",options:C,selectedValues:S("ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS"),onToggle:M=>v("ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS",M),onSelectAll:()=>b("ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS",C),onSelectNone:()=>b("ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS",[])})),Le.default.createElement(sw,{title:"Display",description:"What to show in context tables"},Le.default.createElement("div",{className:"display-subsection"},Le.default.createElement("span",{className:"subsection-label"},"Full Observations"),Le.default.createElement(Ur,{label:"Count",tooltip:"How many observations show expanded details (0-20)"},Le.default.createElement("input",{type:"number",min:"0",max:"20",value:o.ULTRABRAIN_CONTEXT_FULL_COUNT||"5",onChange:M=>g("ULTRABRAIN_CONTEXT_FULL_COUNT",M.target.value)})),Le.default.createElement(Ur,{label:"Field",tooltip:"Which field to expand for full observations"},Le.default.createElement("select",{value:o.ULTRABRAIN_CONTEXT_FULL_FIELD||"narrative",onChange:M=>g("ULTRABRAIN_CONTEXT_FULL_FIELD",M.target.value)},Le.default.createElement("option",{value:"narrative"},"Narrative"),Le.default.createElement("option",{value:"facts"},"Facts")))),Le.default.createElement("div",{className:"display-subsection"},Le.default.createElement("span",{className:"subsection-label"},"Token Economics"),Le.default.createElement("div",{className:"toggle-group"},Le.default.createElement(qp,{id:"show-read-tokens",label:"Read cost",description:"Tokens to read this observation",checked:o.ULTRABRAIN_CONTEXT_SHOW_READ_TOKENS==="true",onChange:()=>y("ULTRABRAIN_CONTEXT_SHOW_READ_TOKENS")}),Le.default.createElement(qp,{id:"show-work-tokens",label:"Work investment",description:"Tokens spent creating this observation",checked:o.ULTRABRAIN_CONTEXT_SHOW_WORK_TOKENS==="true",onChange:()=>y("ULTRABRAIN_CONTEXT_SHOW_WORK_TOKENS")}),Le.default.createElement(qp,{id:"show-savings-amount",label:"Savings",description:"Total tokens saved by reusing context",checked:o.ULTRABRAIN_CONTEXT_SHOW_SAVINGS_AMOUNT==="true",onChange:()=>y("ULTRABRAIN_CONTEXT_SHOW_SAVINGS_AMOUNT")})))),Le.default.createElement(sw,{title:"Advanced",description:"AI provider and model selection",defaultOpen:!1},Le.default.createElement(Ur,{label:"AI Provider",tooltip:"Choose between Claude (via Agent SDK) or Gemini (via REST API)"},Le.default.createElement("select",{value:o.ULTRABRAIN_PROVIDER||"claude",onChange:M=>g("ULTRABRAIN_PROVIDER",M.target.value)},Le.default.createElement("option",{value:"claude"},"Claude (uses your Claude account)"),Le.default.createElement("option",{value:"gemini"},"Gemini (uses API key)"),Le.default.createElement("option",{value:"openrouter"},"OpenRouter (multi-model)"),Le.default.createElement("option",{value:"groq"},"Groq (free tier, GPT-OSS 120B)"))),o.ULTRABRAIN_PROVIDER==="claude"&&Le.default.createElement(Le.default.Fragment,null,Le.default.createElement(Ur,{label:"Authentication",tooltip:"'Subscription' uses your Claude Code CLI billing. 'API Key' uses a separate Anthropic API key."},Le.default.createElement("select",{value:o.ULTRABRAIN_CLAUDE_AUTH_METHOD||"cli",onChange:M=>g("ULTRABRAIN_CLAUDE_AUTH_METHOD",M.target.value)},Le.default.createElement("option",{value:"cli"},"Claude Subscription (via CLI)"),Le.default.createElement("option",{value:"api"},"Anthropic API Key"))),o.ULTRABRAIN_CLAUDE_AUTH_METHOD==="api"&&Le.default.createElement(Ur,{label:"Anthropic API Key",tooltip:"Your Anthropic API key from console.anthropic.com"},Le.default.createElement("input",{type:"password",value:o.ULTRABRAIN_ANTHROPIC_API_KEY||"",onChange:M=>g("ULTRABRAIN_ANTHROPIC_API_KEY",M.target.value),placeholder:"sk-ant-..."})),Le.default.createElement(Ur,{label:"Claude Model",tooltip:"Claude model used for generating observations"},Le.default.createElement("select",{value:o.ULTRABRAIN_MODEL||"haiku",onChange:M=>g("ULTRABRAIN_MODEL",M.target.value)},Le.default.createElement("option",{value:"haiku"},"haiku (fastest)"),Le.default.createElement("option",{value:"sonnet"},"sonnet (balanced)"),Le.default.createElement("option",{value:"opus"},"opus (highest quality)")))),o.ULTRABRAIN_PROVIDER==="gemini"&&Le.default.createElement(Le.default.Fragment,null,Le.default.createElement(Ur,{label:"Gemini API Key",tooltip:"Your Google AI Studio API key (or set GEMINI_API_KEY env var)"},Le.default.createElement("input",{type:"password",value:o.ULTRABRAIN_GEMINI_API_KEY||"",onChange:M=>g("ULTRABRAIN_GEMINI_API_KEY",M.target.value),placeholder:"Enter Gemini API key..."})),Le.default.createElement(Ur,{label:"Gemini Model",tooltip:"Gemini model used for generating observations"},Le.default.createElement("select",{value:o.ULTRABRAIN_GEMINI_MODEL||"gemini-2.5-flash-lite",onChange:M=>g("ULTRABRAIN_GEMINI_MODEL",M.target.value)},Le.default.createElement("option",{value:"gemini-2.5-flash-lite"},"gemini-2.5-flash-lite (10 RPM free)"),Le.default.createElement("option",{value:"gemini-2.5-flash"},"gemini-2.5-flash (5 RPM free)"),Le.default.createElement("option",{value:"gemini-3-flash-preview"},"gemini-3-flash-preview (5 RPM free)"))),Le.default.createElement("div",{className:"toggle-group",style:{marginTop:"8px"}},Le.default.createElement(qp,{id:"gemini-rate-limiting",label:"Rate Limiting",description:"Enable for free tier (10-30 RPM). Disable if you have billing set up (1000+ RPM).",checked:o.ULTRABRAIN_GEMINI_RATE_LIMITING_ENABLED==="true",onChange:M=>g("ULTRABRAIN_GEMINI_RATE_LIMITING_ENABLED",M?"true":"false")}))),o.ULTRABRAIN_PROVIDER==="groq"&&Le.default.createElement(Le.default.Fragment,null,Le.default.createElement(Ur,{label:"Groq API Key",tooltip:"Your Groq API key from console.groq.com (or set GROQ_API_KEY env var)"},Le.default.createElement("input",{type:"password",value:o.ULTRABRAIN_GROQ_API_KEY||"",onChange:M=>g("ULTRABRAIN_GROQ_API_KEY",M.target.value),placeholder:"Enter Groq API key..."})),Le.default.createElement(Ur,{label:"Groq Model",tooltip:"Model identifier from Groq (e.g., openai/gpt-oss-120b)"},Le.default.createElement("input",{type:"text",value:o.ULTRABRAIN_GROQ_MODEL||"openai/gpt-oss-120b",onChange:M=>g("ULTRABRAIN_GROQ_MODEL",M.target.value),placeholder:"openai/gpt-oss-120b"}))),o.ULTRABRAIN_PROVIDER==="openrouter"&&Le.default.createElement(Le.default.Fragment,null,Le.default.createElement(Ur,{label:"OpenRouter API Key",tooltip:"Your OpenRouter API key from openrouter.ai (or set OPENROUTER_API_KEY env var)"},Le.default.createElement("input",{type:"password",value:o.ULTRABRAIN_OPENROUTER_API_KEY||"",onChange:M=>g("ULTRABRAIN_OPENROUTER_API_KEY",M.target.value),placeholder:"Enter OpenRouter API key..."})),Le.default.createElement(Ur,{label:"OpenRouter Model",tooltip:"Model identifier from OpenRouter (e.g., anthropic/claude-3.5-sonnet, google/gemini-2.0-flash-thinking-exp)"},Le.default.createElement("input",{type:"text",value:o.ULTRABRAIN_OPENROUTER_MODEL||"deepseek/deepseek-r1-0528:free",onChange:M=>g("ULTRABRAIN_OPENROUTER_MODEL",M.target.value),placeholder:"e.g., deepseek/deepseek-r1-0528:free"})),Le.default.createElement(Ur,{label:"Site URL (Optional)",tooltip:"Your site URL for OpenRouter analytics (optional)"},Le.default.createElement("input",{type:"text",value:o.ULTRABRAIN_OPENROUTER_SITE_URL||"",onChange:M=>g("ULTRABRAIN_OPENROUTER_SITE_URL",M.target.value),placeholder:"https://yoursite.com"})),Le.default.createElement(Ur,{label:"App Name (Optional)",tooltip:"Your app name for OpenRouter analytics (optional)"},Le.default.createElement("input",{type:"text",value:o.ULTRABRAIN_OPENROUTER_APP_NAME||"ultrabrain",onChange:M=>g("ULTRABRAIN_OPENROUTER_APP_NAME",M.target.value),placeholder:"ultrabrain"}))),Le.default.createElement(Ur,{label:"Worker Port",tooltip:"Port for the background worker service"},Le.default.createElement("input",{type:"number",min:"1024",max:"65535",value:o.ULTRABRAIN_WORKER_PORT||"37777",onChange:M=>g("ULTRABRAIN_WORKER_PORT",M.target.value)})),Le.default.createElement("div",{className:"toggle-group",style:{marginTop:"12px"}},Le.default.createElement(qp,{id:"show-last-summary",label:"Include last summary",description:"Add previous session's summary to context",checked:o.ULTRABRAIN_CONTEXT_SHOW_LAST_SUMMARY==="true",onChange:()=>y("ULTRABRAIN_CONTEXT_SHOW_LAST_SUMMARY")}),Le.default.createElement(qp,{id:"show-last-message",label:"Include last message",description:"Add previous session's final message",checked:o.ULTRABRAIN_CONTEXT_SHOW_LAST_MESSAGE==="true",onChange:()=>y("ULTRABRAIN_CONTEXT_SHOW_LAST_MESSAGE")}))))),Le.default.createElement("div",{className:"modal-footer"},Le.default.createElement("div",{className:"save-status"},s&&Le.default.createElement("span",{className:s.includes("\u2713")?"success":s.includes("\u2717")?"error":""},s)),Le.default.createElement("button",{className:"save-btn",onClick:_,disabled:r},r?"Saving...":"Save"))))}var gt=mt(Ct(),1),__=[{key:"DEBUG",label:"Debug",icon:"\u{1F50D}",color:"#8b8b8b"},{key:"INFO",label:"Info",icon:"\u2139\uFE0F",color:"#58a6ff"},{key:"WARN",label:"Warn",icon:"\u26A0\uFE0F",color:"#d29922"},{key:"ERROR",label:"Error",icon:"\u274C",color:"#f85149"}],y_=[{key:"HOOK",label:"Hook",icon:"\u{1FA9D}",color:"#a371f7"},{key:"WORKER",label:"Worker",icon:"\u2699\uFE0F",color:"#58a6ff"},{key:"SDK",label:"SDK",icon:"\u{1F4E6}",color:"#3fb950"},{key:"PARSER",label:"Parser",icon:"\u{1F4C4}",color:"#79c0ff"},{key:"DB",label:"DB",icon:"\u{1F5C4}\uFE0F",color:"#f0883e"},{key:"SYSTEM",label:"System",icon:"\u{1F4BB}",color:"#8b949e"},{key:"HTTP",label:"HTTP",icon:"\u{1F310}",color:"#39d353"},{key:"SESSION",label:"Session",icon:"\u{1F4CB}",color:"#db61a2"},{key:"LANCE",label:"Lance",icon:"\u{1F52E}",color:"#a855f7"}];function y$(t){let e=/^\[([^\]]+)\]\s+\[(\w+)\s*\]\s+\[(\w+)\s*\]\s+(?:\[([^\]]+)\]\s+)?(.*)$/,n=t.match(e);if(!n)return{raw:t};let[,i,r,s,o,a]=n,l;return a.startsWith("\u2192")?l="dataIn":a.startsWith("\u2190")?l="dataOut":a.startsWith("\u2713")?l="success":a.startsWith("\u2717")?l="failure":a.startsWith("\u23F1")?l="timing":a.includes("[HAPPY-PATH]")&&(l="happyPath"),{raw:t,timestamp:i,level:r?.trim(),component:s?.trim(),correlationId:o||void 0,message:a,isSpecial:l}}function HF({isOpen:t,onClose:e}){let[n,i]=(0,gt.useState)(""),[r,s]=(0,gt.useState)(!1),[o,a]=(0,gt.useState)(null),[l,c]=(0,gt.useState)(!1),[u,d]=(0,gt.useState)(350),[p,m]=(0,gt.useState)(!1),g=(0,gt.useRef)(0),_=(0,gt.useRef)(0),y=(0,gt.useRef)(null),v=(0,gt.useRef)(!0),[S,b]=(0,gt.useState)(new Set(["DEBUG","INFO","WARN","ERROR"])),[w,C]=(0,gt.useState)(new Set(["HOOK","WORKER","SDK","PARSER","DB","SYSTEM","HTTP","SESSION","LANCE"])),[M,L]=(0,gt.useState)(!1),P=(0,gt.useMemo)(()=>n?n.split(`
`).map(y$):[],[n]),T=(0,gt.useMemo)(()=>P.filter(D=>M?D.raw.includes("[ALIGNMENT]"):!D.level||!D.component?!0:S.has(D.level)&&w.has(D.component)),[P,S,w,M]),A=(0,gt.useCallback)(()=>{if(!y.current)return!0;let{scrollTop:D,scrollHeight:X,clientHeight:q}=y.current;return X-D-q<50},[]),I=(0,gt.useCallback)(()=>{y.current&&v.current&&(y.current.scrollTop=y.current.scrollHeight)},[]),F=(0,gt.useCallback)(async()=>{v.current=A(),s(!0),a(null);try{let D=await fetch("/api/logs");if(!D.ok)throw new Error(`Failed to fetch logs: ${D.statusText}`);let X=await D.json();i(X.logs||"")}catch(D){a(D instanceof Error?D.message:"Unknown error")}finally{s(!1)}},[A]);(0,gt.useEffect)(()=>{I()},[n,I]);let B=(0,gt.useCallback)(async()=>{if(confirm("Are you sure you want to clear all logs?")){s(!0),a(null);try{let D=await fetch("/api/logs/clear",{method:"POST"});if(!D.ok)throw new Error(`Failed to clear logs: ${D.statusText}`);i("")}catch(D){a(D instanceof Error?D.message:"Unknown error")}finally{s(!1)}}},[]),O=(0,gt.useCallback)(D=>{D.preventDefault(),m(!0),g.current=D.clientY,_.current=u},[u]);(0,gt.useEffect)(()=>{if(!p)return;let D=q=>{let ne=g.current-q.clientY,re=Math.min(Math.max(150,_.current+ne),window.innerHeight-100);d(re)},X=()=>{m(!1)};return document.addEventListener("mousemove",D),document.addEventListener("mouseup",X),()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",X)}},[p]),(0,gt.useEffect)(()=>{t&&(v.current=!0,F())},[t,F]),(0,gt.useEffect)(()=>{if(!t||!l)return;let D=setInterval(F,2e3);return()=>clearInterval(D)},[t,l,F]);let z=(0,gt.useCallback)(D=>{b(X=>{let q=new Set(X);return q.has(D)?q.delete(D):q.add(D),q})},[]),U=(0,gt.useCallback)(D=>{C(X=>{let q=new Set(X);return q.has(D)?q.delete(D):q.add(D),q})},[]),G=(0,gt.useCallback)(D=>{b(D?new Set(["DEBUG","INFO","WARN","ERROR"]):new Set)},[]),j=(0,gt.useCallback)(D=>{C(D?new Set(["HOOK","WORKER","SDK","PARSER","DB","SYSTEM","HTTP","SESSION","LANCE"]):new Set)},[]);if(!t)return null;let J=D=>{let X=__.find(ie=>ie.key===D.level),q=y_.find(ie=>ie.key===D.component),ne="var(--color-text-primary)",re="normal",$="transparent";return D.level==="ERROR"?(ne="#f85149",$="rgba(248, 81, 73, 0.1)"):D.level==="WARN"?(ne="#d29922",$="rgba(210, 153, 34, 0.05)"):D.isSpecial==="success"?ne="#3fb950":D.isSpecial==="failure"?ne="#f85149":D.isSpecial==="happyPath"?ne="#d29922":X&&(ne=X.color),{color:ne,fontWeight:re,backgroundColor:$,padding:"1px 0",borderRadius:"2px"}},K=(D,X)=>{if(!D.timestamp)return gt.default.createElement("div",{key:X,className:"log-line log-line-raw"},D.raw);let q=__.find(re=>re.key===D.level),ne=y_.find(re=>re.key===D.component);return gt.default.createElement("div",{key:X,className:"log-line",style:J(D)},gt.default.createElement("span",{className:"log-timestamp"},"[",D.timestamp,"]")," ",gt.default.createElement("span",{className:"log-level",style:{color:q?.color},title:D.level},"[",q?.icon||""," ",D.level?.padEnd(5),"]")," ",gt.default.createElement("span",{className:"log-component",style:{color:ne?.color},title:D.component},"[",ne?.icon||""," ",D.component?.padEnd(7),"]")," ",D.correlationId&&gt.default.createElement(gt.default.Fragment,null,gt.default.createElement("span",{className:"log-correlation"},"[",D.correlationId,"]")," "),gt.default.createElement("span",{className:"log-message"},D.message))};return gt.default.createElement("div",{className:"console-drawer",style:{height:`${u}px`}},gt.default.createElement("div",{className:"console-resize-handle",onMouseDown:O},gt.default.createElement("div",{className:"console-resize-bar"})),gt.default.createElement("div",{className:"console-header"},gt.default.createElement("div",{className:"console-tabs"},gt.default.createElement("div",{className:"console-tab active"},"Console")),gt.default.createElement("div",{className:"console-controls"},gt.default.createElement("label",{className:"console-auto-refresh"},gt.default.createElement("input",{type:"checkbox",checked:l,onChange:D=>c(D.target.checked)}),"Auto-refresh"),gt.default.createElement("button",{className:"console-control-btn",onClick:F,disabled:r,title:"Refresh logs"},"\u21BB"),gt.default.createElement("button",{className:"console-control-btn",onClick:()=>{v.current=!0,I()},title:"Scroll to bottom"},"\u2B07"),gt.default.createElement("button",{className:"console-control-btn console-clear-btn",onClick:B,disabled:r,title:"Clear logs"},"\u{1F5D1}"),gt.default.createElement("button",{className:"console-control-btn",onClick:e,title:"Close console"},"\u2715"))),gt.default.createElement("div",{className:"console-filters"},gt.default.createElement("div",{className:"console-filter-section"},gt.default.createElement("span",{className:"console-filter-label"},"Quick:"),gt.default.createElement("div",{className:"console-filter-chips"},gt.default.createElement("button",{className:`console-filter-chip ${M?"active":""}`,onClick:()=>L(!M),style:{"--chip-color":"#f0883e"},title:"Show only session alignment logs"},"\u{1F517} Alignment"))),gt.default.createElement("div",{className:"console-filter-section"},gt.default.createElement("span",{className:"console-filter-label"},"Levels:"),gt.default.createElement("div",{className:"console-filter-chips"},__.map(D=>gt.default.createElement("button",{key:D.key,className:`console-filter-chip ${S.has(D.key)?"active":""}`,onClick:()=>z(D.key),style:{"--chip-color":D.color},title:D.label},D.icon," ",D.label)),gt.default.createElement("button",{className:"console-filter-action",onClick:()=>G(S.size===0),title:S.size===__.length?"Select none":"Select all"},S.size===__.length?"\u25CB":"\u25CF"))),gt.default.createElement("div",{className:"console-filter-section"},gt.default.createElement("span",{className:"console-filter-label"},"Components:"),gt.default.createElement("div",{className:"console-filter-chips"},y_.map(D=>gt.default.createElement("button",{key:D.key,className:`console-filter-chip ${w.has(D.key)?"active":""}`,onClick:()=>U(D.key),style:{"--chip-color":D.color},title:D.label},D.icon," ",D.label)),gt.default.createElement("button",{className:"console-filter-action",onClick:()=>j(w.size===0),title:w.size===y_.length?"Select none":"Select all"},w.size===y_.length?"\u25CB":"\u25CF")))),o&&gt.default.createElement("div",{className:"console-error"},"\u26A0 ",o),gt.default.createElement("div",{className:"console-content",ref:y},gt.default.createElement("div",{className:"console-logs"},T.length===0?gt.default.createElement("div",{className:"log-line log-line-empty"},"No logs available"):T.map((D,X)=>K(D,X)))))}var Sn=mt(Ct(),1);var A3=mt(Ct(),1);function Ys({name:t,color:e,onRemove:n,onClick:i,size:r="sm"}){return A3.default.createElement("span",{className:"tag-badge",style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:r==="sm"?"1px 6px":"2px 8px",fontSize:r==="sm"?"0.65rem":"0.75rem",fontWeight:500,borderRadius:"9999px",backgroundColor:`${e}20`,color:e,border:`1px solid ${e}40`,cursor:i?"pointer":"default",whiteSpace:"nowrap"},onClick:i},t,n&&A3.default.createElement("button",{onClick:a=>{a.stopPropagation(),n()},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0",fontSize:"0.8em",lineHeight:1,opacity:.7}},"x"))}var ow=mt(Ct(),1);function ja({value:t,onChange:e,projects:n}){return ow.default.createElement("select",{className:"kanban-project-filter",value:t,onChange:i=>e(i.target.value),style:{padding:"4px 8px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--color-border-primary, #333)",background:"var(--color-bg-secondary, #1a1a2e)",color:"inherit",cursor:"pointer",minWidth:"140px"}},ow.default.createElement("option",{value:""},"All Projects"),n.map(i=>ow.default.createElement("option",{key:i,value:i},i)))}var x$={bug:"#ef4444",todo:"#f59e0b",idea:"#8b5cf6",learning:"#06b6d4",decision:"#3b82f6",feature:"#10b981",fix:"#f97316",refactor:"#6366f1",performance:"#ec4899",security:"#dc2626",devops:"#64748b",docs:"#84cc16","planned-feature":"#f59e0b"};function S$(t){let e=Date.now()-t,n=Math.floor(e/6e4);if(n<60)return`${n}m ago`;let i=Math.floor(n/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`}function WF({currentProject:t,projects:e,onNavigate:n,onProjectChange:i}){let[r,s]=(0,Sn.useState)(null),[o,a]=(0,Sn.useState)(!0),[l,c]=(0,Sn.useState)(null),[u,d]=(0,Sn.useState)([]);(0,Sn.useEffect)(()=>{fetch("/api/projects/stats?source=claude-code").then(_=>_.json()).then(_=>{let v=(Array.isArray(_)?_:_.projects||[]).map(S=>S.name||S.project).filter(Boolean);d(v)}).catch(()=>{})},[]);let p=()=>{let _=t?`?project=${encodeURIComponent(t)}`:"";fetch(`/api/pm/overview${_}`).then(y=>y.json()).then(s).catch(()=>{}).finally(()=>a(!1))};(0,Sn.useEffect)(()=>{a(!0),p()},[t]);let m=async()=>{c("Running...");try{let y=await(await fetch("/api/pm/backfill-tags",{method:"POST"})).json();c(`Tagged ${y.tagged} observations, ${y.summariesTagged} summaries`),p()}catch{c("Backfill failed")}};if(o)return Sn.default.createElement("div",{className:"pm-view",style:{padding:"2rem",opacity:.5}},"Loading...");if(!r)return Sn.default.createElement("div",{className:"pm-view",style:{padding:"2rem"}},"Failed to load PM data");let g=[{label:"Bugs",count:r.bugs,color:"#ef4444",view:"pm-bugs"},{label:"Todos",count:r.todos,color:"#f59e0b",view:"pm-todos"},{label:"Ideas",count:r.ideas,color:"#8b5cf6",view:"pm-ideas"},{label:"Learnings",count:r.learnings,color:"#06b6d4",view:"pm-learnings"}];return Sn.default.createElement("div",{className:"pm-view",style:{padding:"1.5rem",maxWidth:"900px"}},Sn.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"}},Sn.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},Sn.default.createElement("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:600}},"Project Management"),Sn.default.createElement(ja,{value:t,onChange:i,projects:u})),Sn.default.createElement("button",{onClick:m,style:{background:"none",border:"1px solid var(--border-color, #333)",borderRadius:"6px",padding:"4px 12px",fontSize:"0.75rem",cursor:"pointer",color:"var(--text-muted, #888)"}},"Backfill Tags")),l&&Sn.default.createElement("div",{style:{padding:"8px 12px",marginBottom:"1rem",fontSize:"0.8rem",background:"var(--bg-secondary, #1a1a2e)",borderRadius:"6px",border:"1px solid var(--border-color, #333)"}},l),Sn.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px",marginBottom:"2rem"}},g.map(_=>Sn.default.createElement("div",{key:_.label,onClick:()=>n(_.view),style:{padding:"1rem",borderRadius:"10px",border:`1px solid ${_.color}30`,background:`${_.color}08`,cursor:"pointer",transition:"border-color 0.2s"},onMouseOver:y=>y.currentTarget.style.borderColor=`${_.color}60`,onMouseOut:y=>y.currentTarget.style.borderColor=`${_.color}30`},Sn.default.createElement("div",{style:{fontSize:"2rem",fontWeight:700,color:_.color}},_.count),Sn.default.createElement("div",{style:{fontSize:"0.85rem",opacity:.7}},_.label)))),(r.tasksOpen>0||r.tasksInProgress>0)&&Sn.default.createElement("div",{style:{marginBottom:"2rem"}},Sn.default.createElement("h3",{style:{fontSize:"0.9rem",fontWeight:600,marginBottom:"8px",opacity:.8}},"Kanban Tasks"),Sn.default.createElement("div",{style:{display:"flex",gap:"16px",fontSize:"0.8rem"}},Sn.default.createElement("span",null,r.tasksOpen," open"),Sn.default.createElement("span",null,r.tasksInProgress," in progress"))),r.recent.length>0&&Sn.default.createElement("div",null,Sn.default.createElement("h3",{style:{fontSize:"0.9rem",fontWeight:600,marginBottom:"8px",opacity:.8}},"Recent Tagged Items"),Sn.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},r.recent.map(_=>Sn.default.createElement("div",{key:_.id,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem"}},Sn.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem",minWidth:"24px"}},"#",_.id),Sn.default.createElement("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},_.title||_.subtitle||"(untitled)"),Sn.default.createElement("span",{style:{display:"flex",gap:"4px",flexShrink:0}},_.tags.map(y=>Sn.default.createElement(Ys,{key:y,name:y,color:x$[y]||"#6366f1"}))),Sn.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem",flexShrink:0}},S$(_.created_at_epoch)))))))}var fi=mt(Ct(),1);var Co=mt(Ct(),1);function Yp({value:t,onChange:e,placeholder:n="Search..."}){let[i,r]=(0,Co.useState)(t),s=(0,Co.useRef)(null);(0,Co.useEffect)(()=>{r(t)},[t]);let o=a=>{r(a),s.current&&clearTimeout(s.current),s.current=setTimeout(()=>e(a),300)};return Co.default.createElement("div",{style:{position:"relative",marginBottom:"1rem"}},Co.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",opacity:.4}},Co.default.createElement("circle",{cx:"11",cy:"11",r:"8"}),Co.default.createElement("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})),Co.default.createElement("input",{type:"text",value:i,onChange:a=>o(a.target.value),placeholder:n,style:{width:"100%",padding:"8px 32px 8px 32px",fontSize:"0.85rem",borderRadius:"8px",border:"1px solid var(--border-color, #333)",background:"var(--bg-secondary, #1a1a2e)",color:"inherit",outline:"none",boxSizing:"border-box"}}),i&&Co.default.createElement("button",{onClick:()=>{r(""),e("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted, #888)",fontSize:"1rem",padding:"2px 4px",lineHeight:1}},"\xD7"))}var b$={bug:"#ef4444",fix:"#f97316",security:"#dc2626",performance:"#ec4899",todo:"#f59e0b",feature:"#10b981",refactor:"#6366f1","planned-feature":"#f59e0b"};function w$(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function VF({currentProject:t}){let[e,n]=(0,fi.useState)([]),[i,r]=(0,fi.useState)(!0),[s,o]=(0,fi.useState)(null),[a,l]=(0,fi.useState)("");(0,fi.useEffect)(()=>{r(!0);let u=t?`?project=${encodeURIComponent(t)}`:"";fetch(`/api/pm/bugs${u}`).then(d=>d.json()).then(d=>n(d.bugs||[])).catch(()=>{}).finally(()=>r(!1))},[t]);let c=a?e.filter(u=>(u.title||"").toLowerCase().includes(a.toLowerCase())||(u.subtitle||"").toLowerCase().includes(a.toLowerCase())||(u.narrative||"").toLowerCase().includes(a.toLowerCase())):e;return i?fi.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading bugs..."):fi.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"900px"}},fi.default.createElement("h2",{style:{margin:"0 0 1rem",fontSize:"1.2rem",fontWeight:600}},"Bugs & Fixes",fi.default.createElement("span",{style:{fontSize:"0.85rem",opacity:.5,marginLeft:"8px"}},"(",c.length,")")),fi.default.createElement(Yp,{value:a,onChange:l,placeholder:"Search bugs..."}),c.length===0?fi.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.9rem"}},a?"No bugs match your search.":'No bugs found. Run "Backfill Tags" from Overview to label existing observations.'):fi.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},c.map(u=>fi.default.createElement("div",{key:u.id,style:{padding:"12px 16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",cursor:"pointer"},onClick:()=>o(s===u.id?null:u.id)},fi.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},fi.default.createElement("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:u.tags.includes("fix")?"#10b981":"#ef4444",flexShrink:0}}),fi.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem",minWidth:"30px"}},"#",u.id),fi.default.createElement("span",{style:{flex:1,fontSize:"0.85rem",fontWeight:500}},u.title||u.subtitle||"(untitled)"),fi.default.createElement("span",{style:{display:"flex",gap:"4px",flexShrink:0}},u.tags.map(d=>fi.default.createElement(Ys,{key:d,name:d,color:b$[d]||"#6366f1"}))),fi.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem",flexShrink:0}},w$(u.created_at_epoch))),s===u.id&&u.narrative&&fi.default.createElement("div",{style:{marginTop:"10px",paddingTop:"10px",borderTop:"1px solid var(--border-color, #333)",fontSize:"0.8rem",opacity:.8,lineHeight:1.5,whiteSpace:"pre-wrap"}},u.narrative)))))}var on=mt(Ct(),1);var E$={todo:"#f59e0b",bug:"#ef4444",feature:"#10b981","planned-feature":"#f59e0b"},C$={high:"#ef4444",medium:"#f59e0b",low:"#64748b"};function T$(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}function GF({currentProject:t}){let[e,n]=(0,on.useState)([]),[i,r]=(0,on.useState)([]),[s,o]=(0,on.useState)(!0),[a,l]=(0,on.useState)("all"),[c,u]=(0,on.useState)("");(0,on.useEffect)(()=>{o(!0);let y=t?`?project=${encodeURIComponent(t)}`:"";fetch(`/api/pm/todos${y}`).then(v=>v.json()).then(v=>{n(v.observations||[]),r(v.tasks||[])}).catch(()=>{}).finally(()=>o(!1))},[t]);let d=async y=>{let v=y.status==="done"?"todo":"done";await fetch(`/api/tasks/${y.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:v})}),r(S=>S.map(b=>b.id===y.id?{...b,status:v}:b))},p=c?e.filter(y=>(y.title||"").toLowerCase().includes(c.toLowerCase())||(y.subtitle||"").toLowerCase().includes(c.toLowerCase())):e,m=c?i.filter(y=>y.title.toLowerCase().includes(c.toLowerCase())||(y.description||"").toLowerCase().includes(c.toLowerCase())):i;if(s)return on.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading todos...");let g=m.filter(y=>y.status!=="done"),_=m.filter(y=>y.status==="done");return on.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"900px"}},on.default.createElement("h2",{style:{margin:"0 0 1rem",fontSize:"1.2rem",fontWeight:600}},"Todos",on.default.createElement("span",{style:{fontSize:"0.85rem",opacity:.5,marginLeft:"8px"}},"(",p.length," tagged + ",m.length," tasks)")),on.default.createElement(Yp,{value:c,onChange:u,placeholder:"Search todos..."}),on.default.createElement("div",{style:{display:"flex",gap:"4px",marginBottom:"1rem"}},["all","observations","tasks"].map(y=>on.default.createElement("button",{key:y,onClick:()=>l(y),style:{padding:"4px 12px",fontSize:"0.75rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:a===y?"var(--accent-color, #6366f1)":"transparent",color:a===y?"#fff":"var(--text-muted, #888)",cursor:"pointer",textTransform:"capitalize"}},y))),(a==="all"||a==="observations")&&p.length>0&&on.default.createElement("div",{style:{marginBottom:"1.5rem"}},a==="all"&&on.default.createElement("h3",{style:{fontSize:"0.85rem",fontWeight:600,opacity:.7,marginBottom:"8px"}},"From Observations"),on.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},p.map(y=>on.default.createElement("div",{key:y.id,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem"}},on.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem"}},"#",y.id),on.default.createElement("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},y.title||y.subtitle||"(untitled)"),on.default.createElement("span",{style:{display:"flex",gap:"4px"}},y.tags.map(v=>on.default.createElement(Ys,{key:v,name:v,color:E$[v]||"#6366f1"}))),on.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem"}},T$(y.created_at_epoch)))))),(a==="all"||a==="tasks")&&on.default.createElement("div",null,a==="all"&&on.default.createElement("h3",{style:{fontSize:"0.85rem",fontWeight:600,opacity:.7,marginBottom:"8px"}},"Kanban Tasks"),g.length===0&&_.length===0?on.default.createElement("div",{style:{padding:"1rem",textAlign:"center",opacity:.5,fontSize:"0.85rem"}},"No tasks yet"):on.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},g.map(y=>on.default.createElement("div",{key:y.id,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem"}},on.default.createElement("input",{type:"checkbox",checked:!1,onChange:()=>d(y),style:{cursor:"pointer"}}),on.default.createElement("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:C$[y.priority]||"#64748b",flexShrink:0}}),on.default.createElement("span",{style:{flex:1}},y.title),on.default.createElement("span",{style:{opacity:.5,fontSize:"0.7rem"}},y.status))),_.length>0&&on.default.createElement(on.default.Fragment,null,on.default.createElement("div",{style:{fontSize:"0.75rem",opacity:.4,marginTop:"8px"}},"Completed (",_.length,")"),_.slice(0,5).map(y=>on.default.createElement("div",{key:y.id,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem",opacity:.5}},on.default.createElement("input",{type:"checkbox",checked:!0,onChange:()=>d(y),style:{cursor:"pointer"}}),on.default.createElement("span",{style:{flex:1,textDecoration:"line-through"}},y.title)))))))}var wi=mt(Ct(),1);var M$={idea:"#8b5cf6",feature:"#10b981",docs:"#84cc16","planned-feature":"#f59e0b"};function A$(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}function jF({currentProject:t}){let[e,n]=(0,wi.useState)([]),[i,r]=(0,wi.useState)(!0),[s,o]=(0,wi.useState)(null),[a,l]=(0,wi.useState)("");(0,wi.useEffect)(()=>{r(!0);let u=t?`?project=${encodeURIComponent(t)}`:"";fetch(`/api/pm/ideas${u}`).then(d=>d.json()).then(d=>n(d.ideas||[])).catch(()=>{}).finally(()=>r(!1))},[t]);let c=a?e.filter(u=>(u.title||"").toLowerCase().includes(a.toLowerCase())||(u.subtitle||"").toLowerCase().includes(a.toLowerCase())||(u.narrative||"").toLowerCase().includes(a.toLowerCase())):e;return i?wi.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading ideas..."):wi.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"900px"}},wi.default.createElement("h2",{style:{margin:"0 0 1rem",fontSize:"1.2rem",fontWeight:600}},"Ideas",wi.default.createElement("span",{style:{fontSize:"0.85rem",opacity:.5,marginLeft:"8px"}},"(",c.length,")")),wi.default.createElement(Yp,{value:a,onChange:l,placeholder:"Search ideas..."}),c.length===0?wi.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.9rem"}},a?"No ideas match your search.":'No ideas found. Ideas are auto-tagged from observations containing "idea", "brainstorm", "concept", or "proposal".'):wi.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"12px"}},c.map(u=>wi.default.createElement("div",{key:u.id,onClick:()=>o(s===u.id?null:u.id),style:{padding:"14px 16px",borderRadius:"10px",border:"1px solid #8b5cf630",background:"#8b5cf608",cursor:"pointer",transition:"border-color 0.2s"},onMouseOver:d=>d.currentTarget.style.borderColor="#8b5cf660",onMouseOut:d=>d.currentTarget.style.borderColor="#8b5cf630"},wi.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"6px"}},wi.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem"}},"#",u.id),wi.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem"}},A$(u.created_at_epoch))),wi.default.createElement("div",{style:{fontSize:"0.85rem",fontWeight:500,marginBottom:"6px"}},u.title||u.subtitle||"(untitled)"),wi.default.createElement("div",{style:{display:"flex",gap:"4px",marginBottom:s===u.id?"8px":0}},u.tags.map(d=>wi.default.createElement(Ys,{key:d,name:d,color:M$[d]||"#6366f1"}))),s===u.id&&u.narrative&&wi.default.createElement("div",{style:{paddingTop:"8px",borderTop:"1px solid var(--border-color, #333)",fontSize:"0.8rem",opacity:.8,lineHeight:1.5,whiteSpace:"pre-wrap"}},u.narrative)))))}var jn=mt(Ct(),1);var k$={learning:"#06b6d4",decision:"#3b82f6",idea:"#8b5cf6","planned-feature":"#f59e0b"};function L$(t){return new Date(t).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})}function XF({currentProject:t}){let[e,n]=(0,jn.useState)([]),[i,r]=(0,jn.useState)(!0),[s,o]=(0,jn.useState)(""),[a,l]=(0,jn.useState)(null);(0,jn.useEffect)(()=>{r(!0);let d=t?`?project=${encodeURIComponent(t)}`:"";fetch(`/api/pm/learnings${d}`).then(p=>p.json()).then(p=>n(p.learnings||[])).catch(()=>{}).finally(()=>r(!1))},[t]);let c=s?e.filter(d=>(d.title||"").toLowerCase().includes(s.toLowerCase())||(d.narrative||"").toLowerCase().includes(s.toLowerCase())):e,u=new Map;for(let d of c){let p=new Date(d.created_at_epoch).toDateString();u.has(p)||u.set(p,[]),u.get(p).push(d)}return i?jn.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading learnings..."):jn.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"900px"}},jn.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"}},jn.default.createElement("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:600}},"Learnings & Decisions",jn.default.createElement("span",{style:{fontSize:"0.85rem",opacity:.5,marginLeft:"8px"}},"(",c.length,")"))),jn.default.createElement("input",{type:"text",placeholder:"Search learnings...",value:s,onChange:d=>o(d.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"0.85rem",borderRadius:"8px",border:"1px solid var(--border-color, #333)",background:"var(--bg-secondary, #1a1a2e)",color:"inherit",marginBottom:"1rem",outline:"none",boxSizing:"border-box"}}),c.length===0?jn.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.9rem"}},s?"No learnings match your search.":'No learnings found. Learnings are auto-tagged from observations with type "discovery" or keywords like "learn", "discover", "insight".'):jn.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"16px"}},Array.from(u.entries()).map(([d,p])=>jn.default.createElement("div",{key:d},jn.default.createElement("div",{style:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",opacity:.5,marginBottom:"8px",paddingBottom:"4px",borderBottom:"1px solid var(--border-color, #333)"}},L$(p[0].created_at_epoch)),jn.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},p.map(m=>jn.default.createElement("div",{key:m.id,onClick:()=>l(a===m.id?null:m.id),style:{padding:"10px 14px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",borderLeft:`3px solid ${m.tags.includes("decision")?"#3b82f6":"#06b6d4"}`,cursor:"pointer"}},jn.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},jn.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem"}},"#",m.id),jn.default.createElement("span",{style:{flex:1,fontSize:"0.85rem",fontWeight:500}},m.title||m.subtitle||"(untitled)"),jn.default.createElement("span",{style:{display:"flex",gap:"4px"}},m.tags.map(g=>jn.default.createElement(Ys,{key:g,name:g,color:k$[g]||"#6366f1"}))),jn.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem"}},new Date(m.created_at_epoch).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}))),a===m.id&&m.narrative&&jn.default.createElement("div",{style:{marginTop:"10px",paddingTop:"10px",borderTop:"1px solid var(--border-color, #333)",fontSize:"0.8rem",opacity:.8,lineHeight:1.5,whiteSpace:"pre-wrap"}},m.narrative))))))))}var en=mt(Ct(),1);var P$=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981","#06b6d4","#3b82f6","#6366f1","#8b5cf6","#ec4899","#dc2626","#64748b"];function qF(){let[t,e]=(0,en.useState)([]),[n,i]=(0,en.useState)(!0),[r,s]=(0,en.useState)(""),[o,a]=(0,en.useState)("#6366f1"),[l,c]=(0,en.useState)(null),u=(0,en.useCallback)(()=>{fetch("/api/tags").then(_=>_.json()).then(_=>e(_.tags||[])).catch(()=>{}).finally(()=>i(!1))},[]);(0,en.useEffect)(()=>{u()},[u]);let d=async()=>{if(r.trim()){c(null);try{let _=await fetch("/api/tags",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.trim(),color:o})});if(!_.ok){let y=await _.json();c(y.error||"Failed to create tag");return}s(""),u()}catch{c("Failed to create tag")}}},p=async _=>{_.is_system||confirm(`Delete tag "${_.name}"? This will remove it from all items.`)&&(await fetch(`/api/tags/${_.id}`,{method:"DELETE"}),u())};if(n)return en.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading tags...");let m=t.filter(_=>_.is_system),g=t.filter(_=>!_.is_system);return en.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"700px"}},en.default.createElement("h2",{style:{margin:"0 0 1.5rem",fontSize:"1.2rem",fontWeight:600}},"Tags"),en.default.createElement("div",{style:{padding:"16px",borderRadius:"10px",border:"1px solid var(--border-color, #333)",marginBottom:"1.5rem"}},en.default.createElement("div",{style:{fontSize:"0.85rem",fontWeight:600,marginBottom:"10px"}},"Create Tag"),en.default.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center"}},en.default.createElement("input",{type:"text",placeholder:"Tag name...",value:r,onChange:_=>s(_.target.value),onKeyDown:_=>_.key==="Enter"&&d(),style:{flex:1,padding:"6px 10px",fontSize:"0.85rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--bg-secondary, #1a1a2e)",color:"inherit",outline:"none"}}),en.default.createElement("div",{style:{display:"flex",gap:"4px"}},P$.map(_=>en.default.createElement("button",{key:_,onClick:()=>a(_),style:{width:"18px",height:"18px",borderRadius:"50%",background:_,border:o===_?"2px solid white":"2px solid transparent",cursor:"pointer",padding:0}}))),en.default.createElement("button",{onClick:d,disabled:!r.trim(),style:{padding:"6px 14px",fontSize:"0.8rem",borderRadius:"6px",border:"none",background:"var(--accent-color, #6366f1)",color:"#fff",cursor:r.trim()?"pointer":"not-allowed",opacity:r.trim()?1:.5}},"Create")),r&&en.default.createElement("div",{style:{marginTop:"8px"}},en.default.createElement("span",{style:{fontSize:"0.75rem",opacity:.6}},"Preview: "),en.default.createElement(Ys,{name:r,color:o,size:"md"})),l&&en.default.createElement("div",{style:{marginTop:"8px",fontSize:"0.8rem",color:"#ef4444"}},l)),en.default.createElement("div",{style:{marginBottom:"1.5rem"}},en.default.createElement("h3",{style:{fontSize:"0.85rem",fontWeight:600,opacity:.7,marginBottom:"10px"}},"System Tags (",m.length,")"),en.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},m.map(_=>en.default.createElement("div",{key:_.id,style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem"}},en.default.createElement(Ys,{name:_.name,color:_.color,size:"md"}),en.default.createElement("span",{style:{flex:1}}),en.default.createElement("span",{style:{opacity:.5,fontSize:"0.75rem"}},_.usage_count," item",_.usage_count!==1?"s":""),en.default.createElement("span",{style:{fontSize:"0.65rem",padding:"1px 6px",borderRadius:"4px",background:"var(--bg-secondary, #1a1a2e)",opacity:.5}},"system"))))),en.default.createElement("div",null,en.default.createElement("h3",{style:{fontSize:"0.85rem",fontWeight:600,opacity:.7,marginBottom:"10px"}},"Custom Tags (",g.length,")"),g.length===0?en.default.createElement("div",{style:{padding:"1rem",textAlign:"center",opacity:.5,fontSize:"0.85rem"}},"No custom tags yet. Create one above."):en.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},g.map(_=>en.default.createElement("div",{key:_.id,style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem"}},en.default.createElement(Ys,{name:_.name,color:_.color,size:"md"}),en.default.createElement("span",{style:{flex:1}}),en.default.createElement("span",{style:{opacity:.5,fontSize:"0.75rem"}},_.usage_count," item",_.usage_count!==1?"s":""),en.default.createElement("button",{onClick:()=>p(_),style:{background:"none",border:"1px solid #ef444440",borderRadius:"4px",padding:"2px 8px",fontSize:"0.7rem",color:"#ef4444",cursor:"pointer",opacity:.7}},"Delete"))))))}var Mt=mt(Ct(),1);function k3(t){let e=Date.now()-t,n=Math.floor(e/6e4);if(n<1)return"just now";if(n<60)return`${n}m ago`;let i=Math.floor(n/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`}function D$(t){if(!t||t<0)return"--";if(t<60)return`${t}s`;let e=Math.floor(t/60);if(e<60)return`${e}m`;let n=Math.floor(e/60),i=e%60;return i>0?`${n}h ${i}m`:`${n}h`}var YF={bug:"#ef4444",fix:"#f97316",todo:"#f59e0b",feature:"#10b981",idea:"#3b82f6",learning:"#8b5cf6",decision:"#6366f1",refactor:"#ec4899",security:"#dc2626",performance:"#14b8a6","planned-feature":"#f59e0b"};function KF({currentProject:t}){let[e,n]=(0,Mt.useState)(null),[i,r]=(0,Mt.useState)(!0);if((0,Mt.useEffect)(()=>{if(!t){r(!1);return}r(!0),fetch(`/api/current-state?project=${encodeURIComponent(t)}`).then(d=>d.json()).then(d=>n(d)).catch(()=>{}).finally(()=>r(!1))},[t]),!t)return Mt.default.createElement("div",{style:{padding:"2rem"}},Mt.default.createElement("h2",{style:{margin:"0 0 1rem",fontSize:"1.2rem",fontWeight:600}},"Current State"),Mt.default.createElement("div",{style:{opacity:.5,fontSize:"0.85rem",marginBottom:"1rem"}},"Select a project from the Overview to view its current state."));if(i)return Mt.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading current state...");if(!e||e.error)return Mt.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"No data available.");let s=e.openTasks||{todo:0,in_progress:0,done:0},o=s.todo+s.in_progress+s.done,a=e.recentObservations||[],l=e.recentDecisions||[],c=e.tagCounts||{},u=e.filesChanged||[];return Mt.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"960px"}},Mt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"1.2rem"}},Mt.default.createElement("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:600}},"Current State")),Mt.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"}},Mt.default.createElement("div",{style:{padding:"16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)"}},Mt.default.createElement("div",{style:{fontSize:"0.75rem",textTransform:"uppercase",opacity:.5,marginBottom:"10px",letterSpacing:"0.05em"}},"Last Session"),e.lastSession?Mt.default.createElement("div",null,Mt.default.createElement("div",{style:{fontSize:"1.4rem",fontWeight:700,marginBottom:"6px"}},D$(e.lastSession.duration)),Mt.default.createElement("div",{style:{fontSize:"0.8rem",opacity:.6,marginBottom:"4px"}},k3(e.lastSession.startTime)),Mt.default.createElement("div",{style:{fontSize:"0.8rem",opacity:.6}},e.lastSession.messageCount," observation",e.lastSession.messageCount!==1?"s":""),Mt.default.createElement("div",{style:{display:"inline-block",marginTop:"8px",padding:"2px 8px",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,background:e.lastSession.status==="completed"?"rgba(16,185,129,0.15)":"rgba(245,158,11,0.15)",color:e.lastSession.status==="completed"?"#10b981":"#f59e0b"}},e.lastSession.status)):Mt.default.createElement("div",{style:{opacity:.4,fontSize:"0.85rem"}},"No sessions yet")),Mt.default.createElement("div",{style:{padding:"16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)"}},Mt.default.createElement("div",{style:{fontSize:"0.75rem",textTransform:"uppercase",opacity:.5,marginBottom:"10px",letterSpacing:"0.05em"}},"Active Work"),o>0?Mt.default.createElement("div",null,Mt.default.createElement("div",{style:{display:"flex",gap:"16px",marginBottom:"10px"}},Mt.default.createElement("div",null,Mt.default.createElement("div",{style:{fontSize:"1.4rem",fontWeight:700,color:"#f59e0b"}},s.todo),Mt.default.createElement("div",{style:{fontSize:"0.7rem",opacity:.5}},"Todo")),Mt.default.createElement("div",null,Mt.default.createElement("div",{style:{fontSize:"1.4rem",fontWeight:700,color:"#3b82f6"}},s.in_progress),Mt.default.createElement("div",{style:{fontSize:"0.7rem",opacity:.5}},"In Progress")),Mt.default.createElement("div",null,Mt.default.createElement("div",{style:{fontSize:"1.4rem",fontWeight:700,color:"#10b981"}},s.done),Mt.default.createElement("div",{style:{fontSize:"0.7rem",opacity:.5}},"Done"))),Mt.default.createElement("div",{style:{height:"4px",borderRadius:"2px",background:"rgba(255,255,255,0.1)",overflow:"hidden"}},Mt.default.createElement("div",{style:{height:"100%",width:`${o>0?s.done/o*100:0}%`,background:"#10b981",borderRadius:"2px",transition:"width 0.3s"}}))):Mt.default.createElement("div",{style:{opacity:.4,fontSize:"0.85rem"}},"No tasks yet"))),Mt.default.createElement("div",{style:{padding:"16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",marginBottom:"12px"}},Mt.default.createElement("div",{style:{fontSize:"0.75rem",textTransform:"uppercase",opacity:.5,marginBottom:"10px",letterSpacing:"0.05em"}},"Recent Activity"),a.length>0?Mt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},a.map(d=>Mt.default.createElement("div",{key:d.id,style:{display:"flex",alignItems:"center",gap:"10px",fontSize:"0.82rem"}},Mt.default.createElement("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#6366f1",flexShrink:0}}),Mt.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem",minWidth:"28px"}},"#",d.id),Mt.default.createElement("span",{style:{padding:"1px 6px",borderRadius:"3px",fontSize:"0.65rem",background:"rgba(99,102,241,0.15)",color:"#a5b4fc",minWidth:"50px",textAlign:"center"}},d.type),Mt.default.createElement("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},d.title||d.subtitle||"(untitled)"),Mt.default.createElement("span",{style:{opacity:.4,fontSize:"0.7rem",flexShrink:0}},k3(d.created_at_epoch))))):Mt.default.createElement("div",{style:{opacity:.4,fontSize:"0.85rem"}},"No recent activity")),Mt.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"}},Mt.default.createElement("div",{style:{padding:"16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)"}},Mt.default.createElement("div",{style:{fontSize:"0.75rem",textTransform:"uppercase",opacity:.5,marginBottom:"10px",letterSpacing:"0.05em"}},"Recent Decisions"),l.length>0?Mt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},l.map(d=>Mt.default.createElement("div",{key:d.id,style:{fontSize:"0.82rem"}},Mt.default.createElement("div",{style:{marginBottom:"2px"}},d.title),Mt.default.createElement("div",{style:{fontSize:"0.7rem",opacity:.4}},k3(d.created_at_epoch))))):Mt.default.createElement("div",{style:{opacity:.4,fontSize:"0.85rem"}},"No decisions recorded")),Mt.default.createElement("div",{style:{padding:"16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)"}},Mt.default.createElement("div",{style:{fontSize:"0.75rem",textTransform:"uppercase",opacity:.5,marginBottom:"10px",letterSpacing:"0.05em"}},"Tag Distribution"),Object.keys(c).length>0?Mt.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"}},Object.entries(c).sort((d,p)=>p[1]-d[1]).map(([d,p])=>Mt.default.createElement("span",{key:d,style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"3px 8px",borderRadius:"4px",fontSize:"0.72rem",background:`${YF[d]||"#6366f1"}20`,color:YF[d]||"#6366f1"}},d,Mt.default.createElement("span",{style:{fontWeight:600}},p)))):Mt.default.createElement("div",{style:{opacity:.4,fontSize:"0.85rem"}},"No tags yet"))),u.length>0&&Mt.default.createElement("div",{style:{padding:"16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",marginTop:"12px"}},Mt.default.createElement("div",{style:{fontSize:"0.75rem",textTransform:"uppercase",opacity:.5,marginBottom:"10px",letterSpacing:"0.05em"}},"Recently Changed Files"),Mt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"4px"}},u.map((d,p)=>Mt.default.createElement("div",{key:p,style:{fontSize:"0.78rem",fontFamily:"monospace",opacity:.7}},d)))))}var qt=mt(Ct(),1);var To=mt(Ct(),1),I$={"managed-policy":"#6b7280","project-root":"#3b82f6","project-rules":"#8b5cf6","user-global":"#10b981","project-local":"#3b82f6","auto-memory":"#f59e0b",subdirectory:"#6366f1"},R$={"managed-policy":"Managed","project-root":"Project","project-rules":"Rules","user-global":"Global","project-local":"Local","auto-memory":"Memory",subdirectory:"Subdir"},N$={"every-message":"every msg","once-per-session":"per session","on-demand":"on demand"};function O$(t){let e=t.split("/");return e[e.length-1]||t}function B$(t){let e=new Map;for(let n of t){let i=e.get(n.level)||[];i.push(n),e.set(n.level,i)}return e}function $F({files:t,selectedPath:e,onSelect:n}){let i=B$(t);return To.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"2px",fontSize:"0.8rem"}},["managed-policy","project-root","project-rules","user-global","project-local","auto-memory","subdirectory"].map(s=>{let o=i.get(s);if(!o||o.length===0)return null;let a=I$[s]||"#6b7280",l=R$[s]||s;return To.default.createElement("div",{key:s,style:{marginBottom:"4px"}},To.default.createElement("div",{style:{fontSize:"0.65rem",textTransform:"uppercase",letterSpacing:"0.05em",opacity:.5,padding:"4px 8px 2px",fontWeight:600}},l),o.map(c=>{let u=e===c.path;return To.default.createElement("div",{key:c.path,onClick:()=>c.exists&&n(c.path),style:{padding:"6px 8px",borderRadius:"4px",cursor:c.exists?"pointer":"default",opacity:c.exists?1:.35,background:u?a+"22":"transparent",borderLeft:u?`3px solid ${a}`:"3px solid transparent",display:"flex",flexDirection:"column",gap:"2px"}},To.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"6px"}},To.default.createElement("span",{style:{fontWeight:500,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},O$(c.path)),To.default.createElement("span",{style:{fontSize:"0.6rem",padding:"1px 5px",borderRadius:"3px",background:a+"22",color:a,fontWeight:500,flexShrink:0}},l)),c.exists&&To.default.createElement("div",{style:{display:"flex",gap:"8px",fontSize:"0.65rem",opacity:.5}},To.default.createElement("span",null,c.lineCount," lines"),To.default.createElement("span",null,"~",c.estimatedTokens," tok"),To.default.createElement("span",null,N$[c.loadFrequency]||c.loadFrequency)),!c.exists&&To.default.createElement("div",{style:{fontSize:"0.65rem",opacity:.4,fontStyle:"italic"}},"not created"))}))}))}var Xn=mt(Ct(),1);function U$(t){let e=t.split("/");return e[e.length-1]||t}function JF({file:t,onSave:e}){let[n,i]=(0,Xn.useState)(""),[r,s]=(0,Xn.useState)(""),[o,a]=(0,Xn.useState)(!1),l=(0,Xn.useRef)(null),c=(0,Xn.useRef)(null);(0,Xn.useEffect)(()=>{t?(i(t.content),s(t.content)):(i(""),s(""))},[t?.path,t?.content]);let u=n!==r,d=n.split(`
`).length,p=Math.round(n.length/4),m=(0,Xn.useCallback)(async()=>{if(!(!t||!u)){a(!0);try{e(t.path,n),s(n)}finally{a(!1)}}},[t,n,u,e]),g=(0,Xn.useCallback)(()=>{i(r)},[r]),_=(0,Xn.useCallback)(()=>{l.current&&c.current&&(c.current.scrollTop=l.current.scrollTop)},[]),y=(0,Xn.useCallback)(S=>{(S.metaKey||S.ctrlKey)&&S.key==="s"&&(S.preventDefault(),m())},[m]);if(!t)return Xn.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",opacity:.4,fontSize:"0.85rem"}},"Select a file from the tree to edit");let v=n.split(`
`);return Xn.default.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"}},Xn.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",borderBottom:"1px solid var(--border-color, #333)",fontSize:"0.8rem",flexShrink:0}},Xn.default.createElement("span",{style:{fontWeight:600,flex:1}},U$(t.path),u&&Xn.default.createElement("span",{style:{color:"#f59e0b",marginLeft:"6px",fontSize:"0.7rem"}},"(unsaved)")),Xn.default.createElement("span",{style:{opacity:.5,fontSize:"0.7rem"}},d," lines | ~",p," tokens | ",t.loadFrequency),Xn.default.createElement("button",{onClick:g,disabled:!u,style:{background:"none",border:"1px solid var(--border-color, #444)",color:"inherit",padding:"3px 10px",borderRadius:"4px",cursor:u?"pointer":"default",fontSize:"0.7rem",opacity:u?.8:.3}},"Revert"),Xn.default.createElement("button",{onClick:m,disabled:!u||o,style:{background:u?"#3b82f6":"transparent",border:u?"1px solid #3b82f6":"1px solid var(--border-color, #444)",color:u?"#fff":"inherit",padding:"3px 12px",borderRadius:"4px",cursor:u?"pointer":"default",fontSize:"0.7rem",fontWeight:500,opacity:u?1:.3}},o?"Saving...":"Save")),Xn.default.createElement("div",{style:{flex:1,display:"flex",overflow:"hidden",position:"relative"}},Xn.default.createElement("div",{ref:c,style:{width:"48px",flexShrink:0,overflow:"hidden",padding:"10px 0",borderRight:"1px solid var(--border-color, #333)",userSelect:"none",fontSize:"0.75rem",fontFamily:"monospace",lineHeight:"1.5",color:"inherit",opacity:.3}},v.map((S,b)=>Xn.default.createElement("div",{key:b,style:{textAlign:"right",paddingRight:"8px",height:"1.5em"}},b+1))),Xn.default.createElement("textarea",{ref:l,value:n,onChange:S=>i(S.target.value),onScroll:_,onKeyDown:y,spellCheck:!1,style:{flex:1,resize:"none",border:"none",outline:"none",background:"transparent",color:"inherit",fontFamily:"monospace",fontSize:"0.8rem",lineHeight:"1.5",padding:"10px 12px",overflow:"auto",whiteSpace:"pre",tabSize:2}})))}var sa=mt(Ct(),1),ZF={warning:{color:"#ef4444",icon:"!"},info:{color:"#3b82f6",icon:"i"},optimization:{color:"#f59e0b",icon:"*"}},QF={high:"#ef4444",medium:"#f59e0b",low:"#6b7280"};function e5({suggestions:t,onDismiss:e}){return t.length===0?sa.default.createElement("div",{style:{padding:"12px 16px",opacity:.5,fontSize:"0.8rem"}},"No suggestions - your CLAUDE.md files look good."):sa.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px",padding:"8px"}},t.map(n=>{let i=ZF[n.type]||ZF.info;return sa.default.createElement("div",{key:n.id,style:{padding:"10px 14px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",display:"flex",alignItems:"flex-start",gap:"10px"}},sa.default.createElement("span",{style:{width:"20px",height:"20px",borderRadius:"50%",background:i.color,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.7rem",fontWeight:700,flexShrink:0,marginTop:"2px"}},i.icon),sa.default.createElement("div",{style:{flex:1,minWidth:0}},sa.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"}},sa.default.createElement("span",{style:{fontSize:"0.85rem",fontWeight:600}},n.title),sa.default.createElement("span",{style:{fontSize:"0.65rem",padding:"1px 6px",borderRadius:"3px",background:QF[n.priority]+"22",color:QF[n.priority],fontWeight:500}},n.priority),n.tokenImpact!==void 0&&sa.default.createElement("span",{style:{fontSize:"0.7rem",opacity:.5}},"~",n.tokenImpact," tokens")),sa.default.createElement("div",{style:{fontSize:"0.78rem",opacity:.7,lineHeight:1.4}},n.description)),sa.default.createElement("button",{onClick:()=>e(n.id),style:{background:"none",border:"1px solid var(--border-color, #444)",color:"inherit",padding:"3px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"0.7rem",opacity:.6,flexShrink:0}},"Dismiss"))}))}function t5({currentProject:t,projects:e,onProjectChange:n}){let[i,r]=(0,qt.useState)([]),[s,o]=(0,qt.useState)([]),[a,l]=(0,qt.useState)(null),[c,u]=(0,qt.useState)(!0),[d,p]=(0,qt.useState)(new Set),[m,g]=(0,qt.useState)(!1),[_,y]=(0,qt.useState)(""),v=(0,qt.useCallback)(async T=>{if(t){u(!0),g(!1);try{let A=new URLSearchParams({project:t});T&&A.set("cwd",T);let I=await fetch(`/api/claude-md/files?${A}`);if(!I.ok)g(!0),r([]);else{let F=await I.json();r(F.files||[]),F.files?.length===0&&g(!0)}}catch{g(!0),r([])}finally{u(!1)}}},[t]),S=(0,qt.useCallback)(async()=>{if(t)try{let T=new URLSearchParams({project:t}),I=await(await fetch(`/api/claude-md/suggestions?${T}`)).json();o(I.suggestions||[])}catch{}},[t]);(0,qt.useEffect)(()=>{v(),S()},[v,S]);let b=(0,qt.useCallback)(T=>{l(T)},[]),w=(0,qt.useCallback)(async(T,A)=>{try{let I=new URLSearchParams({path:T});(await(await fetch(`/api/claude-md/file?${I}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:A})})).json()).success&&(v(),S())}catch{}},[v,S]),C=(0,qt.useCallback)(T=>{p(A=>new Set(A).add(T))},[]),M=i.find(T=>T.path===a)||null,L=s.filter(T=>!d.has(T.id)),P=i.filter(T=>T.exists&&T.loadFrequency==="every-message").reduce((T,A)=>T+A.estimatedTokens,0);return t?c?qt.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading CLAUDE.md files..."):m&&i.length===0?qt.default.createElement("div",{style:{padding:"2rem"}},qt.default.createElement("div",{style:{fontWeight:600,fontSize:"1rem",marginBottom:"1rem"}},"CLAUDE.md Manager"),qt.default.createElement(ja,{value:t,onChange:n,projects:e}),qt.default.createElement("div",{style:{marginTop:"1rem",padding:"16px",borderRadius:"8px",border:"1px solid #f59e0b40",background:"#f59e0b08"}},qt.default.createElement("div",{style:{fontSize:"0.85rem",marginBottom:"8px"}},"Could not detect project directory for ",qt.default.createElement("strong",null,t),"."),qt.default.createElement("div",{style:{fontSize:"0.8rem",opacity:.7,marginBottom:"12px"}},"Enter the full path to the project directory:"),qt.default.createElement("div",{style:{display:"flex",gap:"8px"}},qt.default.createElement("input",{type:"text",value:_,onChange:T=>y(T.target.value),placeholder:"/Users/.../project-name",onKeyDown:T=>{T.key==="Enter"&&_.trim()&&v(_.trim())},style:{flex:1,padding:"6px 10px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--bg-secondary, #1a1a2e)",color:"inherit",fontFamily:"monospace"}}),qt.default.createElement("button",{onClick:()=>{_.trim()&&v(_.trim())},style:{padding:"6px 14px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--accent-color, #6366f1)",color:"#fff",cursor:"pointer"}},"Load")))):qt.default.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},qt.default.createElement("div",{style:{padding:"8px 16px",borderBottom:"1px solid var(--border-color, #333)",display:"flex",alignItems:"center",gap:"16px",fontSize:"0.75rem",flexShrink:0}},qt.default.createElement("span",{style:{fontWeight:600}},"CLAUDE.md Manager"),qt.default.createElement(ja,{value:t,onChange:n,projects:e}),qt.default.createElement("span",{style:{opacity:.5}},i.filter(T=>T.exists).length," files | ~",P," tokens per message")),qt.default.createElement("div",{style:{flex:1,display:"flex",overflow:"hidden",minHeight:0}},qt.default.createElement("div",{style:{width:"240px",flexShrink:0,borderRight:"1px solid var(--border-color, #333)",overflowY:"auto",padding:"8px 0"}},qt.default.createElement($F,{files:i,selectedPath:a,onSelect:b})),qt.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"}},qt.default.createElement("div",{style:{flex:1,overflow:"hidden"}},qt.default.createElement(JF,{file:M,onSave:w})),L.length>0&&qt.default.createElement("div",{style:{borderTop:"1px solid var(--border-color, #333)",maxHeight:"200px",overflowY:"auto",flexShrink:0}},qt.default.createElement("div",{style:{padding:"6px 12px",fontSize:"0.7rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"}},"Suggestions (",L.length,")"),qt.default.createElement(e5,{suggestions:L,onDismiss:C}))))):qt.default.createElement("div",{style:{padding:"2rem"}},qt.default.createElement("div",{style:{fontWeight:600,fontSize:"1rem",marginBottom:"1rem"}},"CLAUDE.md Manager"),qt.default.createElement("div",{style:{opacity:.5,fontSize:"0.85rem",marginBottom:"1rem"}},"Select a project to manage its CLAUDE.md files."),e.length>0&&qt.default.createElement(ja,{value:t,onChange:n,projects:e}))}var Ce=mt(Ct(),1);var F$=["TASK_COMPLETE","ALL_TESTS_PASS","BUG_FIXED","FEATURE_IMPLEMENTED","REFACTORING_DONE","DEPLOYMENT_READY"],z$=[{value:"adaptive",label:"Adaptive",desc:"Auto-selects mode per iteration"},{value:"same-session",label:"Same Session",desc:"Continues in existing session"},{value:"fresh",label:"Fresh",desc:"New session per iteration"}],Kp={pending:"#64748b",running:"#3b82f6",completed:"#10b981",failed:"#ef4444"};function n5(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function H$(t,e){let i=(e||Date.now())-t,r=Math.floor(i/6e4),s=Math.floor(i%6e4/1e3);return r>0?`${r}m ${s}s`:`${s}s`}function i5({currentProject:t,projects:e,onProjectChange:n}){let[i,r]=(0,Ce.useState)(null),[s,o]=(0,Ce.useState)(!0),[a,l]=(0,Ce.useState)("config"),[c,u]=(0,Ce.useState)(e),[d,p]=(0,Ce.useState)(""),[m,g]=(0,Ce.useState)(""),[_,y]=(0,Ce.useState)("adaptive"),[v,S]=(0,Ce.useState)(10),[b,w]=(0,Ce.useState)(500),[C,M]=(0,Ce.useState)(.8),[L,P]=(0,Ce.useState)([]),[T,A]=(0,Ce.useState)("any"),[I,F]=(0,Ce.useState)(""),B=(0,Ce.useRef)(null),O=(0,Ce.useCallback)(()=>{if(!t){o(!1);return}let D=`/api/loop/status?project=${encodeURIComponent(t)}`;fetch(D).then(X=>X.json()).then(X=>{if(r(X),X.config){p(X.config.task_description||""),g(X.config.success_criteria||""),y(X.config.mode),S(X.config.max_iterations),w(X.config.iteration_context_tokens),M(X.config.auto_compact_threshold),A(X.config.promise_logic);try{let q=X.config.completion_promises?JSON.parse(X.config.completion_promises):[];P(q)}catch{P([])}}}).catch(()=>{}).finally(()=>o(!1))},[t]);(0,Ce.useEffect)(()=>{fetch("/api/projects/stats?source=claude-code").then(D=>D.json()).then(D=>{D.projects&&u(D.projects.map(X=>X.name))}).catch(()=>u(e))},[e]),(0,Ce.useEffect)(()=>{o(!0),O()},[O]),(0,Ce.useEffect)(()=>(i?.active?(B.current=setInterval(O,5e3),l("current")):B.current&&(clearInterval(B.current),B.current=null),()=>{B.current&&clearInterval(B.current)}),[i?.active,O]);let z=async()=>{d.trim()&&(await fetch("/api/loop/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:t,task_description:d,success_criteria:m||void 0,mode:_,max_iterations:v,completion_promises:L.length>0?L:void 0,promise_logic:T,iteration_context_tokens:b,auto_compact_threshold:C})}),O(),l("current"))},U=async()=>{await fetch(`/api/loop/stop?project=${encodeURIComponent(t)}`,{method:"POST"}),O()},G=async()=>{await fetch(`/api/loop/cancel?project=${encodeURIComponent(t)}`,{method:"POST"}),O()},j=D=>{D&&!L.includes(D)&&P([...L,D]),F("")},J=D=>{P(L.filter(X=>X!==D))};if(!t)return Ce.default.createElement("div",{style:{padding:"2rem"}},Ce.default.createElement("h2",{style:{margin:"0 0 1rem",fontSize:"1.2rem",fontWeight:600}},"UltraBrain Loop"),Ce.default.createElement("div",{style:{opacity:.5,fontSize:"0.85rem",marginBottom:"1rem"}},"Select a project to configure loops."),c.length>0&&Ce.default.createElement(ja,{value:t,onChange:n,projects:c}));if(s)return Ce.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading loop status...");let K=i?.active??!1;return Ce.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"900px"}},K&&Ce.default.createElement("div",{style:{padding:"12px 16px",borderRadius:"8px",background:"linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(59, 130, 246, 0.15))",border:"1px solid rgba(99, 102, 241, 0.3)",marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between"}},Ce.default.createElement("div",null,Ce.default.createElement("div",{style:{fontSize:"0.85rem",fontWeight:600,color:"#818cf8"}},"Loop Active"),Ce.default.createElement("div",{style:{fontSize:"0.75rem",opacity:.7,marginTop:"2px"}},i?.config?.task_description||"Running..."," \u2014 Iteration ",i?.completedCount??0,"/",i?.totalIterations??0)),Ce.default.createElement("div",{style:{display:"flex",gap:"6px"}},Ce.default.createElement("button",{onClick:U,style:{padding:"4px 12px",fontSize:"0.75rem",borderRadius:"6px",border:"1px solid #f59e0b",background:"transparent",color:"#f59e0b",cursor:"pointer"}},"Stop"),Ce.default.createElement("button",{onClick:G,style:{padding:"4px 12px",fontSize:"0.75rem",borderRadius:"6px",border:"1px solid #ef4444",background:"transparent",color:"#ef4444",cursor:"pointer"}},"Cancel"))),Ce.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"1rem"}},Ce.default.createElement("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:600}},"UltraBrain Loop"),Ce.default.createElement(ja,{value:t,onChange:n,projects:c})),Ce.default.createElement("div",{style:{display:"flex",gap:"4px",marginBottom:"1.5rem"}},["config","current","history"].map(D=>Ce.default.createElement("button",{key:D,onClick:()=>l(D),style:{padding:"6px 14px",fontSize:"0.75rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:a===D?"var(--accent-color, #6366f1)":"transparent",color:a===D?"#fff":"var(--text-muted, #888)",cursor:"pointer",textTransform:"capitalize"}},D==="config"?"Configuration":D==="current"?"Current Run":"History"))),a==="config"&&Ce.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"}},Ce.default.createElement("div",null,Ce.default.createElement("label",{style:Sd},"Task Description *"),Ce.default.createElement("textarea",{value:d,onChange:D=>p(D.target.value),placeholder:"Describe the task for the loop to accomplish...",disabled:K,style:{...aw,minHeight:"80px",resize:"vertical"}})),Ce.default.createElement("div",null,Ce.default.createElement("label",{style:Sd},"Success Criteria"),Ce.default.createElement("textarea",{value:m,onChange:D=>g(D.target.value),placeholder:"Define what success looks like...",disabled:K,style:{...aw,minHeight:"60px",resize:"vertical"}})),Ce.default.createElement("div",null,Ce.default.createElement("label",{style:Sd},"Mode"),Ce.default.createElement("div",{style:{display:"flex",gap:"8px"}},z$.map(D=>Ce.default.createElement("button",{key:D.value,onClick:()=>y(D.value),disabled:K,style:{padding:"8px 14px",fontSize:"0.75rem",borderRadius:"6px",border:`1px solid ${_===D.value?"#6366f1":"var(--border-color, #333)"}`,background:_===D.value?"rgba(99, 102, 241, 0.15)":"transparent",color:_===D.value?"#818cf8":"var(--text-muted, #888)",cursor:K?"not-allowed":"pointer",flex:1,textAlign:"center"}},Ce.default.createElement("div",{style:{fontWeight:600}},D.label),Ce.default.createElement("div",{style:{fontSize:"0.65rem",opacity:.6,marginTop:"2px"}},D.desc))))),Ce.default.createElement("div",null,Ce.default.createElement("label",{style:Sd},"Max Iterations: ",v),Ce.default.createElement("input",{type:"range",min:1,max:50,value:v,onChange:D=>S(parseInt(D.target.value,10)),disabled:K,style:{width:"100%"}}),Ce.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.65rem",opacity:.4}},Ce.default.createElement("span",null,"1"),Ce.default.createElement("span",null,"50"))),Ce.default.createElement("div",null,Ce.default.createElement("label",{style:Sd},"Iteration Context Tokens: ",b),Ce.default.createElement("input",{type:"range",min:100,max:2e3,step:100,value:b,onChange:D=>w(parseInt(D.target.value,10)),disabled:K,style:{width:"100%"}}),Ce.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.65rem",opacity:.4}},Ce.default.createElement("span",null,"100"),Ce.default.createElement("span",null,"2000"))),Ce.default.createElement("div",null,Ce.default.createElement("label",{style:Sd},"Auto-Compact Threshold: ",(C*100).toFixed(0),"%"),Ce.default.createElement("input",{type:"range",min:.5,max:1,step:.05,value:C,onChange:D=>M(parseFloat(D.target.value)),disabled:K,style:{width:"100%"}}),Ce.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.65rem",opacity:.4}},Ce.default.createElement("span",null,"50%"),Ce.default.createElement("span",null,"100%"))),Ce.default.createElement("div",null,Ce.default.createElement("label",{style:Sd},"Completion Promises"),Ce.default.createElement("div",{style:{display:"flex",gap:"6px",marginBottom:"8px",alignItems:"center"}},Ce.default.createElement("span",{style:{fontSize:"0.7rem",opacity:.5}},"Logic:"),Ce.default.createElement("button",{onClick:()=>A("any"),disabled:K,style:{padding:"2px 10px",fontSize:"0.7rem",borderRadius:"4px",border:`1px solid ${T==="any"?"#10b981":"var(--border-color, #333)"}`,background:T==="any"?"rgba(16, 185, 129, 0.15)":"transparent",color:T==="any"?"#10b981":"var(--text-muted, #888)",cursor:K?"not-allowed":"pointer"}},"ANY"),Ce.default.createElement("button",{onClick:()=>A("all"),disabled:K,style:{padding:"2px 10px",fontSize:"0.7rem",borderRadius:"4px",border:`1px solid ${T==="all"?"#3b82f6":"var(--border-color, #333)"}`,background:T==="all"?"rgba(59, 130, 246, 0.15)":"transparent",color:T==="all"?"#3b82f6":"var(--text-muted, #888)",cursor:K?"not-allowed":"pointer"}},"ALL")),Ce.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"8px"}},L.map(D=>Ce.default.createElement("span",{key:D,style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"3px 10px",fontSize:"0.7rem",borderRadius:"12px",background:"rgba(99, 102, 241, 0.15)",border:"1px solid rgba(99, 102, 241, 0.3)",color:"#818cf8"}},D,!K&&Ce.default.createElement("span",{onClick:()=>J(D),style:{cursor:"pointer",opacity:.6,fontSize:"0.8rem"}},"x")))),!K&&Ce.default.createElement("div",{style:{display:"flex",gap:"6px"}},Ce.default.createElement("select",{onChange:D=>{D.target.value&&j(D.target.value),D.target.value=""},style:{...aw,flex:1,padding:"6px 8px"}},Ce.default.createElement("option",{value:""},"Add preset..."),F$.filter(D=>!L.includes(D)).map(D=>Ce.default.createElement("option",{key:D,value:D},D))),Ce.default.createElement("input",{value:I,onChange:D=>F(D.target.value),onKeyDown:D=>{D.key==="Enter"&&I.trim()&&j(I.trim().toUpperCase())},placeholder:"Custom promise...",style:{...aw,flex:1,padding:"6px 8px"}}),Ce.default.createElement("button",{onClick:()=>{I.trim()&&j(I.trim().toUpperCase())},disabled:!I.trim(),style:{padding:"6px 12px",fontSize:"0.75rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"transparent",color:"var(--text-muted, #888)",cursor:I.trim()?"pointer":"not-allowed"}},"Add"))),!K&&Ce.default.createElement("button",{onClick:z,disabled:!d.trim(),style:{padding:"10px 20px",fontSize:"0.85rem",fontWeight:600,borderRadius:"8px",border:"none",background:d.trim()?"linear-gradient(135deg, #6366f1, #3b82f6)":"var(--border-color, #333)",color:d.trim()?"#fff":"var(--text-muted, #888)",cursor:d.trim()?"pointer":"not-allowed",marginTop:"0.5rem"}},"Start Loop")),a==="current"&&Ce.default.createElement("div",null,i?.config?Ce.default.createElement(Ce.default.Fragment,null,Ce.default.createElement("div",{style:{padding:"12px 16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",marginBottom:"1rem"}},Ce.default.createElement("div",{style:{fontSize:"0.85rem",fontWeight:600,marginBottom:"4px"}},i.config.task_description||"No task description"),i.config.success_criteria&&Ce.default.createElement("div",{style:{fontSize:"0.75rem",opacity:.6,marginTop:"4px"}},"Criteria: ",i.config.success_criteria),Ce.default.createElement("div",{style:{fontSize:"0.7rem",opacity:.4,marginTop:"6px"}},"Mode: ",i.config.mode," | Max: ",i.config.max_iterations," iterations")),i.iterations.length>0&&Ce.default.createElement("div",{style:{marginBottom:"1rem"}},Ce.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.7rem",opacity:.5,marginBottom:"4px"}},Ce.default.createElement("span",null,"Progress"),Ce.default.createElement("span",null,i.completedCount,"/",i.totalIterations)),Ce.default.createElement("div",{style:{height:"6px",borderRadius:"3px",background:"var(--border-color, #333)",overflow:"hidden"}},Ce.default.createElement("div",{style:{height:"100%",borderRadius:"3px",background:"linear-gradient(90deg, #6366f1, #3b82f6)",width:`${Math.min(100,i.completedCount/i.totalIterations*100)}%`,transition:"width 0.3s ease"}}))),Ce.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},i.iterations.length===0?Ce.default.createElement("div",{style:{padding:"1rem",textAlign:"center",opacity:.5,fontSize:"0.85rem"}},"No iterations yet."):i.iterations.map(D=>Ce.default.createElement("div",{key:D.id,style:{padding:"10px 14px",borderRadius:"8px",border:`1px solid ${D.status==="running"?"rgba(59, 130, 246, 0.4)":"var(--border-color, #333)"}`,background:D.status==="running"?"rgba(59, 130, 246, 0.05)":"transparent"}},Ce.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"}},Ce.default.createElement("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:Kp[D.status]||"#64748b",flexShrink:0,animation:D.status==="running"?"pulse 2s infinite":"none"}}),Ce.default.createElement("span",{style:{fontSize:"0.8rem",fontWeight:600}},"Iteration ",D.iteration_number),Ce.default.createElement("span",{style:{fontSize:"0.65rem",padding:"1px 8px",borderRadius:"4px",background:`${Kp[D.status]}20`,color:Kp[D.status],textTransform:"uppercase"}},D.status),Ce.default.createElement("span",{style:{marginLeft:"auto",fontSize:"0.65rem",opacity:.4}},D.mode_used||"-")),D.key_findings&&Ce.default.createElement("div",{style:{fontSize:"0.75rem",opacity:.7,marginTop:"4px"}},D.key_findings),Ce.default.createElement("div",{style:{display:"flex",gap:"12px",marginTop:"6px",fontSize:"0.65rem",opacity:.4}},D.observations_count>0&&Ce.default.createElement("span",null,D.observations_count," observations"),D.started_at_epoch&&Ce.default.createElement("span",null,H$(D.started_at_epoch,D.completed_at_epoch)),D.started_at_epoch&&Ce.default.createElement("span",null,n5(D.started_at_epoch))))))):Ce.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.85rem"}},"No loop configured yet. Go to Configuration to set one up.")),a==="history"&&Ce.default.createElement(W$,{currentProject:t}))}function W$({currentProject:t}){let[e,n]=(0,Ce.useState)([]),[i,r]=(0,Ce.useState)(null),[s,o]=(0,Ce.useState)(!0);if((0,Ce.useEffect)(()=>{t&&(o(!0),fetch(`/api/loop/history?project=${encodeURIComponent(t)}`).then(c=>c.json()).then(c=>{r(c.config||null),n(c.iterations||[])}).catch(()=>{}).finally(()=>o(!1)))},[t]),s)return Ce.default.createElement("div",{style:{padding:"1rem",opacity:.5,fontSize:"0.85rem"}},"Loading history...");if(!i||e.length===0)return Ce.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.85rem"}},"No loop history for this project.");let a=e.filter(c=>c.status==="completed").length,l=e.filter(c=>c.status==="failed").length;return Ce.default.createElement("div",null,Ce.default.createElement("div",{style:{padding:"12px 16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",marginBottom:"1rem",display:"flex",gap:"1.5rem"}},Ce.default.createElement("div",null,Ce.default.createElement("div",{style:{fontSize:"1.2rem",fontWeight:700}},e.length),Ce.default.createElement("div",{style:{fontSize:"0.65rem",opacity:.5}},"Total Iterations")),Ce.default.createElement("div",null,Ce.default.createElement("div",{style:{fontSize:"1.2rem",fontWeight:700,color:"#10b981"}},a),Ce.default.createElement("div",{style:{fontSize:"0.65rem",opacity:.5}},"Completed")),Ce.default.createElement("div",null,Ce.default.createElement("div",{style:{fontSize:"1.2rem",fontWeight:700,color:"#ef4444"}},l),Ce.default.createElement("div",{style:{fontSize:"0.65rem",opacity:.5}},"Failed")),Ce.default.createElement("div",null,Ce.default.createElement("div",{style:{fontSize:"1.2rem",fontWeight:700,color:"#818cf8"}},i.mode),Ce.default.createElement("div",{style:{fontSize:"0.65rem",opacity:.5}},"Mode"))),Ce.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},e.map(c=>Ce.default.createElement("div",{key:c.id,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem"}},Ce.default.createElement("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:Kp[c.status]||"#64748b",flexShrink:0}}),Ce.default.createElement("span",{style:{fontWeight:600,width:"50px"}},"#",c.iteration_number),Ce.default.createElement("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",opacity:.7}},c.key_findings||"No findings"),c.observations_count>0&&Ce.default.createElement("span",{style:{fontSize:"0.65rem",opacity:.4}},c.observations_count," obs"),Ce.default.createElement("span",{style:{fontSize:"0.6rem",padding:"1px 6px",borderRadius:"4px",background:`${Kp[c.status]}20`,color:Kp[c.status]}},c.status),c.started_at_epoch&&Ce.default.createElement("span",{style:{fontSize:"0.65rem",opacity:.4}},n5(c.started_at_epoch))))))}var Sd={display:"block",fontSize:"0.75rem",fontWeight:600,marginBottom:"4px",opacity:.7},aw={width:"100%",padding:"8px 12px",fontSize:"0.8rem",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--input-bg, #1a1a2e)",color:"inherit",fontFamily:"inherit",outline:"none",boxSizing:"border-box"};var an=mt(Ct(),1);function V$(t,e){return e===0?"0%":`${Math.round(t/e*100)}%`}var r5={lead:"#f59e0b",worker:"#6366f1",reviewer:"#10b981",researcher:"#ec4899"};function s5({currentProject:t,projects:e,onProjectChange:n}){let[i,r]=(0,an.useState)([]),[s,o]=(0,an.useState)(!0),[a,l]=(0,an.useState)(null),[c,u]=(0,an.useState)(null);return(0,an.useEffect)(()=>{o(!0),l(null),fetch("/api/teams").then(d=>{if(!d.ok)throw new Error("Teams API not available");return d.json()}).then(d=>r(d.teams||[])).catch(d=>l(d.message)).finally(()=>o(!1))},[]),s?an.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading teams..."):a?an.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"900px"}},an.default.createElement("h2",{style:{margin:"0 0 1rem",fontSize:"1.2rem",fontWeight:600}},"Agent Teams"),an.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.9rem",borderRadius:"8px",border:"1px solid var(--border-color, #333)"}},"Could not load teams data. The Teams API may not be configured yet.")):an.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"900px"}},an.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"1rem"}},an.default.createElement("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:600}},"Agent Teams",an.default.createElement("span",{style:{fontSize:"0.85rem",opacity:.5,marginLeft:"8px"}},"(",i.length,")")),an.default.createElement(ja,{value:t,onChange:n,projects:e})),i.length===0?an.default.createElement("div",{style:{padding:"2rem",textAlign:"center",borderRadius:"8px",border:"1px solid var(--border-color, #333)"}},an.default.createElement("div",{style:{fontSize:"0.9rem",opacity:.6,marginBottom:"8px"}},"No agent teams found"),an.default.createElement("div",{style:{fontSize:"0.75rem",opacity:.4}},"Teams appear when Claude Code Agent Teams are used. Team configs are stored in ~/.claude/teams/")):an.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}},i.map(d=>{let p=c===d.name,m=d.taskCount>0?d.completedTasks/d.taskCount*100:0;return an.default.createElement("div",{key:d.name,style:{padding:"14px 16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",cursor:"pointer"},onClick:()=>u(p?null:d.name)},an.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},an.default.createElement("span",{style:{width:"10px",height:"10px",borderRadius:"50%",background:d.taskCount>0&&d.completedTasks<d.taskCount?"#f59e0b":d.completedTasks===d.taskCount&&d.taskCount>0?"#10b981":"#64748b",flexShrink:0}}),an.default.createElement("span",{style:{flex:1,fontSize:"0.9rem",fontWeight:600}},d.name),an.default.createElement("span",{style:{fontSize:"0.75rem",opacity:.5}},d.members.length," member",d.members.length!==1?"s":""),an.default.createElement("span",{style:{fontSize:"0.75rem",opacity:.5}},d.completedTasks,"/",d.taskCount," tasks")),d.taskCount>0&&an.default.createElement("div",{style:{marginTop:"10px",display:"flex",alignItems:"center",gap:"8px"}},an.default.createElement("div",{style:{flex:1,height:"4px",borderRadius:"2px",background:"var(--border-color, #333)",overflow:"hidden"}},an.default.createElement("div",{style:{width:`${m}%`,height:"100%",borderRadius:"2px",background:m===100?"#10b981":"#6366f1",transition:"width 0.3s ease"}})),an.default.createElement("span",{style:{fontSize:"0.7rem",opacity:.5,minWidth:"28px",textAlign:"right"}},V$(d.completedTasks,d.taskCount))),p&&an.default.createElement("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid var(--border-color, #333)"}},an.default.createElement("div",{style:{fontSize:"0.75rem",opacity:.5,marginBottom:"8px"}},"Members"),an.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},d.members.map(g=>an.default.createElement("div",{key:g.agentId||g.name,style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 10px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",fontSize:"0.8rem"}},an.default.createElement("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:r5[g.agentType]||"#6366f1",flexShrink:0}}),an.default.createElement("span",{style:{flex:1,fontWeight:500}},g.name),an.default.createElement("span",{style:{fontSize:"0.65rem",padding:"1px 6px",borderRadius:"4px",background:r5[g.agentType]||"#6366f1",color:"#fff",opacity:.8}},g.agentType||"agent"),g.agentId&&an.default.createElement("span",{style:{fontSize:"0.65rem",opacity:.3,fontFamily:"monospace"}},g.agentId.slice(0,8))))),d.members.length===0&&an.default.createElement("div",{style:{fontSize:"0.8rem",opacity:.4,padding:"4px 0"}},"No members configured")))})))}var Zt=mt(Ct(),1);var Ks=mt(Ct(),1);function o5(){let t=(0,Ks.useRef)(null),[e,n]=(0,Ks.useState)("disconnected"),i=(0,Ks.useRef)(),r=(0,Ks.useRef)(0),s=(0,Ks.useRef)(new Map),o=(0,Ks.useCallback)(()=>{if(t.current?.readyState===WebSocket.OPEN)return;n("connecting");let u=window.location.protocol==="https:"?"wss:":"ws:",d=new WebSocket(`${u}//${window.location.host}/ws/terminal`);d.onopen=()=>{n("connected"),r.current=0},d.onmessage=p=>{try{let m=JSON.parse(p.data),g=s.current.get(m.type);g&&g.forEach(y=>y(m));let _=s.current.get("*");_&&_.forEach(y=>y(m))}catch(m){console.error("Failed to parse WS message:",m)}},d.onclose=()=>{n("disconnected");let p=Math.min(1e3*Math.pow(2,r.current),3e4);r.current++,i.current=setTimeout(o,p)},d.onerror=()=>{n("error")},t.current=d},[]),a=(0,Ks.useCallback)(()=>{i.current&&clearTimeout(i.current),t.current?.close(),t.current=null},[]),l=(0,Ks.useCallback)(u=>{t.current?.readyState===WebSocket.OPEN&&t.current.send(JSON.stringify(u))},[]),c=(0,Ks.useCallback)((u,d)=>(s.current.has(u)||s.current.set(u,new Set),s.current.get(u).add(d),()=>{s.current.get(u)?.delete(d)}),[]);return(0,Ks.useEffect)(()=>()=>{a()},[a]),{connect:o,disconnect:a,send:l,on:c,connectionState:e}}var si=mt(Ct(),1),G$=["bash","zsh","sh"],j$={display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",backgroundColor:"#161625",borderBottom:"1px solid #2d2d44",flexShrink:0},lw={display:"inline-flex",alignItems:"center",gap:"4px",padding:"4px 10px",fontSize:"12px",color:"#c0c0d0",backgroundColor:"transparent",border:"1px solid #3a3a5a",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.15s, border-color 0.15s",fontFamily:"inherit"},X$={padding:"4px 8px",fontSize:"12px",color:"#c0c0d0",backgroundColor:"#1a1a2e",border:"1px solid #3a3a5a",borderRadius:"4px",cursor:"pointer",outline:"none",fontFamily:"inherit"};function q$({state:t}){let e=t==="connected"?"#10b981":t==="connecting"?"#f59e0b":"#ef4444",n=t==="connected"?"Connected":t==="connecting"?"Connecting...":t==="error"?"Error":"Disconnected";return si.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"5px",marginLeft:"auto",fontSize:"11px",color:"#888"}},si.default.createElement("div",{style:{width:"7px",height:"7px",borderRadius:"50%",backgroundColor:e,boxShadow:`0 0 4px ${e}`}}),si.default.createElement("span",null,n))}function a5({connectionState:t,selectedShell:e,onShellChange:n,onNewTerminal:i,onSplitHorizontal:r,onSplitVertical:s,onClear:o}){let a=(l,c)=>{let u=l.currentTarget;u.style.backgroundColor=c?"#2a2a45":"transparent",u.style.borderColor=c?"#5a5a8a":"#3a3a5a"};return si.default.createElement("div",{style:j$},si.default.createElement("button",{style:lw,onClick:i,title:"New Terminal",onMouseEnter:l=>a(l,!0),onMouseLeave:l=>a(l,!1)},si.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},si.default.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),si.default.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"})),"New"),si.default.createElement("button",{style:lw,onClick:r,title:"Split Horizontal",onMouseEnter:l=>a(l,!0),onMouseLeave:l=>a(l,!1)},si.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},si.default.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),si.default.createElement("line",{x1:"12",y1:"3",x2:"12",y2:"21"})),"Split H"),si.default.createElement("button",{style:lw,onClick:s,title:"Split Vertical",onMouseEnter:l=>a(l,!0),onMouseLeave:l=>a(l,!1)},si.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},si.default.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),si.default.createElement("line",{x1:"3",y1:"12",x2:"21",y2:"12"})),"Split V"),si.default.createElement("button",{style:lw,onClick:o,title:"Clear Terminal",onMouseEnter:l=>a(l,!0),onMouseLeave:l=>a(l,!1)},si.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},si.default.createElement("path",{d:"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"}),si.default.createElement("line",{x1:"18",y1:"9",x2:"12",y2:"15"}),si.default.createElement("line",{x1:"12",y1:"9",x2:"18",y2:"15"})),"Clear"),si.default.createElement("select",{style:X$,value:e,onChange:l=>n(l.target.value),title:"Shell"},G$.map(l=>si.default.createElement("option",{key:l,value:l},l))),si.default.createElement(q$,{state:t}))}var ha=mt(Ct(),1);var hz=Object.defineProperty,Y$=Object.getOwnPropertyDescriptor,K$=(t,e)=>{for(var n in e)hz(t,n,{get:e[n],enumerable:!0})},Ni=(t,e,n,i)=>{for(var r=i>1?void 0:i?Y$(e,n):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(r=(i?o(e,n,r):o(r))||r);return i&&r&&hz(e,n,r),r},wt=(t,e)=>(n,i)=>e(n,i,t),l5="Terminal input",X3={get:()=>l5,set:t=>l5=t},c5="Too much output to announce, navigate to rows manually to read",q3={get:()=>c5,set:t=>c5=t};function $$(t){return t.replace(/\r?\n/g,"\r")}function J$(t,e){return e?"\x1B[200~"+t+"\x1B[201~":t}function Z$(t,e){t.clipboardData&&t.clipboardData.setData("text/plain",e.selectionText),t.preventDefault()}function Q$(t,e,n,i){if(t.stopPropagation(),t.clipboardData){let r=t.clipboardData.getData("text/plain");dz(r,e,n,i)}}function dz(t,e,n,i){t=$$(t),t=J$(t,n.decPrivateModes.bracketedPasteMode&&i.rawOptions.ignoreBracketedPasteMode!==!0),n.triggerDataEvent(t,!0),e.value=""}function fz(t,e,n){let i=n.getBoundingClientRect(),r=t.clientX-i.left-10,s=t.clientY-i.top-10;e.style.width="20px",e.style.height="20px",e.style.left=`${r}px`,e.style.top=`${s}px`,e.style.zIndex="1000",e.focus()}function u5(t,e,n,i,r){fz(t,e,n),r&&i.rightClickSelect(t),e.value=i.selectionText,e.select()}function Yu(t){return t>65535?(t-=65536,String.fromCharCode((t>>10)+55296)+String.fromCharCode(t%1024+56320)):String.fromCharCode(t)}function Iw(t,e=0,n=t.length){let i="";for(let r=e;r<n;++r){let s=t[r];s>65535?(s-=65536,i+=String.fromCharCode((s>>10)+55296)+String.fromCharCode(s%1024+56320)):i+=String.fromCharCode(s)}return i}var eJ=class{constructor(){this._interim=0}clear(){this._interim=0}decode(t,e){let n=t.length;if(!n)return 0;let i=0,r=0;if(this._interim){let s=t.charCodeAt(r++);56320<=s&&s<=57343?e[i++]=(this._interim-55296)*1024+s-56320+65536:(e[i++]=this._interim,e[i++]=s),this._interim=0}for(let s=r;s<n;++s){let o=t.charCodeAt(s);if(55296<=o&&o<=56319){if(++s>=n)return this._interim=o,i;let a=t.charCodeAt(s);56320<=a&&a<=57343?e[i++]=(o-55296)*1024+a-56320+65536:(e[i++]=o,e[i++]=a);continue}o!==65279&&(e[i++]=o)}return i}},tJ=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(t,e){let n=t.length;if(!n)return 0;let i=0,r,s,o,a,l=0,c=0;if(this.interim[0]){let p=!1,m=this.interim[0];m&=(m&224)===192?31:(m&240)===224?15:7;let g=0,_;for(;(_=this.interim[++g]&63)&&g<4;)m<<=6,m|=_;let y=(this.interim[0]&224)===192?2:(this.interim[0]&240)===224?3:4,v=y-g;for(;c<v;){if(c>=n)return 0;if(_=t[c++],(_&192)!==128){c--,p=!0;break}else this.interim[g++]=_,m<<=6,m|=_&63}p||(y===2?m<128?c--:e[i++]=m:y===3?m<2048||m>=55296&&m<=57343||m===65279||(e[i++]=m):m<65536||m>1114111||(e[i++]=m)),this.interim.fill(0)}let u=n-4,d=c;for(;d<n;){for(;d<u&&!((r=t[d])&128)&&!((s=t[d+1])&128)&&!((o=t[d+2])&128)&&!((a=t[d+3])&128);)e[i++]=r,e[i++]=s,e[i++]=o,e[i++]=a,d+=4;if(r=t[d++],r<128)e[i++]=r;else if((r&224)===192){if(d>=n)return this.interim[0]=r,i;if(s=t[d++],(s&192)!==128){d--;continue}if(l=(r&31)<<6|s&63,l<128){d--;continue}e[i++]=l}else if((r&240)===224){if(d>=n)return this.interim[0]=r,i;if(s=t[d++],(s&192)!==128){d--;continue}if(d>=n)return this.interim[0]=r,this.interim[1]=s,i;if(o=t[d++],(o&192)!==128){d--;continue}if(l=(r&15)<<12|(s&63)<<6|o&63,l<2048||l>=55296&&l<=57343||l===65279)continue;e[i++]=l}else if((r&248)===240){if(d>=n)return this.interim[0]=r,i;if(s=t[d++],(s&192)!==128){d--;continue}if(d>=n)return this.interim[0]=r,this.interim[1]=s,i;if(o=t[d++],(o&192)!==128){d--;continue}if(d>=n)return this.interim[0]=r,this.interim[1]=s,this.interim[2]=o,i;if(a=t[d++],(a&192)!==128){d--;continue}if(l=(r&7)<<18|(s&63)<<12|(o&63)<<6|a&63,l<65536||l>1114111)continue;e[i++]=l}}return i}},pz="",Ku=" ",F_=class mz{constructor(){this.fg=0,this.bg=0,this.extended=new Ew}static toColorRGB(e){return[e>>>16&255,e>>>8&255,e&255]}static fromColorRGB(e){return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255}clone(){let e=new mz;return e.fg=this.fg,e.bg=this.bg,e.extended=this.extended.clone(),e}isInverse(){return this.fg&67108864}isBold(){return this.fg&134217728}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:this.fg&268435456}isBlink(){return this.fg&536870912}isInvisible(){return this.fg&1073741824}isItalic(){return this.bg&67108864}isDim(){return this.bg&134217728}isStrikethrough(){return this.fg&2147483648}isProtected(){return this.bg&536870912}isOverline(){return this.bg&1073741824}getFgColorMode(){return this.fg&50331648}getBgColorMode(){return this.bg&50331648}isFgRGB(){return(this.fg&50331648)===50331648}isBgRGB(){return(this.bg&50331648)===50331648}isFgPalette(){return(this.fg&50331648)===16777216||(this.fg&50331648)===33554432}isBgPalette(){return(this.bg&50331648)===16777216||(this.bg&50331648)===33554432}isFgDefault(){return(this.fg&50331648)===0}isBgDefault(){return(this.bg&50331648)===0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(this.fg&50331648){case 16777216:case 33554432:return this.fg&255;case 50331648:return this.fg&16777215;default:return-1}}getBgColor(){switch(this.bg&50331648){case 16777216:case 33554432:return this.bg&255;case 50331648:return this.bg&16777215;default:return-1}}hasExtendedAttrs(){return this.bg&268435456}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(this.bg&268435456&&~this.extended.underlineColor)switch(this.extended.underlineColor&50331648){case 16777216:case 33554432:return this.extended.underlineColor&255;case 50331648:return this.extended.underlineColor&16777215;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return this.bg&268435456&&~this.extended.underlineColor?this.extended.underlineColor&50331648:this.getFgColorMode()}isUnderlineColorRGB(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===50331648:this.isFgRGB()}isUnderlineColorPalette(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===16777216||(this.extended.underlineColor&50331648)===33554432:this.isFgPalette()}isUnderlineColorDefault(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===0:this.isFgDefault()}getUnderlineStyle(){return this.fg&268435456?this.bg&268435456?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}},Ew=class gz{constructor(e=0,n=0){this._ext=0,this._urlId=0,this._ext=e,this._urlId=n}get ext(){return this._urlId?this._ext&-469762049|this.underlineStyle<<26:this._ext}set ext(e){this._ext=e}get underlineStyle(){return this._urlId?5:(this._ext&469762048)>>26}set underlineStyle(e){this._ext&=-469762049,this._ext|=e<<26&469762048}get underlineColor(){return this._ext&67108863}set underlineColor(e){this._ext&=-67108864,this._ext|=e&67108863}get urlId(){return this._urlId}set urlId(e){this._urlId=e}get underlineVariantOffset(){let e=(this._ext&3758096384)>>29;return e<0?e^4294967288:e}set underlineVariantOffset(e){this._ext&=536870911,this._ext|=e<<29&3758096384}clone(){return new gz(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}},ca=class vz extends F_{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new Ew,this.combinedData=""}static fromCharData(e){let n=new vz;return n.setFromCharData(e),n}isCombined(){return this.content&2097152}getWidth(){return this.content>>22}getChars(){return this.content&2097152?this.combinedData:this.content&2097151?Yu(this.content&2097151):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):this.content&2097151}setFromCharData(e){this.fg=e[0],this.bg=0;let n=!1;if(e[1].length>2)n=!0;else if(e[1].length===2){let i=e[1].charCodeAt(0);if(55296<=i&&i<=56319){let r=e[1].charCodeAt(1);56320<=r&&r<=57343?this.content=(i-55296)*1024+r-56320+65536|e[2]<<22:n=!0}else n=!0}else this.content=e[1].charCodeAt(0)|e[2]<<22;n&&(this.combinedData=e[1],this.content=2097152|e[2]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},h5="di$target",Y3="di$dependencies",L3=new Map;function nJ(t){return t[Y3]||[]}function Cr(t){if(L3.has(t))return L3.get(t);let e=function(n,i,r){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");iJ(e,n,r)};return e._id=t,L3.set(t,e),e}function iJ(t,e,n){e[h5]===e?e[Y3].push({id:t,index:n}):(e[Y3]=[{id:t,index:n}],e[h5]=e)}var ks=Cr("BufferService"),_z=Cr("CoreMouseService"),kd=Cr("CoreService"),rJ=Cr("CharsetService"),Lk=Cr("InstantiationService"),yz=Cr("LogService"),Ls=Cr("OptionsService"),xz=Cr("OscLinkService"),sJ=Cr("UnicodeService"),z_=Cr("DecorationService"),K3=class{constructor(t,e,n){this._bufferService=t,this._optionsService=e,this._oscLinkService=n}provideLinks(t,e){let n=this._bufferService.buffer.lines.get(t-1);if(!n){e(void 0);return}let i=[],r=this._optionsService.rawOptions.linkHandler,s=new ca,o=n.getTrimmedLength(),a=-1,l=-1,c=!1;for(let u=0;u<o;u++)if(!(l===-1&&!n.hasContent(u))){if(n.loadCell(u,s),s.hasExtendedAttrs()&&s.extended.urlId)if(l===-1){l=u,a=s.extended.urlId;continue}else c=s.extended.urlId!==a;else l!==-1&&(c=!0);if(c||l!==-1&&u===o-1){let d=this._oscLinkService.getLinkData(a)?.uri;if(d){let p={start:{x:l+1,y:t},end:{x:u+(!c&&u===o-1?1:0),y:t}},m=!1;if(!r?.allowNonHttpProtocols)try{let g=new URL(d);["http:","https:"].includes(g.protocol)||(m=!0)}catch{m=!0}m||i.push({text:d,range:p,activate:(g,_)=>r?r.activate(g,_,p):oJ(g,_),hover:(g,_)=>r?.hover?.(g,_,p),leave:(g,_)=>r?.leave?.(g,_,p)})}c=!1,s.hasExtendedAttrs()&&s.extended.urlId?(l=u,a=s.extended.urlId):(l=-1,a=-1)}}e(i)}};K3=Ni([wt(0,ks),wt(1,Ls),wt(2,xz)],K3);function oJ(t,e){if(confirm(`Do you want to navigate to ${e}?

WARNING: This link could potentially be dangerous`)){let n=window.open();if(n){try{n.opener=null}catch{}n.location.href=e}else console.warn("Opening link blocked as opener could not be cleared")}}var Rw=Cr("CharSizeService"),Ec=Cr("CoreBrowserService"),Pk=Cr("MouseService"),Cc=Cr("RenderService"),aJ=Cr("SelectionService"),Sz=Cr("CharacterJoinerService"),Qp=Cr("ThemeService"),bz=Cr("LinkProviderService"),lJ=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout(()=>{throw t.stack?d5.isErrorNoTelemetry(t)?new d5(t.message+`

`+t.stack):new Error(t.message+`

`+t.stack):t},0)}}addListener(t){return this.listeners.push(t),()=>{this._removeListener(t)}}emit(t){this.listeners.forEach(e=>{e(t)})}_removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}setUnexpectedErrorHandler(t){this.unexpectedErrorHandler=t}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(t){this.unexpectedErrorHandler(t),this.emit(t)}onUnexpectedExternalError(t){this.unexpectedErrorHandler(t)}},cJ=new lJ;function pw(t){uJ(t)||cJ.onUnexpectedError(t)}var $3="Canceled";function uJ(t){return t instanceof hJ?!0:t instanceof Error&&t.name===$3&&t.message===$3}var hJ=class extends Error{constructor(){super($3),this.name=this.message}};function dJ(t){return t?new Error(`Illegal argument: ${t}`):new Error("Illegal argument")}var d5=class J3 extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof J3)return e;let n=new J3;return n.message=e.message,n.stack=e.stack,n}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Z3=class wz extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,wz.prototype)}};function fJ(t,e,n=0,i=t.length){let r=n,s=i;for(;r<s;){let o=Math.floor((r+s)/2);e(t[o])?r=o+1:s=o}return r-1}var pJ=class Ez{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(Ez.assertInvariants){if(this._prevFindLastPredicate){for(let i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let n=fJ(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=n+1,n===-1?void 0:this._array[n]}};pJ.assertInvariants=!1;function Mo(t,e=0){return t[t.length-(1+e)]}var Cz;(t=>{function e(s){return s<0}t.isLessThan=e;function n(s){return s<=0}t.isLessThanOrEqual=n;function i(s){return s>0}t.isGreaterThan=i;function r(s){return s===0}t.isNeitherLessOrGreaterThan=r,t.greaterThan=1,t.lessThan=-1,t.neitherLessOrGreaterThan=0})(Cz||(Cz={}));function mJ(t,e){return(n,i)=>e(t(n),t(i))}var gJ=(t,e)=>t-e,f5=class Q3{constructor(e){this.iterate=e}forEach(e){this.iterate(n=>(e(n),!0))}toArray(){let e=[];return this.iterate(n=>(e.push(n),!0)),e}filter(e){return new Q3(n=>this.iterate(i=>e(i)?n(i):!0))}map(e){return new Q3(n=>this.iterate(i=>n(e(i))))}some(e){let n=!1;return this.iterate(i=>(n=e(i),!n)),n}findFirst(e){let n;return this.iterate(i=>e(i)?(n=i,!1):!0),n}findLast(e){let n;return this.iterate(i=>(e(i)&&(n=i),!0)),n}findLastMaxBy(e){let n,i=!0;return this.iterate(r=>((i||Cz.isGreaterThan(e(r,n)))&&(i=!1,n=r),!0)),n}};f5.empty=new f5(t=>{});function vJ(t,e){let n=Object.create(null);for(let i of t){let r=e(i),s=n[r];s||(s=n[r]=[]),s.push(i)}return n}var p5,m5,Hse=class{constructor(t,e){this.toKey=e,this._map=new Map,this[p5]="SetWithKey";for(let n of t)this.add(n)}get size(){return this._map.size}add(t){let e=this.toKey(t);return this._map.set(e,t),this}delete(t){return this._map.delete(this.toKey(t))}has(t){return this._map.has(this.toKey(t))}*entries(){for(let t of this._map.values())yield[t,t]}keys(){return this.values()}*values(){for(let t of this._map.values())yield t}clear(){this._map.clear()}forEach(t,e){this._map.forEach(n=>t.call(e,n,n,this))}[(m5=Symbol.iterator,p5=Symbol.toStringTag,m5)](){return this.values()}},_J=class{constructor(){this.map=new Map}add(t,e){let n=this.map.get(t);n||(n=new Set,this.map.set(t,n)),n.add(e)}delete(t,e){let n=this.map.get(t);n&&(n.delete(e),n.size===0&&this.map.delete(t))}forEach(t,e){let n=this.map.get(t);n&&n.forEach(e)}get(t){return this.map.get(t)||new Set}};function yJ(t,e){let n=this,i=!1,r;return function(){if(i)return r;if(i=!0,e)try{r=t.apply(n,arguments)}finally{e()}else r=t.apply(n,arguments);return r}}var Tz;(t=>{function e(w){return w&&typeof w=="object"&&typeof w[Symbol.iterator]=="function"}t.is=e;let n=Object.freeze([]);function i(){return n}t.empty=i;function*r(w){yield w}t.single=r;function s(w){return e(w)?w:r(w)}t.wrap=s;function o(w){return w||n}t.from=o;function*a(w){for(let C=w.length-1;C>=0;C--)yield w[C]}t.reverse=a;function l(w){return!w||w[Symbol.iterator]().next().done===!0}t.isEmpty=l;function c(w){return w[Symbol.iterator]().next().value}t.first=c;function u(w,C){let M=0;for(let L of w)if(C(L,M++))return!0;return!1}t.some=u;function d(w,C){for(let M of w)if(C(M))return M}t.find=d;function*p(w,C){for(let M of w)C(M)&&(yield M)}t.filter=p;function*m(w,C){let M=0;for(let L of w)yield C(L,M++)}t.map=m;function*g(w,C){let M=0;for(let L of w)yield*C(L,M++)}t.flatMap=g;function*_(...w){for(let C of w)yield*C}t.concat=_;function y(w,C,M){let L=M;for(let P of w)L=C(L,P);return L}t.reduce=y;function*v(w,C,M=w.length){for(C<0&&(C+=w.length),M<0?M+=w.length:M>w.length&&(M=w.length);C<M;C++)yield w[C]}t.slice=v;function S(w,C=Number.POSITIVE_INFINITY){let M=[];if(C===0)return[M,w];let L=w[Symbol.iterator]();for(let P=0;P<C;P++){let T=L.next();if(T.done)return[M,t.empty()];M.push(T.value)}return[M,{[Symbol.iterator](){return L}}]}t.consume=S;async function b(w){let C=[];for await(let M of w)C.push(M);return Promise.resolve(C)}t.asyncToArray=b})(Tz||(Tz={}));var xJ=!1,Td=null,SJ=class Mz{constructor(){this.livingDisposables=new Map}getDisposableData(e){let n=this.livingDisposables.get(e);return n||(n={parent:null,source:null,isSingleton:!1,value:e,idx:Mz.idx++},this.livingDisposables.set(e,n)),n}trackDisposable(e){let n=this.getDisposableData(e);n.source||(n.source=new Error().stack)}setParent(e,n){let i=this.getDisposableData(e);i.parent=n}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,n){let i=n.get(e);if(i)return i;let r=e.parent?this.getRootParent(this.getDisposableData(e.parent),n):e;return n.set(e,r),r}getTrackedDisposables(){let e=new Map;return[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n)}computeLeakingDisposables(e=10,n){let i;if(n)i=n;else{let l=new Map,c=[...this.livingDisposables.values()].filter(d=>d.source!==null&&!this.getRootParent(d,l).isSingleton);if(c.length===0)return;let u=new Set(c.map(d=>d.value));if(i=c.filter(d=>!(d.parent&&u.has(d.parent))),i.length===0)throw new Error("There are cyclic diposable chains!")}if(!i)return;function r(l){function c(d,p){for(;d.length>0&&p.some(m=>typeof m=="string"?m===d[0]:d[0].match(m));)d.shift()}let u=l.source.split(`
`).map(d=>d.trim().replace("at ","")).filter(d=>d!=="");return c(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}let s=new _J;for(let l of i){let c=r(l);for(let u=0;u<=c.length;u++)s.add(c.slice(0,u).join(`
`),l)}i.sort(mJ(l=>l.idx,gJ));let o="",a=0;for(let l of i.slice(0,e)){a++;let c=r(l),u=[];for(let d=0;d<c.length;d++){let p=c[d];p=`(shared with ${s.get(c.slice(0,d+1).join(`
`)).size}/${i.length} leaks) at ${p}`;let m=s.get(c.slice(0,d).join(`
`)),g=vJ([...m].map(_=>r(_)[d]),_=>_);delete g[c[d]];for(let[_,y]of Object.entries(g))u.unshift(`    - stacktraces of ${y.length} other leaks continue with ${_}`);u.unshift(p)}o+=`


==================== Leaking disposable ${a}/${i.length}: ${l.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return i.length>e&&(o+=`


... and ${i.length-e} more leaking disposables

`),{leaks:i,details:o}}};SJ.idx=0;function bJ(t){Td=t}if(xJ){let t="__is_disposable_tracked__";bJ(new class{trackDisposable(e){let n=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[t]||console.log(n)},3e3)}setParent(e,n){if(e&&e!==rn.None)try{e[t]=!0}catch{}}markAsDisposed(e){if(e&&e!==rn.None)try{e[t]=!0}catch{}}markAsSingleton(e){}})}function Nw(t){return Td?.trackDisposable(t),t}function Ow(t){Td?.markAsDisposed(t)}function N_(t,e){Td?.setParent(t,e)}function wJ(t,e){if(Td)for(let n of t)Td.setParent(n,e)}function g5(t){return Td?.markAsSingleton(t),t}function Md(t){if(Tz.is(t)){let e=[];for(let n of t)if(n)try{n.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}else if(t)return t.dispose(),t}function EJ(...t){let e=ai(()=>Md(t));return wJ(t,e),e}function ai(t){let e=Nw({dispose:yJ(()=>{Ow(e),t()})});return e}var Az=class kz{constructor(){this._toDispose=new Set,this._isDisposed=!1,Nw(this)}dispose(){this._isDisposed||(Ow(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Md(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return N_(e,this),this._isDisposed?kz.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),N_(e,null))}};Az.DISABLE_DISPOSED_WARNING=!1;var $u=Az,rn=class{constructor(){this._store=new $u,Nw(this),N_(this._store,this)}dispose(){Ow(this),this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}};rn.None=Object.freeze({dispose(){}});var Zp=class{constructor(){this._isDisposed=!1,Nw(this)}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),t&&N_(t,this),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Ow(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t&&N_(t,null),t}},Lo=typeof window=="object"?window:globalThis,ek=class tk{constructor(e){this.element=e,this.next=tk.Undefined,this.prev=tk.Undefined}};ek.Undefined=new ek(void 0);var Ei=ek,v5=class{constructor(){this._first=Ei.Undefined,this._last=Ei.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Ei.Undefined}clear(){let t=this._first;for(;t!==Ei.Undefined;){let e=t.next;t.prev=Ei.Undefined,t.next=Ei.Undefined,t=e}this._first=Ei.Undefined,this._last=Ei.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,e){let n=new Ei(t);if(this._first===Ei.Undefined)this._first=n,this._last=n;else if(e){let r=this._last;this._last=n,n.prev=r,r.next=n}else{let r=this._first;this._first=n,n.next=r,r.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==Ei.Undefined){let t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==Ei.Undefined){let t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==Ei.Undefined&&t.next!==Ei.Undefined){let e=t.prev;e.next=t.next,t.next.prev=e}else t.prev===Ei.Undefined&&t.next===Ei.Undefined?(this._first=Ei.Undefined,this._last=Ei.Undefined):t.next===Ei.Undefined?(this._last=this._last.prev,this._last.next=Ei.Undefined):t.prev===Ei.Undefined&&(this._first=this._first.next,this._first.prev=Ei.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==Ei.Undefined;)yield t.element,t=t.next}},CJ=globalThis.performance&&typeof globalThis.performance.now=="function",TJ=class Lz{static create(e){return new Lz(e)}constructor(e){this._now=CJ&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},MJ=!1,_5=!1,AJ=!1,Fr;(t=>{t.None=()=>rn.None;function e(B){if(AJ){let{onDidAddListener:O}=B,z=rk.create(),U=0;B.onDidAddListener=()=>{++U===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),z.print()),O?.()}}}function n(B,O){return p(B,()=>{},0,void 0,!0,void 0,O)}t.defer=n;function i(B){return(O,z=null,U)=>{let G=!1,j;return j=B(J=>{if(!G)return j?j.dispose():G=!0,O.call(z,J)},null,U),G&&j.dispose(),j}}t.once=i;function r(B,O,z){return u((U,G=null,j)=>B(J=>U.call(G,O(J)),null,j),z)}t.map=r;function s(B,O,z){return u((U,G=null,j)=>B(J=>{O(J),U.call(G,J)},null,j),z)}t.forEach=s;function o(B,O,z){return u((U,G=null,j)=>B(J=>O(J)&&U.call(G,J),null,j),z)}t.filter=o;function a(B){return B}t.signal=a;function l(...B){return(O,z=null,U)=>{let G=EJ(...B.map(j=>j(J=>O.call(z,J))));return d(G,U)}}t.any=l;function c(B,O,z,U){let G=z;return r(B,j=>(G=O(G,j),G),U)}t.reduce=c;function u(B,O){let z,U={onWillAddFirstListener(){z=B(G.fire,G)},onDidRemoveLastListener(){z?.dispose()}};O||e(U);let G=new st(U);return O?.add(G),G.event}function d(B,O){return O instanceof Array?O.push(B):O&&O.add(B),B}function p(B,O,z=100,U=!1,G=!1,j,J){let K,D,X,q=0,ne,re={leakWarningThreshold:j,onWillAddFirstListener(){K=B(ie=>{q++,D=O(D,ie),U&&!X&&($.fire(D),D=void 0),ne=()=>{let le=D;D=void 0,X=void 0,(!U||q>1)&&$.fire(le),q=0},typeof z=="number"?(clearTimeout(X),X=setTimeout(ne,z)):X===void 0&&(X=0,queueMicrotask(ne))})},onWillRemoveListener(){G&&q>0&&ne?.()},onDidRemoveLastListener(){ne=void 0,K.dispose()}};J||e(re);let $=new st(re);return J?.add($),$.event}t.debounce=p;function m(B,O=0,z){return t.debounce(B,(U,G)=>U?(U.push(G),U):[G],O,void 0,!0,void 0,z)}t.accumulate=m;function g(B,O=(U,G)=>U===G,z){let U=!0,G;return o(B,j=>{let J=U||!O(j,G);return U=!1,G=j,J},z)}t.latch=g;function _(B,O,z){return[t.filter(B,O,z),t.filter(B,U=>!O(U),z)]}t.split=_;function y(B,O=!1,z=[],U){let G=z.slice(),j=B(D=>{G?G.push(D):K.fire(D)});U&&U.add(j);let J=()=>{G?.forEach(D=>K.fire(D)),G=null},K=new st({onWillAddFirstListener(){j||(j=B(D=>K.fire(D)),U&&U.add(j))},onDidAddFirstListener(){G&&(O?setTimeout(J):J())},onDidRemoveLastListener(){j&&j.dispose(),j=null}});return U&&U.add(K),K.event}t.buffer=y;function v(B,O){return(z,U,G)=>{let j=O(new b);return B(function(J){let K=j.evaluate(J);K!==S&&z.call(U,K)},void 0,G)}}t.chain=v;let S=Symbol("HaltChainable");class b{constructor(){this.steps=[]}map(O){return this.steps.push(O),this}forEach(O){return this.steps.push(z=>(O(z),z)),this}filter(O){return this.steps.push(z=>O(z)?z:S),this}reduce(O,z){let U=z;return this.steps.push(G=>(U=O(U,G),U)),this}latch(O=(z,U)=>z===U){let z=!0,U;return this.steps.push(G=>{let j=z||!O(G,U);return z=!1,U=G,j?G:S}),this}evaluate(O){for(let z of this.steps)if(O=z(O),O===S)break;return O}}function w(B,O,z=U=>U){let U=(...K)=>J.fire(z(...K)),G=()=>B.on(O,U),j=()=>B.removeListener(O,U),J=new st({onWillAddFirstListener:G,onDidRemoveLastListener:j});return J.event}t.fromNodeEventEmitter=w;function C(B,O,z=U=>U){let U=(...K)=>J.fire(z(...K)),G=()=>B.addEventListener(O,U),j=()=>B.removeEventListener(O,U),J=new st({onWillAddFirstListener:G,onDidRemoveLastListener:j});return J.event}t.fromDOMEventEmitter=C;function M(B){return new Promise(O=>i(B)(O))}t.toPromise=M;function L(B){let O=new st;return B.then(z=>{O.fire(z)},()=>{O.fire(void 0)}).finally(()=>{O.dispose()}),O.event}t.fromPromise=L;function P(B,O){return B(z=>O.fire(z))}t.forward=P;function T(B,O,z){return O(z),B(U=>O(U))}t.runAndSubscribe=T;class A{constructor(O,z){this._observable=O,this._counter=0,this._hasChanged=!1;let U={onWillAddFirstListener:()=>{O.addObserver(this)},onDidRemoveLastListener:()=>{O.removeObserver(this)}};z||e(U),this.emitter=new st(U),z&&z.add(this.emitter)}beginUpdate(O){this._counter++}handlePossibleChange(O){}handleChange(O,z){this._hasChanged=!0}endUpdate(O){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function I(B,O){return new A(B,O).emitter.event}t.fromObservable=I;function F(B){return(O,z,U)=>{let G=0,j=!1,J={beginUpdate(){G++},endUpdate(){G--,G===0&&(B.reportChanges(),j&&(j=!1,O.call(z)))},handlePossibleChange(){},handleChange(){j=!0}};B.addObserver(J),B.reportChanges();let K={dispose(){B.removeObserver(J)}};return U instanceof $u?U.add(K):Array.isArray(U)&&U.push(K),K}}t.fromObservableLight=F})(Fr||(Fr={}));var nk=class ik{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${ik._idPool++}`,ik.all.add(this)}start(e){this._stopWatch=new TJ,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};nk.all=new Set,nk._idPool=0;var kJ=nk,y5=-1,Pz=class Dz{constructor(e,n,i=(Dz._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=n,this.name=i,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,n){let i=this.threshold;if(i<=0||n<i)return;this._stacks||(this._stacks=new Map);let r=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,r+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let[s,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${n} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(s);let l=new PJ(a,s);this._errorHandler(l)}return()=>{let s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,n=0;for(let[i,r]of this._stacks)(!e||n<r)&&(e=[i,r],n=r);return e}};Pz._idPool=1;var LJ=Pz,rk=class Iz{constructor(e){this.value=e}static create(){let e=new Error;return new Iz(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},PJ=class extends Error{constructor(t,e){super(t),this.name="ListenerLeakError",this.stack=e}},DJ=class extends Error{constructor(t,e){super(t),this.name="ListenerRefusalError",this.stack=e}},IJ=0,mw=class{constructor(t){this.value=t,this.id=IJ++}},RJ=2,NJ=(t,e)=>{if(t instanceof mw)e(t);else for(let n=0;n<t.length;n++){let i=t[n];i&&e(i)}},gw;if(MJ){let t=[];setInterval(()=>{t.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(t.join(`
`)),t.length=0)},3e3),gw=new FinalizationRegistry(e=>{typeof e=="string"&&t.push(e)})}var st=class{constructor(t){this._size=0,this._options=t,this._leakageMon=y5>0||this._options?.leakWarningThreshold?new LJ(t?.onListenerError??pw,this._options?.leakWarningThreshold??y5):void 0,this._perfMon=this._options?._profName?new kJ(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(_5){let t=this._listeners;queueMicrotask(()=>{NJ(t,e=>e.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??(this._event=(t,e,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let a=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(a);let l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new DJ(`${a}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);return(this._options?.onListenerError||pw)(c),rn.None}if(this._disposed)return rn.None;e&&(t=t.bind(e));let i=new mw(t),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=rk.create(),r=this._leakageMon.check(i.stack,this._size+1)),_5&&(i.stack=s??rk.create()),this._listeners?this._listeners instanceof mw?(this._deliveryQueue??(this._deliveryQueue=new OJ),this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let o=ai(()=>{gw?.unregister(o),r?.(),this._removeListener(i)});if(n instanceof $u?n.add(o):Array.isArray(n)&&n.push(o),gw){let a=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),l=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(a);gw.register(o,l?.[2]??a,o)}return o}),this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let e=this._listeners,n=e.indexOf(t);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,e[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*RJ<=e.length){let r=0;for(let s=0;s<e.length;s++)e[s]?e[r++]=e[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);e.length=r}}_deliver(t,e){if(!t)return;let n=this._options?.onListenerError||pw;if(!n){t.value(e);return}try{t.value(e)}catch(i){n(i)}}_deliverQueue(t){let e=t.current._listeners;for(;t.i<t.end;)this._deliver(e[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof mw)this._deliver(this._listeners,t);else{let e=this._deliveryQueue;e.enqueue(this,t,this._listeners.length),this._deliverQueue(e)}this._perfMon?.stop()}hasListeners(){return this._size>0}},OJ=class{constructor(){this.i=-1,this.end=0}enqueue(t,e,n){this.i=0,this.end=n,this.current=t,this.value=e}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},sk=class{constructor(){this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new st,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new st,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,n){if(this.getZoomLevel(n)===e)return;let i=this.getWindowId(n);this.mapWindowIdToZoomLevel.set(i,e),this._onDidChangeZoomLevel.fire(i)}getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,n){this.mapWindowIdToZoomFactor.set(this.getWindowId(n),e)}setFullscreen(e,n){if(this.isFullscreen(n)===e)return;let i=this.getWindowId(n);this.mapWindowIdToFullScreen.set(i,e),this._onDidChangeFullscreen.fire(i)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};sk.INSTANCE=new sk;var Dk=sk;function BJ(t,e,n){typeof e=="string"&&(e=t.matchMedia(e)),e.addEventListener("change",n)}var Vse=Dk.INSTANCE.onDidChangeZoomLevel;function UJ(t){return Dk.INSTANCE.getZoomFactor(t)}var Gse=Dk.INSTANCE.onDidChangeFullscreen,em=typeof navigator=="object"?navigator.userAgent:"",ok=em.indexOf("Firefox")>=0,vw=em.indexOf("AppleWebKit")>=0,Ik=em.indexOf("Chrome")>=0,Rz=!Ik&&em.indexOf("Safari")>=0,jse=em.indexOf("Electron/")>=0,Xse=em.indexOf("Android")>=0,_w=!1;if(typeof Lo.matchMedia=="function"){let t=Lo.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Lo.matchMedia("(display-mode: fullscreen)");_w=t.matches,BJ(Lo,t,({matches:n})=>{_w&&e.matches||(_w=n)})}function FJ(){return _w}var Jp="en",Cw=!1,Tw=!1,I_=!1,zJ=!1,Nz=!1,Oz=!1,HJ=!1,WJ=!1,VJ=!1,GJ=!1,cw,yw=Jp,x5=Jp,jJ,Sc,wc=globalThis,ko;typeof wc.vscode<"u"&&typeof wc.vscode.process<"u"?ko=wc.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(ko=process);var Bz=typeof ko?.versions?.electron=="string",XJ=Bz&&ko?.type==="renderer";if(typeof ko=="object"){Cw=ko.platform==="win32",Tw=ko.platform==="darwin",I_=ko.platform==="linux",zJ=I_&&!!ko.env.SNAP&&!!ko.env.SNAP_REVISION,HJ=Bz,VJ=!!ko.env.CI||!!ko.env.BUILD_ARTIFACTSTAGINGDIRECTORY,cw=Jp,yw=Jp;let t=ko.env.VSCODE_NLS_CONFIG;if(t)try{let e=JSON.parse(t);cw=e.userLocale,x5=e.osLocale,yw=e.resolvedLanguage||Jp,jJ=e.languagePack?.translationsConfigFile}catch{}Nz=!0}else typeof navigator=="object"&&!XJ?(Sc=navigator.userAgent,Cw=Sc.indexOf("Windows")>=0,Tw=Sc.indexOf("Macintosh")>=0,WJ=(Sc.indexOf("Macintosh")>=0||Sc.indexOf("iPad")>=0||Sc.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,I_=Sc.indexOf("Linux")>=0,GJ=Sc?.indexOf("Mobi")>=0,Oz=!0,yw=globalThis._VSCODE_NLS_LANGUAGE||Jp,cw=navigator.language.toLowerCase(),x5=cw):console.error("Unable to resolve platform.");var P3=0;Tw?P3=1:Cw?P3=3:I_&&(P3=2);var Uz=Cw,Tl=Tw,qJ=I_,D3=Nz,YJ=Oz&&typeof wc.importScripts=="function",qse=YJ?wc.origin:void 0,Ml=Sc,Gu=yw,KJ;(t=>{function e(){return Gu}t.value=e;function n(){return Gu.length===2?Gu==="en":Gu.length>=3?Gu[0]==="e"&&Gu[1]==="n"&&Gu[2]==="-":!1}t.isDefaultVariant=n;function i(){return Gu==="en"}t.isDefault=i})(KJ||(KJ={}));var $J=typeof wc.postMessage=="function"&&!wc.importScripts,JJ=(()=>{if($J){let t=[];wc.addEventListener("message",n=>{if(n.data&&n.data.vscodeScheduleAsyncWork)for(let i=0,r=t.length;i<r;i++){let s=t[i];if(s.id===n.data.vscodeScheduleAsyncWork){t.splice(i,1),s.callback();return}}});let e=0;return n=>{let i=++e;t.push({id:i,callback:n}),wc.postMessage({vscodeScheduleAsyncWork:i},"*")}}return t=>setTimeout(t)})(),ZJ=!!(Ml&&Ml.indexOf("Chrome")>=0),Yse=!!(Ml&&Ml.indexOf("Firefox")>=0),Kse=!!(!ZJ&&Ml&&Ml.indexOf("Safari")>=0),$se=!!(Ml&&Ml.indexOf("Edg/")>=0),Jse=!!(Ml&&Ml.indexOf("Android")>=0),ju=typeof navigator=="object"?navigator:{},Zse={clipboard:{writeText:D3||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(ju&&ju.clipboard&&ju.clipboard.writeText),readText:D3||!!(ju&&ju.clipboard&&ju.clipboard.readText)},keyboard:D3||FJ()?0:ju.keyboard||Rz?1:2,touch:"ontouchstart"in Lo||ju.maxTouchPoints>0,pointerEvents:Lo.PointerEvent&&("ontouchstart"in Lo||navigator.maxTouchPoints>0)},Rk=class{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(t,e){this._keyCodeToStr[t]=e,this._strToKeyCode[e.toLowerCase()]=t}keyCodeToStr(t){return this._keyCodeToStr[t]}strToKeyCode(t){return this._strToKeyCode[t.toLowerCase()]||0}},I3=new Rk,S5=new Rk,b5=new Rk,QJ=new Array(230),Fz;(t=>{function e(a){return I3.keyCodeToStr(a)}t.toString=e;function n(a){return I3.strToKeyCode(a)}t.fromString=n;function i(a){return S5.keyCodeToStr(a)}t.toUserSettingsUS=i;function r(a){return b5.keyCodeToStr(a)}t.toUserSettingsGeneral=r;function s(a){return S5.strToKeyCode(a)||b5.strToKeyCode(a)}t.fromUserSettings=s;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return I3.keyCodeToStr(a)}t.toElectronAccelerator=o})(Fz||(Fz={}));var eZ=class zz{constructor(e,n,i,r,s){this.ctrlKey=e,this.shiftKey=n,this.altKey=i,this.metaKey=r,this.keyCode=s}equals(e){return e instanceof zz&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",n=this.shiftKey?"1":"0",i=this.altKey?"1":"0",r=this.metaKey?"1":"0";return`K${e}${n}${i}${r}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new tZ([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},tZ=class{constructor(t){if(t.length===0)throw dJ("chords");this.chords=t}getHashCode(){let t="";for(let e=0,n=this.chords.length;e<n;e++)e!==0&&(t+=";"),t+=this.chords[e].getHashCode();return t}equals(t){if(t===null||this.chords.length!==t.chords.length)return!1;for(let e=0;e<this.chords.length;e++)if(!this.chords[e].equals(t.chords[e]))return!1;return!0}};function nZ(t){if(t.charCode){let n=String.fromCharCode(t.charCode).toUpperCase();return Fz.fromString(n)}let e=t.keyCode;if(e===3)return 7;if(ok)switch(e){case 59:return 85;case 60:if(qJ)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Tl)return 57;break}else if(vw&&(Tl&&e===93||!Tl&&e===92))return 57;return QJ[e]||0}var iZ=Tl?256:2048,rZ=512,sZ=1024,oZ=Tl?2048:256,ak=class{constructor(t){this._standardKeyboardEventBrand=!0;let e=t;this.browserEvent=e,this.target=e.target,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,this.altGraphKey=e.getModifierState?.("AltGraph"),this.keyCode=nZ(e),this.code=e.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(t){return this._asKeybinding===t}_computeKeybinding(){let t=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode);let e=0;return this.ctrlKey&&(e|=iZ),this.altKey&&(e|=rZ),this.shiftKey&&(e|=sZ),this.metaKey&&(e|=oZ),e|=t,e}_computeKeyCodeChord(){let t=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode),new eZ(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,t)}},w5=new WeakMap;function aZ(t){if(!t.parent||t.parent===t)return null;try{let e=t.location,n=t.parent.location;if(e.origin!=="null"&&n.origin!=="null"&&e.origin!==n.origin)return null}catch{return null}return t.parent}var lZ=class{static getSameOriginWindowChain(t){let e=w5.get(t);if(!e){e=[],w5.set(t,e);let n=t,i;do i=aZ(n),i?e.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):e.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return e.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(t,e){if(!e||t===e)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain(t);for(let s of r){let o=s.window.deref();if(n+=o?.scrollY??0,i+=o?.scrollX??0,o===e||!s.iframeElement)break;let a=s.iframeElement.getBoundingClientRect();n+=a.top,i+=a.left}return{top:n,left:i}}},M_=class{constructor(t,e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=e.button===0,this.middleButton=e.button===1,this.rightButton=e.button===2,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,e.type==="dblclick"&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,typeof e.pageX=="number"?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=e.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=lZ.getPositionOfChildWindowRelativeToAncestorWindow(t,e.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}},E5=class{constructor(t,e=0,n=0){this.browserEvent=t||null,this.target=t?t.target||t.targetNode||t.srcElement:null,this.deltaY=n,this.deltaX=e;let i=!1;if(Ik){let r=navigator.userAgent.match(/Chrome\/(\d+)/);i=(r?parseInt(r[1]):123)<=122}if(t){let r=t,s=t,o=t.view?.devicePixelRatio||1;if(typeof r.wheelDeltaY<"u")i?this.deltaY=r.wheelDeltaY/(120*o):this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(t.type==="wheel"){let a=t;a.deltaMode===a.DOM_DELTA_LINE?ok&&!Tl?this.deltaY=-t.deltaY/3:this.deltaY=-t.deltaY:this.deltaY=-t.deltaY/40}if(typeof r.wheelDeltaX<"u")Rz&&Uz?this.deltaX=-(r.wheelDeltaX/120):i?this.deltaX=r.wheelDeltaX/(120*o):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-t.detail/3;else if(t.type==="wheel"){let a=t;a.deltaMode===a.DOM_DELTA_LINE?ok&&!Tl?this.deltaX=-t.deltaX/3:this.deltaX=-t.deltaX:this.deltaX=-t.deltaX/40}this.deltaY===0&&this.deltaX===0&&t.wheelDelta&&(i?this.deltaY=t.wheelDelta/(120*o):this.deltaY=t.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}},Hz=Object.freeze(function(t,e){let n=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(n)}}}),cZ;(t=>{function e(n){return n===t.None||n===t.Cancelled||n instanceof uZ?!0:!n||typeof n!="object"?!1:typeof n.isCancellationRequested=="boolean"&&typeof n.onCancellationRequested=="function"}t.isCancellationToken=e,t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Fr.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Hz})})(cZ||(cZ={}));var uZ=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Hz:(this._emitter||(this._emitter=new st),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}};var Nk=class{constructor(t,e){this._isDisposed=!1,this._token=-1,typeof t=="function"&&typeof e=="number"&&this.setIfNotSet(t,e)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,e){if(this._isDisposed)throw new Z3("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},e)}setIfNotSet(t,e){if(this._isDisposed)throw new Z3("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},e))}},hZ=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(t,e,n=globalThis){if(this.isDisposed)throw new Z3("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{t()},e);this.disposable=ai(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},dZ,R3;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?R3=(t,e)=>{JJ(()=>{if(n)return;let i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let n=!1;return{dispose(){n||(n=!0)}}}:R3=(t,e,n)=>{let i=t.requestIdleCallback(e,typeof n=="number"?{timeout:n}:void 0),r=!1;return{dispose(){r||(r=!0,t.cancelIdleCallback(i))}}},dZ=t=>R3(globalThis,t)})();var fZ;(t=>{async function e(i){let r,s=await Promise.all(i.map(o=>o.then(a=>a,a=>{r||(r=a)})));if(typeof r<"u")throw r;return s}t.settled=e;function n(i){return new Promise(async(r,s)=>{try{await i(r,s)}catch(o){s(o)}})}t.withAsyncBody=n})(fZ||(fZ={}));var C5=class aa{static fromArray(e){return new aa(n=>{n.emitMany(e)})}static fromPromise(e){return new aa(async n=>{n.emitMany(await e)})}static fromPromises(e){return new aa(async n=>{await Promise.all(e.map(async i=>n.emitOne(await i)))})}static merge(e){return new aa(async n=>{await Promise.all(e.map(async i=>{for await(let r of i)n.emitOne(r)}))})}constructor(e,n){this._state=0,this._results=[],this._error=null,this._onReturn=n,this._onStateChanged=new st,queueMicrotask(async()=>{let i={emitOne:r=>this.emitOne(r),emitMany:r=>this.emitMany(r),reject:r=>this.reject(r)};try{await Promise.resolve(e(i)),this.resolve()}catch(r){this.reject(r)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await Fr.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,n){return new aa(async i=>{for await(let r of e)i.emitOne(n(r))})}map(e){return aa.map(this,e)}static filter(e,n){return new aa(async i=>{for await(let r of e)n(r)&&i.emitOne(r)})}filter(e){return aa.filter(this,e)}static coalesce(e){return aa.filter(e,n=>!!n)}coalesce(){return aa.coalesce(this)}static async toPromise(e){let n=[];for await(let i of e)n.push(i);return n}toPromise(){return aa.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};C5.EMPTY=C5.fromArray([]);function pZ(t){return 55296<=t&&t<=56319}function T5(t){return 56320<=t&&t<=57343}function mZ(t,e){return(t-55296<<10)+(e-56320)+65536}function gZ(t){return Ok(t,0)}function Ok(t,e){switch(typeof t){case"object":return t===null?bc(349,e):Array.isArray(t)?_Z(t,e):yZ(t,e);case"string":return Wz(t,e);case"boolean":return vZ(t,e);case"number":return bc(t,e);case"undefined":return bc(937,e);default:return bc(617,e)}}function bc(t,e){return(e<<5)-e+t|0}function vZ(t,e){return bc(t?433:863,e)}function Wz(t,e){e=bc(149417,e);for(let n=0,i=t.length;n<i;n++)e=bc(t.charCodeAt(n),e);return e}function _Z(t,e){return e=bc(104579,e),t.reduce((n,i)=>Ok(i,n),e)}function yZ(t,e){return e=bc(181387,e),Object.keys(t).sort().reduce((n,i)=>(n=Wz(i,n),Ok(t[i],n)),e)}function N3(t,e,n=32){let i=n-e,r=~((1<<i)-1);return(t<<e|(r&t)>>>i)>>>0}function M5(t,e=0,n=t.byteLength,i=0){for(let r=0;r<n;r++)t[e+r]=i}function xZ(t,e,n="0"){for(;t.length<e;)t=n+t;return t}function x_(t,e=32){return t instanceof ArrayBuffer?Array.from(new Uint8Array(t)).map(n=>n.toString(16).padStart(2,"0")).join(""):xZ((t>>>0).toString(16),e/4)}var SZ=class Vz{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let n=e.length;if(n===0)return;let i=this._buff,r=this._buffLen,s=this._leftoverHighSurrogate,o,a;for(s!==0?(o=s,a=-1,s=0):(o=e.charCodeAt(0),a=0);;){let l=o;if(pZ(o))if(a+1<n){let c=e.charCodeAt(a+1);T5(c)?(a++,l=mZ(o,c)):l=65533}else{s=o;break}else T5(o)&&(l=65533);if(r=this._push(i,r,l),a++,a<n)o=e.charCodeAt(a);else break}this._buffLen=r,this._leftoverHighSurrogate=s}_push(e,n,i){return i<128?e[n++]=i:i<2048?(e[n++]=192|(i&1984)>>>6,e[n++]=128|(i&63)>>>0):i<65536?(e[n++]=224|(i&61440)>>>12,e[n++]=128|(i&4032)>>>6,e[n++]=128|(i&63)>>>0):(e[n++]=240|(i&1835008)>>>18,e[n++]=128|(i&258048)>>>12,e[n++]=128|(i&4032)>>>6,e[n++]=128|(i&63)>>>0),n>=64&&(this._step(),n-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),n}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),x_(this._h0)+x_(this._h1)+x_(this._h2)+x_(this._h3)+x_(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,M5(this._buff,this._buffLen),this._buffLen>56&&(this._step(),M5(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=Vz._bigBlock32,n=this._buffDV;for(let d=0;d<64;d+=4)e.setUint32(d,n.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)e.setUint32(d,N3(e.getUint32(d-12,!1)^e.getUint32(d-32,!1)^e.getUint32(d-56,!1)^e.getUint32(d-64,!1),1),!1);let i=this._h0,r=this._h1,s=this._h2,o=this._h3,a=this._h4,l,c,u;for(let d=0;d<80;d++)d<20?(l=r&s|~r&o,c=1518500249):d<40?(l=r^s^o,c=1859775393):d<60?(l=r&s|r&o|s&o,c=2400959708):(l=r^s^o,c=3395469782),u=N3(i,5)+l+a+c+e.getUint32(d*4,!1)&4294967295,a=o,o=s,s=N3(r,30),r=i,i=u;this._h0=this._h0+i&4294967295,this._h1=this._h1+r&4294967295,this._h2=this._h2+s&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}};SZ._bigBlock32=new DataView(new ArrayBuffer(320));var{registerWindow:Qse,getWindow:Xa,getDocument:eoe,getWindows:toe,getWindowsCount:noe,getWindowId:A5,getWindowById:ioe,hasWindow:roe,onDidRegisterWindow:bZ,onWillUnregisterWindow:soe,onDidUnregisterWindow:ooe}=(function(){let t=new Map,e={window:Lo,disposables:new $u};t.set(Lo.vscodeWindowId,e);let n=new st,i=new st,r=new st;function s(o,a){return(typeof o=="number"?t.get(o):void 0)??(a?e:void 0)}return{onDidRegisterWindow:n.event,onWillUnregisterWindow:r.event,onDidUnregisterWindow:i.event,registerWindow(o){if(t.has(o.vscodeWindowId))return rn.None;let a=new $u,l={window:o,disposables:a.add(new $u)};return t.set(o.vscodeWindowId,l),a.add(ai(()=>{t.delete(o.vscodeWindowId),i.fire(o)})),a.add(Gt(o,Sr.BEFORE_UNLOAD,()=>{r.fire(o)})),n.fire(l),a},getWindows(){return t.values()},getWindowsCount(){return t.size},getWindowId(o){return o.vscodeWindowId},hasWindow(o){return t.has(o)},getWindowById:s,getWindow(o){let a=o;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=o;return l?.view?l.view.window:Lo},getDocument(o){return Xa(o).document}}})(),wZ=class{constructor(t,e,n,i){this._node=t,this._type=e,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function Gt(t,e,n,i){return new wZ(t,e,n,i)}function EZ(t,e){return function(n){return e(new M_(t,n))}}function CZ(t){return function(e){return t(new ak(e))}}var k5=function(t,e,n,i){let r=n;return e==="click"||e==="mousedown"||e==="contextmenu"?r=EZ(Xa(t),n):(e==="keydown"||e==="keypress"||e==="keyup")&&(r=CZ(n)),Gt(t,e,r,i)},TZ,Mw,MZ=class extends hZ{constructor(t){super(),this.defaultTarget=t&&Xa(t)}cancelAndSet(t,e,n){return super.cancelAndSet(t,e,n??this.defaultTarget)}},O3=class{constructor(t,e=0){this._runner=t,this.priority=e,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(t){pw(t)}}static sort(t,e){return e.priority-t.priority}};(function(){let t=new Map,e=new Map,n=new Map,i=new Map,r=s=>{n.set(s,!1);let o=t.get(s)??[];for(e.set(s,o),t.set(s,[]),i.set(s,!0);o.length>0;)o.sort(O3.sort),o.shift().execute();i.set(s,!1)};Mw=(s,o,a=0)=>{let l=A5(s),c=new O3(o,a),u=t.get(l);return u||(u=[],t.set(l,u)),u.push(c),n.get(l)||(n.set(l,!0),s.requestAnimationFrame(()=>r(l))),c},TZ=(s,o,a)=>{let l=A5(s);if(i.get(l)){let c=new O3(o,a),u=e.get(l);return u||(u=[],e.set(l,u)),u.push(c),c}else return Mw(s,o,a)}})();var L5=class xw{constructor(e,n){this.width=e,this.height=n}with(e=this.width,n=this.height){return e!==this.width||n!==this.height?new xw(e,n):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof xw?e:new xw(e.width,e.height)}static equals(e,n){return e===n?!0:!e||!n?!1:e.width===n.width&&e.height===n.height}};L5.None=new L5(0,0);function AZ(t){let e=t.getBoundingClientRect(),n=Xa(t);return{left:e.left+n.scrollX,top:e.top+n.scrollY,width:e.width,height:e.height}}var aoe=new class{constructor(){this.mutationObservers=new Map}observe(t,e,n){let i=this.mutationObservers.get(t);i||(i=new Map,this.mutationObservers.set(t,i));let r=gZ(n),s=i.get(r);if(s)s.users+=1;else{let o=new st,a=new MutationObserver(c=>o.fire(c));a.observe(t,n);let l=s={users:1,observer:a,onDidMutate:o.event};e.add(ai(()=>{l.users-=1,l.users===0&&(o.dispose(),a.disconnect(),i?.delete(r),i?.size===0&&this.mutationObservers.delete(t))})),i.set(r,s)}return s.onDidMutate}},Sr={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:vw?"webkitAnimationStart":"animationstart",ANIMATION_END:vw?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:vw?"webkitAnimationIteration":"animationiteration"},kZ=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function Gz(t,e,n,...i){let r=kZ.exec(e);if(!r)throw new Error("Bad use of emmet");let s=r[1]||"div",o;return t!=="http://www.w3.org/1999/xhtml"?o=document.createElementNS(t,s):o=document.createElement(s),r[3]&&(o.id=r[3]),r[4]&&(o.className=r[4].replace(/\./g," ").trim()),n&&Object.entries(n).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?o[a]=l:a==="selected"?l&&o.setAttribute(a,"true"):o.setAttribute(a,l))}),o.append(...i),o}function LZ(t,e,...n){return Gz("http://www.w3.org/1999/xhtml",t,e,...n)}LZ.SVG=function(t,e,...n){return Gz("http://www.w3.org/2000/svg",t,e,...n)};var PZ=class{constructor(t){this.domNode=t,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingTop="",this._paddingLeft="",this._paddingBottom="",this._paddingRight="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(t){let e=$s(t);this._maxWidth!==e&&(this._maxWidth=e,this.domNode.style.maxWidth=this._maxWidth)}setWidth(t){let e=$s(t);this._width!==e&&(this._width=e,this.domNode.style.width=this._width)}setHeight(t){let e=$s(t);this._height!==e&&(this._height=e,this.domNode.style.height=this._height)}setTop(t){let e=$s(t);this._top!==e&&(this._top=e,this.domNode.style.top=this._top)}setLeft(t){let e=$s(t);this._left!==e&&(this._left=e,this.domNode.style.left=this._left)}setBottom(t){let e=$s(t);this._bottom!==e&&(this._bottom=e,this.domNode.style.bottom=this._bottom)}setRight(t){let e=$s(t);this._right!==e&&(this._right=e,this.domNode.style.right=this._right)}setPaddingTop(t){let e=$s(t);this._paddingTop!==e&&(this._paddingTop=e,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(t){let e=$s(t);this._paddingLeft!==e&&(this._paddingLeft=e,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(t){let e=$s(t);this._paddingBottom!==e&&(this._paddingBottom=e,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(t){let e=$s(t);this._paddingRight!==e&&(this._paddingRight=e,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(t){let e=$s(t);this._fontSize!==e&&(this._fontSize=e,this.domNode.style.fontSize=this._fontSize)}setFontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(t){this._fontFeatureSettings!==t&&(this._fontFeatureSettings=t,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(t){this._fontVariationSettings!==t&&(this._fontVariationSettings=t,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(t){this._textDecoration!==t&&(this._textDecoration=t,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(t){let e=$s(t);this._lineHeight!==e&&(this._lineHeight=e,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(t){let e=$s(t);this._letterSpacing!==e&&(this._letterSpacing=e,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(t){this._className!==t&&(this._className=t,this.domNode.className=this._className)}toggleClassName(t,e){this.domNode.classList.toggle(t,e),this._className=this.domNode.className}setDisplay(t){this._display!==t&&(this._display=t,this.domNode.style.display=this._display)}setPosition(t){this._position!==t&&(this._position=t,this.domNode.style.position=this._position)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this.domNode.style.visibility=this._visibility)}setColor(t){this._color!==t&&(this._color=t,this.domNode.style.color=this._color)}setBackgroundColor(t){this._backgroundColor!==t&&(this._backgroundColor=t,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(t){this._layerHint!==t&&(this._layerHint=t,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(t){this._boxShadow!==t&&(this._boxShadow=t,this.domNode.style.boxShadow=t)}setContain(t){this._contain!==t&&(this._contain=t,this.domNode.style.contain=this._contain)}setAttribute(t,e){this.domNode.setAttribute(t,e)}removeAttribute(t){this.domNode.removeAttribute(t)}appendChild(t){this.domNode.appendChild(t.domNode)}removeChild(t){this.domNode.removeChild(t.domNode)}};function $s(t){return typeof t=="number"?`${t}px`:t}function R_(t){return new PZ(t)}var jz=class{constructor(){this._hooks=new $u,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(t,e){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,t&&n&&n(e)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(t,e,n,i,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=r;let s=t;try{t.setPointerCapture(e),this._hooks.add(ai(()=>{try{t.releasePointerCapture(e)}catch{}}))}catch{s=Xa(t)}this._hooks.add(Gt(s,Sr.POINTER_MOVE,o=>{if(o.buttons!==n){this.stopMonitoring(!0);return}o.preventDefault(),this._pointerMoveCallback(o)})),this._hooks.add(Gt(s,Sr.POINTER_UP,o=>this.stopMonitoring(!0)))}};function DZ(t,e,n){let i=null,r=null;if(typeof n.value=="function"?(i="value",r=n.value,r.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof n.get=="function"&&(i="get",r=n.get),!r)throw new Error("not supported");let s=`$memoize$${e}`;n[i]=function(...o){return this.hasOwnProperty(s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!1,value:r.apply(this,o)}),this[s]}}var Cl;(t=>(t.Tap="-xterm-gesturetap",t.Change="-xterm-gesturechange",t.Start="-xterm-gesturestart",t.End="-xterm-gesturesend",t.Contextmenu="-xterm-gesturecontextmenu"))(Cl||(Cl={}));var A_=class ss extends rn{constructor(){super(),this.dispatched=!1,this.targets=new v5,this.ignoreTargets=new v5,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Fr.runAndSubscribe(bZ,({window:e,disposables:n})=>{n.add(Gt(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),n.add(Gt(e.document,"touchend",i=>this.onTouchEnd(e,i))),n.add(Gt(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:Lo,disposables:this._store}))}static addTarget(e){if(!ss.isTouchDevice())return rn.None;ss.INSTANCE||(ss.INSTANCE=g5(new ss));let n=ss.INSTANCE.targets.push(e);return ai(n)}static ignoreTarget(e){if(!ss.isTouchDevice())return rn.None;ss.INSTANCE||(ss.INSTANCE=g5(new ss));let n=ss.INSTANCE.ignoreTargets.push(e);return ai(n)}static isTouchDevice(){return"ontouchstart"in Lo||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let n=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,r=e.targetTouches.length;i<r;i++){let s=e.targetTouches.item(i);this.activeTouches[s.identifier]={id:s.identifier,initialTarget:s.target,initialTimeStamp:n,initialPageX:s.pageX,initialPageY:s.pageY,rollingTimestamps:[n],rollingPageX:[s.pageX],rollingPageY:[s.pageY]};let o=this.newGestureEvent(Cl.Start,s.target);o.pageX=s.pageX,o.pageY=s.pageY,this.dispatchEvent(o)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,n){let i=Date.now(),r=Object.keys(this.activeTouches).length;for(let s=0,o=n.changedTouches.length;s<o;s++){let a=n.changedTouches.item(s);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],c=Date.now()-l.initialTimeStamp;if(c<ss.HOLD_DELAY&&Math.abs(l.initialPageX-Mo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Mo(l.rollingPageY))<30){let u=this.newGestureEvent(Cl.Tap,l.initialTarget);u.pageX=Mo(l.rollingPageX),u.pageY=Mo(l.rollingPageY),this.dispatchEvent(u)}else if(c>=ss.HOLD_DELAY&&Math.abs(l.initialPageX-Mo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Mo(l.rollingPageY))<30){let u=this.newGestureEvent(Cl.Contextmenu,l.initialTarget);u.pageX=Mo(l.rollingPageX),u.pageY=Mo(l.rollingPageY),this.dispatchEvent(u)}else if(r===1){let u=Mo(l.rollingPageX),d=Mo(l.rollingPageY),p=Mo(l.rollingTimestamps)-l.rollingTimestamps[0],m=u-l.rollingPageX[0],g=d-l.rollingPageY[0],_=[...this.targets].filter(y=>l.initialTarget instanceof Node&&y.contains(l.initialTarget));this.inertia(e,_,i,Math.abs(m)/p,m>0?1:-1,u,Math.abs(g)/p,g>0?1:-1,d)}this.dispatchEvent(this.newGestureEvent(Cl.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(n.preventDefault(),n.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,n){let i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=n,i.tapCount=0,i}dispatchEvent(e){if(e.type===Cl.Tap){let n=new Date().getTime(),i=0;n-this._lastSetTapCountTime>ss.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=n,e.tapCount=i}else(e.type===Cl.Change||e.type===Cl.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let i of this.ignoreTargets)if(i.contains(e.initialTarget))return;let n=[];for(let i of this.targets)if(i.contains(e.initialTarget)){let r=0,s=e.initialTarget;for(;s&&s!==i;)r++,s=s.parentElement;n.push([r,i])}n.sort((i,r)=>i[0]-r[0]);for(let[i,r]of n)r.dispatchEvent(e),this.dispatched=!0}}inertia(e,n,i,r,s,o,a,l,c){this.handle=Mw(e,()=>{let u=Date.now(),d=u-i,p=0,m=0,g=!0;r+=ss.SCROLL_FRICTION*d,a+=ss.SCROLL_FRICTION*d,r>0&&(g=!1,p=s*r*d),a>0&&(g=!1,m=l*a*d);let _=this.newGestureEvent(Cl.Change);_.translationX=p,_.translationY=m,n.forEach(y=>y.dispatchEvent(_)),g||this.inertia(e,n,u,r,s,o+p,a,l,c+m)})}onTouchMove(e){let n=Date.now();for(let i=0,r=e.changedTouches.length;i<r;i++){let s=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(s.identifier))){console.warn("end of an UNKNOWN touch",s);continue}let o=this.activeTouches[s.identifier],a=this.newGestureEvent(Cl.Change,o.initialTarget);a.translationX=s.pageX-Mo(o.rollingPageX),a.translationY=s.pageY-Mo(o.rollingPageY),a.pageX=s.pageX,a.pageY=s.pageY,this.dispatchEvent(a),o.rollingPageX.length>3&&(o.rollingPageX.shift(),o.rollingPageY.shift(),o.rollingTimestamps.shift()),o.rollingPageX.push(s.pageX),o.rollingPageY.push(s.pageY),o.rollingTimestamps.push(n)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};A_.SCROLL_FRICTION=-.005,A_.HOLD_DELAY=700,A_.CLEAR_TAP_COUNT_TIME=400,Ni([DZ],A_,"isTouchDevice",1);var IZ=A_,Bk=class extends rn{onclick(t,e){this._register(Gt(t,Sr.CLICK,n=>e(new M_(Xa(t),n))))}onmousedown(t,e){this._register(Gt(t,Sr.MOUSE_DOWN,n=>e(new M_(Xa(t),n))))}onmouseover(t,e){this._register(Gt(t,Sr.MOUSE_OVER,n=>e(new M_(Xa(t),n))))}onmouseleave(t,e){this._register(Gt(t,Sr.MOUSE_LEAVE,n=>e(new M_(Xa(t),n))))}onkeydown(t,e){this._register(Gt(t,Sr.KEY_DOWN,n=>e(new ak(n))))}onkeyup(t,e){this._register(Gt(t,Sr.KEY_UP,n=>e(new ak(n))))}oninput(t,e){this._register(Gt(t,Sr.INPUT,e))}onblur(t,e){this._register(Gt(t,Sr.BLUR,e))}onfocus(t,e){this._register(Gt(t,Sr.FOCUS,e))}onchange(t,e){this._register(Gt(t,Sr.CHANGE,e))}ignoreGesture(t){return IZ.ignoreTarget(t)}},P5=11,RZ=class extends Bk{constructor(t){super(),this._onActivate=t.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=t.bgWidth+"px",this.bgDomNode.style.height=t.bgHeight+"px",typeof t.top<"u"&&(this.bgDomNode.style.top="0px"),typeof t.left<"u"&&(this.bgDomNode.style.left="0px"),typeof t.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof t.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=t.className,this.domNode.style.position="absolute",this.domNode.style.width=P5+"px",this.domNode.style.height=P5+"px",typeof t.top<"u"&&(this.domNode.style.top=t.top+"px"),typeof t.left<"u"&&(this.domNode.style.left=t.left+"px"),typeof t.bottom<"u"&&(this.domNode.style.bottom=t.bottom+"px"),typeof t.right<"u"&&(this.domNode.style.right=t.right+"px"),this._pointerMoveMonitor=this._register(new jz),this._register(k5(this.bgDomNode,Sr.POINTER_DOWN,e=>this._arrowPointerDown(e))),this._register(k5(this.domNode,Sr.POINTER_DOWN,e=>this._arrowPointerDown(e))),this._pointerdownRepeatTimer=this._register(new MZ),this._pointerdownScheduleRepeatTimer=this._register(new Nk)}_arrowPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let e=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Xa(t))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(e,200),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),t.preventDefault()}},NZ=class lk{constructor(e,n,i,r,s,o,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(n=n|0,i=i|0,r=r|0,s=s|0,o=o|0,a=a|0),this.rawScrollLeft=r,this.rawScrollTop=a,n<0&&(n=0),r+n>i&&(r=i-n),r<0&&(r=0),s<0&&(s=0),a+s>o&&(a=o-s),a<0&&(a=0),this.width=n,this.scrollWidth=i,this.scrollLeft=r,this.height=s,this.scrollHeight=o,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,n){return new lk(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,n?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,n?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new lk(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,n){let i=this.width!==e.width,r=this.scrollWidth!==e.scrollWidth,s=this.scrollLeft!==e.scrollLeft,o=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:n,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:r,scrollLeftChanged:s,heightChanged:o,scrollHeightChanged:a,scrollTopChanged:l}}},OZ=class extends rn{constructor(t){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new st),this.onScroll=this._onScroll.event,this._smoothScrollDuration=t.smoothScrollDuration,this._scheduleAtNextAnimationFrame=t.scheduleAtNextAnimationFrame,this._state=new NZ(t.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(t){this._smoothScrollDuration=t}validateScrollPosition(t){return this._state.withScrollPosition(t)}getScrollDimensions(){return this._state}setScrollDimensions(t,e){let n=this._state.withScrollDimensions(t,e);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(t){let e=this._state.withScrollPosition(t);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(e,!1)}setScrollPositionSmooth(t,e){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(t);if(this._smoothScrolling){t={scrollLeft:typeof t.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:t.scrollLeft,scrollTop:typeof t.scrollTop>"u"?this._smoothScrolling.to.scrollTop:t.scrollTop};let n=this._state.withScrollPosition(t);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;e?i=new I5(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(t);this._smoothScrolling=I5.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let t=this._smoothScrolling.tick(),e=this._state.withScrollPosition(t);if(this._setState(e,!0),!!this._smoothScrolling){if(t.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(t,e){let n=this._state;n.equals(t)||(this._state=t,this._onScroll.fire(this._state.createScrollEvent(n,e)))}},D5=class{constructor(t,e,n){this.scrollLeft=t,this.scrollTop=e,this.isDone=n}};function B3(t,e){let n=e-t;return function(i){return t+n*FZ(i)}}function BZ(t,e,n){return function(i){return i<n?t(i/n):e((i-n)/(1-n))}}var I5=class ck{constructor(e,n,i,r){this.from=e,this.to=n,this.duration=r,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,n,i){if(Math.abs(e-n)>2.5*i){let r,s;return e<n?(r=e+.75*i,s=n-.75*i):(r=e-.75*i,s=n+.75*i),BZ(B3(e,r),B3(s,n),.33)}return B3(e,n)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let n=(e-this.startTime)/this.duration;if(n<1){let i=this.scrollLeft(n),r=this.scrollTop(n);return new D5(i,r,!1)}return new D5(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,n,i){return ck.start(e,n,i)}static start(e,n,i){i=i+10;let r=Date.now()-10;return new ck(e,n,r,i)}};function UZ(t){return Math.pow(t,3)}function FZ(t){return 1-UZ(1-t)}var zZ=class extends rn{constructor(t,e,n){super(),this._visibility=t,this._visibleClassName=e,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Nk)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this._updateShouldBeVisible())}setShouldBeVisible(t){this._rawShouldBeVisible=t,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let t=this._applyVisibilitySetting();this._shouldBeVisible!==t&&(this._shouldBeVisible=t,this.ensureVisibility())}setIsNeeded(t){this._isNeeded!==t&&(this._isNeeded=t,this.ensureVisibility())}setDomNode(t){this._domNode=t,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(t){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(t?" fade":"")))}},HZ=140,Xz=class extends Bk{constructor(t){super(),this._lazyRender=t.lazyRender,this._host=t.host,this._scrollable=t.scrollable,this._scrollByPage=t.scrollByPage,this._scrollbarState=t.scrollbarState,this._visibilityController=this._register(new zZ(t.visibility,"visible scrollbar "+t.extraScrollbarClassName,"invisible scrollbar "+t.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new jz),this._shouldRender=!0,this.domNode=R_(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(Gt(this.domNode.domNode,Sr.POINTER_DOWN,e=>this._domNodePointerDown(e)))}_createArrow(t){let e=this._register(new RZ(t));this.domNode.domNode.appendChild(e.bgDomNode),this.domNode.domNode.appendChild(e.domNode)}_createSlider(t,e,n,i){this.slider=R_(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(t),this.slider.setLeft(e),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(Gt(this.slider.domNode,Sr.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(t){return this._scrollbarState.setVisibleSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(t){return this._scrollbarState.setScrollSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(t){return this._scrollbarState.setScrollPosition(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(t){t.target===this.domNode.domNode&&this._onPointerDown(t)}delegatePointerDown(t){let e=this.domNode.domNode.getClientRects()[0].top,n=e+this._scrollbarState.getSliderPosition(),i=e+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(t);n<=r&&r<=i?t.button===0&&(t.preventDefault(),this._sliderPointerDown(t)):this._onPointerDown(t)}_onPointerDown(t){let e,n;if(t.target===this.domNode.domNode&&typeof t.offsetX=="number"&&typeof t.offsetY=="number")e=t.offsetX,n=t.offsetY;else{let r=AZ(this.domNode.domNode);e=t.pageX-r.left,n=t.pageY-r.top}let i=this._pointerDownRelativePosition(e,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),t.button===0&&(t.preventDefault(),this._sliderPointerDown(t))}_sliderPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let e=this._sliderPointerPosition(t),n=this._sliderOrthogonalPointerPosition(t),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,r=>{let s=this._sliderOrthogonalPointerPosition(r),o=Math.abs(s-n);if(Uz&&o>HZ){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let a=this._sliderPointerPosition(r)-e;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(a))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(t){let e={};this.writeScrollPosition(e,t),this._scrollable.setScrollPositionNow(e)}updateScrollbarSize(t){this._updateScrollbarSize(t),this._scrollbarState.setScrollbarSize(t),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}},qz=class uk{constructor(e,n,i,r,s,o){this._scrollbarSize=Math.round(n),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=r,this._scrollSize=s,this._scrollPosition=o,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new uk(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let n=Math.round(e);return this._visibleSize!==n?(this._visibleSize=n,this._refreshComputedValues(),!0):!1}setScrollSize(e){let n=Math.round(e);return this._scrollSize!==n?(this._scrollSize=n,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let n=Math.round(e);return this._scrollPosition!==n?(this._scrollPosition=n,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,n,i,r,s){let o=Math.max(0,i-e),a=Math.max(0,o-2*n),l=r>0&&r>i;if(!l)return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let c=Math.round(Math.max(20,Math.floor(i*a/r))),u=(a-c)/(r-i),d=s*u;return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:u,computedSliderPosition:Math.round(d)}}_refreshComputedValues(){let e=uk._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let n=e-this._arrowSize-this._computedSliderSize/2;return Math.round(n/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let n=e-this._arrowSize,i=this._scrollPosition;return n<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let n=this._computedSliderPosition+e;return Math.round(n/this._computedSliderRatio)}},WZ=class extends Xz{constructor(t,e,n){let i=t.getScrollDimensions(),r=t.getCurrentScrollPosition();if(super({lazyRender:e.lazyRender,host:n,scrollbarState:new qz(e.horizontalHasArrows?e.arrowSize:0,e.horizontal===2?0:e.horizontalScrollbarSize,e.vertical===2?0:e.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:e.horizontal,extraScrollbarClassName:"horizontal",scrollable:t,scrollByPage:e.scrollByPage}),e.horizontalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(Math.floor((e.horizontalScrollbarSize-e.horizontalSliderSize)/2),0,void 0,e.horizontalSliderSize)}_updateSlider(t,e){this.slider.setWidth(t),this.slider.setLeft(e)}_renderDomNode(t,e){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(t.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,e){return t}_sliderPointerPosition(t){return t.pageX}_sliderOrthogonalPointerPosition(t){return t.pageY}_updateScrollbarSize(t){this.slider.setHeight(t)}writeScrollPosition(t,e){t.scrollLeft=e}updateOptions(t){this.updateScrollbarSize(t.horizontal===2?0:t.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._visibilityController.setVisibility(t.horizontal),this._scrollByPage=t.scrollByPage}},VZ=class extends Xz{constructor(t,e,n){let i=t.getScrollDimensions(),r=t.getCurrentScrollPosition();if(super({lazyRender:e.lazyRender,host:n,scrollbarState:new qz(e.verticalHasArrows?e.arrowSize:0,e.vertical===2?0:e.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:e.vertical,extraScrollbarClassName:"vertical",scrollable:t,scrollByPage:e.scrollByPage}),e.verticalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(0,Math.floor((e.verticalScrollbarSize-e.verticalSliderSize)/2),e.verticalSliderSize,void 0)}_updateSlider(t,e){this.slider.setHeight(t),this.slider.setTop(e)}_renderDomNode(t,e){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(t.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,e){return e}_sliderPointerPosition(t){return t.pageY}_sliderOrthogonalPointerPosition(t){return t.pageX}_updateScrollbarSize(t){this.slider.setWidth(t)}writeScrollPosition(t,e){t.scrollTop=e}updateOptions(t){this.updateScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(t.vertical),this._scrollByPage=t.scrollByPage}},GZ=500,R5=50,N5=!0,jZ=class{constructor(t,e,n){this.timestamp=t,this.deltaX=e,this.deltaY=n,this.score=0}},hk=class{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,n=0,i=1,r=this._rear;do{let s=r===this._front?e:Math.pow(2,-i);if(e-=s,n+=this._memory[r].score*s,r===this._front)break;r=(this._capacity+r-1)%this._capacity,i++}while(!0);return n<=.5}acceptStandardWheelEvent(e){if(Ik){let n=Xa(e.browserEvent),i=UJ(n);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,n,i){let r=null,s=new jZ(e,n,i);this._front===-1&&this._rear===-1?(this._memory[0]=s,this._front=0,this._rear=0):(r=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=s),s.score=this._computeScore(s,r)}_computeScore(e,n){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),n){let r=Math.abs(e.deltaX),s=Math.abs(e.deltaY),o=Math.abs(n.deltaX),a=Math.abs(n.deltaY),l=Math.max(Math.min(r,o),1),c=Math.max(Math.min(s,a),1),u=Math.max(r,o),d=Math.max(s,a);u%l===0&&d%c===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}};hk.INSTANCE=new hk;var XZ=hk,qZ=class extends Bk{constructor(t,e,n){super(),this._onScroll=this._register(new st),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new st),this.onWillScroll=this._onWillScroll.event,this._options=KZ(e),this._scrollable=n,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));let i={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new VZ(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new WZ(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="xterm-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.appendChild(t),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=R_(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=R_(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=R_(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new Nk),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=Md(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(t){this._verticalScrollbar.delegatePointerDown(t)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(t){this._scrollable.setScrollDimensions(t,!1)}updateClassName(t){this._options.className=t,Tl&&(this._options.className+=" mac"),this._domNode.className="xterm-scrollable-element "+this._options.className}updateOptions(t){typeof t.handleMouseWheel<"u"&&(this._options.handleMouseWheel=t.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof t.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=t.mouseWheelScrollSensitivity),typeof t.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=t.fastScrollSensitivity),typeof t.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=t.scrollPredominantAxis),typeof t.horizontal<"u"&&(this._options.horizontal=t.horizontal),typeof t.vertical<"u"&&(this._options.vertical=t.vertical),typeof t.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=t.horizontalScrollbarSize),typeof t.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=t.verticalScrollbarSize),typeof t.scrollByPage<"u"&&(this._options.scrollByPage=t.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(t){this._revealOnScroll=t}delegateScrollFromMouseWheelEvent(t){this._onMouseWheel(new E5(t))}_setListeningToMouseWheel(t){if(this._mouseWheelToDispose.length>0!==t&&(this._mouseWheelToDispose=Md(this._mouseWheelToDispose),t)){let e=n=>{this._onMouseWheel(new E5(n))};this._mouseWheelToDispose.push(Gt(this._listenOnDomNode,Sr.MOUSE_WHEEL,e,{passive:!1}))}}_onMouseWheel(t){if(t.browserEvent?.defaultPrevented)return;let e=XZ.INSTANCE;N5&&e.acceptStandardWheelEvent(t);let n=!1;if(t.deltaY||t.deltaX){let r=t.deltaY*this._options.mouseWheelScrollSensitivity,s=t.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+r===0?s=r=0:Math.abs(r)>=Math.abs(s)?s=0:r=0),this._options.flipAxes&&([r,s]=[s,r]);let o=!Tl&&t.browserEvent&&t.browserEvent.shiftKey;(this._options.scrollYToX||o)&&!s&&(s=r,r=0),t.browserEvent&&t.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);let a=this._scrollable.getFutureScrollPosition(),l={};if(r){let c=R5*r,u=a.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(l,u)}if(s){let c=R5*s,u=a.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(l,u)}l=this._scrollable.validateScrollPosition(l),(a.scrollLeft!==l.scrollLeft||a.scrollTop!==l.scrollTop)&&(N5&&this._options.mouseWheelSmoothScroll&&e.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(l):this._scrollable.setScrollPositionNow(l),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(t.preventDefault(),t.stopPropagation())}_onDidScroll(t){this._shouldRender=this._horizontalScrollbar.onDidScroll(t)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(t)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let t=this._scrollable.getCurrentScrollPosition(),e=t.scrollTop>0,n=t.scrollLeft>0,i=n?" left":"",r=e?" top":"",s=n||e?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(t){this._mouseIsOver=!1,this._hide()}_onMouseOver(t){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),GZ)}},YZ=class extends qZ{constructor(t,e,n){super(t,e,n)}setScrollPosition(t){t.reuseAnimation?this._scrollable.setScrollPositionSmooth(t,t.reuseAnimation):this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function KZ(t){let e={lazyRender:typeof t.lazyRender<"u"?t.lazyRender:!1,className:typeof t.className<"u"?t.className:"",useShadows:typeof t.useShadows<"u"?t.useShadows:!0,handleMouseWheel:typeof t.handleMouseWheel<"u"?t.handleMouseWheel:!0,flipAxes:typeof t.flipAxes<"u"?t.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof t.consumeMouseWheelIfScrollbarIsNeeded<"u"?t.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof t.alwaysConsumeMouseWheel<"u"?t.alwaysConsumeMouseWheel:!1,scrollYToX:typeof t.scrollYToX<"u"?t.scrollYToX:!1,mouseWheelScrollSensitivity:typeof t.mouseWheelScrollSensitivity<"u"?t.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof t.fastScrollSensitivity<"u"?t.fastScrollSensitivity:5,scrollPredominantAxis:typeof t.scrollPredominantAxis<"u"?t.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof t.mouseWheelSmoothScroll<"u"?t.mouseWheelSmoothScroll:!0,arrowSize:typeof t.arrowSize<"u"?t.arrowSize:11,listenOnDomNode:typeof t.listenOnDomNode<"u"?t.listenOnDomNode:null,horizontal:typeof t.horizontal<"u"?t.horizontal:1,horizontalScrollbarSize:typeof t.horizontalScrollbarSize<"u"?t.horizontalScrollbarSize:10,horizontalSliderSize:typeof t.horizontalSliderSize<"u"?t.horizontalSliderSize:0,horizontalHasArrows:typeof t.horizontalHasArrows<"u"?t.horizontalHasArrows:!1,vertical:typeof t.vertical<"u"?t.vertical:1,verticalScrollbarSize:typeof t.verticalScrollbarSize<"u"?t.verticalScrollbarSize:10,verticalHasArrows:typeof t.verticalHasArrows<"u"?t.verticalHasArrows:!1,verticalSliderSize:typeof t.verticalSliderSize<"u"?t.verticalSliderSize:0,scrollByPage:typeof t.scrollByPage<"u"?t.scrollByPage:!1};return e.horizontalSliderSize=typeof t.horizontalSliderSize<"u"?t.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof t.verticalSliderSize<"u"?t.verticalSliderSize:e.verticalScrollbarSize,Tl&&(e.className+=" mac"),e}var dk=class extends rn{constructor(t,e,n,i,r,s,o,a){super(),this._bufferService=n,this._optionsService=o,this._renderService=a,this._onRequestScrollLines=this._register(new st),this.onRequestScrollLines=this._onRequestScrollLines.event,this._isSyncing=!1,this._isHandlingScroll=!1,this._suppressOnScrollHandler=!1;let l=this._register(new OZ({forceIntegerValues:!1,smoothScrollDuration:this._optionsService.rawOptions.smoothScrollDuration,scheduleAtNextAnimationFrame:c=>Mw(i.window,c)}));this._register(this._optionsService.onSpecificOptionChange("smoothScrollDuration",()=>{l.setSmoothScrollDuration(this._optionsService.rawOptions.smoothScrollDuration)})),this._scrollableElement=this._register(new YZ(e,{vertical:1,horizontal:2,useShadows:!1,mouseWheelSmoothScroll:!0,...this._getChangeOptions()},l)),this._register(this._optionsService.onMultipleOptionChange(["scrollSensitivity","fastScrollSensitivity","overviewRuler"],()=>this._scrollableElement.updateOptions(this._getChangeOptions()))),this._register(r.onProtocolChange(c=>{this._scrollableElement.updateOptions({handleMouseWheel:!(c&16)})})),this._scrollableElement.setScrollDimensions({height:0,scrollHeight:0}),this._register(Fr.runAndSubscribe(s.onChangeColors,()=>{this._scrollableElement.getDomNode().style.backgroundColor=s.colors.background.css})),t.appendChild(this._scrollableElement.getDomNode()),this._register(ai(()=>this._scrollableElement.getDomNode().remove())),this._styleElement=i.mainDocument.createElement("style"),e.appendChild(this._styleElement),this._register(ai(()=>this._styleElement.remove())),this._register(Fr.runAndSubscribe(s.onChangeColors,()=>{this._styleElement.textContent=[".xterm .xterm-scrollable-element > .scrollbar > .slider {",`  background: ${s.colors.scrollbarSliderBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider:hover {",`  background: ${s.colors.scrollbarSliderHoverBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider.active {",`  background: ${s.colors.scrollbarSliderActiveBackground.css};`,"}"].join(`
`)})),this._register(this._bufferService.onResize(()=>this.queueSync())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._latestYDisp=void 0,this.queueSync()})),this._register(this._bufferService.onScroll(()=>this._sync())),this._register(this._scrollableElement.onScroll(c=>this._handleScroll(c)))}scrollLines(t){let e=this._scrollableElement.getScrollPosition();this._scrollableElement.setScrollPosition({reuseAnimation:!0,scrollTop:e.scrollTop+t*this._renderService.dimensions.css.cell.height})}scrollToLine(t,e){e&&(this._latestYDisp=t),this._scrollableElement.setScrollPosition({reuseAnimation:!e,scrollTop:t*this._renderService.dimensions.css.cell.height})}_getChangeOptions(){return{mouseWheelScrollSensitivity:this._optionsService.rawOptions.scrollSensitivity,fastScrollSensitivity:this._optionsService.rawOptions.fastScrollSensitivity,verticalScrollbarSize:this._optionsService.rawOptions.overviewRuler?.width||14}}queueSync(t){t!==void 0&&(this._latestYDisp=t),this._queuedAnimationFrame===void 0&&(this._queuedAnimationFrame=this._renderService.addRefreshCallback(()=>{this._queuedAnimationFrame=void 0,this._sync(this._latestYDisp)}))}_sync(t=this._bufferService.buffer.ydisp){!this._renderService||this._isSyncing||(this._isSyncing=!0,this._suppressOnScrollHandler=!0,this._scrollableElement.setScrollDimensions({height:this._renderService.dimensions.css.canvas.height,scrollHeight:this._renderService.dimensions.css.cell.height*this._bufferService.buffer.lines.length}),this._suppressOnScrollHandler=!1,t!==this._latestYDisp&&this._scrollableElement.setScrollPosition({scrollTop:t*this._renderService.dimensions.css.cell.height}),this._isSyncing=!1)}_handleScroll(t){if(!this._renderService||this._isHandlingScroll||this._suppressOnScrollHandler)return;this._isHandlingScroll=!0;let e=Math.round(t.scrollTop/this._renderService.dimensions.css.cell.height),n=e-this._bufferService.buffer.ydisp;n!==0&&(this._latestYDisp=e,this._onRequestScrollLines.fire(n)),this._isHandlingScroll=!1}};dk=Ni([wt(2,ks),wt(3,Ec),wt(4,_z),wt(5,Qp),wt(6,Ls),wt(7,Cc)],dk);var fk=class extends rn{constructor(t,e,n,i,r){super(),this._screenElement=t,this._bufferService=e,this._coreBrowserService=n,this._decorationService=i,this._renderService=r,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this._register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this._register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this._register(this._decorationService.onDecorationRemoved(s=>this._removeDecoration(s))),this._register(ai(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){let e=this._coreBrowserService.mainDocument.createElement("div");e.classList.add("xterm-decoration"),e.classList.toggle("xterm-decoration-top-layer",t?.options?.layer==="top"),e.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,e.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,e.style.top=`${(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height}px`,e.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let n=t.options.x??0;return n&&n>this._bufferService.cols&&(e.style.display="none"),this._refreshXPosition(t,e),e}_refreshStyle(t){let e=t.marker.line-this._bufferService.buffers.active.ydisp;if(e<0||e>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let n=this._decorationElements.get(t);n||(n=this._createElement(t),t.element=n,this._decorationElements.set(t,n),this._container.appendChild(n),t.onDispose(()=>{this._decorationElements.delete(t),n.remove()})),n.style.display=this._altBufferIsActive?"none":"block",this._altBufferIsActive||(n.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,n.style.top=`${e*this._renderService.dimensions.css.cell.height}px`,n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`),t.onRenderEmitter.fire(n)}}_refreshXPosition(t,e=t.element){if(!e)return;let n=t.options.x??0;(t.options.anchor||"left")==="right"?e.style.right=n?`${n*this._renderService.dimensions.css.cell.width}px`:"":e.style.left=n?`${n*this._renderService.dimensions.css.cell.width}px`:""}_removeDecoration(t){this._decorationElements.get(t)?.remove(),this._decorationElements.delete(t),t.dispose()}};fk=Ni([wt(1,ks),wt(2,Ec),wt(3,z_),wt(4,Cc)],fk);var $Z=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(t){if(t.options.overviewRulerOptions){for(let e of this._zones)if(e.color===t.options.overviewRulerOptions.color&&e.position===t.options.overviewRulerOptions.position){if(this._lineIntersectsZone(e,t.marker.line))return;if(this._lineAdjacentToZone(e,t.marker.line,t.options.overviewRulerOptions.position)){this._addLineToZone(e,t.marker.line);return}}if(this._zonePoolIndex<this._zonePool.length){this._zonePool[this._zonePoolIndex].color=t.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=t.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=t.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=t.marker.line,this._zones.push(this._zonePool[this._zonePoolIndex++]);return}this._zones.push({color:t.options.overviewRulerOptions.color,position:t.options.overviewRulerOptions.position,startBufferLine:t.marker.line,endBufferLine:t.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(t){this._linePadding=t}_lineIntersectsZone(t,e){return e>=t.startBufferLine&&e<=t.endBufferLine}_lineAdjacentToZone(t,e,n){return e>=t.startBufferLine-this._linePadding[n||"full"]&&e<=t.endBufferLine+this._linePadding[n||"full"]}_addLineToZone(t,e){t.startBufferLine=Math.min(t.startBufferLine,e),t.endBufferLine=Math.max(t.endBufferLine,e)}},wl={full:0,left:0,center:0,right:0},Xu={full:0,left:0,center:0,right:0},S_={full:0,left:0,center:0,right:0},Aw=class extends rn{constructor(t,e,n,i,r,s,o,a){super(),this._viewportElement=t,this._screenElement=e,this._bufferService=n,this._decorationService=i,this._renderService=r,this._optionsService=s,this._themeService=o,this._coreBrowserService=a,this._colorZoneStore=new $Z,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement),this._register(ai(()=>this._canvas?.remove()));let l=this._canvas.getContext("2d");if(l)this._ctx=l;else throw new Error("Ctx cannot be null");this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this._register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0))),this._register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this._register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})),this._register(this._renderService.onRender(()=>{(!this._containerHeight||this._containerHeight!==this._screenElement.clientHeight)&&(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._register(this._optionsService.onSpecificOptionChange("overviewRuler",()=>this._queueRefresh(!0))),this._register(this._themeService.onChangeColors(()=>this._queueRefresh())),this._queueRefresh(!0)}get _width(){return this._optionsService.options.overviewRuler?.width||0}_refreshDrawConstants(){let t=Math.floor((this._canvas.width-1)/3),e=Math.ceil((this._canvas.width-1)/3);Xu.full=this._canvas.width,Xu.left=t,Xu.center=e,Xu.right=t,this._refreshDrawHeightConstants(),S_.full=1,S_.left=1,S_.center=1+Xu.left,S_.right=1+Xu.left+Xu.center}_refreshDrawHeightConstants(){wl.full=Math.round(2*this._coreBrowserService.dpr);let t=this._canvas.height/this._bufferService.buffer.lines.length,e=Math.round(Math.max(Math.min(t,12),6)*this._coreBrowserService.dpr);wl.left=e,wl.center=e,wl.right=e}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*wl.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*wl.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*wl.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*wl.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let e of this._decorationService.decorations)this._colorZoneStore.addDecoration(e);this._ctx.lineWidth=1,this._renderRulerOutline();let t=this._colorZoneStore.zones;for(let e of t)e.position!=="full"&&this._renderColorZone(e);for(let e of t)e.position==="full"&&this._renderColorZone(e);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderRulerOutline(){this._ctx.fillStyle=this._themeService.colors.overviewRulerBorder.css,this._ctx.fillRect(0,0,1,this._canvas.height),this._optionsService.rawOptions.overviewRuler.showTopBorder&&this._ctx.fillRect(1,0,this._canvas.width-1,1),this._optionsService.rawOptions.overviewRuler.showBottomBorder&&this._ctx.fillRect(1,this._canvas.height-1,this._canvas.width-1,this._canvas.height)}_renderColorZone(t){this._ctx.fillStyle=t.color,this._ctx.fillRect(S_[t.position||"full"],Math.round((this._canvas.height-1)*(t.startBufferLine/this._bufferService.buffers.active.lines.length)-wl[t.position||"full"]/2),Xu[t.position||"full"],Math.round((this._canvas.height-1)*((t.endBufferLine-t.startBufferLine)/this._bufferService.buffers.active.lines.length)+wl[t.position||"full"]))}_queueRefresh(t,e){this._shouldUpdateDimensions=t||this._shouldUpdateDimensions,this._shouldUpdateAnchor=e||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};Aw=Ni([wt(2,ks),wt(3,z_),wt(4,Cc),wt(5,Ls),wt(6,Qp),wt(7,Ec)],Aw);var qe;(t=>(t.NUL="\0",t.SOH="",t.STX="",t.ETX="",t.EOT="",t.ENQ="",t.ACK="",t.BEL="\x07",t.BS="\b",t.HT="	",t.LF=`
`,t.VT="\v",t.FF="\f",t.CR="\r",t.SO="",t.SI="",t.DLE="",t.DC1="",t.DC2="",t.DC3="",t.DC4="",t.NAK="",t.SYN="",t.ETB="",t.CAN="",t.EM="",t.SUB="",t.ESC="\x1B",t.FS="",t.GS="",t.RS="",t.US="",t.SP=" ",t.DEL="\x7F"))(qe||(qe={}));var Sw;(t=>(t.PAD="\x80",t.HOP="\x81",t.BPH="\x82",t.NBH="\x83",t.IND="\x84",t.NEL="\x85",t.SSA="\x86",t.ESA="\x87",t.HTS="\x88",t.HTJ="\x89",t.VTS="\x8A",t.PLD="\x8B",t.PLU="\x8C",t.RI="\x8D",t.SS2="\x8E",t.SS3="\x8F",t.DCS="\x90",t.PU1="\x91",t.PU2="\x92",t.STS="\x93",t.CCH="\x94",t.MW="\x95",t.SPA="\x96",t.EPA="\x97",t.SOS="\x98",t.SGCI="\x99",t.SCI="\x9A",t.CSI="\x9B",t.ST="\x9C",t.OSC="\x9D",t.PM="\x9E",t.APC="\x9F"))(Sw||(Sw={}));var Yz;(t=>t.ST=`${qe.ESC}\\`)(Yz||(Yz={}));var pk=class{constructor(t,e,n,i,r,s){this._textarea=t,this._compositionView=e,this._bufferService=n,this._optionsService=i,this._coreService=r,this._renderService=s,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(t){this._compositionView.textContent=t.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(t){if(this._isComposing||this._isSendingComposition){if(t.keyCode===20||t.keyCode===229||t.keyCode===16||t.keyCode===17||t.keyCode===18)return!1;this._finalizeComposition(!1)}return t.keyCode===229?(this._handleAnyTextareaChanges(),!1):!0}_finalizeComposition(t){if(this._compositionView.classList.remove("active"),this._isComposing=!1,t){let e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){this._isSendingComposition=!1;let n;e.start+=this._dataAlreadySent.length,this._isComposing?n=this._textarea.value.substring(e.start,this._compositionPosition.start):n=this._textarea.value.substring(e.start),n.length>0&&this._coreService.triggerDataEvent(n,!0)}},0)}else{this._isSendingComposition=!1;let e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){let t=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let e=this._textarea.value,n=e.replace(t,"");this._dataAlreadySent=n,e.length>t.length?this._coreService.triggerDataEvent(n,!0):e.length<t.length?this._coreService.triggerDataEvent(`${qe.DEL}`,!0):e.length===t.length&&e!==t&&this._coreService.triggerDataEvent(e,!0)}},0)}updateCompositionElements(t){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),n=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,r=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=r+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=n+"px",this._compositionView.style.lineHeight=n+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let s=this._compositionView.getBoundingClientRect();this._textarea.style.left=r+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(s.width,1)+"px",this._textarea.style.height=Math.max(s.height,1)+"px",this._textarea.style.lineHeight=s.height+"px"}t||setTimeout(()=>this.updateCompositionElements(!0),0)}}};pk=Ni([wt(2,ks),wt(3,Ls),wt(4,kd),wt(5,Cc)],pk);var br=0,wr=0,Er=0,Ri=0,O5={css:"#00000000",rgba:0},Ji;(t=>{function e(r,s,o,a){return a!==void 0?`#${bd(r)}${bd(s)}${bd(o)}${bd(a)}`:`#${bd(r)}${bd(s)}${bd(o)}`}t.toCss=e;function n(r,s,o,a=255){return(r<<24|s<<16|o<<8|a)>>>0}t.toRgba=n;function i(r,s,o,a){return{css:t.toCss(r,s,o,a),rgba:t.toRgba(r,s,o,a)}}t.toColor=i})(Ji||(Ji={}));var oi;(t=>{function e(l,c){if(Ri=(c.rgba&255)/255,Ri===1)return{css:c.css,rgba:c.rgba};let u=c.rgba>>24&255,d=c.rgba>>16&255,p=c.rgba>>8&255,m=l.rgba>>24&255,g=l.rgba>>16&255,_=l.rgba>>8&255;br=m+Math.round((u-m)*Ri),wr=g+Math.round((d-g)*Ri),Er=_+Math.round((p-_)*Ri);let y=Ji.toCss(br,wr,Er),v=Ji.toRgba(br,wr,Er);return{css:y,rgba:v}}t.blend=e;function n(l){return(l.rgba&255)===255}t.isOpaque=n;function i(l,c,u){let d=bw.ensureContrastRatio(l.rgba,c.rgba,u);if(d)return Ji.toColor(d>>24&255,d>>16&255,d>>8&255)}t.ensureContrastRatio=i;function r(l){let c=(l.rgba|255)>>>0;return[br,wr,Er]=bw.toChannels(c),{css:Ji.toCss(br,wr,Er),rgba:c}}t.opaque=r;function s(l,c){return Ri=Math.round(c*255),[br,wr,Er]=bw.toChannels(l.rgba),{css:Ji.toCss(br,wr,Er,Ri),rgba:Ji.toRgba(br,wr,Er,Ri)}}t.opacity=s;function o(l,c){return Ri=l.rgba&255,s(l,Ri*c/255)}t.multiplyOpacity=o;function a(l){return[l.rgba>>24&255,l.rgba>>16&255,l.rgba>>8&255]}t.toColorRGB=a})(oi||(oi={}));var Ci;(t=>{let e,n;try{let r=document.createElement("canvas");r.width=1,r.height=1;let s=r.getContext("2d",{willReadFrequently:!0});s&&(e=s,e.globalCompositeOperation="copy",n=e.createLinearGradient(0,0,1,1))}catch{}function i(r){if(r.match(/#[\da-f]{3,8}/i))switch(r.length){case 4:return br=parseInt(r.slice(1,2).repeat(2),16),wr=parseInt(r.slice(2,3).repeat(2),16),Er=parseInt(r.slice(3,4).repeat(2),16),Ji.toColor(br,wr,Er);case 5:return br=parseInt(r.slice(1,2).repeat(2),16),wr=parseInt(r.slice(2,3).repeat(2),16),Er=parseInt(r.slice(3,4).repeat(2),16),Ri=parseInt(r.slice(4,5).repeat(2),16),Ji.toColor(br,wr,Er,Ri);case 7:return{css:r,rgba:(parseInt(r.slice(1),16)<<8|255)>>>0};case 9:return{css:r,rgba:parseInt(r.slice(1),16)>>>0}}let s=r.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(s)return br=parseInt(s[1]),wr=parseInt(s[2]),Er=parseInt(s[3]),Ri=Math.round((s[5]===void 0?1:parseFloat(s[5]))*255),Ji.toColor(br,wr,Er,Ri);if(!e||!n)throw new Error("css.toColor: Unsupported css format");if(e.fillStyle=n,e.fillStyle=r,typeof e.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(e.fillRect(0,0,1,1),[br,wr,Er,Ri]=e.getImageData(0,0,1,1).data,Ri!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:Ji.toRgba(br,wr,Er,Ri),css:r}}t.toColor=i})(Ci||(Ci={}));var As;(t=>{function e(i){return n(i>>16&255,i>>8&255,i&255)}t.relativeLuminance=e;function n(i,r,s){let o=i/255,a=r/255,l=s/255,c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),u=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),d=l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4);return c*.2126+u*.7152+d*.0722}t.relativeLuminance2=n})(As||(As={}));var bw;(t=>{function e(o,a){if(Ri=(a&255)/255,Ri===1)return a;let l=a>>24&255,c=a>>16&255,u=a>>8&255,d=o>>24&255,p=o>>16&255,m=o>>8&255;return br=d+Math.round((l-d)*Ri),wr=p+Math.round((c-p)*Ri),Er=m+Math.round((u-m)*Ri),Ji.toRgba(br,wr,Er)}t.blend=e;function n(o,a,l){let c=As.relativeLuminance(o>>8),u=As.relativeLuminance(a>>8);if(xc(c,u)<l){if(u<c){let m=i(o,a,l),g=xc(c,As.relativeLuminance(m>>8));if(g<l){let _=r(o,a,l),y=xc(c,As.relativeLuminance(_>>8));return g>y?m:_}return m}let d=r(o,a,l),p=xc(c,As.relativeLuminance(d>>8));if(p<l){let m=i(o,a,l),g=xc(c,As.relativeLuminance(m>>8));return p>g?d:m}return d}}t.ensureContrastRatio=n;function i(o,a,l){let c=o>>24&255,u=o>>16&255,d=o>>8&255,p=a>>24&255,m=a>>16&255,g=a>>8&255,_=xc(As.relativeLuminance2(p,m,g),As.relativeLuminance2(c,u,d));for(;_<l&&(p>0||m>0||g>0);)p-=Math.max(0,Math.ceil(p*.1)),m-=Math.max(0,Math.ceil(m*.1)),g-=Math.max(0,Math.ceil(g*.1)),_=xc(As.relativeLuminance2(p,m,g),As.relativeLuminance2(c,u,d));return(p<<24|m<<16|g<<8|255)>>>0}t.reduceLuminance=i;function r(o,a,l){let c=o>>24&255,u=o>>16&255,d=o>>8&255,p=a>>24&255,m=a>>16&255,g=a>>8&255,_=xc(As.relativeLuminance2(p,m,g),As.relativeLuminance2(c,u,d));for(;_<l&&(p<255||m<255||g<255);)p=Math.min(255,p+Math.ceil((255-p)*.1)),m=Math.min(255,m+Math.ceil((255-m)*.1)),g=Math.min(255,g+Math.ceil((255-g)*.1)),_=xc(As.relativeLuminance2(p,m,g),As.relativeLuminance2(c,u,d));return(p<<24|m<<16|g<<8|255)>>>0}t.increaseLuminance=r;function s(o){return[o>>24&255,o>>16&255,o>>8&255,o&255]}t.toChannels=s})(bw||(bw={}));function bd(t){let e=t.toString(16);return e.length<2?"0"+e:e}function xc(t,e){return t<e?(e+.05)/(t+.05):(t+.05)/(e+.05)}var JZ=class extends F_{constructor(t,e,n){super(),this.content=0,this.combinedData="",this.fg=t.fg,this.bg=t.bg,this.combinedData=e,this._width=n}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(t){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},kw=class{constructor(t){this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new ca}register(t){let e={id:this._nextCharacterJoinerId++,handler:t};return this._characterJoiners.push(e),e.id}deregister(t){for(let e=0;e<this._characterJoiners.length;e++)if(this._characterJoiners[e].id===t)return this._characterJoiners.splice(e,1),!0;return!1}getJoinedCharacters(t){if(this._characterJoiners.length===0)return[];let e=this._bufferService.buffer.lines.get(t);if(!e||e.length===0)return[];let n=[],i=e.translateToString(!0),r=0,s=0,o=0,a=e.getFg(0),l=e.getBg(0);for(let c=0;c<e.getTrimmedLength();c++)if(e.loadCell(c,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==a||this._workCell.bg!==l){if(c-r>1){let u=this._getJoinedRanges(i,o,s,e,r);for(let d=0;d<u.length;d++)n.push(u[d])}r=c,o=s,a=this._workCell.fg,l=this._workCell.bg}s+=this._workCell.getChars().length||Ku.length}if(this._bufferService.cols-r>1){let c=this._getJoinedRanges(i,o,s,e,r);for(let u=0;u<c.length;u++)n.push(c[u])}return n}_getJoinedRanges(t,e,n,i,r){let s=t.substring(e,n),o=[];try{o=this._characterJoiners[0].handler(s)}catch(a){console.error(a)}for(let a=1;a<this._characterJoiners.length;a++)try{let l=this._characterJoiners[a].handler(s);for(let c=0;c<l.length;c++)kw._mergeRanges(o,l[c])}catch(l){console.error(l)}return this._stringRangesToCellRanges(o,i,r),o}_stringRangesToCellRanges(t,e,n){let i=0,r=!1,s=0,o=t[i];if(o){for(let a=n;a<this._bufferService.cols;a++){let l=e.getWidth(a),c=e.getString(a).length||Ku.length;if(l!==0){if(!r&&o[0]<=s&&(o[0]=a,r=!0),o[1]<=s){if(o[1]=a,o=t[++i],!o)break;o[0]<=s?(o[0]=a,r=!0):r=!1}s+=c}}o&&(o[1]=this._bufferService.cols)}}static _mergeRanges(t,e){let n=!1;for(let i=0;i<t.length;i++){let r=t[i];if(n){if(e[1]<=r[0])return t[i-1][1]=e[1],t;if(e[1]<=r[1])return t[i-1][1]=Math.max(e[1],r[1]),t.splice(i,1),t;t.splice(i,1),i--}else{if(e[1]<=r[0])return t.splice(i,0,e),t;if(e[1]<=r[1])return r[0]=Math.min(e[0],r[0]),t;e[0]<r[1]&&(r[0]=Math.min(e[0],r[0]),n=!0);continue}}return n?t[t.length-1][1]=e[1]:t.push(e),t}};kw=Ni([wt(0,ks)],kw);function ZZ(t){return 57508<=t&&t<=57558}function QZ(t){return 9472<=t&&t<=9631}function eQ(t){return ZZ(t)||QZ(t)}function tQ(){return{css:{canvas:uw(),cell:uw()},device:{canvas:uw(),cell:uw(),char:{width:0,height:0,left:0,top:0}}}}function uw(){return{width:0,height:0}}var mk=class{constructor(t,e,n,i,r,s,o){this._document=t,this._characterJoinerService=e,this._optionsService=n,this._coreBrowserService=i,this._coreService=r,this._decorationService=s,this._themeService=o,this._workCell=new ca,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(t,e,n){this._selectionStart=t,this._selectionEnd=e,this._columnSelectMode=n}createRow(t,e,n,i,r,s,o,a,l,c,u){let d=[],p=this._characterJoinerService.getJoinedCharacters(e),m=this._themeService.colors,g=t.getNoBgTrimmedLength();n&&g<s+1&&(g=s+1);let _,y=0,v="",S=0,b=0,w=0,C=0,M=!1,L=0,P=!1,T=0,A=0,I=[],F=c!==-1&&u!==-1;for(let B=0;B<g;B++){t.loadCell(B,this._workCell);let O=this._workCell.getWidth();if(O===0)continue;let z=!1,U=B>=A,G=B,j=this._workCell;if(p.length>0&&B===p[0][0]&&U){let De=p.shift(),me=this._isCellInSelection(De[0],e);for(S=De[0]+1;S<De[1];S++)U&&(U=me===this._isCellInSelection(S,e));U&&(U=!n||s<De[0]||s>=De[1]),U?(z=!0,j=new JZ(this._workCell,t.translateToString(!0,De[0],De[1]),De[1]-De[0]),G=De[1]-1,O=j.getWidth()):A=De[1]}let J=this._isCellInSelection(B,e),K=n&&B===s,D=F&&B>=c&&B<=u,X=!1;this._decorationService.forEachDecorationAtCell(B,e,void 0,De=>{X=!0});let q=j.getChars()||Ku;if(q===" "&&(j.isUnderline()||j.isOverline())&&(q="\xA0"),T=O*a-l.get(q,j.isBold(),j.isItalic()),!_)_=this._document.createElement("span");else if(y&&(J&&P||!J&&!P&&j.bg===b)&&(J&&P&&m.selectionForeground||j.fg===w)&&j.extended.ext===C&&D===M&&T===L&&!K&&!z&&!X&&U){j.isInvisible()?v+=Ku:v+=q,y++;continue}else y&&(_.textContent=v),_=this._document.createElement("span"),y=0,v="";if(b=j.bg,w=j.fg,C=j.extended.ext,M=D,L=T,P=J,z&&s>=B&&s<=G&&(s=B),!this._coreService.isCursorHidden&&K&&this._coreService.isCursorInitialized){if(I.push("xterm-cursor"),this._coreBrowserService.isFocused)o&&I.push("xterm-cursor-blink"),I.push(i==="bar"?"xterm-cursor-bar":i==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(r)switch(r){case"outline":I.push("xterm-cursor-outline");break;case"block":I.push("xterm-cursor-block");break;case"bar":I.push("xterm-cursor-bar");break;case"underline":I.push("xterm-cursor-underline");break;default:break}}if(j.isBold()&&I.push("xterm-bold"),j.isItalic()&&I.push("xterm-italic"),j.isDim()&&I.push("xterm-dim"),j.isInvisible()?v=Ku:v=j.getChars()||Ku,j.isUnderline()&&(I.push(`xterm-underline-${j.extended.underlineStyle}`),v===" "&&(v="\xA0"),!j.isUnderlineColorDefault()))if(j.isUnderlineColorRGB())_.style.textDecorationColor=`rgb(${F_.toColorRGB(j.getUnderlineColor()).join(",")})`;else{let De=j.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&j.isBold()&&De<8&&(De+=8),_.style.textDecorationColor=m.ansi[De].css}j.isOverline()&&(I.push("xterm-overline"),v===" "&&(v="\xA0")),j.isStrikethrough()&&I.push("xterm-strikethrough"),D&&(_.style.textDecoration="underline");let ne=j.getFgColor(),re=j.getFgColorMode(),$=j.getBgColor(),ie=j.getBgColorMode(),le=!!j.isInverse();if(le){let De=ne;ne=$,$=De;let me=re;re=ie,ie=me}let Ee,ke,Pe=!1;this._decorationService.forEachDecorationAtCell(B,e,void 0,De=>{De.options.layer!=="top"&&Pe||(De.backgroundColorRGB&&(ie=50331648,$=De.backgroundColorRGB.rgba>>8&16777215,Ee=De.backgroundColorRGB),De.foregroundColorRGB&&(re=50331648,ne=De.foregroundColorRGB.rgba>>8&16777215,ke=De.foregroundColorRGB),Pe=De.options.layer==="top")}),!Pe&&J&&(Ee=this._coreBrowserService.isFocused?m.selectionBackgroundOpaque:m.selectionInactiveBackgroundOpaque,$=Ee.rgba>>8&16777215,ie=50331648,Pe=!0,m.selectionForeground&&(re=50331648,ne=m.selectionForeground.rgba>>8&16777215,ke=m.selectionForeground)),Pe&&I.push("xterm-decoration-top");let Te;switch(ie){case 16777216:case 33554432:Te=m.ansi[$],I.push(`xterm-bg-${$}`);break;case 50331648:Te=Ji.toColor($>>16,$>>8&255,$&255),this._addStyle(_,`background-color:#${B5(($>>>0).toString(16),"0",6)}`);break;default:le?(Te=m.foreground,I.push("xterm-bg-257")):Te=m.background}switch(Ee||j.isDim()&&(Ee=oi.multiplyOpacity(Te,.5)),re){case 16777216:case 33554432:j.isBold()&&ne<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ne+=8),this._applyMinimumContrast(_,Te,m.ansi[ne],j,Ee,void 0)||I.push(`xterm-fg-${ne}`);break;case 50331648:let De=Ji.toColor(ne>>16&255,ne>>8&255,ne&255);this._applyMinimumContrast(_,Te,De,j,Ee,ke)||this._addStyle(_,`color:#${B5(ne.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(_,Te,m.foreground,j,Ee,ke)||le&&I.push("xterm-fg-257")}I.length&&(_.className=I.join(" "),I.length=0),!K&&!z&&!X&&U?y++:_.textContent=v,T!==this.defaultSpacing&&(_.style.letterSpacing=`${T}px`),d.push(_),B=G}return _&&y&&(_.textContent=v),d}_applyMinimumContrast(t,e,n,i,r,s){if(this._optionsService.rawOptions.minimumContrastRatio===1||eQ(i.getCode()))return!1;let o=this._getContrastCache(i),a;if(!r&&!s&&(a=o.getColor(e.rgba,n.rgba)),a===void 0){let l=this._optionsService.rawOptions.minimumContrastRatio/(i.isDim()?2:1);a=oi.ensureContrastRatio(r||e,s||n,l),o.setColor((r||e).rgba,(s||n).rgba,a??null)}return a?(this._addStyle(t,`color:${a.css}`),!0):!1}_getContrastCache(t){return t.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(t,e){t.setAttribute("style",`${t.getAttribute("style")||""}${e};`)}_isCellInSelection(t,e){let n=this._selectionStart,i=this._selectionEnd;return!n||!i?!1:this._columnSelectMode?n[0]<=i[0]?t>=n[0]&&e>=n[1]&&t<i[0]&&e<=i[1]:t<n[0]&&e>=n[1]&&t>=i[0]&&e<=i[1]:e>n[1]&&e<i[1]||n[1]===i[1]&&e===n[1]&&t>=n[0]&&t<i[0]||n[1]<i[1]&&e===i[1]&&t<i[0]||n[1]<i[1]&&e===n[1]&&t>=n[0]}};mk=Ni([wt(1,Sz),wt(2,Ls),wt(3,Ec),wt(4,kd),wt(5,z_),wt(6,Qp)],mk);function B5(t,e,n){for(;t.length<n;)t=e+t;return t}var nQ=class{constructor(t,e){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=t.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let n=t.createElement("span");n.classList.add("xterm-char-measure-element");let i=t.createElement("span");i.classList.add("xterm-char-measure-element"),i.style.fontWeight="bold";let r=t.createElement("span");r.classList.add("xterm-char-measure-element"),r.style.fontStyle="italic";let s=t.createElement("span");s.classList.add("xterm-char-measure-element"),s.style.fontWeight="bold",s.style.fontStyle="italic",this._measureElements=[n,i,r,s],this._container.appendChild(n),this._container.appendChild(i),this._container.appendChild(r),this._container.appendChild(s),e.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(t,e,n,i){t===this._font&&e===this._fontSize&&n===this._weight&&i===this._weightBold||(this._font=t,this._fontSize=e,this._weight=n,this._weightBold=i,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${n}`,this._measureElements[1].style.fontWeight=`${i}`,this._measureElements[2].style.fontWeight=`${n}`,this._measureElements[3].style.fontWeight=`${i}`,this.clear())}get(t,e,n){let i=0;if(!e&&!n&&t.length===1&&(i=t.charCodeAt(0))<256){if(this._flat[i]!==-9999)return this._flat[i];let o=this._measure(t,0);return o>0&&(this._flat[i]=o),o}let r=t;e&&(r+="B"),n&&(r+="I");let s=this._holey.get(r);if(s===void 0){let o=0;e&&(o|=1),n&&(o|=2),s=this._measure(t,o),s>0&&this._holey.set(r,s)}return s}_measure(t,e){let n=this._measureElements[e];return n.textContent=t.repeat(32),n.offsetWidth/32}},iQ=class{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(t,e,n,i=!1){if(this.selectionStart=e,this.selectionEnd=n,!e||!n||e[0]===n[0]&&e[1]===n[1]){this.clear();return}let r=t.buffers.active.ydisp,s=e[1]-r,o=n[1]-r,a=Math.max(s,0),l=Math.min(o,t.rows-1);if(a>=t.rows||l<0){this.clear();return}this.hasSelection=!0,this.columnSelectMode=i,this.viewportStartRow=s,this.viewportEndRow=o,this.viewportCappedStartRow=a,this.viewportCappedEndRow=l,this.startCol=e[0],this.endCol=n[0]}isCellSelected(t,e,n){return this.hasSelection?(n-=t.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?e>=this.startCol&&n>=this.viewportCappedStartRow&&e<this.endCol&&n<=this.viewportCappedEndRow:e<this.startCol&&n>=this.viewportCappedStartRow&&e>=this.endCol&&n<=this.viewportCappedEndRow:n>this.viewportStartRow&&n<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&n===this.viewportStartRow&&e>=this.startCol&&e<this.endCol||this.viewportStartRow<this.viewportEndRow&&n===this.viewportEndRow&&e<this.endCol||this.viewportStartRow<this.viewportEndRow&&n===this.viewportStartRow&&e>=this.startCol):!1}};function rQ(){return new iQ}var U3="xterm-dom-renderer-owner-",oa="xterm-rows",hw="xterm-fg-",U5="xterm-bg-",b_="xterm-focus",dw="xterm-selection",sQ=1,gk=class extends rn{constructor(t,e,n,i,r,s,o,a,l,c,u,d,p,m){super(),this._terminal=t,this._document=e,this._element=n,this._screenElement=i,this._viewportElement=r,this._helperContainer=s,this._linkifier2=o,this._charSizeService=l,this._optionsService=c,this._bufferService=u,this._coreService=d,this._coreBrowserService=p,this._themeService=m,this._terminalClass=sQ++,this._rowElements=[],this._selectionRenderModel=rQ(),this.onRequestRedraw=this._register(new st).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(oa),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(dw),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=tQ(),this._updateDimensions(),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._themeService.onChangeColors(g=>this._injectCss(g))),this._injectCss(this._themeService.colors),this._rowFactory=a.createInstance(mk,document),this._element.classList.add(U3+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this._register(this._linkifier2.onShowLinkUnderline(g=>this._handleLinkHover(g))),this._register(this._linkifier2.onHideLinkUnderline(g=>this._handleLinkLeave(g))),this._register(ai(()=>{this._element.classList.remove(U3+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new nQ(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let t=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*t,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*t),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/t),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/t),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let n of this._rowElements)n.style.width=`${this.dimensions.css.canvas.width}px`,n.style.height=`${this.dimensions.css.cell.height}px`,n.style.lineHeight=`${this.dimensions.css.cell.height}px`,n.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let e=`${this._terminalSelector} .${oa} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=e,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(t){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let e=`${this._terminalSelector} .${oa} { pointer-events: none; color: ${t.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;e+=`${this._terminalSelector} .${oa} .xterm-dim { color: ${oi.multiplyOpacity(t.foreground,.5).css};}`,e+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;let n=`blink_underline_${this._terminalClass}`,i=`blink_bar_${this._terminalClass}`,r=`blink_block_${this._terminalClass}`;e+=`@keyframes ${n} { 50% {  border-bottom-style: hidden; }}`,e+=`@keyframes ${i} { 50% {  box-shadow: none; }}`,e+=`@keyframes ${r} { 0% {  background-color: ${t.cursor.css};  color: ${t.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${t.cursor.css}; }}`,e+=`${this._terminalSelector} .${oa}.${b_} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${n} 1s step-end infinite;}${this._terminalSelector} .${oa}.${b_} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${i} 1s step-end infinite;}${this._terminalSelector} .${oa}.${b_} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${r} 1s step-end infinite;}${this._terminalSelector} .${oa} .xterm-cursor.xterm-cursor-block { background-color: ${t.cursor.css}; color: ${t.cursorAccent.css};}${this._terminalSelector} .${oa} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${t.cursor.css} !important; color: ${t.cursorAccent.css} !important;}${this._terminalSelector} .${oa} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${t.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${oa} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${t.cursor.css} inset;}${this._terminalSelector} .${oa} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${t.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,e+=`${this._terminalSelector} .${dw} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${dw} div { position: absolute; background-color: ${t.selectionBackgroundOpaque.css};}${this._terminalSelector} .${dw} div { position: absolute; background-color: ${t.selectionInactiveBackgroundOpaque.css};}`;for(let[s,o]of t.ansi.entries())e+=`${this._terminalSelector} .${hw}${s} { color: ${o.css}; }${this._terminalSelector} .${hw}${s}.xterm-dim { color: ${oi.multiplyOpacity(o,.5).css}; }${this._terminalSelector} .${U5}${s} { background-color: ${o.css}; }`;e+=`${this._terminalSelector} .${hw}257 { color: ${oi.opaque(t.background).css}; }${this._terminalSelector} .${hw}257.xterm-dim { color: ${oi.multiplyOpacity(oi.opaque(t.background),.5).css}; }${this._terminalSelector} .${U5}257 { background-color: ${t.foreground.css}; }`,this._themeStyleElement.textContent=e}_setDefaultSpacing(){let t=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${t}px`,this._rowFactory.defaultSpacing=t}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(t,e){for(let n=this._rowElements.length;n<=e;n++){let i=this._document.createElement("div");this._rowContainer.appendChild(i),this._rowElements.push(i)}for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(t,e){this._refreshRowElements(t,e),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(b_),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(b_),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(t,e,n){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(t,e,n),this.renderRows(0,this._bufferService.rows-1),!t||!e||(this._selectionRenderModel.update(this._terminal,t,e,n),!this._selectionRenderModel.hasSelection))return;let i=this._selectionRenderModel.viewportStartRow,r=this._selectionRenderModel.viewportEndRow,s=this._selectionRenderModel.viewportCappedStartRow,o=this._selectionRenderModel.viewportCappedEndRow,a=this._document.createDocumentFragment();if(n){let l=t[0]>e[0];a.appendChild(this._createSelectionElement(s,l?e[0]:t[0],l?t[0]:e[0],o-s+1))}else{let l=i===s?t[0]:0,c=s===r?e[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(s,l,c));let u=o-s-1;if(a.appendChild(this._createSelectionElement(s+1,0,this._bufferService.cols,u)),s!==o){let d=r===o?e[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(o,0,d))}}this._selectionContainer.appendChild(a)}_createSelectionElement(t,e,n,i=1){let r=this._document.createElement("div"),s=e*this.dimensions.css.cell.width,o=this.dimensions.css.cell.width*(n-e);return s+o>this.dimensions.css.canvas.width&&(o=this.dimensions.css.canvas.width-s),r.style.height=`${i*this.dimensions.css.cell.height}px`,r.style.top=`${t*this.dimensions.css.cell.height}px`,r.style.left=`${s}px`,r.style.width=`${o}px`,r}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let t of this._rowElements)t.replaceChildren()}renderRows(t,e){let n=this._bufferService.buffer,i=n.ybase+n.y,r=Math.min(n.x,this._bufferService.cols-1),s=this._coreService.decPrivateModes.cursorBlink??this._optionsService.rawOptions.cursorBlink,o=this._coreService.decPrivateModes.cursorStyle??this._optionsService.rawOptions.cursorStyle,a=this._optionsService.rawOptions.cursorInactiveStyle;for(let l=t;l<=e;l++){let c=l+n.ydisp,u=this._rowElements[l],d=n.lines.get(c);if(!u||!d)break;u.replaceChildren(...this._rowFactory.createRow(d,c,c===i,o,a,r,s,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${U3}${this._terminalClass}`}_handleLinkHover(t){this._setCellUnderline(t.x1,t.x2,t.y1,t.y2,t.cols,!0)}_handleLinkLeave(t){this._setCellUnderline(t.x1,t.x2,t.y1,t.y2,t.cols,!1)}_setCellUnderline(t,e,n,i,r,s){n<0&&(t=0),i<0&&(e=0);let o=this._bufferService.rows-1;n=Math.max(Math.min(n,o),0),i=Math.max(Math.min(i,o),0),r=Math.min(r,this._bufferService.cols);let a=this._bufferService.buffer,l=a.ybase+a.y,c=Math.min(a.x,r-1),u=this._optionsService.rawOptions.cursorBlink,d=this._optionsService.rawOptions.cursorStyle,p=this._optionsService.rawOptions.cursorInactiveStyle;for(let m=n;m<=i;++m){let g=m+a.ydisp,_=this._rowElements[m],y=a.lines.get(g);if(!_||!y)break;_.replaceChildren(...this._rowFactory.createRow(y,g,g===l,d,p,c,u,this.dimensions.css.cell.width,this._widthCache,s?m===n?t:0:-1,s?(m===i?e:r)-1:-1))}}};gk=Ni([wt(7,Lk),wt(8,Rw),wt(9,Ls),wt(10,ks),wt(11,kd),wt(12,Ec),wt(13,Qp)],gk);var vk=class extends rn{constructor(t,e,n){super(),this._optionsService=n,this.width=0,this.height=0,this._onCharSizeChange=this._register(new st),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this._register(new aQ(this._optionsService))}catch{this._measureStrategy=this._register(new oQ(t,e,this._optionsService))}this._register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let t=this._measureStrategy.measure();(t.width!==this.width||t.height!==this.height)&&(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};vk=Ni([wt(2,Ls)],vk);var Kz=class extends rn{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(t,e){t!==void 0&&t>0&&e!==void 0&&e>0&&(this._result.width=t,this._result.height=e)}},oQ=class extends Kz{constructor(t,e,n){super(),this._document=t,this._parentElement=e,this._optionsService=n,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}},aQ=class extends Kz{constructor(t){super(),this._optionsService=t,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");let e=this._ctx.measureText("W");if(!("width"in e&&"fontBoundingBoxAscent"in e&&"fontBoundingBoxDescent"in e))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;let t=this._ctx.measureText("W");return this._validateAndSet(t.width,t.fontBoundingBoxAscent+t.fontBoundingBoxDescent),this._result}},lQ=class extends rn{constructor(t,e,n){super(),this._textarea=t,this._window=e,this.mainDocument=n,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=this._register(new cQ(this._window)),this._onDprChange=this._register(new st),this.onDprChange=this._onDprChange.event,this._onWindowChange=this._register(new st),this.onWindowChange=this._onWindowChange.event,this._register(this.onWindowChange(i=>this._screenDprMonitor.setWindow(i))),this._register(Fr.forward(this._screenDprMonitor.onDprChange,this._onDprChange)),this._register(Gt(this._textarea,"focus",()=>this._isFocused=!0)),this._register(Gt(this._textarea,"blur",()=>this._isFocused=!1))}get window(){return this._window}set window(t){this._window!==t&&(this._window=t,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}},cQ=class extends rn{constructor(t){super(),this._parentWindow=t,this._windowResizeListener=this._register(new Zp),this._onDprChange=this._register(new st),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this._register(ai(()=>this.clearListener()))}setWindow(t){this._parentWindow=t,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=Gt(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){!this._resolutionMediaMatchList||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}},uQ=class extends rn{constructor(){super(),this.linkProviders=[],this._register(ai(()=>this.linkProviders.length=0))}registerLinkProvider(t){return this.linkProviders.push(t),{dispose:()=>{let e=this.linkProviders.indexOf(t);e!==-1&&this.linkProviders.splice(e,1)}}}};function Uk(t,e,n){let i=n.getBoundingClientRect(),r=t.getComputedStyle(n),s=parseInt(r.getPropertyValue("padding-left")),o=parseInt(r.getPropertyValue("padding-top"));return[e.clientX-i.left-s,e.clientY-i.top-o]}function hQ(t,e,n,i,r,s,o,a,l){if(!s)return;let c=Uk(t,e,n);if(c)return c[0]=Math.ceil((c[0]+(l?o/2:0))/o),c[1]=Math.ceil(c[1]/a),c[0]=Math.min(Math.max(c[0],1),i+(l?1:0)),c[1]=Math.min(Math.max(c[1],1),r),c}var _k=class{constructor(t,e){this._renderService=t,this._charSizeService=e}getCoords(t,e,n,i,r){return hQ(window,t,e,n,i,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,r)}getMouseReportCoords(t,e){let n=Uk(window,t,e);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};_k=Ni([wt(0,Cc),wt(1,Rw)],_k);var dQ=class{constructor(t,e){this._renderCallback=t,this._coreBrowserService=e,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(t){return this._refreshCallbacks.push(t),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(t,e,n){this._rowCount=n,t=t!==void 0?t:0,e=e!==void 0?e:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,e):e,!this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0){this._runRefreshCallbacks();return}let t=Math.max(this._rowStart,0),e=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,e),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let t of this._refreshCallbacks)t(0);this._refreshCallbacks=[]}},$z={};K$($z,{getSafariVersion:()=>pQ,isChromeOS:()=>e6,isFirefox:()=>Jz,isIpad:()=>mQ,isIphone:()=>gQ,isLegacyEdge:()=>fQ,isLinux:()=>Fk,isMac:()=>Lw,isNode:()=>Bw,isSafari:()=>Zz,isWindows:()=>Qz});var Bw=typeof process<"u"&&"title"in process,H_=Bw?"node":navigator.userAgent,W_=Bw?"node":navigator.platform,Jz=H_.includes("Firefox"),fQ=H_.includes("Edge"),Zz=/^((?!chrome|android).)*safari/i.test(H_);function pQ(){if(!Zz)return 0;let t=H_.match(/Version\/(\d+)/);return t===null||t.length<2?0:parseInt(t[1])}var Lw=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(W_),mQ=W_==="iPad",gQ=W_==="iPhone",Qz=["Windows","Win16","Win32","WinCE"].includes(W_),Fk=W_.indexOf("Linux")>=0,e6=/\bCrOS\b/.test(H_),t6=class{constructor(){this._tasks=[],this._i=0}enqueue(t){this._tasks.push(t),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(t){this._idleCallback=void 0;let e=0,n=0,i=t.timeRemaining(),r=0;for(;this._i<this._tasks.length;){if(e=performance.now(),this._tasks[this._i]()||this._i++,e=Math.max(1,performance.now()-e),n=Math.max(e,n),r=t.timeRemaining(),n*1.5>r){i-e<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(i-e))}ms`),this._start();return}i=r}this.clear()}},vQ=class extends t6{_requestCallback(t){return setTimeout(()=>t(this._createDeadline(16)))}_cancelCallback(t){clearTimeout(t)}_createDeadline(t){let e=performance.now()+t;return{timeRemaining:()=>Math.max(0,e-performance.now())}}},_Q=class extends t6{_requestCallback(t){return requestIdleCallback(t)}_cancelCallback(t){cancelIdleCallback(t)}},Pw=!Bw&&"requestIdleCallback"in window?_Q:vQ,yQ=class{constructor(){this._queue=new Pw}set(t){this._queue.clear(),this._queue.enqueue(t)}flush(){this._queue.flush()}},yk=class extends rn{constructor(t,e,n,i,r,s,o,a,l){super(),this._rowCount=t,this._optionsService=n,this._charSizeService=i,this._coreService=r,this._coreBrowserService=a,this._renderer=this._register(new Zp),this._pausedResizeTask=new yQ,this._observerDisposable=this._register(new Zp),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this._register(new st),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this._register(new st),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this._register(new st),this.onRender=this._onRender.event,this._onRefreshRequest=this._register(new st),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new dQ((c,u)=>this._renderRows(c,u),this._coreBrowserService),this._register(this._renderDebouncer),this._syncOutputHandler=new xQ(this._coreBrowserService,this._coreService,()=>this._fullRefresh()),this._register(ai(()=>this._syncOutputHandler.dispose())),this._register(this._coreBrowserService.onDprChange(()=>this.handleDevicePixelRatioChange())),this._register(o.onResize(()=>this._fullRefresh())),this._register(o.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this._register(s.onDecorationRegistered(()=>this._fullRefresh())),this._register(s.onDecorationRemoved(()=>this._fullRefresh())),this._register(this._optionsService.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(o.cols,o.rows),this._fullRefresh()})),this._register(this._optionsService.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(o.buffer.y,o.buffer.y,!0))),this._register(l.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(this._coreBrowserService.window,e),this._register(this._coreBrowserService.onWindowChange(c=>this._registerIntersectionObserver(c,e)))}get dimensions(){return this._renderer.value.dimensions}_registerIntersectionObserver(t,e){if("IntersectionObserver"in t){let n=new t.IntersectionObserver(i=>this._handleIntersectionChange(i[i.length-1]),{threshold:0});n.observe(e),this._observerDisposable.value=ai(()=>n.disconnect())}}_handleIntersectionChange(t){this._isPaused=t.isIntersecting===void 0?t.intersectionRatio===0:!t.isIntersecting,!this._isPaused&&!this._charSizeService.hasValidSize&&this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(t,e,n=!1){if(this._isPaused){this._needsFullRefresh=!0;return}if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(t,e);return}let i=this._syncOutputHandler.flush();i&&(t=Math.min(t,i.start),e=Math.max(e,i.end)),n||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(t,e,this._rowCount)}_renderRows(t,e){if(this._renderer.value){if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(t,e);return}t=Math.min(t,this._rowCount-1),e=Math.min(e,this._rowCount-1),this._renderer.value.renderRows(t,e),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:t,end:e}),this._onRender.fire({start:t,end:e}),this._isNextRenderRedrawOnly=!0}}resize(t,e){this._rowCount=e,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(t){this._renderer.value=t,this._renderer.value&&(this._renderer.value.onRequestRedraw(e=>this.refreshRows(e.start,e.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(t){return this._renderDebouncer.addRefreshCallback(t)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(t,e){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(t,e)):this._renderer.value.handleResize(t,e),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(t,e,n){this._selectionState.start=t,this._selectionState.end=e,this._selectionState.columnSelectMode=n,this._renderer.value?.handleSelectionChanged(t,e,n)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};yk=Ni([wt(2,Ls),wt(3,Rw),wt(4,kd),wt(5,z_),wt(6,ks),wt(7,Ec),wt(8,Qp)],yk);var xQ=class{constructor(t,e,n){this._coreBrowserService=t,this._coreService=e,this._onTimeout=n,this._start=0,this._end=0,this._isBuffering=!1}bufferRows(t,e){this._isBuffering?(this._start=Math.min(this._start,t),this._end=Math.max(this._end,e)):(this._start=t,this._end=e,this._isBuffering=!0),this._timeout===void 0&&(this._timeout=this._coreBrowserService.window.setTimeout(()=>{this._timeout=void 0,this._coreService.decPrivateModes.synchronizedOutput=!1,this._onTimeout()},1e3))}flush(){if(this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0),!this._isBuffering)return;let t={start:this._start,end:this._end};return this._isBuffering=!1,t}dispose(){this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0)}};function SQ(t,e,n,i){let r=n.buffer.x,s=n.buffer.y;if(!n.buffer.hasScrollback)return EQ(r,s,t,e,n,i)+Uw(s,e,n,i)+CQ(r,s,t,e,n,i);let o;if(s===e)return o=r>t?"D":"C",B_(Math.abs(r-t),O_(o,i));o=s>e?"D":"C";let a=Math.abs(s-e),l=wQ(s>e?t:r,n)+(a-1)*n.cols+1+bQ(s>e?r:t,n);return B_(l,O_(o,i))}function bQ(t,e){return t-1}function wQ(t,e){return e.cols-t}function EQ(t,e,n,i,r,s){return Uw(e,i,r,s).length===0?"":B_(i6(t,e,t,e-Ad(e,r),!1,r).length,O_("D",s))}function Uw(t,e,n,i){let r=t-Ad(t,n),s=e-Ad(e,n),o=Math.abs(r-s)-TQ(t,e,n);return B_(o,O_(n6(t,e),i))}function CQ(t,e,n,i,r,s){let o;Uw(e,i,r,s).length>0?o=i-Ad(i,r):o=e;let a=i,l=MQ(t,e,n,i,r,s);return B_(i6(t,o,n,a,l==="C",r).length,O_(l,s))}function TQ(t,e,n){let i=0,r=t-Ad(t,n),s=e-Ad(e,n);for(let o=0;o<Math.abs(r-s);o++){let a=n6(t,e)==="A"?-1:1;n.buffer.lines.get(r+a*o)?.isWrapped&&i++}return i}function Ad(t,e){let n=0,i=e.buffer.lines.get(t),r=i?.isWrapped;for(;r&&t>=0&&t<e.rows;)n++,i=e.buffer.lines.get(--t),r=i?.isWrapped;return n}function MQ(t,e,n,i,r,s){let o;return Uw(n,i,r,s).length>0?o=i-Ad(i,r):o=e,t<n&&o<=i||t>=n&&o<i?"C":"D"}function n6(t,e){return t>e?"A":"B"}function i6(t,e,n,i,r,s){let o=t,a=e,l="";for(;(o!==n||a!==i)&&a>=0&&a<s.buffer.lines.length;)o+=r?1:-1,r&&o>s.cols-1?(l+=s.buffer.translateBufferLineToString(a,!1,t,o),o=0,t=0,a++):!r&&o<0&&(l+=s.buffer.translateBufferLineToString(a,!1,0,t+1),o=s.cols-1,t=o,a--);return l+s.buffer.translateBufferLineToString(a,!1,t,o)}function O_(t,e){let n=e?"O":"[";return qe.ESC+n+t}function B_(t,e){t=Math.floor(t);let n="";for(let i=0;i<t;i++)n+=e;return n}var AQ=class{constructor(t){this._bufferService=t,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:!this.selectionEnd||!this.selectionStart?this.selectionStart:this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?t%this._bufferService.cols===0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)-1]:[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[t,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[Math.max(t,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let t=this.selectionStart,e=this.selectionEnd;return!t||!e?!1:t[1]>e[1]||t[1]===e[1]&&t[0]>e[0]}handleTrim(t){return this.selectionStart&&(this.selectionStart[1]-=t),this.selectionEnd&&(this.selectionEnd[1]-=t),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}};function F5(t,e){if(t.start.y>t.end.y)throw new Error(`Buffer range end (${t.end.x}, ${t.end.y}) cannot be before start (${t.start.x}, ${t.start.y})`);return e*(t.end.y-t.start.y)+(t.end.x-t.start.x+1)}var F3=50,kQ=15,LQ=50,PQ=500,DQ="\xA0",IQ=new RegExp(DQ,"g"),xk=class extends rn{constructor(t,e,n,i,r,s,o,a,l){super(),this._element=t,this._screenElement=e,this._linkifier=n,this._bufferService=i,this._coreService=r,this._mouseService=s,this._optionsService=o,this._renderService=a,this._coreBrowserService=l,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new ca,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this._register(new st),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this._register(new st),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this._register(new st),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this._register(new st),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=c=>this._handleMouseMove(c),this._mouseUpListener=c=>this._handleMouseUp(c),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(c=>this._handleTrim(c)),this._register(this._bufferService.buffers.onBufferActivate(c=>this._handleBufferActivate(c))),this.enable(),this._model=new AQ(this._bufferService),this._activeSelectionMode=0,this._register(ai(()=>{this._removeMouseDownListeners()})),this._register(this._bufferService.onResize(c=>{c.rowsChanged&&this.clearSelection()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let t=this._model.finalSelectionStart,e=this._model.finalSelectionEnd;return!t||!e?!1:t[0]!==e[0]||t[1]!==e[1]}get selectionText(){let t=this._model.finalSelectionStart,e=this._model.finalSelectionEnd;if(!t||!e)return"";let n=this._bufferService.buffer,i=[];if(this._activeSelectionMode===3){if(t[0]===e[0])return"";let r=t[0]<e[0]?t[0]:e[0],s=t[0]<e[0]?e[0]:t[0];for(let o=t[1];o<=e[1];o++){let a=n.translateBufferLineToString(o,!0,r,s);i.push(a)}}else{let r=t[1]===e[1]?e[0]:void 0;i.push(n.translateBufferLineToString(t[1],!0,t[0],r));for(let s=t[1]+1;s<=e[1]-1;s++){let o=n.lines.get(s),a=n.translateBufferLineToString(s,!0);o?.isWrapped?i[i.length-1]+=a:i.push(a)}if(t[1]!==e[1]){let s=n.lines.get(e[1]),o=n.translateBufferLineToString(e[1],!0,0,e[0]);s&&s.isWrapped?i[i.length-1]+=o:i.push(o)}}return i.map(r=>r.replace(IQ," ")).join(Qz?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(t){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),Fk&&t&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(t){let e=this._getMouseBufferCoords(t),n=this._model.finalSelectionStart,i=this._model.finalSelectionEnd;return!n||!i||!e?!1:this._areCoordsInSelection(e,n,i)}isCellInSelection(t,e){let n=this._model.finalSelectionStart,i=this._model.finalSelectionEnd;return!n||!i?!1:this._areCoordsInSelection([t,e],n,i)}_areCoordsInSelection(t,e,n){return t[1]>e[1]&&t[1]<n[1]||e[1]===n[1]&&t[1]===e[1]&&t[0]>=e[0]&&t[0]<n[0]||e[1]<n[1]&&t[1]===n[1]&&t[0]<n[0]||e[1]<n[1]&&t[1]===e[1]&&t[0]>=e[0]}_selectWordAtCursor(t,e){let n=this._linkifier.currentLink?.link?.range;if(n)return this._model.selectionStart=[n.start.x-1,n.start.y-1],this._model.selectionStartLength=F5(n,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let i=this._getMouseBufferCoords(t);return i?(this._selectWordAt(i,e),this._model.selectionEnd=void 0,!0):!1}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(t,e){this._model.clearSelection(),t=Math.max(t,0),e=Math.min(e,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,t],this._model.selectionEnd=[this._bufferService.cols,e],this.refresh(),this._onSelectionChange.fire()}_handleTrim(t){this._model.handleTrim(t)&&this.refresh()}_getMouseBufferCoords(t){let e=this._mouseService.getCoords(t,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(e)return e[0]--,e[1]--,e[1]+=this._bufferService.buffer.ydisp,e}_getMouseEventScrollAmount(t){let e=Uk(this._coreBrowserService.window,t,this._screenElement)[1],n=this._renderService.dimensions.css.canvas.height;return e>=0&&e<=n?0:(e>n&&(e-=n),e=Math.min(Math.max(e,-F3),F3),e/=F3,e/Math.abs(e)+Math.round(e*(kQ-1)))}shouldForceSelection(t){return Lw?t.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:t.shiftKey}handleMouseDown(t){if(this._mouseDownTimeStamp=t.timeStamp,!(t.button===2&&this.hasSelection)&&t.button===0){if(!this._enabled){if(!this.shouldForceSelection(t))return;t.stopPropagation()}t.preventDefault(),this._dragScrollAmount=0,this._enabled&&t.shiftKey?this._handleIncrementalClick(t):t.detail===1?this._handleSingleClick(t):t.detail===2?this._handleDoubleClick(t):t.detail===3&&this._handleTripleClick(t),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),LQ)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(t){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(t))}_handleSingleClick(t){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(t)?3:0,this._model.selectionStart=this._getMouseBufferCoords(t),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let e=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);e&&e.length!==this._model.selectionStart[0]&&e.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(t){this._selectWordAtCursor(t,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(t){let e=this._getMouseBufferCoords(t);e&&(this._activeSelectionMode=2,this._selectLineAt(e[1]))}shouldColumnSelect(t){return t.altKey&&!(Lw&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(t){if(t.stopImmediatePropagation(),!this._model.selectionStart)return;let e=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(t),!this._model.selectionEnd){this.refresh(!0);return}this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(t),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let n=this._bufferService.buffer;if(this._model.selectionEnd[1]<n.lines.length){let i=n.lines.get(this._model.selectionEnd[1]);i&&i.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}(!e||e[0]!==this._model.selectionEnd[0]||e[1]!==this._model.selectionEnd[1])&&this.refresh(!0)}_dragScroll(){if(!(!this._model.selectionEnd||!this._model.selectionStart)&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let t=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(t.ydisp+this._bufferService.rows,t.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=t.ydisp),this.refresh()}}_handleMouseUp(t){let e=t.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&e<PQ&&t.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let n=this._mouseService.getCoords(t,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(n&&n[0]!==void 0&&n[1]!==void 0){let i=SQ(n[0]-1,n[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(i,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let t=this._model.finalSelectionStart,e=this._model.finalSelectionEnd,n=!!t&&!!e&&(t[0]!==e[0]||t[1]!==e[1]);if(!n){this._oldHasSelection&&this._fireOnSelectionChange(t,e,n);return}!t||!e||(!this._oldSelectionStart||!this._oldSelectionEnd||t[0]!==this._oldSelectionStart[0]||t[1]!==this._oldSelectionStart[1]||e[0]!==this._oldSelectionEnd[0]||e[1]!==this._oldSelectionEnd[1])&&this._fireOnSelectionChange(t,e,n)}_fireOnSelectionChange(t,e,n){this._oldSelectionStart=t,this._oldSelectionEnd=e,this._oldHasSelection=n,this._onSelectionChange.fire()}_handleBufferActivate(t){this.clearSelection(),this._trimListener.dispose(),this._trimListener=t.activeBuffer.lines.onTrim(e=>this._handleTrim(e))}_convertViewportColToCharacterIndex(t,e){let n=e;for(let i=0;e>=i;i++){let r=t.loadCell(i,this._workCell).getChars().length;this._workCell.getWidth()===0?n--:r>1&&e!==i&&(n+=r-1)}return n}setSelection(t,e,n){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[t,e],this._model.selectionStartLength=n,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(t){this._isClickInSelection(t)||(this._selectWordAtCursor(t,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(t,e,n=!0,i=!0){if(t[0]>=this._bufferService.cols)return;let r=this._bufferService.buffer,s=r.lines.get(t[1]);if(!s)return;let o=r.translateBufferLineToString(t[1],!1),a=this._convertViewportColToCharacterIndex(s,t[0]),l=a,c=t[0]-a,u=0,d=0,p=0,m=0;if(o.charAt(a)===" "){for(;a>0&&o.charAt(a-1)===" ";)a--;for(;l<o.length&&o.charAt(l+1)===" ";)l++}else{let y=t[0],v=t[0];s.getWidth(y)===0&&(u++,y--),s.getWidth(v)===2&&(d++,v++);let S=s.getString(v).length;for(S>1&&(m+=S-1,l+=S-1);y>0&&a>0&&!this._isCharWordSeparator(s.loadCell(y-1,this._workCell));){s.loadCell(y-1,this._workCell);let b=this._workCell.getChars().length;this._workCell.getWidth()===0?(u++,y--):b>1&&(p+=b-1,a-=b-1),a--,y--}for(;v<s.length&&l+1<o.length&&!this._isCharWordSeparator(s.loadCell(v+1,this._workCell));){s.loadCell(v+1,this._workCell);let b=this._workCell.getChars().length;this._workCell.getWidth()===2?(d++,v++):b>1&&(m+=b-1,l+=b-1),l++,v++}}l++;let g=a+c-u+p,_=Math.min(this._bufferService.cols,l-a+u+d-p-m);if(!(!e&&o.slice(a,l).trim()==="")){if(n&&g===0&&s.getCodePoint(0)!==32){let y=r.lines.get(t[1]-1);if(y&&s.isWrapped&&y.getCodePoint(this._bufferService.cols-1)!==32){let v=this._getWordAt([this._bufferService.cols-1,t[1]-1],!1,!0,!1);if(v){let S=this._bufferService.cols-v.start;g-=S,_+=S}}}if(i&&g+_===this._bufferService.cols&&s.getCodePoint(this._bufferService.cols-1)!==32){let y=r.lines.get(t[1]+1);if(y?.isWrapped&&y.getCodePoint(0)!==32){let v=this._getWordAt([0,t[1]+1],!1,!1,!0);v&&(_+=v.length)}}return{start:g,length:_}}}_selectWordAt(t,e){let n=this._getWordAt(t,e);if(n){for(;n.start<0;)n.start+=this._bufferService.cols,t[1]--;this._model.selectionStart=[n.start,t[1]],this._model.selectionStartLength=n.length}}_selectToWordAt(t){let e=this._getWordAt(t,!0);if(e){let n=t[1];for(;e.start<0;)e.start+=this._bufferService.cols,n--;if(!this._model.areSelectionValuesReversed())for(;e.start+e.length>this._bufferService.cols;)e.length-=this._bufferService.cols,n++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?e.start:e.start+e.length,n]}}_isCharWordSeparator(t){return t.getWidth()===0?!1:this._optionsService.rawOptions.wordSeparator.indexOf(t.getChars())>=0}_selectLineAt(t){let e=this._bufferService.buffer.getWrappedRangeForLine(t),n={start:{x:0,y:e.first},end:{x:this._bufferService.cols-1,y:e.last}};this._model.selectionStart=[0,e.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=F5(n,this._bufferService.cols)}};xk=Ni([wt(3,ks),wt(4,kd),wt(5,Pk),wt(6,Ls),wt(7,Cc),wt(8,Ec)],xk);var z5=class{constructor(){this._data={}}set(t,e,n){this._data[t]||(this._data[t]={}),this._data[t][e]=n}get(t,e){return this._data[t]?this._data[t][e]:void 0}clear(){this._data={}}},H5=class{constructor(){this._color=new z5,this._css=new z5}setCss(t,e,n){this._css.set(t,e,n)}getCss(t,e){return this._css.get(t,e)}setColor(t,e,n){this._color.set(t,e,n)}getColor(t,e){return this._color.get(t,e)}clear(){this._color.clear(),this._css.clear()}},cr=Object.freeze((()=>{let t=[Ci.toColor("#2e3436"),Ci.toColor("#cc0000"),Ci.toColor("#4e9a06"),Ci.toColor("#c4a000"),Ci.toColor("#3465a4"),Ci.toColor("#75507b"),Ci.toColor("#06989a"),Ci.toColor("#d3d7cf"),Ci.toColor("#555753"),Ci.toColor("#ef2929"),Ci.toColor("#8ae234"),Ci.toColor("#fce94f"),Ci.toColor("#729fcf"),Ci.toColor("#ad7fa8"),Ci.toColor("#34e2e2"),Ci.toColor("#eeeeec")],e=[0,95,135,175,215,255];for(let n=0;n<216;n++){let i=e[n/36%6|0],r=e[n/6%6|0],s=e[n%6];t.push({css:Ji.toCss(i,r,s),rgba:Ji.toRgba(i,r,s)})}for(let n=0;n<24;n++){let i=8+n*10;t.push({css:Ji.toCss(i,i,i),rgba:Ji.toRgba(i,i,i)})}return t})()),wd=Ci.toColor("#ffffff"),k_=Ci.toColor("#000000"),W5=Ci.toColor("#ffffff"),V5=k_,w_={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117},RQ=wd,Sk=class extends rn{constructor(t){super(),this._optionsService=t,this._contrastCache=new H5,this._halfContrastCache=new H5,this._onChangeColors=this._register(new st),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:wd,background:k_,cursor:W5,cursorAccent:V5,selectionForeground:void 0,selectionBackgroundTransparent:w_,selectionBackgroundOpaque:oi.blend(k_,w_),selectionInactiveBackgroundTransparent:w_,selectionInactiveBackgroundOpaque:oi.blend(k_,w_),scrollbarSliderBackground:oi.opacity(wd,.2),scrollbarSliderHoverBackground:oi.opacity(wd,.4),scrollbarSliderActiveBackground:oi.opacity(wd,.5),overviewRulerBorder:wd,ansi:cr.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this._register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this._register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(t={}){let e=this._colors;if(e.foreground=Wn(t.foreground,wd),e.background=Wn(t.background,k_),e.cursor=oi.blend(e.background,Wn(t.cursor,W5)),e.cursorAccent=oi.blend(e.background,Wn(t.cursorAccent,V5)),e.selectionBackgroundTransparent=Wn(t.selectionBackground,w_),e.selectionBackgroundOpaque=oi.blend(e.background,e.selectionBackgroundTransparent),e.selectionInactiveBackgroundTransparent=Wn(t.selectionInactiveBackground,e.selectionBackgroundTransparent),e.selectionInactiveBackgroundOpaque=oi.blend(e.background,e.selectionInactiveBackgroundTransparent),e.selectionForeground=t.selectionForeground?Wn(t.selectionForeground,O5):void 0,e.selectionForeground===O5&&(e.selectionForeground=void 0),oi.isOpaque(e.selectionBackgroundTransparent)&&(e.selectionBackgroundTransparent=oi.opacity(e.selectionBackgroundTransparent,.3)),oi.isOpaque(e.selectionInactiveBackgroundTransparent)&&(e.selectionInactiveBackgroundTransparent=oi.opacity(e.selectionInactiveBackgroundTransparent,.3)),e.scrollbarSliderBackground=Wn(t.scrollbarSliderBackground,oi.opacity(e.foreground,.2)),e.scrollbarSliderHoverBackground=Wn(t.scrollbarSliderHoverBackground,oi.opacity(e.foreground,.4)),e.scrollbarSliderActiveBackground=Wn(t.scrollbarSliderActiveBackground,oi.opacity(e.foreground,.5)),e.overviewRulerBorder=Wn(t.overviewRulerBorder,RQ),e.ansi=cr.slice(),e.ansi[0]=Wn(t.black,cr[0]),e.ansi[1]=Wn(t.red,cr[1]),e.ansi[2]=Wn(t.green,cr[2]),e.ansi[3]=Wn(t.yellow,cr[3]),e.ansi[4]=Wn(t.blue,cr[4]),e.ansi[5]=Wn(t.magenta,cr[5]),e.ansi[6]=Wn(t.cyan,cr[6]),e.ansi[7]=Wn(t.white,cr[7]),e.ansi[8]=Wn(t.brightBlack,cr[8]),e.ansi[9]=Wn(t.brightRed,cr[9]),e.ansi[10]=Wn(t.brightGreen,cr[10]),e.ansi[11]=Wn(t.brightYellow,cr[11]),e.ansi[12]=Wn(t.brightBlue,cr[12]),e.ansi[13]=Wn(t.brightMagenta,cr[13]),e.ansi[14]=Wn(t.brightCyan,cr[14]),e.ansi[15]=Wn(t.brightWhite,cr[15]),t.extendedAnsi){let n=Math.min(e.ansi.length-16,t.extendedAnsi.length);for(let i=0;i<n;i++)e.ansi[i+16]=Wn(t.extendedAnsi[i],cr[i+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(t){this._restoreColor(t),this._onChangeColors.fire(this.colors)}_restoreColor(t){if(t===void 0){for(let e=0;e<this._restoreColors.ansi.length;++e)this._colors.ansi[e]=this._restoreColors.ansi[e];return}switch(t){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[t]=this._restoreColors.ansi[t]}}modifyColors(t){t(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};Sk=Ni([wt(0,Ls)],Sk);function Wn(t,e){if(t!==void 0)try{return Ci.toColor(t)}catch{}return e}var NQ=class{constructor(...t){this._entries=new Map;for(let[e,n]of t)this.set(e,n)}set(t,e){let n=this._entries.get(t);return this._entries.set(t,e),n}forEach(t){for(let[e,n]of this._entries.entries())t(e,n)}has(t){return this._entries.has(t)}get(t){return this._entries.get(t)}},OQ=class{constructor(){this._services=new NQ,this._services.set(Lk,this)}setService(t,e){this._services.set(t,e)}getService(t){return this._services.get(t)}createInstance(t,...e){let n=nJ(t).sort((s,o)=>s.index-o.index),i=[];for(let s of n){let o=this._services.get(s.id);if(!o)throw new Error(`[createInstance] ${t.name} depends on UNKNOWN service ${s.id._id}.`);i.push(o)}let r=n.length>0?n[0].index:e.length;if(e.length!==r)throw new Error(`[createInstance] First service dependency of ${t.name} at position ${r+1} conflicts with ${e.length} static arguments`);return new t(...e,...i)}},BQ={trace:0,debug:1,info:2,warn:3,error:4,off:5},UQ="xterm.js: ",bk=class extends rn{constructor(t){super(),this._optionsService=t,this._logLevel=5,this._updateLogLevel(),this._register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),FQ=this}get logLevel(){return this._logLevel}_updateLogLevel(){this._logLevel=BQ[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let e=0;e<t.length;e++)typeof t[e]=="function"&&(t[e]=t[e]())}_log(t,e,n){this._evalLazyOptionalParams(n),t.call(console,(this._optionsService.options.logger?"":UQ)+e,...n)}trace(t,...e){this._logLevel<=0&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,t,e)}debug(t,...e){this._logLevel<=1&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,t,e)}info(t,...e){this._logLevel<=2&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,t,e)}warn(t,...e){this._logLevel<=3&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,t,e)}error(t,...e){this._logLevel<=4&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,t,e)}};bk=Ni([wt(0,Ls)],bk);var FQ,G5=class extends rn{constructor(t){super(),this._maxLength=t,this.onDeleteEmitter=this._register(new st),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this._register(new st),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this._register(new st),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(t){if(this._maxLength===t)return;let e=new Array(t);for(let n=0;n<Math.min(t,this.length);n++)e[n]=this._array[this._getCyclicIndex(n)];this._array=e,this._maxLength=t,this._startIndex=0}get length(){return this._length}set length(t){if(t>this._length)for(let e=this._length;e<t;e++)this._array[e]=void 0;this._length=t}get(t){return this._array[this._getCyclicIndex(t)]}set(t,e){this._array[this._getCyclicIndex(t)]=e}push(t){this._array[this._getCyclicIndex(this._length)]=t,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(t,e,...n){if(e){for(let i=t;i<this._length-e;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+e)];this._length-=e,this.onDeleteEmitter.fire({index:t,amount:e})}for(let i=this._length-1;i>=t;i--)this._array[this._getCyclicIndex(i+n.length)]=this._array[this._getCyclicIndex(i)];for(let i=0;i<n.length;i++)this._array[this._getCyclicIndex(t+i)]=n[i];if(n.length&&this.onInsertEmitter.fire({index:t,amount:n.length}),this._length+n.length>this._maxLength){let i=this._length+n.length-this._maxLength;this._startIndex+=i,this._length=this._maxLength,this.onTrimEmitter.fire(i)}else this._length+=n.length}trimStart(t){t>this._length&&(t=this._length),this._startIndex+=t,this._length-=t,this.onTrimEmitter.fire(t)}shiftElements(t,e,n){if(!(e<=0)){if(t<0||t>=this._length)throw new Error("start argument out of range");if(t+n<0)throw new Error("Cannot shift elements in list beyond index 0");if(n>0){for(let r=e-1;r>=0;r--)this.set(t+r+n,this.get(t+r));let i=t+e+n-this._length;if(i>0)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let i=0;i<e;i++)this.set(t+i+n,this.get(t+i))}}_getCyclicIndex(t){return(this._startIndex+t)%this._maxLength}},cn=3,$i=Object.freeze(new F_),fw=0,z3=2,L_=class r6{constructor(e,n,i=!1){this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(e*cn);let r=n||ca.fromCharData([0,pz,1,0]);for(let s=0;s<e;++s)this.setCell(s,r);this.length=e}get(e){let n=this._data[e*cn+0],i=n&2097151;return[this._data[e*cn+1],n&2097152?this._combined[e]:i?Yu(i):"",n>>22,n&2097152?this._combined[e].charCodeAt(this._combined[e].length-1):i]}set(e,n){this._data[e*cn+1]=n[0],n[1].length>1?(this._combined[e]=n[1],this._data[e*cn+0]=e|2097152|n[2]<<22):this._data[e*cn+0]=n[1].charCodeAt(0)|n[2]<<22}getWidth(e){return this._data[e*cn+0]>>22}hasWidth(e){return this._data[e*cn+0]&12582912}getFg(e){return this._data[e*cn+1]}getBg(e){return this._data[e*cn+2]}hasContent(e){return this._data[e*cn+0]&4194303}getCodePoint(e){let n=this._data[e*cn+0];return n&2097152?this._combined[e].charCodeAt(this._combined[e].length-1):n&2097151}isCombined(e){return this._data[e*cn+0]&2097152}getString(e){let n=this._data[e*cn+0];return n&2097152?this._combined[e]:n&2097151?Yu(n&2097151):""}isProtected(e){return this._data[e*cn+2]&536870912}loadCell(e,n){return fw=e*cn,n.content=this._data[fw+0],n.fg=this._data[fw+1],n.bg=this._data[fw+2],n.content&2097152&&(n.combinedData=this._combined[e]),n.bg&268435456&&(n.extended=this._extendedAttrs[e]),n}setCell(e,n){n.content&2097152&&(this._combined[e]=n.combinedData),n.bg&268435456&&(this._extendedAttrs[e]=n.extended),this._data[e*cn+0]=n.content,this._data[e*cn+1]=n.fg,this._data[e*cn+2]=n.bg}setCellFromCodepoint(e,n,i,r){r.bg&268435456&&(this._extendedAttrs[e]=r.extended),this._data[e*cn+0]=n|i<<22,this._data[e*cn+1]=r.fg,this._data[e*cn+2]=r.bg}addCodepointToCell(e,n,i){let r=this._data[e*cn+0];r&2097152?this._combined[e]+=Yu(n):r&2097151?(this._combined[e]=Yu(r&2097151)+Yu(n),r&=-2097152,r|=2097152):r=n|1<<22,i&&(r&=-12582913,r|=i<<22),this._data[e*cn+0]=r}insertCells(e,n,i){if(e%=this.length,e&&this.getWidth(e-1)===2&&this.setCellFromCodepoint(e-1,0,1,i),n<this.length-e){let r=new ca;for(let s=this.length-e-n-1;s>=0;--s)this.setCell(e+n+s,this.loadCell(e+s,r));for(let s=0;s<n;++s)this.setCell(e+s,i)}else for(let r=e;r<this.length;++r)this.setCell(r,i);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,i)}deleteCells(e,n,i){if(e%=this.length,n<this.length-e){let r=new ca;for(let s=0;s<this.length-e-n;++s)this.setCell(e+s,this.loadCell(e+n+s,r));for(let s=this.length-n;s<this.length;++s)this.setCell(s,i)}else for(let r=e;r<this.length;++r)this.setCell(r,i);e&&this.getWidth(e-1)===2&&this.setCellFromCodepoint(e-1,0,1,i),this.getWidth(e)===0&&!this.hasContent(e)&&this.setCellFromCodepoint(e,0,1,i)}replaceCells(e,n,i,r=!1){if(r){for(e&&this.getWidth(e-1)===2&&!this.isProtected(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),n<this.length&&this.getWidth(n-1)===2&&!this.isProtected(n)&&this.setCellFromCodepoint(n,0,1,i);e<n&&e<this.length;)this.isProtected(e)||this.setCell(e,i),e++;return}for(e&&this.getWidth(e-1)===2&&this.setCellFromCodepoint(e-1,0,1,i),n<this.length&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n,0,1,i);e<n&&e<this.length;)this.setCell(e++,i)}resize(e,n){if(e===this.length)return this._data.length*4*z3<this._data.buffer.byteLength;let i=e*cn;if(e>this.length){if(this._data.buffer.byteLength>=i*4)this._data=new Uint32Array(this._data.buffer,0,i);else{let r=new Uint32Array(i);r.set(this._data),this._data=r}for(let r=this.length;r<e;++r)this.setCell(r,n)}else{this._data=this._data.subarray(0,i);let r=Object.keys(this._combined);for(let o=0;o<r.length;o++){let a=parseInt(r[o],10);a>=e&&delete this._combined[a]}let s=Object.keys(this._extendedAttrs);for(let o=0;o<s.length;o++){let a=parseInt(s[o],10);a>=e&&delete this._extendedAttrs[a]}}return this.length=e,i*4*z3<this._data.buffer.byteLength}cleanupMemory(){if(this._data.length*4*z3<this._data.buffer.byteLength){let e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,n=!1){if(n){for(let i=0;i<this.length;++i)this.isProtected(i)||this.setCell(i,e);return}this._combined={},this._extendedAttrs={};for(let i=0;i<this.length;++i)this.setCell(i,e)}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(let n in e._combined)this._combined[n]=e._combined[n];this._extendedAttrs={};for(let n in e._extendedAttrs)this._extendedAttrs[n]=e._extendedAttrs[n];this.isWrapped=e.isWrapped}clone(){let e=new r6(0);e._data=new Uint32Array(this._data),e.length=this.length;for(let n in this._combined)e._combined[n]=this._combined[n];for(let n in this._extendedAttrs)e._extendedAttrs[n]=this._extendedAttrs[n];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(this._data[e*cn+0]&4194303)return e+(this._data[e*cn+0]>>22);return 0}getNoBgTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(this._data[e*cn+0]&4194303||this._data[e*cn+2]&50331648)return e+(this._data[e*cn+0]>>22);return 0}copyCellsFrom(e,n,i,r,s){let o=e._data;if(s)for(let l=r-1;l>=0;l--){for(let c=0;c<cn;c++)this._data[(i+l)*cn+c]=o[(n+l)*cn+c];o[(n+l)*cn+2]&268435456&&(this._extendedAttrs[i+l]=e._extendedAttrs[n+l])}else for(let l=0;l<r;l++){for(let c=0;c<cn;c++)this._data[(i+l)*cn+c]=o[(n+l)*cn+c];o[(n+l)*cn+2]&268435456&&(this._extendedAttrs[i+l]=e._extendedAttrs[n+l])}let a=Object.keys(e._combined);for(let l=0;l<a.length;l++){let c=parseInt(a[l],10);c>=n&&(this._combined[c-n+i]=e._combined[c])}}translateToString(e,n,i,r){n=n??0,i=i??this.length,e&&(i=Math.min(i,this.getTrimmedLength())),r&&(r.length=0);let s="";for(;n<i;){let o=this._data[n*cn+0],a=o&2097151,l=o&2097152?this._combined[n]:a?Yu(a):Ku;if(s+=l,r)for(let c=0;c<l.length;++c)r.push(n);n+=o>>22||1}return r&&r.push(n),s}};function zQ(t,e,n,i,r,s){let o=[];for(let a=0;a<t.length-1;a++){let l=a,c=t.get(++l);if(!c.isWrapped)continue;let u=[t.get(a)];for(;l<t.length&&c.isWrapped;)u.push(c),c=t.get(++l);if(!s&&i>=a&&i<l){a+=u.length-1;continue}let d=0,p=U_(u,d,e),m=1,g=0;for(;m<u.length;){let y=U_(u,m,e),v=y-g,S=n-p,b=Math.min(v,S);u[d].copyCellsFrom(u[m],g,p,b,!1),p+=b,p===n&&(d++,p=0),g+=b,g===y&&(m++,g=0),p===0&&d!==0&&u[d-1].getWidth(n-1)===2&&(u[d].copyCellsFrom(u[d-1],n-1,p++,1,!1),u[d-1].setCell(n-1,r))}u[d].replaceCells(p,n,r);let _=0;for(let y=u.length-1;y>0&&(y>d||u[y].getTrimmedLength()===0);y--)_++;_>0&&(o.push(a+u.length-_),o.push(_)),a+=u.length-1}return o}function HQ(t,e){let n=[],i=0,r=e[i],s=0;for(let o=0;o<t.length;o++)if(r===o){let a=e[++i];t.onDeleteEmitter.fire({index:o-s,amount:a}),o+=a-1,s+=a,r=e[++i]}else n.push(o);return{layout:n,countRemoved:s}}function WQ(t,e){let n=[];for(let i=0;i<e.length;i++)n.push(t.get(e[i]));for(let i=0;i<n.length;i++)t.set(i,n[i]);t.length=e.length}function VQ(t,e,n){let i=[],r=t.map((l,c)=>U_(t,c,e)).reduce((l,c)=>l+c),s=0,o=0,a=0;for(;a<r;){if(r-a<n){i.push(r-a);break}s+=n;let l=U_(t,o,e);s>l&&(s-=l,o++);let c=t[o].getWidth(s-1)===2;c&&s--;let u=c?n-1:n;i.push(u),a+=u}return i}function U_(t,e,n){if(e===t.length-1)return t[e].getTrimmedLength();let i=!t[e].hasContent(n-1)&&t[e].getWidth(n-1)===1,r=t[e+1].getWidth(0)===2;return i&&r?n-1:n}var s6=class o6{constructor(e){this.line=e,this.isDisposed=!1,this._disposables=[],this._id=o6._nextId++,this._onDispose=this.register(new st),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),Md(this._disposables),this._disposables.length=0)}register(e){return this._disposables.push(e),e}};s6._nextId=1;var GQ=s6,hr={},Ed=hr.B;hr[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"};hr.A={"#":"\xA3"};hr.B=void 0;hr[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"};hr.C=hr[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"};hr.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"};hr.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"};hr.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"};hr.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"};hr.E=hr[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"};hr.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"};hr.H=hr[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"};hr["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"};var j5=4294967295,X5=class{constructor(t,e,n){this._hasScrollback=t,this._optionsService=e,this._bufferService=n,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=$i.clone(),this.savedCharset=Ed,this.markers=[],this._nullCell=ca.fromCharData([0,pz,1,0]),this._whitespaceCell=ca.fromCharData([0,Ku,1,32]),this._isClearing=!1,this._memoryCleanupQueue=new Pw,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new G5(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(t){return t?(this._nullCell.fg=t.fg,this._nullCell.bg=t.bg,this._nullCell.extended=t.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new Ew),this._nullCell}getWhitespaceCell(t){return t?(this._whitespaceCell.fg=t.fg,this._whitespaceCell.bg=t.bg,this._whitespaceCell.extended=t.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new Ew),this._whitespaceCell}getBlankLine(t,e){return new L_(this._bufferService.cols,this.getNullCell(t),e)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let t=this.ybase+this.y-this.ydisp;return t>=0&&t<this._rows}_getCorrectBufferLength(t){if(!this._hasScrollback)return t;let e=t+this._optionsService.rawOptions.scrollback;return e>j5?j5:e}fillViewportRows(t){if(this.lines.length===0){t===void 0&&(t=$i);let e=this._rows;for(;e--;)this.lines.push(this.getBlankLine(t))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new G5(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(t,e){let n=this.getNullCell($i),i=0,r=this._getCorrectBufferLength(e);if(r>this.lines.maxLength&&(this.lines.maxLength=r),this.lines.length>0){if(this._cols<t)for(let o=0;o<this.lines.length;o++)i+=+this.lines.get(o).resize(t,n);let s=0;if(this._rows<e)for(let o=this._rows;o<e;o++)this.lines.length<e+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new L_(t,n)):this.ybase>0&&this.lines.length<=this.ybase+this.y+s+1?(this.ybase--,s++,this.ydisp>0&&this.ydisp--):this.lines.push(new L_(t,n)));else for(let o=this._rows;o>e;o--)this.lines.length>e+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(r<this.lines.maxLength){let o=this.lines.length-r;o>0&&(this.lines.trimStart(o),this.ybase=Math.max(this.ybase-o,0),this.ydisp=Math.max(this.ydisp-o,0),this.savedY=Math.max(this.savedY-o,0)),this.lines.maxLength=r}this.x=Math.min(this.x,t-1),this.y=Math.min(this.y,e-1),s&&(this.y+=s),this.savedX=Math.min(this.savedX,t-1),this.scrollTop=0}if(this.scrollBottom=e-1,this._isReflowEnabled&&(this._reflow(t,e),this._cols>t))for(let s=0;s<this.lines.length;s++)i+=+this.lines.get(s).resize(t,n);this._cols=t,this._rows=e,this._memoryCleanupQueue.clear(),i>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let t=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,t=!1);let e=0;for(;this._memoryCleanupPosition<this.lines.length;)if(e+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),e>100)return!0;return t}get _isReflowEnabled(){let t=this._optionsService.rawOptions.windowsPty;return t&&t.buildNumber?this._hasScrollback&&t.backend==="conpty"&&t.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(t,e){this._cols!==t&&(t>this._cols?this._reflowLarger(t,e):this._reflowSmaller(t,e))}_reflowLarger(t,e){let n=this._optionsService.rawOptions.reflowCursorLine,i=zQ(this.lines,this._cols,t,this.ybase+this.y,this.getNullCell($i),n);if(i.length>0){let r=HQ(this.lines,i);WQ(this.lines,r.layout),this._reflowLargerAdjustViewport(t,e,r.countRemoved)}}_reflowLargerAdjustViewport(t,e,n){let i=this.getNullCell($i),r=n;for(;r-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<e&&this.lines.push(new L_(t,i))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-n,0)}_reflowSmaller(t,e){let n=this._optionsService.rawOptions.reflowCursorLine,i=this.getNullCell($i),r=[],s=0;for(let o=this.lines.length-1;o>=0;o--){let a=this.lines.get(o);if(!a||!a.isWrapped&&a.getTrimmedLength()<=t)continue;let l=[a];for(;a.isWrapped&&o>0;)a=this.lines.get(--o),l.unshift(a);if(!n){let b=this.ybase+this.y;if(b>=o&&b<o+l.length)continue}let c=l[l.length-1].getTrimmedLength(),u=VQ(l,this._cols,t),d=u.length-l.length,p;this.ybase===0&&this.y!==this.lines.length-1?p=Math.max(0,this.y-this.lines.maxLength+d):p=Math.max(0,this.lines.length-this.lines.maxLength+d);let m=[];for(let b=0;b<d;b++){let w=this.getBlankLine($i,!0);m.push(w)}m.length>0&&(r.push({start:o+l.length+s,newLines:m}),s+=m.length),l.push(...m);let g=u.length-1,_=u[g];_===0&&(g--,_=u[g]);let y=l.length-d-1,v=c;for(;y>=0;){let b=Math.min(v,_);if(l[g]===void 0)break;if(l[g].copyCellsFrom(l[y],v-b,_-b,b,!0),_-=b,_===0&&(g--,_=u[g]),v-=b,v===0){y--;let w=Math.max(y,0);v=U_(l,w,this._cols)}}for(let b=0;b<l.length;b++)u[b]<t&&l[b].setCell(u[b],i);let S=d-p;for(;S-- >0;)this.ybase===0?this.y<e-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+s)-e&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+d,this.ybase+e-1)}if(r.length>0){let o=[],a=[];for(let _=0;_<this.lines.length;_++)a.push(this.lines.get(_));let l=this.lines.length,c=l-1,u=0,d=r[u];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+s);let p=0;for(let _=Math.min(this.lines.maxLength-1,l+s-1);_>=0;_--)if(d&&d.start>c+p){for(let y=d.newLines.length-1;y>=0;y--)this.lines.set(_--,d.newLines[y]);_++,o.push({index:c+1,amount:d.newLines.length}),p+=d.newLines.length,d=r[++u]}else this.lines.set(_,a[c--]);let m=0;for(let _=o.length-1;_>=0;_--)o[_].index+=m,this.lines.onInsertEmitter.fire(o[_]),m+=o[_].amount;let g=Math.max(0,l+s-this.lines.maxLength);g>0&&this.lines.onTrimEmitter.fire(g)}}translateBufferLineToString(t,e,n=0,i){let r=this.lines.get(t);return r?r.translateToString(e,n,i):""}getWrappedRangeForLine(t){let e=t,n=t;for(;e>0&&this.lines.get(e).isWrapped;)e--;for(;n+1<this.lines.length&&this.lines.get(n+1).isWrapped;)n++;return{first:e,last:n}}setupTabStops(t){for(t!=null?this.tabs[t]||(t=this.prevStop(t)):(this.tabs={},t=0);t<this._cols;t+=this._optionsService.rawOptions.tabStopWidth)this.tabs[t]=!0}prevStop(t){for(t==null&&(t=this.x);!this.tabs[--t]&&t>0;);return t>=this._cols?this._cols-1:t<0?0:t}nextStop(t){for(t==null&&(t=this.x);!this.tabs[++t]&&t<this._cols;);return t>=this._cols?this._cols-1:t<0?0:t}clearMarkers(t){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].line===t&&(this.markers[e].dispose(),this.markers.splice(e--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].dispose();this.markers.length=0,this._isClearing=!1}addMarker(t){let e=new GQ(t);return this.markers.push(e),e.register(this.lines.onTrim(n=>{e.line-=n,e.line<0&&e.dispose()})),e.register(this.lines.onInsert(n=>{e.line>=n.index&&(e.line+=n.amount)})),e.register(this.lines.onDelete(n=>{e.line>=n.index&&e.line<n.index+n.amount&&e.dispose(),e.line>n.index&&(e.line-=n.amount)})),e.register(e.onDispose(()=>this._removeMarker(e))),e}_removeMarker(t){this._isClearing||this.markers.splice(this.markers.indexOf(t),1)}},jQ=class extends rn{constructor(t,e){super(),this._optionsService=t,this._bufferService=e,this._onBufferActivate=this._register(new st),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this._register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this._register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new X5(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new X5(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(t){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(t),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(t,e){this._normal.resize(t,e),this._alt.resize(t,e),this.setupTabStops(t)}setupTabStops(t){this._normal.setupTabStops(t),this._alt.setupTabStops(t)}},a6=2,l6=1,wk=class extends rn{constructor(t){super(),this.isUserScrolling=!1,this._onResize=this._register(new st),this.onResize=this._onResize.event,this._onScroll=this._register(new st),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,a6),this.rows=Math.max(t.rawOptions.rows||0,l6),this.buffers=this._register(new jQ(t,this)),this._register(this.buffers.onBufferActivate(e=>{this._onScroll.fire(e.activeBuffer.ydisp)}))}get buffer(){return this.buffers.active}resize(t,e){let n=this.cols!==t,i=this.rows!==e;this.cols=t,this.rows=e,this.buffers.resize(t,e),this._onResize.fire({cols:t,rows:e,colsChanged:n,rowsChanged:i})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,e=!1){let n=this.buffer,i;i=this._cachedBlankLine,(!i||i.length!==this.cols||i.getFg(0)!==t.fg||i.getBg(0)!==t.bg)&&(i=n.getBlankLine(t,e),this._cachedBlankLine=i),i.isWrapped=e;let r=n.ybase+n.scrollTop,s=n.ybase+n.scrollBottom;if(n.scrollTop===0){let o=n.lines.isFull;s===n.lines.length-1?o?n.lines.recycle().copyFrom(i):n.lines.push(i.clone()):n.lines.splice(s+1,0,i.clone()),o?this.isUserScrolling&&(n.ydisp=Math.max(n.ydisp-1,0)):(n.ybase++,this.isUserScrolling||n.ydisp++)}else{let o=s-r+1;n.lines.shiftElements(r+1,o-1,-1),n.lines.set(s,i.clone())}this.isUserScrolling||(n.ydisp=n.ybase),this._onScroll.fire(n.ydisp)}scrollLines(t,e){let n=this.buffer;if(t<0){if(n.ydisp===0)return;this.isUserScrolling=!0}else t+n.ydisp>=n.ybase&&(this.isUserScrolling=!1);let i=n.ydisp;n.ydisp=Math.max(Math.min(n.ydisp+t,n.ybase),0),i!==n.ydisp&&(e||this._onScroll.fire(n.ydisp))}};wk=Ni([wt(0,Ls)],wk);var $p={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnEraseInDisplay:!1,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},reflowCursorLine:!1,rescaleOverlappingGlyphs:!1,rightClickSelectsWord:Lw,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRuler:{}},XQ=["normal","bold","100","200","300","400","500","600","700","800","900"],qQ=class extends rn{constructor(t){super(),this._onOptionChange=this._register(new st),this.onOptionChange=this._onOptionChange.event;let e={...$p};for(let n in t)if(n in e)try{let i=t[n];e[n]=this._sanitizeAndValidateOption(n,i)}catch(i){console.error(i)}this.rawOptions=e,this.options={...e},this._setupOptions(),this._register(ai(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(t,e){return this.onOptionChange(n=>{n===t&&e(this.rawOptions[t])})}onMultipleOptionChange(t,e){return this.onOptionChange(n=>{t.indexOf(n)!==-1&&e()})}_setupOptions(){let t=n=>{if(!(n in $p))throw new Error(`No option with key "${n}"`);return this.rawOptions[n]},e=(n,i)=>{if(!(n in $p))throw new Error(`No option with key "${n}"`);i=this._sanitizeAndValidateOption(n,i),this.rawOptions[n]!==i&&(this.rawOptions[n]=i,this._onOptionChange.fire(n))};for(let n in this.rawOptions){let i={get:t.bind(this,n),set:e.bind(this,n)};Object.defineProperty(this.options,n,i)}}_sanitizeAndValidateOption(t,e){switch(t){case"cursorStyle":if(e||(e=$p[t]),!YQ(e))throw new Error(`"${e}" is not a valid value for ${t}`);break;case"wordSeparator":e||(e=$p[t]);break;case"fontWeight":case"fontWeightBold":if(typeof e=="number"&&1<=e&&e<=1e3)break;e=XQ.includes(e)?e:$p[t];break;case"cursorWidth":e=Math.floor(e);case"lineHeight":case"tabStopWidth":if(e<1)throw new Error(`${t} cannot be less than 1, value: ${e}`);break;case"minimumContrastRatio":e=Math.max(1,Math.min(21,Math.round(e*10)/10));break;case"scrollback":if(e=Math.min(e,4294967295),e<0)throw new Error(`${t} cannot be less than 0, value: ${e}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(e<=0)throw new Error(`${t} cannot be less than or equal to 0, value: ${e}`);break;case"rows":case"cols":if(!e&&e!==0)throw new Error(`${t} must be numeric, value: ${e}`);break;case"windowsPty":e=e??{};break}return e}};function YQ(t){return t==="block"||t==="underline"||t==="bar"}function P_(t,e=5){if(typeof t!="object")return t;let n=Array.isArray(t)?[]:{};for(let i in t)n[i]=e<=1?t[i]:t[i]&&P_(t[i],e-1);return n}var q5=Object.freeze({insertMode:!1}),Y5=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,cursorBlink:void 0,cursorStyle:void 0,origin:!1,reverseWraparound:!1,sendFocus:!1,synchronizedOutput:!1,wraparound:!0}),Ek=class extends rn{constructor(t,e,n){super(),this._bufferService=t,this._logService=e,this._optionsService=n,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this._register(new st),this.onData=this._onData.event,this._onUserInput=this._register(new st),this.onUserInput=this._onUserInput.event,this._onBinary=this._register(new st),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this._register(new st),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=P_(q5),this.decPrivateModes=P_(Y5)}reset(){this.modes=P_(q5),this.decPrivateModes=P_(Y5)}triggerDataEvent(t,e=!1){if(this._optionsService.rawOptions.disableStdin)return;let n=this._bufferService.buffer;e&&this._optionsService.rawOptions.scrollOnUserInput&&n.ybase!==n.ydisp&&this._onRequestScrollToBottom.fire(),e&&this._onUserInput.fire(),this._logService.debug(`sending data "${t}"`),this._logService.trace("sending data (codes)",()=>t.split("").map(i=>i.charCodeAt(0))),this._onData.fire(t)}triggerBinaryEvent(t){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${t}"`),this._logService.trace("sending binary (codes)",()=>t.split("").map(e=>e.charCodeAt(0))),this._onBinary.fire(t))}};Ek=Ni([wt(0,ks),wt(1,yz),wt(2,Ls)],Ek);var K5={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:t=>t.button===4||t.action!==1?!1:(t.ctrl=!1,t.alt=!1,t.shift=!1,!0)},VT200:{events:19,restrict:t=>t.action!==32},DRAG:{events:23,restrict:t=>!(t.action===32&&t.button===3)},ANY:{events:31,restrict:t=>!0}};function H3(t,e){let n=(t.ctrl?16:0)|(t.shift?4:0)|(t.alt?8:0);return t.button===4?(n|=64,n|=t.action):(n|=t.button&3,t.button&4&&(n|=64),t.button&8&&(n|=128),t.action===32?n|=32:t.action===0&&!e&&(n|=3)),n}var W3=String.fromCharCode,$5={DEFAULT:t=>{let e=[H3(t,!1)+32,t.col+32,t.row+32];return e[0]>255||e[1]>255||e[2]>255?"":`\x1B[M${W3(e[0])}${W3(e[1])}${W3(e[2])}`},SGR:t=>{let e=t.action===0&&t.button!==4?"m":"M";return`\x1B[<${H3(t,!0)};${t.col};${t.row}${e}`},SGR_PIXELS:t=>{let e=t.action===0&&t.button!==4?"m":"M";return`\x1B[<${H3(t,!0)};${t.x};${t.y}${e}`}},Ck=class extends rn{constructor(t,e,n){super(),this._bufferService=t,this._coreService=e,this._optionsService=n,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._wheelPartialScroll=0,this._onProtocolChange=this._register(new st),this.onProtocolChange=this._onProtocolChange.event;for(let i of Object.keys(K5))this.addProtocol(i,K5[i]);for(let i of Object.keys($5))this.addEncoding(i,$5[i]);this.reset()}addProtocol(t,e){this._protocols[t]=e}addEncoding(t,e){this._encodings[t]=e}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(t){if(!this._protocols[t])throw new Error(`unknown protocol "${t}"`);this._activeProtocol=t,this._onProtocolChange.fire(this._protocols[t].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(t){if(!this._encodings[t])throw new Error(`unknown encoding "${t}"`);this._activeEncoding=t}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null,this._wheelPartialScroll=0}consumeWheelEvent(t,e,n){if(t.deltaY===0||t.shiftKey||e===void 0||n===void 0)return 0;let i=e/n,r=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(r/=i+0,Math.abs(t.deltaY)<50&&(r*=.3),this._wheelPartialScroll+=r,r=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._bufferService.rows),r}_applyScrollModifier(t,e){return e.altKey||e.ctrlKey||e.shiftKey?t*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:t*this._optionsService.rawOptions.scrollSensitivity}triggerMouseEvent(t){if(t.col<0||t.col>=this._bufferService.cols||t.row<0||t.row>=this._bufferService.rows||t.button===4&&t.action===32||t.button===3&&t.action!==32||t.button!==4&&(t.action===2||t.action===3)||(t.col++,t.row++,t.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,t,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(t))return!1;let e=this._encodings[this._activeEncoding](t);return e&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(e):this._coreService.triggerDataEvent(e,!0)),this._lastEvent=t,!0}explainEvents(t){return{down:!!(t&1),up:!!(t&2),drag:!!(t&4),move:!!(t&8),wheel:!!(t&16)}}_equalEvents(t,e,n){if(n){if(t.x!==e.x||t.y!==e.y)return!1}else if(t.col!==e.col||t.row!==e.row)return!1;return!(t.button!==e.button||t.action!==e.action||t.ctrl!==e.ctrl||t.alt!==e.alt||t.shift!==e.shift)}};Ck=Ni([wt(0,ks),wt(1,kd),wt(2,Ls)],Ck);var V3=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],KQ=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],ur;function $Q(t,e){let n=0,i=e.length-1,r;if(t<e[0][0]||t>e[i][1])return!1;for(;i>=n;)if(r=n+i>>1,t>e[r][1])n=r+1;else if(t<e[r][0])i=r-1;else return!0;return!1}var JQ=class{constructor(){if(this.version="6",!ur){ur=new Uint8Array(65536),ur.fill(1),ur[0]=0,ur.fill(0,1,32),ur.fill(0,127,160),ur.fill(2,4352,4448),ur[9001]=2,ur[9002]=2,ur.fill(2,11904,42192),ur[12351]=1,ur.fill(2,44032,55204),ur.fill(2,63744,64256),ur.fill(2,65040,65050),ur.fill(2,65072,65136),ur.fill(2,65280,65377),ur.fill(2,65504,65511);for(let t=0;t<V3.length;++t)ur.fill(0,V3[t][0],V3[t][1]+1)}}wcwidth(t){return t<32?0:t<127?1:t<65536?ur[t]:$Q(t,KQ)?0:t>=131072&&t<=196605||t>=196608&&t<=262141?2:1}charProperties(t,e){let n=this.wcwidth(t),i=n===0&&e!==0;if(i){let r=Cd.extractWidth(e);r===0?i=!1:r>n&&(n=r)}return Cd.createPropertyValue(0,n,i)}},Cd=class ww{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new st,this.onChange=this._onChange.event;let e=new JQ;this.register(e),this._active=e.version,this._activeProvider=e}static extractShouldJoin(e){return(e&1)!==0}static extractWidth(e){return e>>1&3}static extractCharKind(e){return e>>3}static createPropertyValue(e,n,i=!1){return(e&16777215)<<3|(n&3)<<1|(i?1:0)}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(e){if(!this._providers[e])throw new Error(`unknown Unicode version "${e}"`);this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}register(e){this._providers[e.version]=e}wcwidth(e){return this._activeProvider.wcwidth(e)}getStringCellWidth(e){let n=0,i=0,r=e.length;for(let s=0;s<r;++s){let o=e.charCodeAt(s);if(55296<=o&&o<=56319){if(++s>=r)return n+this.wcwidth(o);let c=e.charCodeAt(s);56320<=c&&c<=57343?o=(o-55296)*1024+c-56320+65536:n+=this.wcwidth(c)}let a=this.charProperties(o,i),l=ww.extractWidth(a);ww.extractShouldJoin(a)&&(l-=ww.extractWidth(i)),n+=l,i=a}return n}charProperties(e,n){return this._activeProvider.charProperties(e,n)}},ZQ=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(t){this.glevel=t,this.charset=this._charsets[t]}setgCharset(t,e){this._charsets[t]=e,this.glevel===t&&(this.charset=e)}};function J5(t){let e=t.buffer.lines.get(t.buffer.ybase+t.buffer.y-1)?.get(t.cols-1),n=t.buffer.lines.get(t.buffer.ybase+t.buffer.y);n&&e&&(n.isWrapped=e[3]!==0&&e[3]!==32)}var E_=2147483647,QQ=256,c6=class Tk{constructor(e=32,n=32){if(this.maxLength=e,this.maxSubParamsLength=n,n>QQ)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(e),this.length=0,this._subParams=new Int32Array(n),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(e),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(e){let n=new Tk;if(!e.length)return n;for(let i=Array.isArray(e[0])?1:0;i<e.length;++i){let r=e[i];if(Array.isArray(r))for(let s=0;s<r.length;++s)n.addSubParam(r[s]);else n.addParam(r)}return n}clone(){let e=new Tk(this.maxLength,this.maxSubParamsLength);return e.params.set(this.params),e.length=this.length,e._subParams.set(this._subParams),e._subParamsLength=this._subParamsLength,e._subParamsIdx.set(this._subParamsIdx),e._rejectDigits=this._rejectDigits,e._rejectSubDigits=this._rejectSubDigits,e._digitIsSub=this._digitIsSub,e}toArray(){let e=[];for(let n=0;n<this.length;++n){e.push(this.params[n]);let i=this._subParamsIdx[n]>>8,r=this._subParamsIdx[n]&255;r-i>0&&e.push(Array.prototype.slice.call(this._subParams,i,r))}return e}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(e){if(this._digitIsSub=!1,this.length>=this.maxLength){this._rejectDigits=!0;return}if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>E_?E_:e}addSubParam(e){if(this._digitIsSub=!0,!!this.length){if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength){this._rejectSubDigits=!0;return}if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>E_?E_:e,this._subParamsIdx[this.length-1]++}}hasSubParams(e){return(this._subParamsIdx[e]&255)-(this._subParamsIdx[e]>>8)>0}getSubParams(e){let n=this._subParamsIdx[e]>>8,i=this._subParamsIdx[e]&255;return i-n>0?this._subParams.subarray(n,i):null}getSubParamsAll(){let e={};for(let n=0;n<this.length;++n){let i=this._subParamsIdx[n]>>8,r=this._subParamsIdx[n]&255;r-i>0&&(e[n]=this._subParams.slice(i,r))}return e}addDigit(e){let n;if(this._rejectDigits||!(n=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let i=this._digitIsSub?this._subParams:this.params,r=i[n-1];i[n-1]=~r?Math.min(r*10+e,E_):e}},C_=[],eee=class{constructor(){this._state=0,this._active=C_,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(t,e){this._handlers[t]===void 0&&(this._handlers[t]=[]);let n=this._handlers[t];return n.push(e),{dispose:()=>{let i=n.indexOf(e);i!==-1&&n.splice(i,1)}}}clearHandler(t){this._handlers[t]&&delete this._handlers[t]}setHandlerFallback(t){this._handlerFb=t}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=C_}reset(){if(this._state===2)for(let t=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;t>=0;--t)this._active[t].end(!1);this._stack.paused=!1,this._active=C_,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||C_,!this._active.length)this._handlerFb(this._id,"START");else for(let t=this._active.length-1;t>=0;t--)this._active[t].start()}_put(t,e,n){if(!this._active.length)this._handlerFb(this._id,"PUT",Iw(t,e,n));else for(let i=this._active.length-1;i>=0;i--)this._active[i].put(t,e,n)}start(){this.reset(),this._state=1}put(t,e,n){if(this._state!==3){if(this._state===1)for(;e<n;){let i=t[e++];if(i===59){this._state=2,this._start();break}if(i<48||57<i){this._state=3;return}this._id===-1&&(this._id=0),this._id=this._id*10+i-48}this._state===2&&n-e>0&&this._put(t,e,n)}}end(t,e=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),!this._active.length)this._handlerFb(this._id,"END",t);else{let n=!1,i=this._active.length-1,r=!1;if(this._stack.paused&&(i=this._stack.loopPosition-1,n=e,r=this._stack.fallThrough,this._stack.paused=!1),!r&&n===!1){for(;i>=0&&(n=this._active[i].end(t),n!==!0);i--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!1,n;i--}for(;i>=0;i--)if(n=this._active[i].end(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!0,n}this._active=C_,this._id=-1,this._state=0}}},Ao=class{constructor(t){this._handler=t,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(t,e,n){this._hitLimit||(this._data+=Iw(t,e,n),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}end(t){let e=!1;if(this._hitLimit)e=!1;else if(t&&(e=this._handler(this._data),e instanceof Promise))return e.then(n=>(this._data="",this._hitLimit=!1,n));return this._data="",this._hitLimit=!1,e}},T_=[],tee=class{constructor(){this._handlers=Object.create(null),this._active=T_,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=T_}registerHandler(t,e){this._handlers[t]===void 0&&(this._handlers[t]=[]);let n=this._handlers[t];return n.push(e),{dispose:()=>{let i=n.indexOf(e);i!==-1&&n.splice(i,1)}}}clearHandler(t){this._handlers[t]&&delete this._handlers[t]}setHandlerFallback(t){this._handlerFb=t}reset(){if(this._active.length)for(let t=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;t>=0;--t)this._active[t].unhook(!1);this._stack.paused=!1,this._active=T_,this._ident=0}hook(t,e){if(this.reset(),this._ident=t,this._active=this._handlers[t]||T_,!this._active.length)this._handlerFb(this._ident,"HOOK",e);else for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(e)}put(t,e,n){if(!this._active.length)this._handlerFb(this._ident,"PUT",Iw(t,e,n));else for(let i=this._active.length-1;i>=0;i--)this._active[i].put(t,e,n)}unhook(t,e=!0){if(!this._active.length)this._handlerFb(this._ident,"UNHOOK",t);else{let n=!1,i=this._active.length-1,r=!1;if(this._stack.paused&&(i=this._stack.loopPosition-1,n=e,r=this._stack.fallThrough,this._stack.paused=!1),!r&&n===!1){for(;i>=0&&(n=this._active[i].unhook(t),n!==!0);i--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!1,n;i--}for(;i>=0;i--)if(n=this._active[i].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!0,n}this._active=T_,this._ident=0}},D_=new c6;D_.addParam(0);var Z5=class{constructor(t){this._handler=t,this._data="",this._params=D_,this._hitLimit=!1}hook(t){this._params=t.length>1||t.params[0]?t.clone():D_,this._data="",this._hitLimit=!1}put(t,e,n){this._hitLimit||(this._data+=Iw(t,e,n),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}unhook(t){let e=!1;if(this._hitLimit)e=!1;else if(t&&(e=this._handler(this._data,this._params),e instanceof Promise))return e.then(n=>(this._params=D_,this._data="",this._hitLimit=!1,n));return this._params=D_,this._data="",this._hitLimit=!1,e}},nee=class{constructor(t){this.table=new Uint8Array(t)}setDefault(t,e){this.table.fill(t<<4|e)}add(t,e,n,i){this.table[e<<8|t]=n<<4|i}addMany(t,e,n,i){for(let r=0;r<t.length;r++)this.table[e<<8|t[r]]=n<<4|i}},la=160,iee=(function(){let t=new nee(4095),e=Array.apply(null,Array(256)).map((a,l)=>l),n=(a,l)=>e.slice(a,l),i=n(32,127),r=n(0,24);r.push(25),r.push.apply(r,n(28,32));let s=n(0,14),o;t.setDefault(1,0),t.addMany(i,0,2,0);for(o in s)t.addMany([24,26,153,154],o,3,0),t.addMany(n(128,144),o,3,0),t.addMany(n(144,152),o,3,0),t.add(156,o,0,0),t.add(27,o,11,1),t.add(157,o,4,8),t.addMany([152,158,159],o,0,7),t.add(155,o,11,3),t.add(144,o,11,9);return t.addMany(r,0,3,0),t.addMany(r,1,3,1),t.add(127,1,0,1),t.addMany(r,8,0,8),t.addMany(r,3,3,3),t.add(127,3,0,3),t.addMany(r,4,3,4),t.add(127,4,0,4),t.addMany(r,6,3,6),t.addMany(r,5,3,5),t.add(127,5,0,5),t.addMany(r,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(i,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(n(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(i,7,0,7),t.addMany(r,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(n(64,127),3,7,0),t.addMany(n(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(n(48,60),4,8,4),t.addMany(n(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(n(32,64),6,0,6),t.add(127,6,0,6),t.addMany(n(64,127),6,0,0),t.addMany(n(32,48),3,9,5),t.addMany(n(32,48),5,9,5),t.addMany(n(48,64),5,0,6),t.addMany(n(64,127),5,7,0),t.addMany(n(32,48),4,9,5),t.addMany(n(32,48),1,9,2),t.addMany(n(32,48),2,9,2),t.addMany(n(48,127),2,10,0),t.addMany(n(48,80),1,10,0),t.addMany(n(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(n(96,127),1,10,0),t.add(80,1,11,9),t.addMany(r,9,0,9),t.add(127,9,0,9),t.addMany(n(28,32),9,0,9),t.addMany(n(32,48),9,9,12),t.addMany(n(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(r,11,0,11),t.addMany(n(32,128),11,0,11),t.addMany(n(28,32),11,0,11),t.addMany(r,10,0,10),t.add(127,10,0,10),t.addMany(n(28,32),10,0,10),t.addMany(n(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(n(32,48),10,9,12),t.addMany(r,12,0,12),t.add(127,12,0,12),t.addMany(n(28,32),12,0,12),t.addMany(n(32,48),12,9,12),t.addMany(n(48,64),12,0,11),t.addMany(n(64,127),12,12,13),t.addMany(n(64,127),10,12,13),t.addMany(n(64,127),9,12,13),t.addMany(r,13,13,13),t.addMany(i,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(la,0,2,0),t.add(la,8,5,8),t.add(la,6,0,6),t.add(la,11,0,11),t.add(la,13,13,13),t})(),ree=class extends rn{constructor(t=iee){super(),this._transitions=t,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new c6,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(e,n,i)=>{},this._executeHandlerFb=e=>{},this._csiHandlerFb=(e,n)=>{},this._escHandlerFb=e=>{},this._errorHandlerFb=e=>e,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this._register(ai(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this._register(new eee),this._dcsParser=this._register(new tee),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(t,e=[64,126]){let n=0;if(t.prefix){if(t.prefix.length>1)throw new Error("only one byte as prefix supported");if(n=t.prefix.charCodeAt(0),n&&60>n||n>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(t.intermediates){if(t.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let r=0;r<t.intermediates.length;++r){let s=t.intermediates.charCodeAt(r);if(32>s||s>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");n<<=8,n|=s}}if(t.final.length!==1)throw new Error("final must be a single byte");let i=t.final.charCodeAt(0);if(e[0]>i||i>e[1])throw new Error(`final must be in range ${e[0]} .. ${e[1]}`);return n<<=8,n|=i,n}identToString(t){let e=[];for(;t;)e.push(String.fromCharCode(t&255)),t>>=8;return e.reverse().join("")}setPrintHandler(t){this._printHandler=t}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(t,e){let n=this._identifier(t,[48,126]);this._escHandlers[n]===void 0&&(this._escHandlers[n]=[]);let i=this._escHandlers[n];return i.push(e),{dispose:()=>{let r=i.indexOf(e);r!==-1&&i.splice(r,1)}}}clearEscHandler(t){this._escHandlers[this._identifier(t,[48,126])]&&delete this._escHandlers[this._identifier(t,[48,126])]}setEscHandlerFallback(t){this._escHandlerFb=t}setExecuteHandler(t,e){this._executeHandlers[t.charCodeAt(0)]=e}clearExecuteHandler(t){this._executeHandlers[t.charCodeAt(0)]&&delete this._executeHandlers[t.charCodeAt(0)]}setExecuteHandlerFallback(t){this._executeHandlerFb=t}registerCsiHandler(t,e){let n=this._identifier(t);this._csiHandlers[n]===void 0&&(this._csiHandlers[n]=[]);let i=this._csiHandlers[n];return i.push(e),{dispose:()=>{let r=i.indexOf(e);r!==-1&&i.splice(r,1)}}}clearCsiHandler(t){this._csiHandlers[this._identifier(t)]&&delete this._csiHandlers[this._identifier(t)]}setCsiHandlerFallback(t){this._csiHandlerFb=t}registerDcsHandler(t,e){return this._dcsParser.registerHandler(this._identifier(t),e)}clearDcsHandler(t){this._dcsParser.clearHandler(this._identifier(t))}setDcsHandlerFallback(t){this._dcsParser.setHandlerFallback(t)}registerOscHandler(t,e){return this._oscParser.registerHandler(t,e)}clearOscHandler(t){this._oscParser.clearHandler(t)}setOscHandlerFallback(t){this._oscParser.setHandlerFallback(t)}setErrorHandler(t){this._errorHandler=t}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(t,e,n,i,r){this._parseStack.state=t,this._parseStack.handlers=e,this._parseStack.handlerPos=n,this._parseStack.transition=i,this._parseStack.chunkPos=r}parse(t,e,n){let i=0,r=0,s=0,o;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,s=this._parseStack.chunkPos+1;else{if(n===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let a=this._parseStack.handlers,l=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(n===!1&&l>-1){for(;l>=0&&(o=a[l](this._params),o!==!0);l--)if(o instanceof Promise)return this._parseStack.handlerPos=l,o}this._parseStack.handlers=[];break;case 4:if(n===!1&&l>-1){for(;l>=0&&(o=a[l](),o!==!0);l--)if(o instanceof Promise)return this._parseStack.handlerPos=l,o}this._parseStack.handlers=[];break;case 6:if(i=t[this._parseStack.chunkPos],o=this._dcsParser.unhook(i!==24&&i!==26,n),o)return o;i===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(i=t[this._parseStack.chunkPos],o=this._oscParser.end(i!==24&&i!==26,n),o)return o;i===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break}this._parseStack.state=0,s=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=this._parseStack.transition&15}for(let a=s;a<e;++a){switch(i=t[a],r=this._transitions.table[this.currentState<<8|(i<160?i:la)],r>>4){case 2:for(let p=a+1;;++p){if(p>=e||(i=t[p])<32||i>126&&i<la){this._printHandler(t,a,p),a=p-1;break}if(++p>=e||(i=t[p])<32||i>126&&i<la){this._printHandler(t,a,p),a=p-1;break}if(++p>=e||(i=t[p])<32||i>126&&i<la){this._printHandler(t,a,p),a=p-1;break}if(++p>=e||(i=t[p])<32||i>126&&i<la){this._printHandler(t,a,p),a=p-1;break}}break;case 3:this._executeHandlers[i]?this._executeHandlers[i]():this._executeHandlerFb(i),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:a,code:i,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let l=this._csiHandlers[this._collect<<8|i],c=l?l.length-1:-1;for(;c>=0&&(o=l[c](this._params),o!==!0);c--)if(o instanceof Promise)return this._preserveStack(3,l,c,r,a),o;c<0&&this._csiHandlerFb(this._collect<<8|i,this._params),this.precedingJoinState=0;break;case 8:do switch(i){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(i-48)}while(++a<e&&(i=t[a])>47&&i<60);a--;break;case 9:this._collect<<=8,this._collect|=i;break;case 10:let u=this._escHandlers[this._collect<<8|i],d=u?u.length-1:-1;for(;d>=0&&(o=u[d](),o!==!0);d--)if(o instanceof Promise)return this._preserveStack(4,u,d,r,a),o;d<0&&this._escHandlerFb(this._collect<<8|i),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|i,this._params);break;case 13:for(let p=a+1;;++p)if(p>=e||(i=t[p])===24||i===26||i===27||i>127&&i<la){this._dcsParser.put(t,a,p),a=p-1;break}break;case 14:if(o=this._dcsParser.unhook(i!==24&&i!==26),o)return this._preserveStack(6,[],0,r,a),o;i===27&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let p=a+1;;p++)if(p>=e||(i=t[p])<32||i>127&&i<la){this._oscParser.put(t,a,p),a=p-1;break}break;case 6:if(o=this._oscParser.end(i!==24&&i!==26),o)return this._preserveStack(5,[],0,r,a),o;i===27&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break}this.currentState=r&15}}},see=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,oee=/^[\da-f]+$/;function Q5(t){if(!t)return;let e=t.toLowerCase();if(e.indexOf("rgb:")===0){e=e.slice(4);let n=see.exec(e);if(n){let i=n[1]?15:n[4]?255:n[7]?4095:65535;return[Math.round(parseInt(n[1]||n[4]||n[7]||n[10],16)/i*255),Math.round(parseInt(n[2]||n[5]||n[8]||n[11],16)/i*255),Math.round(parseInt(n[3]||n[6]||n[9]||n[12],16)/i*255)]}}else if(e.indexOf("#")===0&&(e=e.slice(1),oee.exec(e)&&[3,6,9,12].includes(e.length))){let n=e.length/3,i=[0,0,0];for(let r=0;r<3;++r){let s=parseInt(e.slice(n*r,n*r+n),16);i[r]=n===1?s<<4:n===2?s:n===3?s>>4:s>>8}return i}}function G3(t,e){let n=t.toString(16),i=n.length<2?"0"+n:n;switch(e){case 4:return n[0];case 8:return i;case 12:return(i+i).slice(0,3);default:return i+i}}function aee(t,e=16){let[n,i,r]=t;return`rgb:${G3(n,e)}/${G3(i,e)}/${G3(r,e)}`}var lee={"(":0,")":1,"*":2,"+":3,"-":1,".":2},qu=131072,ez=10;function tz(t,e){if(t>24)return e.setWinLines||!1;switch(t){case 1:return!!e.restoreWin;case 2:return!!e.minimizeWin;case 3:return!!e.setWinPosition;case 4:return!!e.setWinSizePixels;case 5:return!!e.raiseWin;case 6:return!!e.lowerWin;case 7:return!!e.refreshWin;case 8:return!!e.setWinSizeChars;case 9:return!!e.maximizeWin;case 10:return!!e.fullscreenWin;case 11:return!!e.getWinState;case 13:return!!e.getWinPosition;case 14:return!!e.getWinSizePixels;case 15:return!!e.getScreenSizePixels;case 16:return!!e.getCellSizePixels;case 18:return!!e.getWinSizeChars;case 19:return!!e.getScreenSizeChars;case 20:return!!e.getIconTitle;case 21:return!!e.getWinTitle;case 22:return!!e.pushTitle;case 23:return!!e.popTitle;case 24:return!!e.setWinLines}return!1}var nz=5e3,iz=0,cee=class extends rn{constructor(t,e,n,i,r,s,o,a,l=new ree){super(),this._bufferService=t,this._charsetService=e,this._coreService=n,this._logService=i,this._optionsService=r,this._oscLinkService=s,this._coreMouseService=o,this._unicodeService=a,this._parser=l,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new eJ,this._utf8Decoder=new tJ,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=$i.clone(),this._eraseAttrDataInternal=$i.clone(),this._onRequestBell=this._register(new st),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this._register(new st),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this._register(new st),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this._register(new st),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this._register(new st),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this._register(new st),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this._register(new st),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this._register(new st),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this._register(new st),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this._register(new st),this.onLineFeed=this._onLineFeed.event,this._onScroll=this._register(new st),this.onScroll=this._onScroll.event,this._onTitleChange=this._register(new st),this.onTitleChange=this._onTitleChange.event,this._onColor=this._register(new st),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this._register(this._parser),this._dirtyRowTracker=new Mk(this._bufferService),this._activeBuffer=this._bufferService.buffer,this._register(this._bufferService.buffers.onBufferActivate(c=>this._activeBuffer=c.activeBuffer)),this._parser.setCsiHandlerFallback((c,u)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(c),params:u.toArray()})}),this._parser.setEscHandlerFallback(c=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(c)})}),this._parser.setExecuteHandlerFallback(c=>{this._logService.debug("Unknown EXECUTE code: ",{code:c})}),this._parser.setOscHandlerFallback((c,u,d)=>{this._logService.debug("Unknown OSC code: ",{identifier:c,action:u,data:d})}),this._parser.setDcsHandlerFallback((c,u,d)=>{u==="HOOK"&&(d=d.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(c),action:u,payload:d})}),this._parser.setPrintHandler((c,u,d)=>this.print(c,u,d)),this._parser.registerCsiHandler({final:"@"},c=>this.insertChars(c)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},c=>this.scrollLeft(c)),this._parser.registerCsiHandler({final:"A"},c=>this.cursorUp(c)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},c=>this.scrollRight(c)),this._parser.registerCsiHandler({final:"B"},c=>this.cursorDown(c)),this._parser.registerCsiHandler({final:"C"},c=>this.cursorForward(c)),this._parser.registerCsiHandler({final:"D"},c=>this.cursorBackward(c)),this._parser.registerCsiHandler({final:"E"},c=>this.cursorNextLine(c)),this._parser.registerCsiHandler({final:"F"},c=>this.cursorPrecedingLine(c)),this._parser.registerCsiHandler({final:"G"},c=>this.cursorCharAbsolute(c)),this._parser.registerCsiHandler({final:"H"},c=>this.cursorPosition(c)),this._parser.registerCsiHandler({final:"I"},c=>this.cursorForwardTab(c)),this._parser.registerCsiHandler({final:"J"},c=>this.eraseInDisplay(c,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},c=>this.eraseInDisplay(c,!0)),this._parser.registerCsiHandler({final:"K"},c=>this.eraseInLine(c,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},c=>this.eraseInLine(c,!0)),this._parser.registerCsiHandler({final:"L"},c=>this.insertLines(c)),this._parser.registerCsiHandler({final:"M"},c=>this.deleteLines(c)),this._parser.registerCsiHandler({final:"P"},c=>this.deleteChars(c)),this._parser.registerCsiHandler({final:"S"},c=>this.scrollUp(c)),this._parser.registerCsiHandler({final:"T"},c=>this.scrollDown(c)),this._parser.registerCsiHandler({final:"X"},c=>this.eraseChars(c)),this._parser.registerCsiHandler({final:"Z"},c=>this.cursorBackwardTab(c)),this._parser.registerCsiHandler({final:"`"},c=>this.charPosAbsolute(c)),this._parser.registerCsiHandler({final:"a"},c=>this.hPositionRelative(c)),this._parser.registerCsiHandler({final:"b"},c=>this.repeatPrecedingCharacter(c)),this._parser.registerCsiHandler({final:"c"},c=>this.sendDeviceAttributesPrimary(c)),this._parser.registerCsiHandler({prefix:">",final:"c"},c=>this.sendDeviceAttributesSecondary(c)),this._parser.registerCsiHandler({final:"d"},c=>this.linePosAbsolute(c)),this._parser.registerCsiHandler({final:"e"},c=>this.vPositionRelative(c)),this._parser.registerCsiHandler({final:"f"},c=>this.hVPosition(c)),this._parser.registerCsiHandler({final:"g"},c=>this.tabClear(c)),this._parser.registerCsiHandler({final:"h"},c=>this.setMode(c)),this._parser.registerCsiHandler({prefix:"?",final:"h"},c=>this.setModePrivate(c)),this._parser.registerCsiHandler({final:"l"},c=>this.resetMode(c)),this._parser.registerCsiHandler({prefix:"?",final:"l"},c=>this.resetModePrivate(c)),this._parser.registerCsiHandler({final:"m"},c=>this.charAttributes(c)),this._parser.registerCsiHandler({final:"n"},c=>this.deviceStatus(c)),this._parser.registerCsiHandler({prefix:"?",final:"n"},c=>this.deviceStatusPrivate(c)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},c=>this.softReset(c)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},c=>this.setCursorStyle(c)),this._parser.registerCsiHandler({final:"r"},c=>this.setScrollRegion(c)),this._parser.registerCsiHandler({final:"s"},c=>this.saveCursor(c)),this._parser.registerCsiHandler({final:"t"},c=>this.windowOptions(c)),this._parser.registerCsiHandler({final:"u"},c=>this.restoreCursor(c)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},c=>this.insertColumns(c)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},c=>this.deleteColumns(c)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},c=>this.selectProtected(c)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},c=>this.requestMode(c,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},c=>this.requestMode(c,!1)),this._parser.setExecuteHandler(qe.BEL,()=>this.bell()),this._parser.setExecuteHandler(qe.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(qe.BS,()=>this.backspace()),this._parser.setExecuteHandler(qe.HT,()=>this.tab()),this._parser.setExecuteHandler(qe.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(qe.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(Sw.IND,()=>this.index()),this._parser.setExecuteHandler(Sw.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(Sw.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new Ao(c=>(this.setTitle(c),this.setIconName(c),!0))),this._parser.registerOscHandler(1,new Ao(c=>this.setIconName(c))),this._parser.registerOscHandler(2,new Ao(c=>this.setTitle(c))),this._parser.registerOscHandler(4,new Ao(c=>this.setOrReportIndexedColor(c))),this._parser.registerOscHandler(8,new Ao(c=>this.setHyperlink(c))),this._parser.registerOscHandler(10,new Ao(c=>this.setOrReportFgColor(c))),this._parser.registerOscHandler(11,new Ao(c=>this.setOrReportBgColor(c))),this._parser.registerOscHandler(12,new Ao(c=>this.setOrReportCursorColor(c))),this._parser.registerOscHandler(104,new Ao(c=>this.restoreIndexedColor(c))),this._parser.registerOscHandler(110,new Ao(c=>this.restoreFgColor(c))),this._parser.registerOscHandler(111,new Ao(c=>this.restoreBgColor(c))),this._parser.registerOscHandler(112,new Ao(c=>this.restoreCursorColor(c))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let c in hr)this._parser.registerEscHandler({intermediates:"(",final:c},()=>this.selectCharset("("+c)),this._parser.registerEscHandler({intermediates:")",final:c},()=>this.selectCharset(")"+c)),this._parser.registerEscHandler({intermediates:"*",final:c},()=>this.selectCharset("*"+c)),this._parser.registerEscHandler({intermediates:"+",final:c},()=>this.selectCharset("+"+c)),this._parser.registerEscHandler({intermediates:"-",final:c},()=>this.selectCharset("-"+c)),this._parser.registerEscHandler({intermediates:".",final:c},()=>this.selectCharset("."+c)),this._parser.registerEscHandler({intermediates:"/",final:c},()=>this.selectCharset("/"+c));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(c=>(this._logService.error("Parsing error: ",c),c)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new Z5((c,u)=>this.requestStatusString(c,u)))}getAttrData(){return this._curAttrData}_preserveStack(t,e,n,i){this._parseStack.paused=!0,this._parseStack.cursorStartX=t,this._parseStack.cursorStartY=e,this._parseStack.decodedLength=n,this._parseStack.position=i}_logSlowResolvingAsync(t){this._logService.logLevel<=3&&Promise.race([t,new Promise((e,n)=>setTimeout(()=>n("#SLOW_TIMEOUT"),nz))]).catch(e=>{if(e!=="#SLOW_TIMEOUT")throw e;console.warn(`async parser handler taking longer than ${nz} ms`)})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(t,e){let n,i=this._activeBuffer.x,r=this._activeBuffer.y,s=0,o=this._parseStack.paused;if(o){if(n=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,e))return this._logSlowResolvingAsync(n),n;i=this._parseStack.cursorStartX,r=this._parseStack.cursorStartY,this._parseStack.paused=!1,t.length>qu&&(s=this._parseStack.position+qu)}if(this._logService.logLevel<=1&&this._logService.debug(`parsing data ${typeof t=="string"?` "${t}"`:` "${Array.prototype.map.call(t,c=>String.fromCharCode(c)).join("")}"`}`),this._logService.logLevel===0&&this._logService.trace("parsing data (codes)",typeof t=="string"?t.split("").map(c=>c.charCodeAt(0)):t),this._parseBuffer.length<t.length&&this._parseBuffer.length<qu&&(this._parseBuffer=new Uint32Array(Math.min(t.length,qu))),o||this._dirtyRowTracker.clearRange(),t.length>qu)for(let c=s;c<t.length;c+=qu){let u=c+qu<t.length?c+qu:t.length,d=typeof t=="string"?this._stringDecoder.decode(t.substring(c,u),this._parseBuffer):this._utf8Decoder.decode(t.subarray(c,u),this._parseBuffer);if(n=this._parser.parse(this._parseBuffer,d))return this._preserveStack(i,r,d,c),this._logSlowResolvingAsync(n),n}else if(!o){let c=typeof t=="string"?this._stringDecoder.decode(t,this._parseBuffer):this._utf8Decoder.decode(t,this._parseBuffer);if(n=this._parser.parse(this._parseBuffer,c))return this._preserveStack(i,r,c,0),this._logSlowResolvingAsync(n),n}(this._activeBuffer.x!==i||this._activeBuffer.y!==r)&&this._onCursorMove.fire();let a=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),l=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);l<this._bufferService.rows&&this._onRequestRefreshRows.fire({start:Math.min(l,this._bufferService.rows-1),end:Math.min(a,this._bufferService.rows-1)})}print(t,e,n){let i,r,s=this._charsetService.charset,o=this._optionsService.rawOptions.screenReaderMode,a=this._bufferService.cols,l=this._coreService.decPrivateModes.wraparound,c=this._coreService.modes.insertMode,u=this._curAttrData,d=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&n-e>0&&d.getWidth(this._activeBuffer.x-1)===2&&d.setCellFromCodepoint(this._activeBuffer.x-1,0,1,u);let p=this._parser.precedingJoinState;for(let m=e;m<n;++m){if(i=t[m],i<127&&s){let v=s[String.fromCharCode(i)];v&&(i=v.charCodeAt(0))}let g=this._unicodeService.charProperties(i,p);r=Cd.extractWidth(g);let _=Cd.extractShouldJoin(g),y=_?Cd.extractWidth(p):0;if(p=g,o&&this._onA11yChar.fire(Yu(i)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+r-y>a){if(l){let v=d,S=this._activeBuffer.x-y;for(this._activeBuffer.x=y,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),d=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),y>0&&d instanceof L_&&d.copyCellsFrom(v,S,0,y,!1);S<a;)v.setCellFromCodepoint(S++,0,1,u)}else if(this._activeBuffer.x=a-1,r===2)continue}if(_&&this._activeBuffer.x){let v=d.getWidth(this._activeBuffer.x-1)?1:2;d.addCodepointToCell(this._activeBuffer.x-v,i,r);for(let S=r-y;--S>=0;)d.setCellFromCodepoint(this._activeBuffer.x++,0,0,u);continue}if(c&&(d.insertCells(this._activeBuffer.x,r-y,this._activeBuffer.getNullCell(u)),d.getWidth(a-1)===2&&d.setCellFromCodepoint(a-1,0,1,u)),d.setCellFromCodepoint(this._activeBuffer.x++,i,r,u),r>0)for(;--r;)d.setCellFromCodepoint(this._activeBuffer.x++,0,0,u)}this._parser.precedingJoinState=p,this._activeBuffer.x<a&&n-e>0&&d.getWidth(this._activeBuffer.x)===0&&!d.hasContent(this._activeBuffer.x)&&d.setCellFromCodepoint(this._activeBuffer.x,0,1,u),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(t,e){return t.final==="t"&&!t.prefix&&!t.intermediates?this._parser.registerCsiHandler(t,n=>tz(n.params[0],this._optionsService.rawOptions.windowOptions)?e(n):!0):this._parser.registerCsiHandler(t,e)}registerDcsHandler(t,e){return this._parser.registerDcsHandler(t,new Z5(e))}registerEscHandler(t,e){return this._parser.registerEscHandler(t,e)}registerOscHandler(t,e){return this._parser.registerOscHandler(t,new Ao(e))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);t.hasWidth(this._activeBuffer.x)&&!t.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-t),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(t=this._bufferService.cols-1){this._activeBuffer.x=Math.min(t,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(t,e){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=t,this._activeBuffer.y=this._activeBuffer.scrollTop+e):(this._activeBuffer.x=t,this._activeBuffer.y=e),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(t,e){this._restrictCursor(),this._setCursor(this._activeBuffer.x+t,this._activeBuffer.y+e)}cursorUp(t){let e=this._activeBuffer.y-this._activeBuffer.scrollTop;return e>=0?this._moveCursor(0,-Math.min(e,t.params[0]||1)):this._moveCursor(0,-(t.params[0]||1)),!0}cursorDown(t){let e=this._activeBuffer.scrollBottom-this._activeBuffer.y;return e>=0?this._moveCursor(0,Math.min(e,t.params[0]||1)):this._moveCursor(0,t.params[0]||1),!0}cursorForward(t){return this._moveCursor(t.params[0]||1,0),!0}cursorBackward(t){return this._moveCursor(-(t.params[0]||1),0),!0}cursorNextLine(t){return this.cursorDown(t),this._activeBuffer.x=0,!0}cursorPrecedingLine(t){return this.cursorUp(t),this._activeBuffer.x=0,!0}cursorCharAbsolute(t){return this._setCursor((t.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(t){return this._setCursor(t.length>=2?(t.params[1]||1)-1:0,(t.params[0]||1)-1),!0}charPosAbsolute(t){return this._setCursor((t.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(t){return this._moveCursor(t.params[0]||1,0),!0}linePosAbsolute(t){return this._setCursor(this._activeBuffer.x,(t.params[0]||1)-1),!0}vPositionRelative(t){return this._moveCursor(0,t.params[0]||1),!0}hVPosition(t){return this.cursorPosition(t),!0}tabClear(t){let e=t.params[0];return e===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:e===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(t){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let e=t.params[0]||1;for(;e--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(t){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let e=t.params[0]||1;for(;e--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(t){let e=t.params[0];return e===1&&(this._curAttrData.bg|=536870912),(e===2||e===0)&&(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(t,e,n,i=!1,r=!1){let s=this._activeBuffer.lines.get(this._activeBuffer.ybase+t);s.replaceCells(e,n,this._activeBuffer.getNullCell(this._eraseAttrData()),r),i&&(s.isWrapped=!1)}_resetBufferLine(t,e=!1){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+t);n&&(n.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),e),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+t),n.isWrapped=!1)}eraseInDisplay(t,e=!1){this._restrictCursor(this._bufferService.cols);let n;switch(t.params[0]){case 0:for(n=this._activeBuffer.y,this._dirtyRowTracker.markDirty(n),this._eraseInBufferLine(n++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,e);n<this._bufferService.rows;n++)this._resetBufferLine(n,e);this._dirtyRowTracker.markDirty(n);break;case 1:for(n=this._activeBuffer.y,this._dirtyRowTracker.markDirty(n),this._eraseInBufferLine(n,0,this._activeBuffer.x+1,!0,e),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(n+1).isWrapped=!1);n--;)this._resetBufferLine(n,e);this._dirtyRowTracker.markDirty(0);break;case 2:if(this._optionsService.rawOptions.scrollOnEraseInDisplay){for(n=this._bufferService.rows,this._dirtyRowTracker.markRangeDirty(0,n-1);n--&&!this._activeBuffer.lines.get(this._activeBuffer.ybase+n)?.getTrimmedLength(););for(;n>=0;n--)this._bufferService.scroll(this._eraseAttrData())}else{for(n=this._bufferService.rows,this._dirtyRowTracker.markDirty(n-1);n--;)this._resetBufferLine(n,e);this._dirtyRowTracker.markDirty(0)}break;case 3:let i=this._activeBuffer.lines.length-this._bufferService.rows;i>0&&(this._activeBuffer.lines.trimStart(i),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-i,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-i,0),this._onScroll.fire(0));break}return!0}eraseInLine(t,e=!1){switch(this._restrictCursor(this._bufferService.cols),t.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,e);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,e);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,e);break}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(t){this._restrictCursor();let e=t.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let n=this._activeBuffer.ybase+this._activeBuffer.y,i=this._bufferService.rows-1-this._activeBuffer.scrollBottom,r=this._bufferService.rows-1+this._activeBuffer.ybase-i+1;for(;e--;)this._activeBuffer.lines.splice(r-1,1),this._activeBuffer.lines.splice(n,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(t){this._restrictCursor();let e=t.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let n=this._activeBuffer.ybase+this._activeBuffer.y,i;for(i=this._bufferService.rows-1-this._activeBuffer.scrollBottom,i=this._bufferService.rows-1+this._activeBuffer.ybase-i;e--;)this._activeBuffer.lines.splice(n,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(t){this._restrictCursor();let e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return e&&(e.insertCells(this._activeBuffer.x,t.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(t){this._restrictCursor();let e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return e&&(e.deleteCells(this._activeBuffer.x,t.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(t){let e=t.params[0]||1;for(;e--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(t){let e=t.params[0]||1;for(;e--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine($i));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let e=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);i.deleteCells(0,e,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let e=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);i.insertCells(0,e,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let e=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);i.insertCells(this._activeBuffer.x,e,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let e=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);i.deleteCells(this._activeBuffer.x,e,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(t){this._restrictCursor();let e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return e&&(e.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(t.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(t){let e=this._parser.precedingJoinState;if(!e)return!0;let n=t.params[0]||1,i=Cd.extractWidth(e),r=this._activeBuffer.x-i,s=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(r),o=new Uint32Array(s.length*n),a=0;for(let c=0;c<s.length;){let u=s.codePointAt(c)||0;o[a++]=u,c+=u>65535?2:1}let l=a;for(let c=1;c<n;++c)o.copyWithin(l,0,a),l+=a;return this.print(o,0,l),!0}sendDeviceAttributesPrimary(t){return t.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(qe.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(qe.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(t){return t.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(qe.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(qe.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(t.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(qe.ESC+"[>83;40003;0c")),!0}_is(t){return(this._optionsService.rawOptions.termName+"").indexOf(t)===0}setMode(t){for(let e=0;e<t.length;e++)switch(t.params[e]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0;break}return!0}setModePrivate(t){for(let e=0;e<t.length;e++)switch(t.params[e]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,Ed),this._charsetService.setgCharset(1,Ed),this._charsetService.setgCharset(2,Ed),this._charsetService.setgCharset(3,Ed);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!0;break}return!0}resetMode(t){for(let e=0;e<t.length;e++)switch(t.params[e]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1;break}return!0}resetModePrivate(t){for(let e=0;e<t.length;e++)switch(t.params[e]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),t.params[e]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!1,this._onRequestRefreshRows.fire(void 0);break}return!0}requestMode(t,e){(_=>(_[_.NOT_RECOGNIZED=0]="NOT_RECOGNIZED",_[_.SET=1]="SET",_[_.RESET=2]="RESET",_[_.PERMANENTLY_SET=3]="PERMANENTLY_SET",_[_.PERMANENTLY_RESET=4]="PERMANENTLY_RESET"))(void 0||(n={}));let i=this._coreService.decPrivateModes,{activeProtocol:r,activeEncoding:s}=this._coreMouseService,o=this._coreService,{buffers:a,cols:l}=this._bufferService,{active:c,alt:u}=a,d=this._optionsService.rawOptions,p=(_,y)=>(o.triggerDataEvent(`${qe.ESC}[${e?"":"?"}${_};${y}$y`),!0),m=_=>_?1:2,g=t.params[0];return e?g===2?p(g,4):g===4?p(g,m(o.modes.insertMode)):g===12?p(g,3):g===20?p(g,m(d.convertEol)):p(g,0):g===1?p(g,m(i.applicationCursorKeys)):g===3?p(g,d.windowOptions.setWinLines?l===80?2:l===132?1:0:0):g===6?p(g,m(i.origin)):g===7?p(g,m(i.wraparound)):g===8?p(g,3):g===9?p(g,m(r==="X10")):g===12?p(g,m(d.cursorBlink)):g===25?p(g,m(!o.isCursorHidden)):g===45?p(g,m(i.reverseWraparound)):g===66?p(g,m(i.applicationKeypad)):g===67?p(g,4):g===1e3?p(g,m(r==="VT200")):g===1002?p(g,m(r==="DRAG")):g===1003?p(g,m(r==="ANY")):g===1004?p(g,m(i.sendFocus)):g===1005?p(g,4):g===1006?p(g,m(s==="SGR")):g===1015?p(g,4):g===1016?p(g,m(s==="SGR_PIXELS")):g===1048?p(g,1):g===47||g===1047||g===1049?p(g,m(c===u)):g===2004?p(g,m(i.bracketedPasteMode)):g===2026?p(g,m(i.synchronizedOutput)):p(g,0)}_updateAttrColor(t,e,n,i,r){return e===2?(t|=50331648,t&=-16777216,t|=F_.fromColorRGB([n,i,r])):e===5&&(t&=-50331904,t|=33554432|n&255),t}_extractColor(t,e,n){let i=[0,0,-1,0,0,0],r=0,s=0;do{if(i[s+r]=t.params[e+s],t.hasSubParams(e+s)){let o=t.getSubParams(e+s),a=0;do i[1]===5&&(r=1),i[s+a+1+r]=o[a];while(++a<o.length&&a+s+1+r<i.length);break}if(i[1]===5&&s+r>=2||i[1]===2&&s+r>=5)break;i[1]&&(r=1)}while(++s+e<t.length&&s+r<i.length);for(let o=2;o<i.length;++o)i[o]===-1&&(i[o]=0);switch(i[0]){case 38:n.fg=this._updateAttrColor(n.fg,i[1],i[3],i[4],i[5]);break;case 48:n.bg=this._updateAttrColor(n.bg,i[1],i[3],i[4],i[5]);break;case 58:n.extended=n.extended.clone(),n.extended.underlineColor=this._updateAttrColor(n.extended.underlineColor,i[1],i[3],i[4],i[5])}return s}_processUnderline(t,e){e.extended=e.extended.clone(),(!~t||t>5)&&(t=1),e.extended.underlineStyle=t,e.fg|=268435456,t===0&&(e.fg&=-268435457),e.updateExtended()}_processSGR0(t){t.fg=$i.fg,t.bg=$i.bg,t.extended=t.extended.clone(),t.extended.underlineStyle=0,t.extended.underlineColor&=-67108864,t.updateExtended()}charAttributes(t){if(t.length===1&&t.params[0]===0)return this._processSGR0(this._curAttrData),!0;let e=t.length,n,i=this._curAttrData;for(let r=0;r<e;r++)n=t.params[r],n>=30&&n<=37?(i.fg&=-50331904,i.fg|=16777216|n-30):n>=40&&n<=47?(i.bg&=-50331904,i.bg|=16777216|n-40):n>=90&&n<=97?(i.fg&=-50331904,i.fg|=16777216|n-90|8):n>=100&&n<=107?(i.bg&=-50331904,i.bg|=16777216|n-100|8):n===0?this._processSGR0(i):n===1?i.fg|=134217728:n===3?i.bg|=67108864:n===4?(i.fg|=268435456,this._processUnderline(t.hasSubParams(r)?t.getSubParams(r)[0]:1,i)):n===5?i.fg|=536870912:n===7?i.fg|=67108864:n===8?i.fg|=1073741824:n===9?i.fg|=2147483648:n===2?i.bg|=134217728:n===21?this._processUnderline(2,i):n===22?(i.fg&=-134217729,i.bg&=-134217729):n===23?i.bg&=-67108865:n===24?(i.fg&=-268435457,this._processUnderline(0,i)):n===25?i.fg&=-536870913:n===27?i.fg&=-67108865:n===28?i.fg&=-1073741825:n===29?i.fg&=2147483647:n===39?(i.fg&=-67108864,i.fg|=$i.fg&16777215):n===49?(i.bg&=-67108864,i.bg|=$i.bg&16777215):n===38||n===48||n===58?r+=this._extractColor(t,r,i):n===53?i.bg|=1073741824:n===55?i.bg&=-1073741825:n===59?(i.extended=i.extended.clone(),i.extended.underlineColor=-1,i.updateExtended()):n===100?(i.fg&=-67108864,i.fg|=$i.fg&16777215,i.bg&=-67108864,i.bg|=$i.bg&16777215):this._logService.debug("Unknown SGR attribute: %d.",n);return!0}deviceStatus(t){switch(t.params[0]){case 5:this._coreService.triggerDataEvent(`${qe.ESC}[0n`);break;case 6:let e=this._activeBuffer.y+1,n=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${qe.ESC}[${e};${n}R`);break}return!0}deviceStatusPrivate(t){switch(t.params[0]){case 6:let e=this._activeBuffer.y+1,n=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${qe.ESC}[?${e};${n}R`);break;case 15:break;case 25:break;case 26:break;case 53:break}return!0}softReset(t){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=$i.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(t){let e=t.length===0?1:t.params[0];if(e===0)this._coreService.decPrivateModes.cursorStyle=void 0,this._coreService.decPrivateModes.cursorBlink=void 0;else{switch(e){case 1:case 2:this._coreService.decPrivateModes.cursorStyle="block";break;case 3:case 4:this._coreService.decPrivateModes.cursorStyle="underline";break;case 5:case 6:this._coreService.decPrivateModes.cursorStyle="bar";break}let n=e%2===1;this._coreService.decPrivateModes.cursorBlink=n}return!0}setScrollRegion(t){let e=t.params[0]||1,n;return(t.length<2||(n=t.params[1])>this._bufferService.rows||n===0)&&(n=this._bufferService.rows),n>e&&(this._activeBuffer.scrollTop=e-1,this._activeBuffer.scrollBottom=n-1,this._setCursor(0,0)),!0}windowOptions(t){if(!tz(t.params[0],this._optionsService.rawOptions.windowOptions))return!0;let e=t.length>1?t.params[1]:0;switch(t.params[0]){case 14:e!==2&&this._onRequestWindowsOptionsReport.fire(0);break;case 16:this._onRequestWindowsOptionsReport.fire(1);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${qe.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:(e===0||e===2)&&(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>ez&&this._windowTitleStack.shift()),(e===0||e===1)&&(this._iconNameStack.push(this._iconName),this._iconNameStack.length>ez&&this._iconNameStack.shift());break;case 23:(e===0||e===2)&&this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),(e===0||e===1)&&this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop());break}return!0}saveCursor(t){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(t){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(t){return this._windowTitle=t,this._onTitleChange.fire(t),!0}setIconName(t){return this._iconName=t,!0}setOrReportIndexedColor(t){let e=[],n=t.split(";");for(;n.length>1;){let i=n.shift(),r=n.shift();if(/^\d+$/.exec(i)){let s=parseInt(i);if(rz(s))if(r==="?")e.push({type:0,index:s});else{let o=Q5(r);o&&e.push({type:1,index:s,color:o})}}}return e.length&&this._onColor.fire(e),!0}setHyperlink(t){let e=t.indexOf(";");if(e===-1)return!0;let n=t.slice(0,e).trim(),i=t.slice(e+1);return i?this._createHyperlink(n,i):n.trim()?!1:this._finishHyperlink()}_createHyperlink(t,e){this._getCurrentLinkId()&&this._finishHyperlink();let n=t.split(":"),i,r=n.findIndex(s=>s.startsWith("id="));return r!==-1&&(i=n[r].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:i,uri:e}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(t,e){let n=t.split(";");for(let i=0;i<n.length&&!(e>=this._specialColors.length);++i,++e)if(n[i]==="?")this._onColor.fire([{type:0,index:this._specialColors[e]}]);else{let r=Q5(n[i]);r&&this._onColor.fire([{type:1,index:this._specialColors[e],color:r}])}return!0}setOrReportFgColor(t){return this._setOrReportSpecialColor(t,0)}setOrReportBgColor(t){return this._setOrReportSpecialColor(t,1)}setOrReportCursorColor(t){return this._setOrReportSpecialColor(t,2)}restoreIndexedColor(t){if(!t)return this._onColor.fire([{type:2}]),!0;let e=[],n=t.split(";");for(let i=0;i<n.length;++i)if(/^\d+$/.exec(n[i])){let r=parseInt(n[i]);rz(r)&&e.push({type:2,index:r})}return e.length&&this._onColor.fire(e),!0}restoreFgColor(t){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(t){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(t){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,Ed),!0}selectCharset(t){return t.length!==2?(this.selectDefaultCharset(),!0):(t[0]==="/"||this._charsetService.setgCharset(lee[t[0]],hr[t[1]]||Ed),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let t=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,t,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=$i.clone(),this._eraseAttrDataInternal=$i.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=this._curAttrData.bg&67108863,this._eraseAttrDataInternal}setgLevel(t){return this._charsetService.setgLevel(t),!0}screenAlignmentPattern(){let t=new ca;t.content=1<<22|69,t.fg=this._curAttrData.fg,t.bg=this._curAttrData.bg,this._setCursor(0,0);for(let e=0;e<this._bufferService.rows;++e){let n=this._activeBuffer.ybase+this._activeBuffer.y+e,i=this._activeBuffer.lines.get(n);i&&(i.fill(t),i.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(t,e){let n=o=>(this._coreService.triggerDataEvent(`${qe.ESC}${o}${qe.ESC}\\`),!0),i=this._bufferService.buffer,r=this._optionsService.rawOptions;return n(t==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:t==='"p'?'P1$r61;1"p':t==="r"?`P1$r${i.scrollTop+1};${i.scrollBottom+1}r`:t==="m"?"P1$r0m":t===" q"?`P1$r${{block:2,underline:4,bar:6}[r.cursorStyle]-(r.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(t,e){this._dirtyRowTracker.markRangeDirty(t,e)}},Mk=class{constructor(t){this._bufferService=t,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(t){t<this.start?this.start=t:t>this.end&&(this.end=t)}markRangeDirty(t,e){t>e&&(iz=t,t=e,e=iz),t<this.start&&(this.start=t),e>this.end&&(this.end=e)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};Mk=Ni([wt(0,ks)],Mk);function rz(t){return 0<=t&&t<256}var uee=5e7,sz=12,hee=50,dee=class extends rn{constructor(t){super(),this._action=t,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this._register(new st),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(t,e){if(e!==void 0&&this._syncCalls>e){this._syncCalls=0;return}if(this._pendingData+=t.length,this._writeBuffer.push(t),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;this._isSyncWriting=!0;let n;for(;n=this._writeBuffer.shift();){this._action(n);let i=this._callbacks.shift();i&&i()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(t,e){if(this._pendingData>uee)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput){this._didUserInput=!1,this._pendingData+=t.length,this._writeBuffer.push(t),this._callbacks.push(e),this._innerWrite();return}setTimeout(()=>this._innerWrite())}this._pendingData+=t.length,this._writeBuffer.push(t),this._callbacks.push(e)}_innerWrite(t=0,e=!0){let n=t||performance.now();for(;this._writeBuffer.length>this._bufferOffset;){let i=this._writeBuffer[this._bufferOffset],r=this._action(i,e);if(r){let o=a=>performance.now()-n>=sz?setTimeout(()=>this._innerWrite(0,a)):this._innerWrite(n,a);r.catch(a=>(queueMicrotask(()=>{throw a}),Promise.resolve(!1))).then(o);return}let s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=i.length,performance.now()-n>=sz)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>hee&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}},Ak=class{constructor(t){this._bufferService=t,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(t){let e=this._bufferService.buffer;if(t.id===void 0){let a=e.addMarker(e.ybase+e.y),l={data:t,id:this._nextId++,lines:[a]};return a.onDispose(()=>this._removeMarkerFromLink(l,a)),this._dataByLinkId.set(l.id,l),l.id}let n=t,i=this._getEntryIdKey(n),r=this._entriesWithId.get(i);if(r)return this.addLineToLink(r.id,e.ybase+e.y),r.id;let s=e.addMarker(e.ybase+e.y),o={id:this._nextId++,key:this._getEntryIdKey(n),data:n,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(o,s)),this._entriesWithId.set(o.key,o),this._dataByLinkId.set(o.id,o),o.id}addLineToLink(t,e){let n=this._dataByLinkId.get(t);if(n&&n.lines.every(i=>i.line!==e)){let i=this._bufferService.buffer.addMarker(e);n.lines.push(i),i.onDispose(()=>this._removeMarkerFromLink(n,i))}}getLinkData(t){return this._dataByLinkId.get(t)?.data}_getEntryIdKey(t){return`${t.id};;${t.uri}`}_removeMarkerFromLink(t,e){let n=t.lines.indexOf(e);n!==-1&&(t.lines.splice(n,1),t.lines.length===0&&(t.data.id!==void 0&&this._entriesWithId.delete(t.key),this._dataByLinkId.delete(t.id)))}};Ak=Ni([wt(0,ks)],Ak);var oz=!1,fee=class extends rn{constructor(t){super(),this._windowsWrappingHeuristics=this._register(new Zp),this._onBinary=this._register(new st),this.onBinary=this._onBinary.event,this._onData=this._register(new st),this.onData=this._onData.event,this._onLineFeed=this._register(new st),this.onLineFeed=this._onLineFeed.event,this._onResize=this._register(new st),this.onResize=this._onResize.event,this._onWriteParsed=this._register(new st),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this._register(new st),this._instantiationService=new OQ,this.optionsService=this._register(new qQ(t)),this._instantiationService.setService(Ls,this.optionsService),this._bufferService=this._register(this._instantiationService.createInstance(wk)),this._instantiationService.setService(ks,this._bufferService),this._logService=this._register(this._instantiationService.createInstance(bk)),this._instantiationService.setService(yz,this._logService),this.coreService=this._register(this._instantiationService.createInstance(Ek)),this._instantiationService.setService(kd,this.coreService),this.coreMouseService=this._register(this._instantiationService.createInstance(Ck)),this._instantiationService.setService(_z,this.coreMouseService),this.unicodeService=this._register(this._instantiationService.createInstance(Cd)),this._instantiationService.setService(sJ,this.unicodeService),this._charsetService=this._instantiationService.createInstance(ZQ),this._instantiationService.setService(rJ,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(Ak),this._instantiationService.setService(xz,this._oscLinkService),this._inputHandler=this._register(new cee(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this._register(Fr.forward(this._inputHandler.onLineFeed,this._onLineFeed)),this._register(this._inputHandler),this._register(Fr.forward(this._bufferService.onResize,this._onResize)),this._register(Fr.forward(this.coreService.onData,this._onData)),this._register(Fr.forward(this.coreService.onBinary,this._onBinary)),this._register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom(!0))),this._register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this._register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this._register(this._bufferService.onScroll(()=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this._register(new dee((e,n)=>this._inputHandler.parse(e,n))),this._register(Fr.forward(this._writeBuffer.onWriteParsed,this._onWriteParsed))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this._register(new st),this._onScroll.event(t=>{this._onScrollApi?.fire(t.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(t){for(let e in t)this.optionsService.options[e]=t[e]}write(t,e){this._writeBuffer.write(t,e)}writeSync(t,e){this._logService.logLevel<=3&&!oz&&(this._logService.warn("writeSync is unreliable and will be removed soon."),oz=!0),this._writeBuffer.writeSync(t,e)}input(t,e=!0){this.coreService.triggerDataEvent(t,e)}resize(t,e){isNaN(t)||isNaN(e)||(t=Math.max(t,a6),e=Math.max(e,l6),this._bufferService.resize(t,e))}scroll(t,e=!1){this._bufferService.scroll(t,e)}scrollLines(t,e){this._bufferService.scrollLines(t,e)}scrollPages(t){this.scrollLines(t*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(t){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(t){let e=t-this._bufferService.buffer.ydisp;e!==0&&this.scrollLines(e)}registerEscHandler(t,e){return this._inputHandler.registerEscHandler(t,e)}registerDcsHandler(t,e){return this._inputHandler.registerDcsHandler(t,e)}registerCsiHandler(t,e){return this._inputHandler.registerCsiHandler(t,e)}registerOscHandler(t,e){return this._inputHandler.registerOscHandler(t,e)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let t=!1,e=this.optionsService.rawOptions.windowsPty;e&&e.buildNumber!==void 0&&e.buildNumber!==void 0?t=e.backend==="conpty"&&e.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(t=!0),t?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let t=[];t.push(this.onLineFeed(J5.bind(null,this._bufferService))),t.push(this.registerCsiHandler({final:"H"},()=>(J5(this._bufferService),!1))),this._windowsWrappingHeuristics.value=ai(()=>{for(let e of t)e.dispose()})}}},pee={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};function mee(t,e,n,i){let r={type:0,cancel:!1,key:void 0},s=(t.shiftKey?1:0)|(t.altKey?2:0)|(t.ctrlKey?4:0)|(t.metaKey?8:0);switch(t.keyCode){case 0:t.key==="UIKeyInputUpArrow"?e?r.key=qe.ESC+"OA":r.key=qe.ESC+"[A":t.key==="UIKeyInputLeftArrow"?e?r.key=qe.ESC+"OD":r.key=qe.ESC+"[D":t.key==="UIKeyInputRightArrow"?e?r.key=qe.ESC+"OC":r.key=qe.ESC+"[C":t.key==="UIKeyInputDownArrow"&&(e?r.key=qe.ESC+"OB":r.key=qe.ESC+"[B");break;case 8:r.key=t.ctrlKey?"\b":qe.DEL,t.altKey&&(r.key=qe.ESC+r.key);break;case 9:if(t.shiftKey){r.key=qe.ESC+"[Z";break}r.key=qe.HT,r.cancel=!0;break;case 13:r.key=t.altKey?qe.ESC+qe.CR:qe.CR,r.cancel=!0;break;case 27:r.key=qe.ESC,t.altKey&&(r.key=qe.ESC+qe.ESC),r.cancel=!0;break;case 37:if(t.metaKey)break;s?r.key=qe.ESC+"[1;"+(s+1)+"D":e?r.key=qe.ESC+"OD":r.key=qe.ESC+"[D";break;case 39:if(t.metaKey)break;s?r.key=qe.ESC+"[1;"+(s+1)+"C":e?r.key=qe.ESC+"OC":r.key=qe.ESC+"[C";break;case 38:if(t.metaKey)break;s?r.key=qe.ESC+"[1;"+(s+1)+"A":e?r.key=qe.ESC+"OA":r.key=qe.ESC+"[A";break;case 40:if(t.metaKey)break;s?r.key=qe.ESC+"[1;"+(s+1)+"B":e?r.key=qe.ESC+"OB":r.key=qe.ESC+"[B";break;case 45:!t.shiftKey&&!t.ctrlKey&&(r.key=qe.ESC+"[2~");break;case 46:s?r.key=qe.ESC+"[3;"+(s+1)+"~":r.key=qe.ESC+"[3~";break;case 36:s?r.key=qe.ESC+"[1;"+(s+1)+"H":e?r.key=qe.ESC+"OH":r.key=qe.ESC+"[H";break;case 35:s?r.key=qe.ESC+"[1;"+(s+1)+"F":e?r.key=qe.ESC+"OF":r.key=qe.ESC+"[F";break;case 33:t.shiftKey?r.type=2:t.ctrlKey?r.key=qe.ESC+"[5;"+(s+1)+"~":r.key=qe.ESC+"[5~";break;case 34:t.shiftKey?r.type=3:t.ctrlKey?r.key=qe.ESC+"[6;"+(s+1)+"~":r.key=qe.ESC+"[6~";break;case 112:s?r.key=qe.ESC+"[1;"+(s+1)+"P":r.key=qe.ESC+"OP";break;case 113:s?r.key=qe.ESC+"[1;"+(s+1)+"Q":r.key=qe.ESC+"OQ";break;case 114:s?r.key=qe.ESC+"[1;"+(s+1)+"R":r.key=qe.ESC+"OR";break;case 115:s?r.key=qe.ESC+"[1;"+(s+1)+"S":r.key=qe.ESC+"OS";break;case 116:s?r.key=qe.ESC+"[15;"+(s+1)+"~":r.key=qe.ESC+"[15~";break;case 117:s?r.key=qe.ESC+"[17;"+(s+1)+"~":r.key=qe.ESC+"[17~";break;case 118:s?r.key=qe.ESC+"[18;"+(s+1)+"~":r.key=qe.ESC+"[18~";break;case 119:s?r.key=qe.ESC+"[19;"+(s+1)+"~":r.key=qe.ESC+"[19~";break;case 120:s?r.key=qe.ESC+"[20;"+(s+1)+"~":r.key=qe.ESC+"[20~";break;case 121:s?r.key=qe.ESC+"[21;"+(s+1)+"~":r.key=qe.ESC+"[21~";break;case 122:s?r.key=qe.ESC+"[23;"+(s+1)+"~":r.key=qe.ESC+"[23~";break;case 123:s?r.key=qe.ESC+"[24;"+(s+1)+"~":r.key=qe.ESC+"[24~";break;default:if(t.ctrlKey&&!t.shiftKey&&!t.altKey&&!t.metaKey)t.keyCode>=65&&t.keyCode<=90?r.key=String.fromCharCode(t.keyCode-64):t.keyCode===32?r.key=qe.NUL:t.keyCode>=51&&t.keyCode<=55?r.key=String.fromCharCode(t.keyCode-51+27):t.keyCode===56?r.key=qe.DEL:t.keyCode===219?r.key=qe.ESC:t.keyCode===220?r.key=qe.FS:t.keyCode===221&&(r.key=qe.GS);else if((!n||i)&&t.altKey&&!t.metaKey){let o=pee[t.keyCode]?.[t.shiftKey?1:0];if(o)r.key=qe.ESC+o;else if(t.keyCode>=65&&t.keyCode<=90){let a=t.ctrlKey?t.keyCode-64:t.keyCode+32,l=String.fromCharCode(a);t.shiftKey&&(l=l.toUpperCase()),r.key=qe.ESC+l}else if(t.keyCode===32)r.key=qe.ESC+(t.ctrlKey?qe.NUL:" ");else if(t.key==="Dead"&&t.code.startsWith("Key")){let a=t.code.slice(3,4);t.shiftKey||(a=a.toLowerCase()),r.key=qe.ESC+a,r.cancel=!0}}else n&&!t.altKey&&!t.ctrlKey&&!t.shiftKey&&t.metaKey?t.keyCode===65&&(r.type=1):t.key&&!t.ctrlKey&&!t.altKey&&!t.metaKey&&t.keyCode>=48&&t.key.length===1?r.key=t.key:t.key&&t.ctrlKey&&(t.key==="_"&&(r.key=qe.US),t.key==="@"&&(r.key=qe.NUL));break}return r}var Vi=0,gee=class{constructor(t){this._getKey=t,this._array=[],this._insertedValues=[],this._flushInsertedTask=new Pw,this._isFlushingInserted=!1,this._deletedIndices=[],this._flushDeletedTask=new Pw,this._isFlushingDeleted=!1}clear(){this._array.length=0,this._insertedValues.length=0,this._flushInsertedTask.clear(),this._isFlushingInserted=!1,this._deletedIndices.length=0,this._flushDeletedTask.clear(),this._isFlushingDeleted=!1}insert(t){this._flushCleanupDeleted(),this._insertedValues.length===0&&this._flushInsertedTask.enqueue(()=>this._flushInserted()),this._insertedValues.push(t)}_flushInserted(){let t=this._insertedValues.sort((r,s)=>this._getKey(r)-this._getKey(s)),e=0,n=0,i=new Array(this._array.length+this._insertedValues.length);for(let r=0;r<i.length;r++)n>=this._array.length||this._getKey(t[e])<=this._getKey(this._array[n])?(i[r]=t[e],e++):i[r]=this._array[n++];this._array=i,this._insertedValues.length=0}_flushCleanupInserted(){!this._isFlushingInserted&&this._insertedValues.length>0&&this._flushInsertedTask.flush()}delete(t){if(this._flushCleanupInserted(),this._array.length===0)return!1;let e=this._getKey(t);if(e===void 0||(Vi=this._search(e),Vi===-1)||this._getKey(this._array[Vi])!==e)return!1;do if(this._array[Vi]===t)return this._deletedIndices.length===0&&this._flushDeletedTask.enqueue(()=>this._flushDeleted()),this._deletedIndices.push(Vi),!0;while(++Vi<this._array.length&&this._getKey(this._array[Vi])===e);return!1}_flushDeleted(){this._isFlushingDeleted=!0;let t=this._deletedIndices.sort((r,s)=>r-s),e=0,n=new Array(this._array.length-t.length),i=0;for(let r=0;r<this._array.length;r++)t[e]===r?e++:n[i++]=this._array[r];this._array=n,this._deletedIndices.length=0,this._isFlushingDeleted=!1}_flushCleanupDeleted(){!this._isFlushingDeleted&&this._deletedIndices.length>0&&this._flushDeletedTask.flush()}*getKeyIterator(t){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(Vi=this._search(t),!(Vi<0||Vi>=this._array.length)&&this._getKey(this._array[Vi])===t))do yield this._array[Vi];while(++Vi<this._array.length&&this._getKey(this._array[Vi])===t)}forEachByKey(t,e){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(Vi=this._search(t),!(Vi<0||Vi>=this._array.length)&&this._getKey(this._array[Vi])===t))do e(this._array[Vi]);while(++Vi<this._array.length&&this._getKey(this._array[Vi])===t)}values(){return this._flushCleanupInserted(),this._flushCleanupDeleted(),[...this._array].values()}_search(t){let e=0,n=this._array.length-1;for(;n>=e;){let i=e+n>>1,r=this._getKey(this._array[i]);if(r>t)n=i-1;else if(r<t)e=i+1;else{for(;i>0&&this._getKey(this._array[i-1])===t;)i--;return i}}return e}},j3=0,az=0,vee=class extends rn{constructor(){super(),this._decorations=new gee(t=>t?.marker.line),this._onDecorationRegistered=this._register(new st),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this._register(new st),this.onDecorationRemoved=this._onDecorationRemoved.event,this._register(ai(()=>this.reset()))}get decorations(){return this._decorations.values()}registerDecoration(t){if(t.marker.isDisposed)return;let e=new _ee(t);if(e){let n=e.marker.onDispose(()=>e.dispose()),i=e.onDispose(()=>{i.dispose(),e&&(this._decorations.delete(e)&&this._onDecorationRemoved.fire(e),n.dispose())});this._decorations.insert(e),this._onDecorationRegistered.fire(e)}return e}reset(){for(let t of this._decorations.values())t.dispose();this._decorations.clear()}*getDecorationsAtCell(t,e,n){let i=0,r=0;for(let s of this._decorations.getKeyIterator(e))i=s.options.x??0,r=i+(s.options.width??1),t>=i&&t<r&&(!n||(s.options.layer??"bottom")===n)&&(yield s)}forEachDecorationAtCell(t,e,n,i){this._decorations.forEachByKey(e,r=>{j3=r.options.x??0,az=j3+(r.options.width??1),t>=j3&&t<az&&(!n||(r.options.layer??"bottom")===n)&&i(r)})}},_ee=class extends $u{constructor(t){super(),this.options=t,this.onRenderEmitter=this.add(new st),this.onRender=this.onRenderEmitter.event,this._onDispose=this.add(new st),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=t.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=Ci.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=Ci.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}},yee=1e3,xee=class{constructor(t,e=yee){this._renderCallback=t,this._debounceThresholdMS=e,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(t,e,n){this._rowCount=n,t=t!==void 0?t:0,e=e!==void 0?e:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,e):e;let i=performance.now();if(i-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=i,this._innerRefresh();else if(!this._additionalRefreshRequested){let r=i-this._lastRefreshMs,s=this._debounceThresholdMS-r;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=performance.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},s)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let t=Math.max(this._rowStart,0),e=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,e)}},lz=20,cz=!1,Dw=class extends rn{constructor(t,e,n,i){super(),this._terminal=t,this._coreBrowserService=n,this._renderService=i,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="";let r=this._coreBrowserService.mainDocument;this._accessibilityContainer=r.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=r.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let s=0;s<this._terminal.rows;s++)this._rowElements[s]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[s]);if(this._topBoundaryFocusListener=s=>this._handleBoundaryFocus(s,0),this._bottomBoundaryFocusListener=s=>this._handleBoundaryFocus(s,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=r.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this._register(new xee(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");cz?(this._accessibilityContainer.classList.add("debug"),this._rowContainer.classList.add("debug"),this._debugRootContainer=r.createElement("div"),this._debugRootContainer.classList.add("xterm"),this._debugRootContainer.appendChild(r.createTextNode("------start a11y------")),this._debugRootContainer.appendChild(this._accessibilityContainer),this._debugRootContainer.appendChild(r.createTextNode("------end a11y------")),this._terminal.element.insertAdjacentElement("afterend",this._debugRootContainer)):this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this._register(this._terminal.onResize(s=>this._handleResize(s.rows))),this._register(this._terminal.onRender(s=>this._refreshRows(s.start,s.end))),this._register(this._terminal.onScroll(()=>this._refreshRows())),this._register(this._terminal.onA11yChar(s=>this._handleChar(s))),this._register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this._register(this._terminal.onA11yTab(s=>this._handleTab(s))),this._register(this._terminal.onKey(s=>this._handleKey(s.key))),this._register(this._terminal.onBlur(()=>this._clearLiveRegion())),this._register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._register(Gt(r,"selectionchange",()=>this._handleSelectionChange())),this._register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRowsDimensions(),this._refreshRows(),this._register(ai(()=>{cz?this._debugRootContainer.remove():this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(t){for(let e=0;e<t;e++)this._handleChar(" ")}_handleChar(t){this._liveRegionLineCount<lz+1&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==t&&(this._charsToAnnounce+=t):this._charsToAnnounce+=t,t===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===lz+1&&(this._liveRegion.textContent+=q3.get())))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(t){this._clearLiveRegion(),/\p{Control}/u.test(t)||this._charsToConsume.push(t)}_refreshRows(t,e){this._liveRegionDebouncer.refresh(t,e,this._terminal.rows)}_renderRows(t,e){let n=this._terminal.buffer,i=n.lines.length.toString();for(let r=t;r<=e;r++){let s=n.lines.get(n.ydisp+r),o=[],a=s?.translateToString(!0,void 0,void 0,o)||"",l=(n.ydisp+r+1).toString(),c=this._rowElements[r];c&&(a.length===0?(c.textContent="\xA0",this._rowColumns.set(c,[0,1])):(c.textContent=a,this._rowColumns.set(c,o)),c.setAttribute("aria-posinset",l),c.setAttribute("aria-setsize",i),this._alignRowWidth(c))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(t,e){let n=t.target,i=this._rowElements[e===0?1:this._rowElements.length-2],r=n.getAttribute("aria-posinset"),s=e===0?"1":`${this._terminal.buffer.lines.length}`;if(r===s||t.relatedTarget!==i)return;let o,a;if(e===0?(o=n,a=this._rowElements.pop(),this._rowContainer.removeChild(a)):(o=this._rowElements.shift(),a=n,this._rowContainer.removeChild(o)),o.removeEventListener("focus",this._topBoundaryFocusListener),a.removeEventListener("focus",this._bottomBoundaryFocusListener),e===0){let l=this._createAccessibilityTreeNode();this._rowElements.unshift(l),this._rowContainer.insertAdjacentElement("afterbegin",l)}else{let l=this._createAccessibilityTreeNode();this._rowElements.push(l),this._rowContainer.appendChild(l)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(e===0?-1:1),this._rowElements[e===0?1:this._rowElements.length-2].focus(),t.preventDefault(),t.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;let t=this._coreBrowserService.mainDocument.getSelection();if(!t)return;if(t.isCollapsed){this._rowContainer.contains(t.anchorNode)&&this._terminal.clearSelection();return}if(!t.anchorNode||!t.focusNode){console.error("anchorNode and/or focusNode are null");return}let e={node:t.anchorNode,offset:t.anchorOffset},n={node:t.focusNode,offset:t.focusOffset};if((e.node.compareDocumentPosition(n.node)&Node.DOCUMENT_POSITION_PRECEDING||e.node===n.node&&e.offset>n.offset)&&([e,n]=[n,e]),e.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(e={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(e.node))return;let i=this._rowElements.slice(-1)[0];if(n.node.compareDocumentPosition(i)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(n={node:i,offset:i.textContent?.length??0}),!this._rowContainer.contains(n.node))return;let r=({node:a,offset:l})=>{let c=a instanceof Text?a.parentNode:a,u=parseInt(c?.getAttribute("aria-posinset"),10)-1;if(isNaN(u))return console.warn("row is invalid. Race condition?"),null;let d=this._rowColumns.get(c);if(!d)return console.warn("columns is null. Race condition?"),null;let p=l<d.length?d[l]:d.slice(-1)[0]+1;return p>=this._terminal.cols&&(++u,p=0),{row:u,column:p}},s=r(e),o=r(n);if(!(!s||!o)){if(s.row>o.row||s.row===o.row&&s.column>=o.column)throw new Error("invalid range");this._terminal.select(s.column,s.row,(o.row-s.row)*this._terminal.cols-s.column+o.column)}}_handleResize(t){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let e=this._rowContainer.children.length;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let t=this._coreBrowserService.mainDocument.createElement("div");return t.setAttribute("role","listitem"),t.tabIndex=-1,this._refreshRowDimensions(t),t}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){Object.assign(this._accessibilityContainer.style,{width:`${this._renderService.dimensions.css.canvas.width}px`,fontSize:`${this._terminal.options.fontSize}px`}),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let t=0;t<this._terminal.rows;t++)this._refreshRowDimensions(this._rowElements[t]),this._alignRowWidth(this._rowElements[t])}}_refreshRowDimensions(t){t.style.height=`${this._renderService.dimensions.css.cell.height}px`}_alignRowWidth(t){t.style.transform="";let e=t.getBoundingClientRect().width,n=this._rowColumns.get(t)?.slice(-1)?.[0];if(!n)return;let i=n*this._renderService.dimensions.css.cell.width;t.style.transform=`scaleX(${i/e})`}};Dw=Ni([wt(1,Lk),wt(2,Ec),wt(3,Cc)],Dw);var kk=class extends rn{constructor(t,e,n,i,r){super(),this._element=t,this._mouseService=e,this._renderService=n,this._bufferService=i,this._linkProviderService=r,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this._register(new st),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this._register(new st),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this._register(ai(()=>{Md(this._linkCacheDisposables),this._linkCacheDisposables.length=0,this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this._register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this._register(Gt(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this._register(Gt(this._element,"mousemove",this._handleMouseMove.bind(this))),this._register(Gt(this._element,"mousedown",this._handleMouseDown.bind(this))),this._register(Gt(this._element,"mouseup",this._handleMouseUp.bind(this)))}get currentLink(){return this._currentLink}_handleMouseMove(t){this._lastMouseEvent=t;let e=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!e)return;this._isMouseOut=!1;let n=t.composedPath();for(let i=0;i<n.length;i++){let r=n[i];if(r.classList.contains("xterm"))break;if(r.classList.contains("xterm-hover"))return}(!this._lastBufferCell||e.x!==this._lastBufferCell.x||e.y!==this._lastBufferCell.y)&&(this._handleHover(e),this._lastBufferCell=e)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized){this._clearCurrentLink(),this._askForLink(t,!1),this._wasResized=!1;return}this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,e){(!this._activeProviderReplies||!e)&&(this._activeProviderReplies?.forEach(i=>{i?.forEach(r=>{r.link.dispose&&r.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let n=!1;for(let[i,r]of this._linkProviderService.linkProviders.entries())e?this._activeProviderReplies?.get(i)&&(n=this._checkLinkProviderResult(i,t,n)):r.provideLinks(t.y,s=>{if(this._isMouseOut)return;let o=s?.map(a=>({link:a}));this._activeProviderReplies?.set(i,o),n=this._checkLinkProviderResult(i,t,n),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,e){let n=new Set;for(let i=0;i<e.size;i++){let r=e.get(i);if(r)for(let s=0;s<r.length;s++){let o=r[s],a=o.link.range.start.y<t?0:o.link.range.start.x,l=o.link.range.end.y>t?this._bufferService.cols:o.link.range.end.x;for(let c=a;c<=l;c++){if(n.has(c)){r.splice(s--,1);break}n.add(c)}}}}_checkLinkProviderResult(t,e,n){if(!this._activeProviderReplies)return n;let i=this._activeProviderReplies.get(t),r=!1;for(let s=0;s<t;s++)(!this._activeProviderReplies.has(s)||this._activeProviderReplies.get(s))&&(r=!0);if(!r&&i){let s=i.find(o=>this._linkAtPosition(o.link,e));s&&(n=!0,this._handleNewLink(s))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!n)for(let s=0;s<this._activeProviderReplies.size;s++){let o=this._activeProviderReplies.get(s)?.find(a=>this._linkAtPosition(a.link,e));if(o){n=!0,this._handleNewLink(o);break}}return n}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._currentLink)return;let e=this._positionFromMouseEvent(t,this._element,this._mouseService);e&&this._mouseDownLink&&See(this._mouseDownLink.link,this._currentLink.link)&&this._linkAtPosition(this._currentLink.link,e)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,e){!this._currentLink||!this._lastMouseEvent||(!t||!e||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=e)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,Md(this._linkCacheDisposables),this._linkCacheDisposables.length=0)}_handleNewLink(t){if(!this._lastMouseEvent)return;let e=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);e&&this._linkAtPosition(t.link,e)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0?!0:t.link.decorations.underline,pointerCursor:t.link.decorations===void 0?!0:t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:n=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==n&&(this._currentLink.state.decorations.pointerCursor=n,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",n))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:n=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==n&&(this._currentLink.state.decorations.underline=n,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,n))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(n=>{if(!this._currentLink)return;let i=n.start===0?0:n.start+1+this._bufferService.buffer.ydisp,r=this._bufferService.buffer.ydisp+1+n.end;if(this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=r&&(this._clearCurrentLink(i,r),this._lastMouseEvent)){let s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._askForLink(s,!1)}})))}_linkHover(t,e,n){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(e,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),e.hover&&e.hover(n,e.text)}_fireUnderlineEvent(t,e){let n=t.range,i=this._bufferService.buffer.ydisp,r=this._createLinkUnderlineEvent(n.start.x-1,n.start.y-i-1,n.end.x,n.end.y-i-1,void 0);(e?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(r)}_linkLeave(t,e,n){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(e,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),e.leave&&e.leave(n,e.text)}_linkAtPosition(t,e){let n=t.range.start.y*this._bufferService.cols+t.range.start.x,i=t.range.end.y*this._bufferService.cols+t.range.end.x,r=e.y*this._bufferService.cols+e.x;return n<=r&&r<=i}_positionFromMouseEvent(t,e,n){let i=n.getCoords(t,e,this._bufferService.cols,this._bufferService.rows);if(i)return{x:i[0],y:i[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,e,n,i,r){return{x1:t,y1:e,x2:n,y2:i,cols:this._bufferService.cols,fg:r}}};kk=Ni([wt(1,Pk),wt(2,Cc),wt(3,ks),wt(4,bz)],kk);function See(t,e){return t.text===e.text&&t.range.start.x===e.range.start.x&&t.range.start.y===e.range.start.y&&t.range.end.x===e.range.end.x&&t.range.end.y===e.range.end.y}var bee=class extends fee{constructor(t={}){super(t),this._linkifier=this._register(new Zp),this.browser=$z,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this._register(new Zp),this._onCursorMove=this._register(new st),this.onCursorMove=this._onCursorMove.event,this._onKey=this._register(new st),this.onKey=this._onKey.event,this._onRender=this._register(new st),this.onRender=this._onRender.event,this._onSelectionChange=this._register(new st),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this._register(new st),this.onTitleChange=this._onTitleChange.event,this._onBell=this._register(new st),this.onBell=this._onBell.event,this._onFocus=this._register(new st),this._onBlur=this._register(new st),this._onA11yCharEmitter=this._register(new st),this._onA11yTabEmitter=this._register(new st),this._onWillOpen=this._register(new st),this._setup(),this._decorationService=this._instantiationService.createInstance(vee),this._instantiationService.setService(z_,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(uQ),this._instantiationService.setService(bz,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(K3)),this._register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this._register(this._inputHandler.onRequestRefreshRows(e=>this.refresh(e?.start??0,e?.end??this.rows-1))),this._register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this._register(this._inputHandler.onRequestReset(()=>this.reset())),this._register(this._inputHandler.onRequestWindowsOptionsReport(e=>this._reportWindowsOptions(e))),this._register(this._inputHandler.onColor(e=>this._handleColorEvent(e))),this._register(Fr.forward(this._inputHandler.onCursorMove,this._onCursorMove)),this._register(Fr.forward(this._inputHandler.onTitleChange,this._onTitleChange)),this._register(Fr.forward(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this._register(Fr.forward(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this._register(this._bufferService.onResize(e=>this._afterResize(e.cols,e.rows))),this._register(ai(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}get linkifier(){return this._linkifier.value}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(t){if(this._themeService)for(let e of t){let n,i="";switch(e.index){case 256:n="foreground",i="10";break;case 257:n="background",i="11";break;case 258:n="cursor",i="12";break;default:n="ansi",i="4;"+e.index}switch(e.type){case 0:let r=oi.toColorRGB(n==="ansi"?this._themeService.colors.ansi[e.index]:this._themeService.colors[n]);this.coreService.triggerDataEvent(`${qe.ESC}]${i};${aee(r)}${Yz.ST}`);break;case 1:if(n==="ansi")this._themeService.modifyColors(s=>s.ansi[e.index]=Ji.toColor(...e.color));else{let s=n;this._themeService.modifyColors(o=>o[s]=Ji.toColor(...e.color))}break;case 2:this._themeService.restoreColor(e.index);break}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(t){t?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Dw,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(t){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(qe.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(qe.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let t=this.buffer.ybase+this.buffer.y,e=this.buffer.lines.get(t);if(!e)return;let n=Math.min(this.buffer.x,this.cols-1),i=this._renderService.dimensions.css.cell.height,r=e.getWidth(n),s=this._renderService.dimensions.css.cell.width*r,o=this.buffer.y*this._renderService.dimensions.css.cell.height,a=n*this._renderService.dimensions.css.cell.width;this.textarea.style.left=a+"px",this.textarea.style.top=o+"px",this.textarea.style.width=s+"px",this.textarea.style.height=i+"px",this.textarea.style.lineHeight=i+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this._register(Gt(this.element,"copy",e=>{this.hasSelection()&&Z$(e,this._selectionService)}));let t=e=>Q$(e,this.textarea,this.coreService,this.optionsService);this._register(Gt(this.textarea,"paste",t)),this._register(Gt(this.element,"paste",t)),Jz?this._register(Gt(this.element,"mousedown",e=>{e.button===2&&u5(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this._register(Gt(this.element,"contextmenu",e=>{u5(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),Fk&&this._register(Gt(this.element,"auxclick",e=>{e.button===1&&fz(e,this.textarea,this.screenElement)}))}_bindKeys(){this._register(Gt(this.textarea,"keyup",t=>this._keyUp(t),!0)),this._register(Gt(this.textarea,"keydown",t=>this._keyDown(t),!0)),this._register(Gt(this.textarea,"keypress",t=>this._keyPress(t),!0)),this._register(Gt(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this._register(Gt(this.textarea,"compositionupdate",t=>this._compositionHelper.compositionupdate(t))),this._register(Gt(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this._register(Gt(this.textarea,"input",t=>this._inputEvent(t),!0)),this._register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(t){if(!t)throw new Error("Terminal requires a parent element.");if(t.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService){this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView);return}this._document=t.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),t.appendChild(this.element);let e=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),e.appendChild(this._viewportElement),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._register(Gt(this.screenElement,"mousemove",r=>this.updateCursorStyle(r))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),e.appendChild(this.screenElement);let n=this.textarea=this._document.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",X3.get()),e6||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._register(this.optionsService.onSpecificOptionChange("disableStdin",()=>n.readOnly=this.optionsService.rawOptions.disableStdin)),this.textarea.readOnly=this.optionsService.rawOptions.disableStdin,this._coreBrowserService=this._register(this._instantiationService.createInstance(lQ,this.textarea,t.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(Ec,this._coreBrowserService),this._register(Gt(this.textarea,"focus",r=>this._handleTextAreaFocus(r))),this._register(Gt(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(vk,this._document,this._helperContainer),this._instantiationService.setService(Rw,this._charSizeService),this._themeService=this._instantiationService.createInstance(Sk),this._instantiationService.setService(Qp,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(kw),this._instantiationService.setService(Sz,this._characterJoinerService),this._renderService=this._register(this._instantiationService.createInstance(yk,this.rows,this.screenElement)),this._instantiationService.setService(Cc,this._renderService),this._register(this._renderService.onRenderedViewportChange(r=>this._onRender.fire(r))),this.onResize(r=>this._renderService.resize(r.cols,r.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(pk,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(_k),this._instantiationService.setService(Pk,this._mouseService);let i=this._linkifier.value=this._register(this._instantiationService.createInstance(kk,this.screenElement));this.element.appendChild(e);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this._register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this._register(this.onBlur(()=>this._renderService.handleBlur())),this._register(this.onFocus(()=>this._renderService.handleFocus())),this._viewport=this._register(this._instantiationService.createInstance(dk,this.element,this.screenElement)),this._register(this._viewport.onRequestScrollLines(r=>{super.scrollLines(r,!1),this.refresh(0,this.rows-1)})),this._selectionService=this._register(this._instantiationService.createInstance(xk,this.element,this.screenElement,i)),this._instantiationService.setService(aJ,this._selectionService),this._register(this._selectionService.onRequestScrollLines(r=>this.scrollLines(r.amount,r.suppressScrollEvent))),this._register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this._register(this._selectionService.onRequestRedraw(r=>this._renderService.handleSelectionChanged(r.start,r.end,r.columnSelectMode))),this._register(this._selectionService.onLinuxMouseSelection(r=>{this.textarea.value=r,this.textarea.focus(),this.textarea.select()})),this._register(Fr.any(this._onScroll.event,this._inputHandler.onScroll)(()=>{this._selectionService.refresh(),this._viewport?.queueSync()})),this._register(this._instantiationService.createInstance(fk,this.screenElement)),this._register(Gt(this.element,"mousedown",r=>this._selectionService.handleMouseDown(r))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Dw,this)),this._register(this.optionsService.onSpecificOptionChange("screenReaderMode",r=>this._handleScreenReaderModeOptionChange(r))),this.options.overviewRuler.width&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(Aw,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRuler",r=>{!this._overviewRulerRenderer&&r&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(Aw,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(gk,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){let t=this,e=this.element;function n(s){let o=t._mouseService.getMouseReportCoords(s,t.screenElement);if(!o)return!1;let a,l;switch(s.overrideType||s.type){case"mousemove":l=32,s.buttons===void 0?(a=3,s.button!==void 0&&(a=s.button<3?s.button:3)):a=s.buttons&1?0:s.buttons&4?1:s.buttons&2?2:3;break;case"mouseup":l=0,a=s.button<3?s.button:3;break;case"mousedown":l=1,a=s.button<3?s.button:3;break;case"wheel":if(t._customWheelEventHandler&&t._customWheelEventHandler(s)===!1)return!1;let c=s.deltaY;if(c===0||t.coreMouseService.consumeWheelEvent(s,t._renderService?.dimensions?.device?.cell?.height,t._coreBrowserService?.dpr)===0)return!1;l=c<0?0:1,a=4;break;default:return!1}return l===void 0||a===void 0||a>4?!1:t.coreMouseService.triggerMouseEvent({col:o.col,row:o.row,x:o.x,y:o.y,button:a,action:l,ctrl:s.ctrlKey,alt:s.altKey,shift:s.shiftKey})}let i={mouseup:null,wheel:null,mousedrag:null,mousemove:null},r={mouseup:s=>(n(s),s.buttons||(this._document.removeEventListener("mouseup",i.mouseup),i.mousedrag&&this._document.removeEventListener("mousemove",i.mousedrag)),this.cancel(s)),wheel:s=>(n(s),this.cancel(s,!0)),mousedrag:s=>{s.buttons&&n(s)},mousemove:s=>{s.buttons||n(s)}};this._register(this.coreMouseService.onProtocolChange(s=>{s?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(s)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),s&8?i.mousemove||(e.addEventListener("mousemove",r.mousemove),i.mousemove=r.mousemove):(e.removeEventListener("mousemove",i.mousemove),i.mousemove=null),s&16?i.wheel||(e.addEventListener("wheel",r.wheel,{passive:!1}),i.wheel=r.wheel):(e.removeEventListener("wheel",i.wheel),i.wheel=null),s&2?i.mouseup||(i.mouseup=r.mouseup):(this._document.removeEventListener("mouseup",i.mouseup),i.mouseup=null),s&4?i.mousedrag||(i.mousedrag=r.mousedrag):(this._document.removeEventListener("mousemove",i.mousedrag),i.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this._register(Gt(e,"mousedown",s=>{if(s.preventDefault(),this.focus(),!(!this.coreMouseService.areMouseEventsActive||this._selectionService.shouldForceSelection(s)))return n(s),i.mouseup&&this._document.addEventListener("mouseup",i.mouseup),i.mousedrag&&this._document.addEventListener("mousemove",i.mousedrag),this.cancel(s)})),this._register(Gt(e,"wheel",s=>{if(!i.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(s)===!1)return!1;if(!this.buffer.hasScrollback){if(s.deltaY===0)return!1;if(t.coreMouseService.consumeWheelEvent(s,t._renderService?.dimensions?.device?.cell?.height,t._coreBrowserService?.dpr)===0)return this.cancel(s,!0);let o=qe.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(s.deltaY<0?"A":"B");return this.coreService.triggerDataEvent(o,!0),this.cancel(s,!0)}}},{passive:!1}))}refresh(t,e){this._renderService?.refreshRows(t,e)}updateCursorStyle(t){this._selectionService?.shouldColumnSelect(t)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(t,e){this._viewport?this._viewport.scrollLines(t):super.scrollLines(t,e),this.refresh(0,this.rows-1)}scrollPages(t){this.scrollLines(t*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(t){t&&this._viewport?this._viewport.scrollToLine(this.buffer.ybase,!0):this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(t){let e=t-this._bufferService.buffer.ydisp;e!==0&&this.scrollLines(e)}paste(t){dz(t,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(t){this._customKeyEventHandler=t}attachCustomWheelEventHandler(t){this._customWheelEventHandler=t}registerLinkProvider(t){return this._linkProviderService.registerLinkProvider(t)}registerCharacterJoiner(t){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let e=this._characterJoinerService.register(t);return this.refresh(0,this.rows-1),e}deregisterCharacterJoiner(t){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(t)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(t){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+t)}registerDecoration(t){return this._decorationService.registerDecoration(t)}hasSelection(){return this._selectionService?this._selectionService.hasSelection:!1}select(t,e,n){this._selectionService.setSelection(t,e,n)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(!(!this._selectionService||!this._selectionService.hasSelection))return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(t,e){this._selectionService?.selectLines(t,e)}_keyDown(t){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(t)===!1)return!1;let e=this.browser.isMac&&this.options.macOptionIsMeta&&t.altKey;if(!e&&!this._compositionHelper.keydown(t))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(!0),!1;!e&&(t.key==="Dead"||t.key==="AltGraph")&&(this._unprocessedDeadKey=!0);let n=mee(t,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(t),n.type===3||n.type===2){let i=this.rows-1;return this.scrollLines(n.type===2?-i:i),this.cancel(t,!0)}if(n.type===1&&this.selectAll(),this._isThirdLevelShift(this.browser,t)||(n.cancel&&this.cancel(t,!0),!n.key)||t.key&&!t.ctrlKey&&!t.altKey&&!t.metaKey&&t.key.length===1&&t.key.charCodeAt(0)>=65&&t.key.charCodeAt(0)<=90)return!0;if(this._unprocessedDeadKey)return this._unprocessedDeadKey=!1,!0;if((n.key===qe.ETX||n.key===qe.CR)&&(this.textarea.value=""),this._onKey.fire({key:n.key,domEvent:t}),this._showCursor(),this.coreService.triggerDataEvent(n.key,!0),!this.optionsService.rawOptions.screenReaderMode||t.altKey||t.ctrlKey)return this.cancel(t,!0);this._keyDownHandled=!0}_isThirdLevelShift(t,e){let n=t.isMac&&!this.options.macOptionIsMeta&&e.altKey&&!e.ctrlKey&&!e.metaKey||t.isWindows&&e.altKey&&e.ctrlKey&&!e.metaKey||t.isWindows&&e.getModifierState("AltGraph");return e.type==="keypress"?n:n&&(!e.keyCode||e.keyCode>47)}_keyUp(t){this._keyDownSeen=!1,!(this._customKeyEventHandler&&this._customKeyEventHandler(t)===!1)&&(wee(t)||this.focus(),this.updateCursorStyle(t),this._keyPressHandled=!1)}_keyPress(t){let e;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(t)===!1)return!1;if(this.cancel(t),t.charCode)e=t.charCode;else if(t.which===null||t.which===void 0)e=t.keyCode;else if(t.which!==0&&t.charCode!==0)e=t.which;else return!1;return!e||(t.altKey||t.ctrlKey||t.metaKey)&&!this._isThirdLevelShift(this.browser,t)?!1:(e=String.fromCharCode(e),this._onKey.fire({key:e,domEvent:t}),this._showCursor(),this.coreService.triggerDataEvent(e,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,!0)}_inputEvent(t){if(t.data&&t.inputType==="insertText"&&(!t.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let e=t.data;return this.coreService.triggerDataEvent(e,!0),this.cancel(t),!0}return!1}resize(t,e){if(t===this.cols&&e===this.rows){this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure();return}super.resize(t,e)}_afterResize(t,e){this._charSizeService?.measure()}clear(){if(!(this.buffer.ybase===0&&this.buffer.y===0)){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let t=1;t<this.rows;t++)this.buffer.lines.push(this.buffer.getBlankLine($i));this._onScroll.fire({position:this.buffer.ydisp}),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;let t=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this._customKeyEventHandler=t,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(qe.ESC+"[I"):this.coreService.triggerDataEvent(qe.ESC+"[O")}_reportWindowsOptions(t){if(this._renderService)switch(t){case 0:let e=this._renderService.dimensions.css.canvas.width.toFixed(0),n=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${qe.ESC}[4;${n};${e}t`);break;case 1:let i=this._renderService.dimensions.css.cell.width.toFixed(0),r=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${qe.ESC}[6;${r};${i}t`);break}}cancel(t,e){if(!(!this.options.cancelEvents&&!e))return t.preventDefault(),t.stopPropagation(),!1}};function wee(t){return t.keyCode===16||t.keyCode===17||t.keyCode===18}var Eee=class{constructor(){this._addons=[]}dispose(){for(let t=this._addons.length-1;t>=0;t--)this._addons[t].instance.dispose()}loadAddon(t,e){let n={instance:e,dispose:e.dispose,isDisposed:!1};this._addons.push(n),e.dispose=()=>this._wrappedAddonDispose(n),e.activate(t)}_wrappedAddonDispose(t){if(t.isDisposed)return;let e=-1;for(let n=0;n<this._addons.length;n++)if(this._addons[n]===t){e=n;break}if(e===-1)throw new Error("Could not dispose an addon that has not been loaded");t.isDisposed=!0,t.dispose.apply(t.instance),this._addons.splice(e,1)}},Cee=class{constructor(t){this._line=t}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(t,e){if(!(t<0||t>=this._line.length))return e?(this._line.loadCell(t,e),e):this._line.loadCell(t,new ca)}translateToString(t,e,n){return this._line.translateToString(t,e,n)}},uz=class{constructor(t,e){this._buffer=t,this.type=e}init(t){return this._buffer=t,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(t){let e=this._buffer.lines.get(t);if(e)return new Cee(e)}getNullCell(){return new ca}},Tee=class extends rn{constructor(t){super(),this._core=t,this._onBufferChange=this._register(new st),this.onBufferChange=this._onBufferChange.event,this._normal=new uz(this._core.buffers.normal,"normal"),this._alternate=new uz(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}},Mee=class{constructor(t){this._core=t}registerCsiHandler(t,e){return this._core.registerCsiHandler(t,n=>e(n.toArray()))}addCsiHandler(t,e){return this.registerCsiHandler(t,e)}registerDcsHandler(t,e){return this._core.registerDcsHandler(t,(n,i)=>e(n,i.toArray()))}addDcsHandler(t,e){return this.registerDcsHandler(t,e)}registerEscHandler(t,e){return this._core.registerEscHandler(t,e)}addEscHandler(t,e){return this.registerEscHandler(t,e)}registerOscHandler(t,e){return this._core.registerOscHandler(t,e)}addOscHandler(t,e){return this.registerOscHandler(t,e)}},Aee=class{constructor(t){this._core=t}register(t){this._core.unicodeService.register(t)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(t){this._core.unicodeService.activeVersion=t}},kee=["cols","rows"],El=0,u6=class extends rn{constructor(t){super(),this._core=this._register(new bee(t)),this._addonManager=this._register(new Eee),this._publicOptions={...this._core.options};let e=i=>this._core.options[i],n=(i,r)=>{this._checkReadonlyOptions(i),this._core.options[i]=r};for(let i in this._core.options){let r={get:e.bind(this,i),set:n.bind(this,i)};Object.defineProperty(this._publicOptions,i,r)}}_checkReadonlyOptions(t){if(kee.includes(t))throw new Error(`Option "${t}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new Mee(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new Aee(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this._register(new Tee(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let t=this._core.coreService.decPrivateModes,e="none";switch(this._core.coreMouseService.activeProtocol){case"X10":e="x10";break;case"VT200":e="vt200";break;case"DRAG":e="drag";break;case"ANY":e="any";break}return{applicationCursorKeysMode:t.applicationCursorKeys,applicationKeypadMode:t.applicationKeypad,bracketedPasteMode:t.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:e,originMode:t.origin,reverseWraparoundMode:t.reverseWraparound,sendFocusMode:t.sendFocus,synchronizedOutputMode:t.synchronizedOutput,wraparoundMode:t.wraparound}}get options(){return this._publicOptions}set options(t){for(let e in t)this._publicOptions[e]=t[e]}blur(){this._core.blur()}focus(){this._core.focus()}input(t,e=!0){this._core.input(t,e)}resize(t,e){this._verifyIntegers(t,e),this._core.resize(t,e)}open(t){this._core.open(t)}attachCustomKeyEventHandler(t){this._core.attachCustomKeyEventHandler(t)}attachCustomWheelEventHandler(t){this._core.attachCustomWheelEventHandler(t)}registerLinkProvider(t){return this._core.registerLinkProvider(t)}registerCharacterJoiner(t){return this._checkProposedApi(),this._core.registerCharacterJoiner(t)}deregisterCharacterJoiner(t){this._checkProposedApi(),this._core.deregisterCharacterJoiner(t)}registerMarker(t=0){return this._verifyIntegers(t),this._core.registerMarker(t)}registerDecoration(t){return this._checkProposedApi(),this._verifyPositiveIntegers(t.x??0,t.width??0,t.height??0),this._core.registerDecoration(t)}hasSelection(){return this._core.hasSelection()}select(t,e,n){this._verifyIntegers(t,e,n),this._core.select(t,e,n)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(t,e){this._verifyIntegers(t,e),this._core.selectLines(t,e)}dispose(){super.dispose()}scrollLines(t){this._verifyIntegers(t),this._core.scrollLines(t)}scrollPages(t){this._verifyIntegers(t),this._core.scrollPages(t)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(t){this._verifyIntegers(t),this._core.scrollToLine(t)}clear(){this._core.clear()}write(t,e){this._core.write(t,e)}writeln(t,e){this._core.write(t),this._core.write(`\r
`,e)}paste(t){this._core.paste(t)}refresh(t,e){this._verifyIntegers(t,e),this._core.refresh(t,e)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(t){this._addonManager.loadAddon(this,t)}static get strings(){return{get promptLabel(){return X3.get()},set promptLabel(t){X3.set(t)},get tooMuchOutput(){return q3.get()},set tooMuchOutput(t){q3.set(t)}}}_verifyIntegers(...t){for(El of t)if(El===1/0||isNaN(El)||El%1!==0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...t){for(El of t)if(El&&(El===1/0||isNaN(El)||El%1!==0||El<0))throw new Error("This API only accepts positive integers")}};var Lee=2,Pee=1,h6=class{activate(t){this._terminal=t}dispose(){}fit(){let t=this.proposeDimensions();if(!t||!this._terminal||isNaN(t.cols)||isNaN(t.rows))return;let e=this._terminal._core;(this._terminal.rows!==t.rows||this._terminal.cols!==t.cols)&&(e._renderService.clear(),this._terminal.resize(t.cols,t.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let t=this._terminal._core._renderService.dimensions;if(t.css.cell.width===0||t.css.cell.height===0)return;let e=this._terminal.options.scrollback===0?0:this._terminal.options.overviewRuler?.width||14,n=window.getComputedStyle(this._terminal.element.parentElement),i=parseInt(n.getPropertyValue("height")),r=Math.max(0,parseInt(n.getPropertyValue("width"))),s=window.getComputedStyle(this._terminal.element),o={top:parseInt(s.getPropertyValue("padding-top")),bottom:parseInt(s.getPropertyValue("padding-bottom")),right:parseInt(s.getPropertyValue("padding-right")),left:parseInt(s.getPropertyValue("padding-left"))},a=o.top+o.bottom,l=o.right+o.left,c=i-a,u=r-l-e;return{cols:Math.max(Lee,Math.floor(u/t.css.cell.width)),rows:Math.max(Pee,Math.floor(c/t.css.cell.height))}}};var Dee=class{constructor(t,e,n,i={}){this._terminal=t,this._regex=e,this._handler=n,this._options=i}provideLinks(t,e){let n=Ree.computeLink(t,this._regex,this._terminal,this._handler);e(this._addCallbacks(n))}_addCallbacks(t){return t.map(e=>(e.leave=this._options.leave,e.hover=(n,i)=>{if(this._options.hover){let{range:r}=e;this._options.hover(n,i,r)}},e))}};function Iee(t){try{let e=new URL(t),n=e.password&&e.username?`${e.protocol}//${e.username}:${e.password}@${e.host}`:e.username?`${e.protocol}//${e.username}@${e.host}`:`${e.protocol}//${e.host}`;return t.toLocaleLowerCase().startsWith(n.toLocaleLowerCase())}catch{return!1}}var Ree=class Fw{static computeLink(e,n,i,r){let s=new RegExp(n.source,(n.flags||"")+"g"),[o,a]=Fw._getWindowedLineStrings(e-1,i),l=o.join(""),c,u=[];for(;c=s.exec(l);){let d=c[0];if(!Iee(d))continue;let[p,m]=Fw._mapStrIdx(i,a,0,c.index),[g,_]=Fw._mapStrIdx(i,p,m,d.length);if(p===-1||m===-1||g===-1||_===-1)continue;let y={start:{x:m+1,y:p+1},end:{x:_,y:g+1}};u.push({range:y,text:d,activate:r})}return u}static _getWindowedLineStrings(e,n){let i,r=e,s=e,o=0,a="",l=[];if(i=n.buffer.active.getLine(e)){let c=i.translateToString(!0);if(i.isWrapped&&c[0]!==" "){for(o=0;(i=n.buffer.active.getLine(--r))&&o<2048&&(a=i.translateToString(!0),o+=a.length,l.push(a),!(!i.isWrapped||a.indexOf(" ")!==-1)););l.reverse()}for(l.push(c),o=0;(i=n.buffer.active.getLine(++s))&&i.isWrapped&&o<2048&&(a=i.translateToString(!0),o+=a.length,l.push(a),a.indexOf(" ")===-1););}return[l,r]}static _mapStrIdx(e,n,i,r){let s=e.buffer.active,o=s.getNullCell(),a=i;for(;r;){let l=s.getLine(n);if(!l)return[-1,-1];for(let c=a;c<l.length;++c){l.getCell(c,o);let u=o.getChars();if(o.getWidth()&&(r-=u.length||1,c===l.length-1&&u==="")){let d=s.getLine(n+1);d&&d.isWrapped&&(d.getCell(0,o),o.getWidth()===2&&(r+=1))}if(r<0)return[n,c]}n++,a=0}return[n,a]}},Nee=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function Oee(t,e){let n=window.open();if(n){try{n.opener=null}catch{}n.location.href=e}else console.warn("Opening link blocked as opener could not be cleared")}var d6=class{constructor(t=Oee,e={}){this._handler=t,this._options=e}activate(t){this._terminal=t;let e=this._options,n=e.urlRegex||Nee;this._linkProvider=this._terminal.registerLinkProvider(new Dee(this._terminal,n,this._handler,e))}dispose(){this._linkProvider?.dispose()}};var Bee=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout(()=>{throw t.stack?f6.isErrorNoTelemetry(t)?new f6(t.message+`

`+t.stack):new Error(t.message+`

`+t.stack):t},0)}}addListener(t){return this.listeners.push(t),()=>{this._removeListener(t)}}emit(t){this.listeners.forEach(e=>{e(t)})}_removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}setUnexpectedErrorHandler(t){this.unexpectedErrorHandler=t}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(t){this.unexpectedErrorHandler(t),this.emit(t)}onUnexpectedExternalError(t){this.unexpectedErrorHandler(t)}},Uee=new Bee;function zk(t){Fee(t)||Uee.onUnexpectedError(t)}var Vk="Canceled";function Fee(t){return t instanceof zee?!0:t instanceof Error&&t.name===Vk&&t.message===Vk}var zee=class extends Error{constructor(){super(Vk),this.name=this.message}},f6=class Gk extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof Gk)return e;let n=new Gk;return n.message=e.message,n.stack=e.stack,n}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}};function Hee(t,e,n=0,i=t.length){let r=n,s=i;for(;r<s;){let o=Math.floor((r+s)/2);e(t[o])?r=o+1:s=o}return r-1}var Wee=class b6{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(b6.assertInvariants){if(this._prevFindLastPredicate){for(let i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let n=Hee(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=n+1,n===-1?void 0:this._array[n]}};Wee.assertInvariants=!1;var w6;(t=>{function e(s){return s<0}t.isLessThan=e;function n(s){return s<=0}t.isLessThanOrEqual=n;function i(s){return s>0}t.isGreaterThan=i;function r(s){return s===0}t.isNeitherLessOrGreaterThan=r,t.greaterThan=1,t.lessThan=-1,t.neitherLessOrGreaterThan=0})(w6||(w6={}));function Vee(t,e){return(n,i)=>e(t(n),t(i))}var Gee=(t,e)=>t-e,p6=class jk{constructor(e){this.iterate=e}forEach(e){this.iterate(n=>(e(n),!0))}toArray(){let e=[];return this.iterate(n=>(e.push(n),!0)),e}filter(e){return new jk(n=>this.iterate(i=>e(i)?n(i):!0))}map(e){return new jk(n=>this.iterate(i=>n(e(i))))}some(e){let n=!1;return this.iterate(i=>(n=e(i),!n)),n}findFirst(e){let n;return this.iterate(i=>e(i)?(n=i,!1):!0),n}findLast(e){let n;return this.iterate(i=>(e(i)&&(n=i),!0)),n}findLastMaxBy(e){let n,i=!0;return this.iterate(r=>((i||w6.isGreaterThan(e(r,n)))&&(i=!1,n=r),!0)),n}};p6.empty=new p6(t=>{});function jee(t,e){let n=Object.create(null);for(let i of t){let r=e(i),s=n[r];s||(s=n[r]=[]),s.push(i)}return n}var m6,g6,vle=class{constructor(t,e){this.toKey=e,this._map=new Map,this[m6]="SetWithKey";for(let n of t)this.add(n)}get size(){return this._map.size}add(t){let e=this.toKey(t);return this._map.set(e,t),this}delete(t){return this._map.delete(this.toKey(t))}has(t){return this._map.has(this.toKey(t))}*entries(){for(let t of this._map.values())yield[t,t]}keys(){return this.values()}*values(){for(let t of this._map.values())yield t}clear(){this._map.clear()}forEach(t,e){this._map.forEach(n=>t.call(e,n,n,this))}[(g6=Symbol.iterator,m6=Symbol.toStringTag,g6)](){return this.values()}},Xee=class{constructor(){this.map=new Map}add(t,e){let n=this.map.get(t);n||(n=new Set,this.map.set(t,n)),n.add(e)}delete(t,e){let n=this.map.get(t);n&&(n.delete(e),n.size===0&&this.map.delete(t))}forEach(t,e){let n=this.map.get(t);n&&n.forEach(e)}get(t){return this.map.get(t)||new Set}};function qee(t,e){let n=this,i=!1,r;return function(){if(i)return r;if(i=!0,e)try{r=t.apply(n,arguments)}finally{e()}else r=t.apply(n,arguments);return r}}var E6;(t=>{function e(w){return w&&typeof w=="object"&&typeof w[Symbol.iterator]=="function"}t.is=e;let n=Object.freeze([]);function i(){return n}t.empty=i;function*r(w){yield w}t.single=r;function s(w){return e(w)?w:r(w)}t.wrap=s;function o(w){return w||n}t.from=o;function*a(w){for(let C=w.length-1;C>=0;C--)yield w[C]}t.reverse=a;function l(w){return!w||w[Symbol.iterator]().next().done===!0}t.isEmpty=l;function c(w){return w[Symbol.iterator]().next().value}t.first=c;function u(w,C){let M=0;for(let L of w)if(C(L,M++))return!0;return!1}t.some=u;function d(w,C){for(let M of w)if(C(M))return M}t.find=d;function*p(w,C){for(let M of w)C(M)&&(yield M)}t.filter=p;function*m(w,C){let M=0;for(let L of w)yield C(L,M++)}t.map=m;function*g(w,C){let M=0;for(let L of w)yield*C(L,M++)}t.flatMap=g;function*_(...w){for(let C of w)yield*C}t.concat=_;function y(w,C,M){let L=M;for(let P of w)L=C(L,P);return L}t.reduce=y;function*v(w,C,M=w.length){for(C<0&&(C+=w.length),M<0?M+=w.length:M>w.length&&(M=w.length);C<M;C++)yield w[C]}t.slice=v;function S(w,C=Number.POSITIVE_INFINITY){let M=[];if(C===0)return[M,w];let L=w[Symbol.iterator]();for(let P=0;P<C;P++){let T=L.next();if(T.done)return[M,t.empty()];M.push(T.value)}return[M,{[Symbol.iterator](){return L}}]}t.consume=S;async function b(w){let C=[];for await(let M of w)C.push(M);return Promise.resolve(C)}t.asyncToArray=b})(E6||(E6={}));var Yee=!1,nm=null,Kee=class C6{constructor(){this.livingDisposables=new Map}getDisposableData(e){let n=this.livingDisposables.get(e);return n||(n={parent:null,source:null,isSingleton:!1,value:e,idx:C6.idx++},this.livingDisposables.set(e,n)),n}trackDisposable(e){let n=this.getDisposableData(e);n.source||(n.source=new Error().stack)}setParent(e,n){let i=this.getDisposableData(e);i.parent=n}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,n){let i=n.get(e);if(i)return i;let r=e.parent?this.getRootParent(this.getDisposableData(e.parent),n):e;return n.set(e,r),r}getTrackedDisposables(){let e=new Map;return[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n)}computeLeakingDisposables(e=10,n){let i;if(n)i=n;else{let l=new Map,c=[...this.livingDisposables.values()].filter(d=>d.source!==null&&!this.getRootParent(d,l).isSingleton);if(c.length===0)return;let u=new Set(c.map(d=>d.value));if(i=c.filter(d=>!(d.parent&&u.has(d.parent))),i.length===0)throw new Error("There are cyclic diposable chains!")}if(!i)return;function r(l){function c(d,p){for(;d.length>0&&p.some(m=>typeof m=="string"?m===d[0]:d[0].match(m));)d.shift()}let u=l.source.split(`
`).map(d=>d.trim().replace("at ","")).filter(d=>d!=="");return c(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}let s=new Xee;for(let l of i){let c=r(l);for(let u=0;u<=c.length;u++)s.add(c.slice(0,u).join(`
`),l)}i.sort(Vee(l=>l.idx,Gee));let o="",a=0;for(let l of i.slice(0,e)){a++;let c=r(l),u=[];for(let d=0;d<c.length;d++){let p=c[d];p=`(shared with ${s.get(c.slice(0,d+1).join(`
`)).size}/${i.length} leaks) at ${p}`;let m=s.get(c.slice(0,d).join(`
`)),g=jee([...m].map(_=>r(_)[d]),_=>_);delete g[c[d]];for(let[_,y]of Object.entries(g))u.unshift(`    - stacktraces of ${y.length} other leaks continue with ${_}`);u.unshift(p)}o+=`


==================== Leaking disposable ${a}/${i.length}: ${l.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return i.length>e&&(o+=`


... and ${i.length-e} more leaking disposables

`),{leaks:i,details:o}}};Kee.idx=0;function $ee(t){nm=t}if(Yee){let t="__is_disposable_tracked__";$ee(new class{trackDisposable(e){let n=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[t]||console.log(n)},3e3)}setParent(e,n){if(e&&e!==kl.None)try{e[t]=!0}catch{}}markAsDisposed(e){if(e&&e!==kl.None)try{e[t]=!0}catch{}}markAsSingleton(e){}})}function Xw(t){return nm?.trackDisposable(t),t}function qw(t){nm?.markAsDisposed(t)}function G_(t,e){nm?.setParent(t,e)}function Jee(t,e){if(nm)for(let n of t)nm.setParent(n,e)}function V_(t){if(E6.is(t)){let e=[];for(let n of t)if(n)try{n.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}else if(t)return t.dispose(),t}function T6(...t){let e=im(()=>V_(t));return Jee(t,e),e}function im(t){let e=Xw({dispose:qee(()=>{qw(e),t()})});return e}var M6=class A6{constructor(){this._toDispose=new Set,this._isDisposed=!1,Xw(this)}dispose(){this._isDisposed||(qw(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{V_(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return G_(e,this),this._isDisposed?A6.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),G_(e,null))}};M6.DISABLE_DISPOSED_WARNING=!1;var Zk=M6,kl=class{constructor(){this._store=new Zk,Xw(this),G_(this._store,this)}dispose(){qw(this),this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}};kl.None=Object.freeze({dispose(){}});var jw=class{constructor(){this._isDisposed=!1,Xw(this)}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),t&&G_(t,this),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,qw(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t&&G_(t,null),t}},v6=class Xk{constructor(e){this.element=e,this.next=Xk.Undefined,this.prev=Xk.Undefined}};v6.Undefined=new v6(void 0);var Zee=globalThis.performance&&typeof globalThis.performance.now=="function",Qee=class k6{static create(e){return new k6(e)}constructor(e){this._now=Zee&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},ete=!1,_6=!1,tte=!1,Qk;(t=>{t.None=()=>kl.None;function e(B){if(tte){let{onDidAddListener:O}=B,z=Kk.create(),U=0;B.onDidAddListener=()=>{++U===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),z.print()),O?.()}}}function n(B,O){return p(B,()=>{},0,void 0,!0,void 0,O)}t.defer=n;function i(B){return(O,z=null,U)=>{let G=!1,j;return j=B(J=>{if(!G)return j?j.dispose():G=!0,O.call(z,J)},null,U),G&&j.dispose(),j}}t.once=i;function r(B,O,z){return u((U,G=null,j)=>B(J=>U.call(G,O(J)),null,j),z)}t.map=r;function s(B,O,z){return u((U,G=null,j)=>B(J=>{O(J),U.call(G,J)},null,j),z)}t.forEach=s;function o(B,O,z){return u((U,G=null,j)=>B(J=>O(J)&&U.call(G,J),null,j),z)}t.filter=o;function a(B){return B}t.signal=a;function l(...B){return(O,z=null,U)=>{let G=T6(...B.map(j=>j(J=>O.call(z,J))));return d(G,U)}}t.any=l;function c(B,O,z,U){let G=z;return r(B,j=>(G=O(G,j),G),U)}t.reduce=c;function u(B,O){let z,U={onWillAddFirstListener(){z=B(G.fire,G)},onDidRemoveLastListener(){z?.dispose()}};O||e(U);let G=new Al(U);return O?.add(G),G.event}function d(B,O){return O instanceof Array?O.push(B):O&&O.add(B),B}function p(B,O,z=100,U=!1,G=!1,j,J){let K,D,X,q=0,ne,re={leakWarningThreshold:j,onWillAddFirstListener(){K=B(ie=>{q++,D=O(D,ie),U&&!X&&($.fire(D),D=void 0),ne=()=>{let le=D;D=void 0,X=void 0,(!U||q>1)&&$.fire(le),q=0},typeof z=="number"?(clearTimeout(X),X=setTimeout(ne,z)):X===void 0&&(X=0,queueMicrotask(ne))})},onWillRemoveListener(){G&&q>0&&ne?.()},onDidRemoveLastListener(){ne=void 0,K.dispose()}};J||e(re);let $=new Al(re);return J?.add($),$.event}t.debounce=p;function m(B,O=0,z){return t.debounce(B,(U,G)=>U?(U.push(G),U):[G],O,void 0,!0,void 0,z)}t.accumulate=m;function g(B,O=(U,G)=>U===G,z){let U=!0,G;return o(B,j=>{let J=U||!O(j,G);return U=!1,G=j,J},z)}t.latch=g;function _(B,O,z){return[t.filter(B,O,z),t.filter(B,U=>!O(U),z)]}t.split=_;function y(B,O=!1,z=[],U){let G=z.slice(),j=B(D=>{G?G.push(D):K.fire(D)});U&&U.add(j);let J=()=>{G?.forEach(D=>K.fire(D)),G=null},K=new Al({onWillAddFirstListener(){j||(j=B(D=>K.fire(D)),U&&U.add(j))},onDidAddFirstListener(){G&&(O?setTimeout(J):J())},onDidRemoveLastListener(){j&&j.dispose(),j=null}});return U&&U.add(K),K.event}t.buffer=y;function v(B,O){return(z,U,G)=>{let j=O(new b);return B(function(J){let K=j.evaluate(J);K!==S&&z.call(U,K)},void 0,G)}}t.chain=v;let S=Symbol("HaltChainable");class b{constructor(){this.steps=[]}map(O){return this.steps.push(O),this}forEach(O){return this.steps.push(z=>(O(z),z)),this}filter(O){return this.steps.push(z=>O(z)?z:S),this}reduce(O,z){let U=z;return this.steps.push(G=>(U=O(U,G),U)),this}latch(O=(z,U)=>z===U){let z=!0,U;return this.steps.push(G=>{let j=z||!O(G,U);return z=!1,U=G,j?G:S}),this}evaluate(O){for(let z of this.steps)if(O=z(O),O===S)break;return O}}function w(B,O,z=U=>U){let U=(...K)=>J.fire(z(...K)),G=()=>B.on(O,U),j=()=>B.removeListener(O,U),J=new Al({onWillAddFirstListener:G,onDidRemoveLastListener:j});return J.event}t.fromNodeEventEmitter=w;function C(B,O,z=U=>U){let U=(...K)=>J.fire(z(...K)),G=()=>B.addEventListener(O,U),j=()=>B.removeEventListener(O,U),J=new Al({onWillAddFirstListener:G,onDidRemoveLastListener:j});return J.event}t.fromDOMEventEmitter=C;function M(B){return new Promise(O=>i(B)(O))}t.toPromise=M;function L(B){let O=new Al;return B.then(z=>{O.fire(z)},()=>{O.fire(void 0)}).finally(()=>{O.dispose()}),O.event}t.fromPromise=L;function P(B,O){return B(z=>O.fire(z))}t.forward=P;function T(B,O,z){return O(z),B(U=>O(U))}t.runAndSubscribe=T;class A{constructor(O,z){this._observable=O,this._counter=0,this._hasChanged=!1;let U={onWillAddFirstListener:()=>{O.addObserver(this)},onDidRemoveLastListener:()=>{O.removeObserver(this)}};z||e(U),this.emitter=new Al(U),z&&z.add(this.emitter)}beginUpdate(O){this._counter++}handlePossibleChange(O){}handleChange(O,z){this._hasChanged=!0}endUpdate(O){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function I(B,O){return new A(B,O).emitter.event}t.fromObservable=I;function F(B){return(O,z,U)=>{let G=0,j=!1,J={beginUpdate(){G++},endUpdate(){G--,G===0&&(B.reportChanges(),j&&(j=!1,O.call(z)))},handlePossibleChange(){},handleChange(){j=!0}};B.addObserver(J),B.reportChanges();let K={dispose(){B.removeObserver(J)}};return U instanceof Zk?U.add(K):Array.isArray(U)&&U.push(K),K}}t.fromObservableLight=F})(Qk||(Qk={}));var qk=class Yk{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${Yk._idPool++}`,Yk.all.add(this)}start(e){this._stopWatch=new Qee,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};qk.all=new Set,qk._idPool=0;var nte=qk,y6=-1,L6=class P6{constructor(e,n,i=(P6._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=n,this.name=i,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,n){let i=this.threshold;if(i<=0||n<i)return;this._stacks||(this._stacks=new Map);let r=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,r+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let[s,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${n} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(s);let l=new rte(a,s);this._errorHandler(l)}return()=>{let s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,n=0;for(let[i,r]of this._stacks)(!e||n<r)&&(e=[i,r],n=r);return e}};L6._idPool=1;var ite=L6,Kk=class D6{constructor(e){this.value=e}static create(){let e=new Error;return new D6(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},rte=class extends Error{constructor(t,e){super(t),this.name="ListenerLeakError",this.stack=e}},ste=class extends Error{constructor(t,e){super(t),this.name="ListenerRefusalError",this.stack=e}},ote=0,Hw=class{constructor(t){this.value=t,this.id=ote++}},ate=2,lte=(t,e)=>{if(t instanceof Hw)e(t);else for(let n=0;n<t.length;n++){let i=t[n];i&&e(i)}},Ww;if(ete){let t=[];setInterval(()=>{t.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(t.join(`
`)),t.length=0)},3e3),Ww=new FinalizationRegistry(e=>{typeof e=="string"&&t.push(e)})}var Al=class{constructor(t){this._size=0,this._options=t,this._leakageMon=y6>0||this._options?.leakWarningThreshold?new ite(t?.onListenerError??zk,this._options?.leakWarningThreshold??y6):void 0,this._perfMon=this._options?._profName?new nte(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(_6){let t=this._listeners;queueMicrotask(()=>{lte(t,e=>e.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??(this._event=(t,e,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let a=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(a);let l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new ste(`${a}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);return(this._options?.onListenerError||zk)(c),kl.None}if(this._disposed)return kl.None;e&&(t=t.bind(e));let i=new Hw(t),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=Kk.create(),r=this._leakageMon.check(i.stack,this._size+1)),_6&&(i.stack=s??Kk.create()),this._listeners?this._listeners instanceof Hw?(this._deliveryQueue??(this._deliveryQueue=new cte),this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let o=im(()=>{Ww?.unregister(o),r?.(),this._removeListener(i)});if(n instanceof Zk?n.add(o):Array.isArray(n)&&n.push(o),Ww){let a=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),l=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(a);Ww.register(o,l?.[2]??a,o)}return o}),this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let e=this._listeners,n=e.indexOf(t);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,e[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*ate<=e.length){let r=0;for(let s=0;s<e.length;s++)e[s]?e[r++]=e[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);e.length=r}}_deliver(t,e){if(!t)return;let n=this._options?.onListenerError||zk;if(!n){t.value(e);return}try{t.value(e)}catch(i){n(i)}}_deliverQueue(t){let e=t.current._listeners;for(;t.i<t.end;)this._deliver(e[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof Hw)this._deliver(this._listeners,t);else{let e=this._deliveryQueue;e.enqueue(this,t,this._listeners.length),this._deliverQueue(e)}this._perfMon?.stop()}hasListeners(){return this._size>0}},cte=class{constructor(){this.i=-1,this.end=0}enqueue(t,e,n){this.i=0,this.end=n,this.current=t,this.value=e}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},I6=Object.freeze(function(t,e){let n=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(n)}}}),ute;(t=>{function e(n){return n===t.None||n===t.Cancelled||n instanceof hte?!0:!n||typeof n!="object"?!1:typeof n.isCancellationRequested=="boolean"&&typeof n.onCancellationRequested=="function"}t.isCancellationToken=e,t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Qk.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:I6})})(ute||(ute={}));var hte=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?I6:(this._emitter||(this._emitter=new Al),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},tm="en",$k=!1,Jk=!1,Vw=!1,dte=!1,fte=!1,R6=!1,pte=!1,mte=!1,gte=!1,vte=!1,zw,Gw=tm,x6=tm,_te,Tc,Mc=globalThis,Po;typeof Mc.vscode<"u"&&typeof Mc.vscode.process<"u"?Po=Mc.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Po=process);var N6=typeof Po?.versions?.electron=="string",yte=N6&&Po?.type==="renderer";if(typeof Po=="object"){$k=Po.platform==="win32",Jk=Po.platform==="darwin",Vw=Po.platform==="linux",dte=Vw&&!!Po.env.SNAP&&!!Po.env.SNAP_REVISION,pte=N6,gte=!!Po.env.CI||!!Po.env.BUILD_ARTIFACTSTAGINGDIRECTORY,zw=tm,Gw=tm;let t=Po.env.VSCODE_NLS_CONFIG;if(t)try{let e=JSON.parse(t);zw=e.userLocale,x6=e.osLocale,Gw=e.resolvedLanguage||tm,_te=e.languagePack?.translationsConfigFile}catch{}fte=!0}else typeof navigator=="object"&&!yte?(Tc=navigator.userAgent,$k=Tc.indexOf("Windows")>=0,Jk=Tc.indexOf("Macintosh")>=0,mte=(Tc.indexOf("Macintosh")>=0||Tc.indexOf("iPad")>=0||Tc.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Vw=Tc.indexOf("Linux")>=0,vte=Tc?.indexOf("Mobi")>=0,R6=!0,Gw=globalThis._VSCODE_NLS_LANGUAGE||tm,zw=navigator.language.toLowerCase(),x6=zw):console.error("Unable to resolve platform.");var Hk=0;Jk?Hk=1:$k?Hk=3:Vw&&(Hk=2);var xte=R6&&typeof Mc.importScripts=="function",_le=xte?Mc.origin:void 0,Ll=Tc,Ju=Gw,Ste;(t=>{function e(){return Ju}t.value=e;function n(){return Ju.length===2?Ju==="en":Ju.length>=3?Ju[0]==="e"&&Ju[1]==="n"&&Ju[2]==="-":!1}t.isDefaultVariant=n;function i(){return Ju==="en"}t.isDefault=i})(Ste||(Ste={}));var bte=typeof Mc.postMessage=="function"&&!Mc.importScripts,wte=(()=>{if(bte){let t=[];Mc.addEventListener("message",n=>{if(n.data&&n.data.vscodeScheduleAsyncWork)for(let i=0,r=t.length;i<r;i++){let s=t[i];if(s.id===n.data.vscodeScheduleAsyncWork){t.splice(i,1),s.callback();return}}});let e=0;return n=>{let i=++e;t.push({id:i,callback:n}),Mc.postMessage({vscodeScheduleAsyncWork:i},"*")}}return t=>setTimeout(t)})(),Ete=!!(Ll&&Ll.indexOf("Chrome")>=0),yle=!!(Ll&&Ll.indexOf("Firefox")>=0),xle=!!(!Ete&&Ll&&Ll.indexOf("Safari")>=0),Sle=!!(Ll&&Ll.indexOf("Edg/")>=0),ble=!!(Ll&&Ll.indexOf("Android")>=0);function O6(t,e=0,n){let i=setTimeout(()=>{t(),n&&r.dispose()},e),r=im(()=>{clearTimeout(i),n?.deleteAndLeak(r)});return n?.add(r),r}var Cte,Wk;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Wk=(t,e)=>{wte(()=>{if(n)return;let i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let n=!1;return{dispose(){n||(n=!0)}}}:Wk=(t,e,n)=>{let i=t.requestIdleCallback(e,typeof n=="number"?{timeout:n}:void 0),r=!1;return{dispose(){r||(r=!0,t.cancelIdleCallback(i))}}},Cte=t=>Wk(globalThis,t)})();var Tte;(t=>{async function e(i){let r,s=await Promise.all(i.map(o=>o.then(a=>a,a=>{r||(r=a)})));if(typeof r<"u")throw r;return s}t.settled=e;function n(i){return new Promise(async(r,s)=>{try{await i(r,s)}catch(o){s(o)}})}t.withAsyncBody=n})(Tte||(Tte={}));var S6=class ua{static fromArray(e){return new ua(n=>{n.emitMany(e)})}static fromPromise(e){return new ua(async n=>{n.emitMany(await e)})}static fromPromises(e){return new ua(async n=>{await Promise.all(e.map(async i=>n.emitOne(await i)))})}static merge(e){return new ua(async n=>{await Promise.all(e.map(async i=>{for await(let r of i)n.emitOne(r)}))})}constructor(e,n){this._state=0,this._results=[],this._error=null,this._onReturn=n,this._onStateChanged=new Al,queueMicrotask(async()=>{let i={emitOne:r=>this.emitOne(r),emitMany:r=>this.emitMany(r),reject:r=>this.reject(r)};try{await Promise.resolve(e(i)),this.resolve()}catch(r){this.reject(r)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await Qk.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,n){return new ua(async i=>{for await(let r of e)i.emitOne(n(r))})}map(e){return ua.map(this,e)}static filter(e,n){return new ua(async i=>{for await(let r of e)n(r)&&i.emitOne(r)})}filter(e){return ua.filter(this,e)}static coalesce(e){return ua.filter(e,n=>!!n)}coalesce(){return ua.coalesce(this)}static async toPromise(e){let n=[];for await(let i of e)n.push(i);return n}toPromise(){return ua.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};S6.EMPTY=S6.fromArray([]);var Mte=class extends kl{constructor(t){super(),this._terminal=t,this._linesCacheTimeout=this._register(new jw),this._linesCacheDisposables=this._register(new jw),this._register(im(()=>this._destroyLinesCache()))}initLinesCache(){this._linesCache||(this._linesCache=new Array(this._terminal.buffer.active.length),this._linesCacheDisposables.value=T6(this._terminal.onLineFeed(()=>this._destroyLinesCache()),this._terminal.onCursorMove(()=>this._destroyLinesCache()),this._terminal.onResize(()=>this._destroyLinesCache()))),this._linesCacheTimeout.value=O6(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._linesCacheDisposables.clear(),this._linesCacheTimeout.clear()}getLineFromCache(t){return this._linesCache?.[t]}setLineInCache(t,e){this._linesCache&&(this._linesCache[t]=e)}translateBufferLineToStringWithWrap(t,e){let n=[],i=[0],r=this._terminal.buffer.active.getLine(t);for(;r;){let s=this._terminal.buffer.active.getLine(t+1),o=s?s.isWrapped:!1,a=r.translateToString(!o&&e);if(o&&s){let l=r.getCell(r.length-1);l&&l.getCode()===0&&l.getWidth()===1&&s.getCell(0)?.getWidth()===2&&(a=a.slice(0,-1))}if(n.push(a),o)i.push(i[i.length-1]+a.length);else break;t++,r=s}return[n.join(""),i]}},Ate=class{get cachedSearchTerm(){return this._cachedSearchTerm}set cachedSearchTerm(t){this._cachedSearchTerm=t}get lastSearchOptions(){return this._lastSearchOptions}set lastSearchOptions(t){this._lastSearchOptions=t}isValidSearchTerm(t){return!!(t&&t.length>0)}didOptionsChange(t){return this._lastSearchOptions?t?this._lastSearchOptions.caseSensitive!==t.caseSensitive||this._lastSearchOptions.regex!==t.regex||this._lastSearchOptions.wholeWord!==t.wholeWord:!1:!0}shouldUpdateHighlighting(t,e){return e?.decorations?this._cachedSearchTerm===void 0||t!==this._cachedSearchTerm||this.didOptionsChange(e):!1}clearCachedTerm(){this._cachedSearchTerm=void 0}reset(){this._cachedSearchTerm=void 0,this._lastSearchOptions=void 0}},kte=class{constructor(t,e){this._terminal=t,this._lineCache=e}find(t,e,n,i){if(!t||t.length===0){this._terminal.clearSelection();return}if(n>this._terminal.cols)throw new Error(`Invalid col: ${n} to search in terminal of ${this._terminal.cols} cols`);this._lineCache.initLinesCache();let r={startRow:e,startCol:n},s=this._findInLine(t,r,i);if(!s)for(let o=e+1;o<this._terminal.buffer.active.baseY+this._terminal.rows&&(r.startRow=o,r.startCol=0,s=this._findInLine(t,r,i),!s);o++);return s}findNextWithSelection(t,e,n){if(!t||t.length===0){this._terminal.clearSelection();return}let i=this._terminal.getSelectionPosition();this._terminal.clearSelection();let r=0,s=0;i&&(n===t?(r=i.end.x,s=i.end.y):(r=i.start.x,s=i.start.y)),this._lineCache.initLinesCache();let o={startRow:s,startCol:r},a=this._findInLine(t,o,e);if(!a)for(let l=s+1;l<this._terminal.buffer.active.baseY+this._terminal.rows&&(o.startRow=l,o.startCol=0,a=this._findInLine(t,o,e),!a);l++);if(!a&&s!==0)for(let l=0;l<s&&(o.startRow=l,o.startCol=0,a=this._findInLine(t,o,e),!a);l++);return!a&&i&&(o.startRow=i.start.y,o.startCol=0,a=this._findInLine(t,o,e)),a}findPreviousWithSelection(t,e,n){if(!t||t.length===0){this._terminal.clearSelection();return}let i=this._terminal.getSelectionPosition();this._terminal.clearSelection();let r=this._terminal.buffer.active.baseY+this._terminal.rows-1,s=this._terminal.cols,o=!0;this._lineCache.initLinesCache();let a={startRow:r,startCol:s},l;if(i&&(a.startRow=r=i.start.y,a.startCol=s=i.start.x,n!==t&&(l=this._findInLine(t,a,e,!1),l||(a.startRow=r=i.end.y,a.startCol=s=i.end.x))),l||(l=this._findInLine(t,a,e,o)),!l){a.startCol=Math.max(a.startCol,this._terminal.cols);for(let c=r-1;c>=0&&(a.startRow=c,l=this._findInLine(t,a,e,o),!l);c--);}if(!l&&r!==this._terminal.buffer.active.baseY+this._terminal.rows-1)for(let c=this._terminal.buffer.active.baseY+this._terminal.rows-1;c>=r&&(a.startRow=c,l=this._findInLine(t,a,e,o),!l);c--);return l}_isWholeWord(t,e,n){return(t===0||" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?".includes(e[t-1]))&&(t+n.length===e.length||" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?".includes(e[t+n.length]))}_findInLine(t,e,n={},i=!1){let r=e.startRow,s=e.startCol;if(this._terminal.buffer.active.getLine(r)?.isWrapped){if(i){e.startCol+=this._terminal.cols;return}return e.startRow--,e.startCol+=this._terminal.cols,this._findInLine(t,e,n)}let o=this._lineCache.getLineFromCache(r);o||(o=this._lineCache.translateBufferLineToStringWithWrap(r,!0),this._lineCache.setLineInCache(r,o));let[a,l]=o,c=this._bufferColsToStringOffset(r,s),u=t,d=a;n.regex||(u=n.caseSensitive?t:t.toLowerCase(),d=n.caseSensitive?a:a.toLowerCase());let p=-1;if(n.regex){let m=RegExp(u,n.caseSensitive?"g":"gi"),g;if(i)for(;g=m.exec(d.slice(0,c));)p=m.lastIndex-g[0].length,t=g[0],m.lastIndex-=t.length-1;else g=m.exec(d.slice(c)),g&&g[0].length>0&&(p=c+(m.lastIndex-g[0].length),t=g[0])}else i?c-u.length>=0&&(p=d.lastIndexOf(u,c-u.length)):p=d.indexOf(u,c);if(p>=0){if(n.wholeWord&&!this._isWholeWord(p,d,t))return;let m=0;for(;m<l.length-1&&p>=l[m+1];)m++;let g=m;for(;g<l.length-1&&p+t.length>=l[g+1];)g++;let _=p-l[m],y=p+t.length-l[g],v=this._stringLengthToBufferSize(r+m,_),S=this._stringLengthToBufferSize(r+g,y)-v+this._terminal.cols*(g-m);return{term:t,col:v,row:r+m,size:S}}}_stringLengthToBufferSize(t,e){let n=this._terminal.buffer.active.getLine(t);if(!n)return 0;for(let i=0;i<e;i++){let r=n.getCell(i);if(!r)break;let s=r.getChars();s.length>1&&(e-=s.length-1);let o=n.getCell(i+1);o&&o.getWidth()===0&&e++}return e}_bufferColsToStringOffset(t,e){let n=t,i=0,r=this._terminal.buffer.active.getLine(n);for(;e>0&&r;){for(let s=0;s<e&&s<this._terminal.cols;s++){let o=r.getCell(s);if(!o)break;o.getWidth()&&(i+=o.getCode()===0?1:o.getChars().length)}if(n++,r=this._terminal.buffer.active.getLine(n),r&&!r.isWrapped)break;e-=this._terminal.cols}return i}},Lte=class extends kl{constructor(t){super(),this._terminal=t,this._highlightDecorations=[],this._highlightedLines=new Set,this._register(im(()=>this.clearHighlightDecorations()))}createHighlightDecorations(t,e){this.clearHighlightDecorations();for(let n of t){let i=this._createResultDecorations(n,e,!1);if(i)for(let r of i)this._storeDecoration(r,n)}}createActiveDecoration(t,e){let n=this._createResultDecorations(t,e,!0);if(n)return{decorations:n,match:t,dispose(){V_(n)}}}clearHighlightDecorations(){V_(this._highlightDecorations),this._highlightDecorations=[],this._highlightedLines.clear()}_storeDecoration(t,e){this._highlightedLines.add(t.marker.line),this._highlightDecorations.push({decoration:t,match:e,dispose(){t.dispose()}})}_applyStyles(t,e,n){t.classList.contains("xterm-find-result-decoration")||(t.classList.add("xterm-find-result-decoration"),e&&(t.style.outline=`1px solid ${e}`)),n&&t.classList.add("xterm-find-active-result-decoration")}_createResultDecorations(t,e,n){let i=[],r=t.col,s=t.size,o=-this._terminal.buffer.active.baseY-this._terminal.buffer.active.cursorY+t.row;for(;s>0;){let l=Math.min(this._terminal.cols-r,s);i.push([o,r,l]),r=0,s-=l,o++}let a=[];for(let l of i){let c=this._terminal.registerMarker(l[0]),u=this._terminal.registerDecoration({marker:c,x:l[1],width:l[2],backgroundColor:n?e.activeMatchBackground:e.matchBackground,overviewRulerOptions:this._highlightedLines.has(c.line)?void 0:{color:n?e.activeMatchColorOverviewRuler:e.matchOverviewRuler,position:"center"}});if(u){let d=[];d.push(c),d.push(u.onRender(p=>this._applyStyles(p,n?e.activeMatchBorder:e.matchBorder,!1))),d.push(u.onDispose(()=>V_(d))),a.push(u)}}return a.length===0?void 0:a}},Pte=class extends kl{constructor(){super(...arguments),this._searchResults=[],this._onDidChangeResults=this._register(new Al)}get onDidChangeResults(){return this._onDidChangeResults.event}get searchResults(){return this._searchResults}get selectedDecoration(){return this._selectedDecoration}set selectedDecoration(t){this._selectedDecoration=t}updateResults(t,e){this._searchResults=t.slice(0,e)}clearResults(){this._searchResults=[]}clearSelectedDecoration(){this._selectedDecoration&&(this._selectedDecoration.dispose(),this._selectedDecoration=void 0)}findResultIndex(t){for(let e=0;e<this._searchResults.length;e++){let n=this._searchResults[e];if(n.row===t.row&&n.col===t.col&&n.size===t.size)return e}return-1}fireResultsChanged(t){if(!t)return;let e=-1;this._selectedDecoration&&(e=this.findResultIndex(this._selectedDecoration.match)),this._onDidChangeResults.fire({resultIndex:e,resultCount:this._searchResults.length})}reset(){this.clearSelectedDecoration(),this.clearResults()}},B6=class extends kl{constructor(t){super(),this._highlightTimeout=this._register(new jw),this._lineCache=this._register(new jw),this._state=new Ate,this._resultTracker=this._register(new Pte),this._highlightLimit=t?.highlightLimit??1e3}get onDidChangeResults(){return this._resultTracker.onDidChangeResults}activate(t){this._terminal=t,this._lineCache.value=new Mte(t),this._engine=new kte(t,this._lineCache.value),this._decorationManager=new Lte(t),this._register(this._terminal.onWriteParsed(()=>this._updateMatches())),this._register(this._terminal.onResize(()=>this._updateMatches())),this._register(im(()=>this.clearDecorations()))}_updateMatches(){this._highlightTimeout.clear(),this._state.cachedSearchTerm&&this._state.lastSearchOptions?.decorations&&(this._highlightTimeout.value=O6(()=>{let t=this._state.cachedSearchTerm;this._state.clearCachedTerm(),this.findPrevious(t,{...this._state.lastSearchOptions,incremental:!0},{noScroll:!0})},200))}clearDecorations(t){this._resultTracker.clearSelectedDecoration(),this._decorationManager?.clearHighlightDecorations(),this._resultTracker.clearResults(),t||this._state.clearCachedTerm()}clearActiveDecoration(){this._resultTracker.clearSelectedDecoration()}findNext(t,e,n){if(!this._terminal||!this._engine)throw new Error("Cannot use addon until it has been loaded");this._state.lastSearchOptions=e,this._state.shouldUpdateHighlighting(t,e)&&this._highlightAllMatches(t,e);let i=this._findNextAndSelect(t,e,n);return this._fireResults(e),this._state.cachedSearchTerm=t,i}_highlightAllMatches(t,e){if(!this._terminal||!this._engine||!this._decorationManager)throw new Error("Cannot use addon until it has been loaded");if(!this._state.isValidSearchTerm(t)){this.clearDecorations();return}this.clearDecorations(!0);let n=[],i,r=this._engine.find(t,0,0,e);for(;r&&(i?.row!==r.row||i?.col!==r.col)&&!(n.length>=this._highlightLimit);)i=r,n.push(i),r=this._engine.find(t,i.col+i.term.length>=this._terminal.cols?i.row+1:i.row,i.col+i.term.length>=this._terminal.cols?0:i.col+1,e);this._resultTracker.updateResults(n,this._highlightLimit),e.decorations&&this._decorationManager.createHighlightDecorations(n,e.decorations)}_findNextAndSelect(t,e,n){if(!this._terminal||!this._engine)return!1;if(!this._state.isValidSearchTerm(t))return this._terminal.clearSelection(),this.clearDecorations(),!1;let i=this._engine.findNextWithSelection(t,e,this._state.cachedSearchTerm);return this._selectResult(i,e?.decorations,n?.noScroll)}findPrevious(t,e,n){if(!this._terminal||!this._engine)throw new Error("Cannot use addon until it has been loaded");this._state.lastSearchOptions=e,this._state.shouldUpdateHighlighting(t,e)&&this._highlightAllMatches(t,e);let i=this._findPreviousAndSelect(t,e,n);return this._fireResults(e),this._state.cachedSearchTerm=t,i}_fireResults(t){this._resultTracker.fireResultsChanged(!!t?.decorations)}_findPreviousAndSelect(t,e,n){if(!this._terminal||!this._engine)return!1;if(!this._state.isValidSearchTerm(t))return this._terminal.clearSelection(),this.clearDecorations(),!1;let i=this._engine.findPreviousWithSelection(t,e,this._state.cachedSearchTerm);return this._selectResult(i,e?.decorations,n?.noScroll)}_selectResult(t,e,n){if(!this._terminal||!this._decorationManager)return!1;if(this._resultTracker.clearSelectedDecoration(),!t)return this._terminal.clearSelection(),!1;if(this._terminal.select(t.col,t.row,t.size),e){let i=this._decorationManager.createActiveDecoration(t,e);i&&(this._resultTracker.selectedDecoration=i)}if(!n&&(t.row>=this._terminal.buffer.active.viewportY+this._terminal.rows||t.row<this._terminal.buffer.active.viewportY)){let i=t.row-this._terminal.buffer.active.viewportY;i-=Math.floor(this._terminal.rows/2),this._terminal.scrollLines(i)}return!0}};var Dte=`
.xterm { position: relative; user-select: none; -ms-user-select: none; -webkit-user-select: none; }
.xterm.focus, .xterm:focus { outline: none; }
.xterm .xterm-helpers { position: absolute; top: 0; z-index: 5; }
.xterm .xterm-helper-textarea { padding: 0; border: 0; margin: 0; position: absolute; opacity: 0; left: -9999em; top: 0; width: 0; height: 0; z-index: -5; white-space: nowrap; overflow: hidden; resize: none; }
.xterm .composition-view { background: #000; color: #FFF; display: none; position: absolute; white-space: nowrap; z-index: 1; }
.xterm .composition-view.active { display: block; }
.xterm .xterm-viewport { background-color: #000; overflow-y: scroll; cursor: default; position: absolute; right: 0; left: 0; top: 0; bottom: 0; }
.xterm .xterm-screen { position: relative; }
.xterm .xterm-screen canvas { position: absolute; left: 0; top: 0; }
.xterm .xterm-scroll-area { visibility: hidden; }
.xterm-char-measure-element { display: inline-block; visibility: hidden; position: absolute; top: 0; left: -9999em; line-height: normal; }
.xterm.enable-mouse-events { cursor: default; }
.xterm.xterm-cursor-pointer, .xterm .xterm-cursor-pointer { cursor: pointer; }
.xterm.column-select.focus { cursor: crosshair; }
.xterm .xterm-accessibility, .xterm .xterm-message { position: absolute; left: 0; top: 0; bottom: 0; right: 0; z-index: 10; color: transparent; pointer-events: none; }
.xterm .live-region { position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden; }
.xterm-dim { opacity: 0.5; }
.xterm-underline-1 { text-decoration: underline; }
.xterm-underline-2 { text-decoration: double underline; }
.xterm-underline-3 { text-decoration: wavy underline; }
.xterm-underline-4 { text-decoration: dotted underline; }
.xterm-underline-5 { text-decoration: dashed underline; }
.xterm-overline { text-decoration: overline; }
.xterm-strikethrough { text-decoration: line-through; }
.xterm-screen .xterm-decoration-container .xterm-decoration { z-index: 6; position: absolute; }
.xterm-screen .xterm-decoration-container .xterm-decoration.xterm-decoration-top-layer { z-index: 7; }
.xterm-decoration-overview-ruler { z-index: 8; position: absolute; top: 0; right: 0; pointer-events: none; }
.xterm-decoration-top { z-index: 2; position: relative; }
`,U6=!1;function Ite(){if(U6)return;let t=document.createElement("style");t.setAttribute("data-xterm-css","true"),t.textContent=Dte,document.head.appendChild(t),U6=!0}var Rte={width:"100%",height:"100%",backgroundColor:"#0a0a14",overflow:"hidden"};function eL({onData:t,dataToWrite:e,onResize:n,isActive:i}){let r=(0,ha.useRef)(null),s=(0,ha.useRef)(null),o=(0,ha.useRef)(null),a=(0,ha.useRef)(null),l=(0,ha.useRef)("");return(0,ha.useEffect)(()=>{if(Ite(),!r.current)return;let c=new u6({cursorBlink:!0,cursorStyle:"block",fontSize:13,fontFamily:"'JetBrains Mono', 'Fira Code', 'Cascadia Code', Menlo, Monaco, 'Courier New', monospace",lineHeight:1.2,theme:{background:"#0a0a14",foreground:"#e0e0e0",cursor:"#e0e0e0",cursorAccent:"#0a0a14",selectionBackground:"#3a3a6a80",black:"#1a1a2e",red:"#ef4444",green:"#10b981",yellow:"#f59e0b",blue:"#6366f1",magenta:"#ec4899",cyan:"#06b6d4",white:"#e0e0e0",brightBlack:"#4a4a6a",brightRed:"#f87171",brightGreen:"#34d399",brightYellow:"#fbbf24",brightBlue:"#818cf8",brightMagenta:"#f472b6",brightCyan:"#22d3ee",brightWhite:"#ffffff"},allowProposedApi:!0,scrollback:5e3}),u=new h6,d=new d6,p=new B6;c.loadAddon(u),c.loadAddon(d),c.loadAddon(p),c.open(r.current),u.fit(),c.onData(g=>{t(g)}),c.onResize(({cols:g,rows:_})=>{n?.(g,_)}),s.current=c,o.current=u,a.current=p;let m=new ResizeObserver(()=>{try{u.fit()}catch{}});return m.observe(r.current),()=>{m.disconnect(),c.dispose(),s.current=null,o.current=null,a.current=null}},[]),(0,ha.useEffect)(()=>{e&&e!==l.current&&s.current&&(s.current.write(e),l.current=e)},[e]),(0,ha.useEffect)(()=>{if(i&&o.current){let c=setTimeout(()=>{try{o.current?.fit()}catch{}},50);return()=>clearTimeout(c)}},[i]),ha.default.createElement("div",{ref:r,style:Rte})}var Js=mt(Ct(),1);function F6({direction:t,children:e,initialRatio:n=.5,minSize:i=100}){let[r,s]=(0,Js.useState)(n),o=(0,Js.useRef)(null),a=(0,Js.useRef)(!1),l=(0,Js.useCallback)(g=>{g.preventDefault(),a.current=!0,document.body.style.cursor=t==="horizontal"?"col-resize":"row-resize",document.body.style.userSelect="none"},[t]);(0,Js.useEffect)(()=>{let g=y=>{if(!a.current||!o.current)return;let v=o.current.getBoundingClientRect(),S;t==="horizontal"?S=(y.clientX-v.left)/v.width:S=(y.clientY-v.top)/v.height;let b=t==="horizontal"?v.width:v.height,w=i/b,C=1-w;S=Math.max(w,Math.min(C,S)),s(S)},_=()=>{a.current&&(a.current=!1,document.body.style.cursor="",document.body.style.userSelect="")};return document.addEventListener("mousemove",g),document.addEventListener("mouseup",_),()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",_)}},[t,i]);let c=t==="horizontal",u={display:"flex",flexDirection:c?"row":"column",width:"100%",height:"100%",overflow:"hidden"},d={[c?"width":"height"]:`calc(${r*100}% - 2px)`,overflow:"hidden",position:"relative"},p={flex:1,overflow:"hidden",position:"relative"},m={[c?"width":"height"]:"4px",cursor:c?"col-resize":"row-resize",backgroundColor:"#2d2d44",flexShrink:0,transition:"background-color 0.15s"};return Js.default.createElement("div",{ref:o,style:u},Js.default.createElement("div",{style:d},e[0]),Js.default.createElement("div",{style:m,onMouseDown:l,onMouseEnter:g=>{g.currentTarget.style.backgroundColor="#4a4a6a"},onMouseLeave:g=>{a.current||(g.currentTarget.style.backgroundColor="#2d2d44")}}),Js.default.createElement("div",{style:p},e[1]))}var Nte={display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#0d0d1a",color:"#e0e0e0"},Ote={display:"flex",alignItems:"center",backgroundColor:"#12121f",borderBottom:"1px solid #2d2d44",overflowX:"auto",flexShrink:0},Bte=t=>({display:"inline-flex",alignItems:"center",gap:"6px",padding:"6px 14px",fontSize:"12px",color:t?"#e0e0e0":"#7a7a9a",backgroundColor:t?"#1a1a2e":"transparent",borderBottom:t?"2px solid #6366f1":"2px solid transparent",borderRight:"1px solid #1e1e35",cursor:"pointer",whiteSpace:"nowrap",transition:"background-color 0.15s, color 0.15s",fontFamily:"inherit"}),Ute={display:"inline-flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"3px",fontSize:"14px",lineHeight:1,color:"#666",cursor:"pointer",transition:"background-color 0.15s, color 0.15s"},Fte={display:"inline-flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",margin:"0 4px",fontSize:"16px",color:"#7a7a9a",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.15s, color 0.15s",fontFamily:"inherit"},zte={flex:1,overflow:"hidden",position:"relative"},Hte={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#5a5a7a",fontSize:"14px",gap:"12px"},tL=0;function z6(){let{connect:t,disconnect:e,send:n,on:i,connectionState:r}=o5(),[s,o]=(0,Zt.useState)([]),[a,l]=(0,Zt.useState)(null),[c,u]=(0,Zt.useState)("zsh"),[d,p]=(0,Zt.useState)(null),m=(0,Zt.useRef)(new Map),[g,_]=(0,Zt.useState)(0);(0,Zt.useEffect)(()=>(t(),()=>e()),[t,e]),(0,Zt.useEffect)(()=>i("output",T=>{if(T.terminalId&&T.data){let A=m.current.get(T.terminalId)||"";m.current.set(T.terminalId,A+T.data),_(I=>I+1)}}),[i]),(0,Zt.useEffect)(()=>i("created",T=>{if(T.terminalId){let A=T.shell||c,I=T.terminalId.slice(0,6),F={id:T.terminalId,shell:A,title:`${A} (${I})`,dataBuffer:""};o(B=>[...B,F]),l(T.terminalId),p(B=>B||{type:"terminal",terminalId:T.terminalId})}}),[i,c]),(0,Zt.useEffect)(()=>i("exited",T=>{T.terminalId&&v(T.terminalId)}),[i]);let y=(0,Zt.useCallback)(()=>{tL++;let P=`temp-${tL}`;n({type:"create",shell:c})},[n,c]),v=(0,Zt.useCallback)(P=>{n({type:"destroy",terminalId:P}),m.current.delete(P),o(T=>T.filter(I=>I.id!==P)),l(T=>{if(T===P){let A=s.filter(I=>I.id!==P);return A.length>0?A[A.length-1].id:null}return T}),p(T=>T?nL(T,P):null)},[n,s]),S=(0,Zt.useCallback)((P,T)=>{n({type:"input",terminalId:P,data:T})},[n]),b=(0,Zt.useCallback)((P,T,A)=>{n({type:"resize",terminalId:P,cols:T,rows:A})},[n]),w=(0,Zt.useCallback)(()=>{a&&n({type:"input",terminalId:a,data:"\x1B[2J\x1B[H"})},[n,a]),C=(0,Zt.useCallback)(P=>{if(!a)return;tL++,n({type:"create",shell:c});let T=i("created",A=>{A.terminalId&&(p(I=>I?iL(I,a,A.terminalId,P):{type:"terminal",terminalId:A.terminalId}),T())})},[a,n,c,i]),M=P=>{if(P.type==="terminal"&&P.terminalId){let T=P.terminalId===a,A=m.current.get(P.terminalId)||"";return Zt.default.createElement("div",{style:{width:"100%",height:"100%",display:T?"block":"none"},key:P.terminalId},Zt.default.createElement(eL,{onData:I=>S(P.terminalId,I),dataToWrite:A,onResize:(I,F)=>b(P.terminalId,I,F),isActive:T}))}return P.type==="split"&&P.children&&P.direction?Zt.default.createElement(F6,{direction:P.direction},[M(P.children[0]),M(P.children[1])]):null},L=()=>s.length===0?Zt.default.createElement("div",{style:Hte},Zt.default.createElement("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",style:{opacity:.4}},Zt.default.createElement("rect",{x:"2",y:"3",width:"20",height:"18",rx:"2"}),Zt.default.createElement("polyline",{points:"7 10 10 13 7 16"}),Zt.default.createElement("line",{x1:"13",y1:"16",x2:"17",y2:"16"})),Zt.default.createElement("span",null,"No terminals open. Click + to create one.")):s.map(P=>{let T=P.id===a,A=m.current.get(P.id)||"";return Zt.default.createElement("div",{key:P.id,style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,visibility:T?"visible":"hidden"}},Zt.default.createElement(eL,{onData:I=>S(P.id,I),dataToWrite:A,onResize:(I,F)=>b(P.id,I,F),isActive:T}))});return Zt.default.createElement("div",{style:Nte},Zt.default.createElement(a5,{connectionState:r,selectedShell:c,onShellChange:u,onNewTerminal:y,onSplitHorizontal:()=>C("horizontal"),onSplitVertical:()=>C("vertical"),onClear:w}),Zt.default.createElement("div",{style:Ote},s.map(P=>Zt.default.createElement("div",{key:P.id,style:Bte(P.id===a),onClick:()=>l(P.id),onMouseEnter:T=>{P.id!==a&&(T.currentTarget.style.backgroundColor="#1a1a30",T.currentTarget.style.color="#b0b0c0")},onMouseLeave:T=>{P.id!==a&&(T.currentTarget.style.backgroundColor="transparent",T.currentTarget.style.color="#7a7a9a")}},Zt.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Zt.default.createElement("polyline",{points:"4 17 10 11 4 5"}),Zt.default.createElement("line",{x1:"12",y1:"19",x2:"20",y2:"19"})),Zt.default.createElement("span",null,P.title),Zt.default.createElement("span",{style:Ute,onClick:T=>{T.stopPropagation(),v(P.id)},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#3a3a5a",T.currentTarget.style.color="#ef4444"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="transparent",T.currentTarget.style.color="#666"},title:"Close terminal"},"x"))),Zt.default.createElement("button",{style:Fte,onClick:y,title:"New Terminal",onMouseEnter:P=>{P.currentTarget.style.backgroundColor="#2a2a45",P.currentTarget.style.color="#e0e0e0"},onMouseLeave:P=>{P.currentTarget.style.backgroundColor="transparent",P.currentTarget.style.color="#7a7a9a"}},"+")),Zt.default.createElement("div",{style:zte},L()))}function nL(t,e){if(t.type==="terminal")return t.terminalId===e?null:t;if(t.type==="split"&&t.children){let n=nL(t.children[0],e),i=nL(t.children[1],e);return!n&&!i?null:n?i?{...t,children:[n,i]}:n:i}return t}function iL(t,e,n,i){return t.type==="terminal"&&t.terminalId===e?{type:"split",direction:i,children:[{type:"terminal",terminalId:e},{type:"terminal",terminalId:n}]}:t.type==="split"&&t.children?{...t,children:[iL(t.children[0],e,n,i),iL(t.children[1],e,n,i)]}:t}var bn=mt(Ct(),1);var j_=mt(Ct(),1);function Wte(t){if(t<=0)return"0s";let e=Math.floor(t/1e3),n=Math.floor(e/60),i=Math.floor(n/60);if(i>0){let r=n%60;return`${i}h ${r}m`}if(n>0){let r=e%60;return`${n}m ${r}s`}return`${e}s`}function H6(t){return t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString()}var Vte={backgroundColor:"var(--bg-secondary, #27272a)",borderRadius:"8px",padding:"20px",border:"1px solid var(--border-primary, #3f3f46)",display:"flex",flexDirection:"column",gap:"4px"},Gte={fontSize:"11px",color:"var(--text-secondary, #a1a1aa)",fontFamily:"monospace",textTransform:"uppercase",letterSpacing:"0.05em"},jte={fontSize:"28px",fontWeight:700,color:"var(--text-primary, #fafafa)",fontFamily:"monospace",lineHeight:1.2};function W6({totalSessions:t,totalObservations:e,avgSessionDuration:n,avgObservationsPerSession:i}){let r=[{label:"Total Sessions",value:H6(t)},{label:"Total Observations",value:H6(e)},{label:"Avg Session Duration",value:Wte(n)},{label:"Avg Obs / Session",value:i.toFixed(1)}];return j_.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px"}},r.map(s=>j_.default.createElement("div",{key:s.label,style:Vte},j_.default.createElement("div",{style:Gte},s.label),j_.default.createElement("div",{style:jte},s.value))))}var Ac=mt(Ct(),1);var rm=24,X_=160,Xte=60,qte=15;function Yte(t,e){return`hsl(260, 60%, ${45+t/Math.max(e-1,1)*20}%)`}function V6({tools:t}){let e=t.slice(0,qte),n=e.length>0?e[0].count:1;if(e.length===0)return Ac.default.createElement("div",{style:{padding:"2rem",opacity:.5,textAlign:"center"}},"No tool usage data available");let i=600,r=i-X_-Xte,s=e.length*(rm+6)+10;return Ac.default.createElement("div",{style:{width:"100%",overflowX:"auto"}},Ac.default.createElement("svg",{width:"100%",height:s,viewBox:`0 0 ${i} ${s}`,preserveAspectRatio:"xMinYMin meet",style:{display:"block"}},e.map((o,a)=>{let l=a*(rm+6)+5,c=Math.max(o.count/n*r,2),u=Yte(a,e.length);return Ac.default.createElement("g",{key:o.name},Ac.default.createElement("text",{x:X_-8,y:l+rm/2+1,textAnchor:"end",dominantBaseline:"middle",fill:"var(--text-secondary, #a1a1aa)",fontSize:"12",fontFamily:"monospace"},o.name.length>22?o.name.slice(0,20)+"..":o.name),Ac.default.createElement("rect",{x:X_,y:l,width:r,height:rm,rx:4,fill:"var(--bg-tertiary, #27272a)",opacity:.3}),Ac.default.createElement("rect",{x:X_,y:l,width:c,height:rm,rx:4,fill:u,opacity:.85}),Ac.default.createElement("text",{x:X_+r+8,y:l+rm/2+1,dominantBaseline:"middle",fill:"var(--text-primary, #fafafa)",fontSize:"12",fontFamily:"monospace",fontWeight:"600"},o.count))})))}var pi=mt(Ct(),1),Yw=["#ef4444","#f97316","#eab308","#ec4899","#8b5cf6","#06b6d4","#14b8a6","#84cc16","#f43f5e","#a855f7"];function G6({errors:t,daily:e}){let n=t.reduce((o,a)=>o+a.count,0),{path:i,maxCount:r,points:s}=(0,pi.useMemo)(()=>{if(e.length===0)return{path:"",maxCount:0,points:[]};let o=Math.max(...e.map(_=>_.count),1),a=500,l=120,c={top:10,bottom:20,left:0,right:0},u=a-c.left-c.right,d=l-c.top-c.bottom,p=e.map((_,y)=>({x:c.left+y/Math.max(e.length-1,1)*u,y:c.top+d-_.count/o*d,date:_.date,count:_.count})),m=`M ${p[0].x} ${p[0].y}`;for(let _=1;_<p.length;_++)m+=` L ${p[_].x} ${p[_].y}`;let g=m+` L ${p[p.length-1].x} ${l-c.bottom} L ${p[0].x} ${l-c.bottom} Z`;return{path:m,areaPath:g,maxCount:o,points:p}},[e]);return t.length===0&&e.length===0?pi.default.createElement("div",{style:{padding:"2rem",opacity:.5,textAlign:"center"}},"No error data available"):pi.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"16px"}},t.length>0&&pi.default.createElement("div",null,pi.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-secondary, #a1a1aa)",marginBottom:"8px",fontFamily:"monospace"}},"Error Types (",n," total)"),pi.default.createElement("div",{style:{display:"flex",borderRadius:"6px",overflow:"hidden",height:"24px"}},t.map((o,a)=>{let l=n>0?o.count/n*100:0;return pi.default.createElement("div",{key:o.type,style:{width:`${l}%`,backgroundColor:Yw[a%Yw.length],minWidth:l>0?"2px":0,transition:"width 0.3s ease"},title:`${o.type}: ${o.count}`})})),pi.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"8px"}},t.map((o,a)=>pi.default.createElement("div",{key:o.type,style:{display:"flex",alignItems:"center",gap:"4px"}},pi.default.createElement("div",{style:{width:"8px",height:"8px",borderRadius:"2px",backgroundColor:Yw[a%Yw.length]}}),pi.default.createElement("span",{style:{fontSize:"11px",color:"var(--text-secondary, #a1a1aa)",fontFamily:"monospace"}},o.type," (",o.count,")"),o.trend!==0&&pi.default.createElement("span",{style:{fontSize:"10px",color:o.trend>0?"#ef4444":"#22c55e",fontFamily:"monospace"}},o.trend>0?"+":"",o.trend,"%"))))),e.length>0&&pi.default.createElement("div",null,pi.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-secondary, #a1a1aa)",marginBottom:"8px",fontFamily:"monospace"}},"Daily Error Trend"),pi.default.createElement("svg",{width:"100%",height:140,viewBox:"0 0 500 140",preserveAspectRatio:"xMinYMin meet",style:{display:"block"}},[0,.25,.5,.75,1].map(o=>{let a=10+(1-o)*90;return pi.default.createElement("line",{key:o,x1:0,y1:a,x2:500,y2:a,stroke:"var(--border-primary, #3f3f46)",strokeWidth:.5,opacity:.3})}),s.length>1&&pi.default.createElement("path",{d:`${i} L ${s[s.length-1].x} 120 L ${s[0].x} 120 Z`,fill:"#ef4444",opacity:.1}),pi.default.createElement("path",{d:i,fill:"none",stroke:"#ef4444",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),s.map((o,a)=>pi.default.createElement("circle",{key:a,cx:o.x,cy:o.y,r:2,fill:"#ef4444",opacity:.8},pi.default.createElement("title",null,`${o.date}: ${o.count} error${o.count!==1?"s":""}`))),pi.default.createElement("text",{x:4,y:16,fill:"var(--text-secondary, #a1a1aa)",fontSize:"9",fontFamily:"monospace"},r),pi.default.createElement("text",{x:4,y:118,fill:"var(--text-secondary, #a1a1aa)",fontSize:"9",fontFamily:"monospace"},"0"))))}var Tr=mt(Ct(),1),da=13,sm=3,om=["#161b22","#0e4429","#006d32","#26a641","#39d353"],Kte=["","Mon","","Wed","","Fri",""],$te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],rL=30,sL=20,oL=52;function Jte(t){return t===0?om[0]:t<=2?om[1]:t<=5?om[2]:t<=9?om[3]:om[4]}function Zte(t){let e=new Map;for(let o of t)e.set(o.date,o.count);let n=new Date,i=[],r=[],s=new Date(n);s.setDate(s.getDate()-oL*7+(7-s.getDay()));for(let o=0;o<oL;o++){let a=[],l=[];for(let c=0;c<7;c++){let u=new Date(s);if(u.setDate(u.getDate()+o*7+c),u>n)a.push(-1),l.push("");else{let d=u.toISOString().slice(0,10);a.push(e.get(d)||0),l.push(d)}}i.push(a),r.push(l)}return{grid:i,dates:r}}function j6({days:t}){let[e,n]=(0,Tr.useState)(null),{grid:i,dates:r}=(0,Tr.useMemo)(()=>Zte(t),[t]),s=(0,Tr.useMemo)(()=>{let l=[],c=-1;for(let u=0;u<i.length;u++){let d=r[u][0];if(!d)continue;let p=new Date(d).getMonth();p!==c&&(l.push({label:$te[p],x:rL+u*(da+sm)}),c=p)}return l},[i,r]),o=rL+oL*(da+sm),a=sL+7*(da+sm);return Tr.default.createElement("div",{style:{width:"100%",overflowX:"auto",position:"relative"}},Tr.default.createElement("svg",{width:"100%",height:a,viewBox:`0 0 ${o} ${a}`,preserveAspectRatio:"xMinYMin meet",style:{display:"block"}},s.map((l,c)=>Tr.default.createElement("text",{key:c,x:l.x,y:12,fill:"var(--text-secondary, #a1a1aa)",fontSize:"10",fontFamily:"monospace"},l.label)),Kte.map((l,c)=>l?Tr.default.createElement("text",{key:c,x:0,y:sL+c*(da+sm)+da-2,fill:"var(--text-secondary, #a1a1aa)",fontSize:"10",fontFamily:"monospace"},l):null),i.map((l,c)=>l.map((u,d)=>{if(u===-1)return null;let p=rL+c*(da+sm),m=sL+d*(da+sm);return Tr.default.createElement("rect",{key:`${c}-${d}`,x:p,y:m,width:da,height:da,rx:2,fill:Jte(u),style:{cursor:"pointer"},onMouseEnter:g=>{let _=r[c][d];_&&n({x:p+da/2,y:m-8,text:`${u} observation${u!==1?"s":""} on ${_}`})},onMouseLeave:()=>n(null)})})),e&&Tr.default.createElement("g",null,Tr.default.createElement("rect",{x:e.x-80,y:e.y-22,width:160,height:20,rx:4,fill:"var(--bg-primary, #18181b)",stroke:"var(--border-primary, #3f3f46)",strokeWidth:1}),Tr.default.createElement("text",{x:e.x,y:e.y-9,textAnchor:"middle",fill:"var(--text-primary, #fafafa)",fontSize:"10",fontFamily:"monospace"},e.text))),Tr.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"8px",justifyContent:"flex-end"}},Tr.default.createElement("span",{style:{fontSize:"10px",color:"var(--text-secondary, #a1a1aa)",fontFamily:"monospace",marginRight:"4px"}},"Less"),om.map((l,c)=>Tr.default.createElement("div",{key:c,style:{width:da-2,height:da-2,backgroundColor:l,borderRadius:"2px"}})),Tr.default.createElement("span",{style:{fontSize:"10px",color:"var(--text-secondary, #a1a1aa)",fontFamily:"monospace",marginLeft:"4px"}},"More")))}var Qte=[{value:"7",label:"7d"},{value:"30",label:"30d"},{value:"90",label:"90d"},{value:"365",label:"1y"}];function X6({currentProject:t,projects:e,onProjectChange:n}){let[i,r]=(0,bn.useState)("30"),[s,o]=(0,bn.useState)(!0),[a,l]=(0,bn.useState)([]),[c,u]=(0,bn.useState)([]),[d,p]=(0,bn.useState)([]),[m,g]=(0,bn.useState)([]),[_,y]=(0,bn.useState)({totalSessions:0,totalObservations:0,avgSessionDuration:0,avgObservationsPerSession:0}),v=(0,bn.useCallback)(async()=>{o(!0);let S=t?`project=${encodeURIComponent(t)}&`:"";try{let[b,w,C,M]=await Promise.all([fetch(`/api/analytics/tool-usage?${S}days=${i}`),fetch(`/api/analytics/activity?${S}days=365`),fetch(`/api/analytics/errors?${S}days=${i}`),fetch(`/api/analytics/efficiency?${S?S.slice(0,-1):""}`)]),[L,P,T,A]=await Promise.all([b.json(),w.json(),C.json(),M.json()]);l(L.tools||[]),u(P.days||[]),p(T.errors||[]),g(T.daily||[]),y({totalSessions:A.totalSessions||0,totalObservations:A.totalObservations||0,avgSessionDuration:A.avgSessionDuration||0,avgObservationsPerSession:A.avgObservationsPerSession||0})}catch(b){console.error("Failed to fetch analytics:",b)}finally{o(!1)}},[t,i]);return(0,bn.useEffect)(()=>{v()},[v]),bn.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"1100px"}},bn.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px",flexWrap:"wrap",gap:"12px"}},bn.default.createElement("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:600}},"Analytics Dashboard"),bn.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},bn.default.createElement("select",{value:t,onChange:S=>n(S.target.value),style:{backgroundColor:"var(--bg-secondary, #27272a)",color:"var(--text-primary, #fafafa)",border:"1px solid var(--border-primary, #3f3f46)",borderRadius:"6px",padding:"6px 10px",fontSize:"12px",fontFamily:"monospace",cursor:"pointer",outline:"none"}},bn.default.createElement("option",{value:""},"All Projects"),e.map(S=>bn.default.createElement("option",{key:S,value:S},S))),bn.default.createElement("div",{style:{display:"flex",borderRadius:"6px",overflow:"hidden",border:"1px solid var(--border-primary, #3f3f46)"}},Qte.map(S=>bn.default.createElement("button",{key:S.value,onClick:()=>r(S.value),style:{backgroundColor:i===S.value?"var(--accent, #8b5cf6)":"var(--bg-secondary, #27272a)",color:i===S.value?"#fff":"var(--text-secondary, #a1a1aa)",border:"none",padding:"6px 12px",fontSize:"11px",fontFamily:"monospace",cursor:"pointer",fontWeight:i===S.value?600:400,transition:"background-color 0.15s ease"}},S.label))))),s?bn.default.createElement("div",{style:{padding:"3rem",textAlign:"center",opacity:.5}},"Loading analytics..."):bn.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"20px"}},bn.default.createElement(W6,{totalSessions:_.totalSessions,totalObservations:_.totalObservations,avgSessionDuration:_.avgSessionDuration,avgObservationsPerSession:_.avgObservationsPerSession}),bn.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"16px"}},bn.default.createElement("div",{style:{backgroundColor:"var(--bg-secondary, #27272a)",borderRadius:"8px",padding:"16px",border:"1px solid var(--border-primary, #3f3f46)"}},bn.default.createElement("div",{style:{fontSize:"13px",fontWeight:600,marginBottom:"12px",color:"var(--text-primary, #fafafa)"}},"Tool Usage"),bn.default.createElement(V6,{tools:a})),bn.default.createElement("div",{style:{backgroundColor:"var(--bg-secondary, #27272a)",borderRadius:"8px",padding:"16px",border:"1px solid var(--border-primary, #3f3f46)"}},bn.default.createElement("div",{style:{fontSize:"13px",fontWeight:600,marginBottom:"12px",color:"var(--text-primary, #fafafa)"}},"Error Patterns"),bn.default.createElement(G6,{errors:d,daily:m}))),bn.default.createElement("div",{style:{backgroundColor:"var(--bg-secondary, #27272a)",borderRadius:"8px",padding:"16px",border:"1px solid var(--border-primary, #3f3f46)"}},bn.default.createElement("div",{style:{fontSize:"13px",fontWeight:600,marginBottom:"12px",color:"var(--text-primary, #fafafa)"}},"Activity (Past Year)"),bn.default.createElement(j6,{days:c}))))}var Yt=mt(Ct(),1);var _t=mt(Ct(),1);var Pl=mt(Ct(),1),q6=[{label:"Every minute",expression:"* * * * *",description:"Runs every minute"},{label:"Every hour",expression:"0 * * * *",description:"Runs at the start of every hour"},{label:"Daily at 8am",expression:"0 8 * * *",description:"Runs daily at 8:00 AM"},{label:"Weekly Mon 9am",expression:"0 9 * * 1",description:"Runs every Monday at 9:00 AM"},{label:"Monthly 1st",expression:"0 0 1 * *",description:"Runs on the 1st of every month at midnight"}];function ene(t){if(!t)return"";let e=t.trim().split(/\s+/);if(e.length!==5)return"Invalid cron expression (needs 5 fields)";let[n,i,r,s,o]=e,a=q6.find(c=>c.expression===t);if(a)return a.description;let l=[];if(n==="*"&&i==="*"?l.push("Every minute"):n==="0"&&i==="*"?l.push("Every hour"):n.includes("/")?l.push(`Every ${n.split("/")[1]} minutes`):i==="*"?l.push(`At minute ${n} of every hour`):i.includes("/")?l.push(`At minute ${n}, every ${i.split("/")[1]} hours`):l.push(`At ${i.padStart(2,"0")}:${n.padStart(2,"0")}`),r!=="*"&&l.push(`on day ${r}`),s!=="*"){let c=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];l.push(`in ${c[parseInt(s)]||s}`)}if(o!=="*"){let c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],u=parseInt(o);l.push(`on ${c[u]||o}`)}return l.join(" ")}function Y6({value:t,onChange:e}){let[n,i]=(0,Pl.useState)("");return(0,Pl.useEffect)(()=>{i(ene(t))},[t]),Pl.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},Pl.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"}},q6.map(r=>Pl.default.createElement("button",{key:r.expression,type:"button",onClick:()=>e(r.expression),style:{padding:"4px 10px",fontSize:"0.75rem",borderRadius:"4px",border:t===r.expression?"1px solid var(--accent-color, #6366f1)":"1px solid var(--border-color, #333)",background:t===r.expression?"var(--accent-color, #6366f1)":"transparent",color:t===r.expression?"#fff":"var(--text-color, #e0e0e0)",cursor:"pointer"}},r.label))),Pl.default.createElement("input",{type:"text",value:t,onChange:r=>e(r.target.value),placeholder:"* * * * * (min hour day month weekday)",style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--input-bg, #1a1a2e)",color:"var(--text-color, #e0e0e0)",fontSize:"0.85rem",fontFamily:"monospace"}}),n&&Pl.default.createElement("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary, #888)",padding:"4px 0"}},n))}var tne=[{value:"cron",label:"Cron Schedule"},{value:"webhook",label:"Webhook"},{value:"trigger",label:"Event Trigger"},{value:"one-time",label:"One-Time"}],nne=[{value:"sonnet",label:"Sonnet"},{value:"opus",label:"Opus"},{value:"haiku",label:"Haiku"}],ine=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Berlin","Europe/Paris","Asia/Tokyo","Asia/Shanghai","Australia/Sydney"],fa={padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--input-bg, #1a1a2e)",color:"var(--text-color, #e0e0e0)",fontSize:"0.85rem",width:"100%",boxSizing:"border-box"},Do={fontSize:"0.8rem",fontWeight:600,marginBottom:"4px",color:"var(--text-color, #e0e0e0)"},Io={display:"flex",flexDirection:"column",gap:"4px",marginBottom:"16px"};function K6({job:t,onSave:e,onCancel:n,projects:i}){let[r,s]=(0,_t.useState)(t?.name||""),[o,a]=(0,_t.useState)(t?.type||"cron"),[l,c]=(0,_t.useState)(t?.project||i[0]||""),[u,d]=(0,_t.useState)(t?.cron_expression||"0 * * * *"),[p,m]=(0,_t.useState)(t?.timezone||"UTC"),[g,_]=(0,_t.useState)(t?.trigger_event||""),[y,v]=(0,_t.useState)(t?.trigger_conditions?typeof t.trigger_conditions=="string"?t.trigger_conditions:JSON.stringify(t.trigger_conditions,null,2):"{}"),[S,b]=(0,_t.useState)(t?.task_description||""),[w,C]=(0,_t.useState)(t?.model||"sonnet"),[M,L]=(0,_t.useState)(t?.max_runtime_seconds||3600),[P,T]=(0,_t.useState)(t?.working_directory||"");return _t.default.createElement("form",{onSubmit:I=>{I.preventDefault();let F;if(o==="trigger"&&y)try{F=JSON.parse(y)}catch{F=y}e({name:r,type:o,project:l,cron_expression:o==="cron"?u:void 0,timezone:o==="cron"?p:void 0,trigger_event:o==="trigger"?g:void 0,trigger_conditions:o==="trigger"?F:void 0,task_description:S,model:w,max_runtime_seconds:M,working_directory:P||void 0})},style:{padding:"20px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",background:"var(--card-bg, #16162a)"}},_t.default.createElement("h3",{style:{margin:"0 0 16px",fontSize:"1.1rem",fontWeight:600}},t?"Edit Job":"Create Automation Job"),_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Job Name"),_t.default.createElement("input",{type:"text",value:r,onChange:I=>s(I.target.value),placeholder:"e.g., Nightly test suite",required:!0,style:fa})),_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Type"),_t.default.createElement("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"}},tne.map(I=>_t.default.createElement("button",{key:I.value,type:"button",onClick:()=>a(I.value),style:{padding:"6px 14px",borderRadius:"6px",border:o===I.value?"1px solid var(--accent-color, #6366f1)":"1px solid var(--border-color, #333)",background:o===I.value?"var(--accent-color, #6366f1)":"transparent",color:o===I.value?"#fff":"var(--text-color, #e0e0e0)",cursor:"pointer",fontSize:"0.8rem"}},I.label)))),o==="cron"&&_t.default.createElement(_t.default.Fragment,null,_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Cron Expression"),_t.default.createElement(Y6,{value:u,onChange:d})),_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Timezone"),_t.default.createElement("select",{value:p,onChange:I=>m(I.target.value),style:fa},ine.map(I=>_t.default.createElement("option",{key:I,value:I},I))))),o==="webhook"&&t?.webhook_path&&_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Webhook URL"),_t.default.createElement("div",{style:{...fa,fontFamily:"monospace",fontSize:"0.8rem",wordBreak:"break-all",background:"var(--code-bg, #0d0d1a)"}},`${window.location.origin}/api/webhooks/${t.webhook_path}`),t.webhook_secret&&_t.default.createElement(_t.default.Fragment,null,_t.default.createElement("label",{style:{...Do,marginTop:"8px"}},"Webhook Secret"),_t.default.createElement("div",{style:{...fa,fontFamily:"monospace",fontSize:"0.75rem",wordBreak:"break-all",background:"var(--code-bg, #0d0d1a)"}},t.webhook_secret))),o==="webhook"&&!t&&_t.default.createElement("div",{style:{...Io,padding:"12px",background:"var(--info-bg, #1a1a3e)",borderRadius:"6px",fontSize:"0.8rem",color:"var(--text-secondary, #888)"}},"Webhook URL and secret will be auto-generated after creation."),o==="trigger"&&_t.default.createElement(_t.default.Fragment,null,_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Event Type"),_t.default.createElement("select",{value:g,onChange:I=>_(I.target.value),style:fa},_t.default.createElement("option",{value:""},"Select event type..."),_t.default.createElement("option",{value:"observation_created"},"Observation Created"),_t.default.createElement("option",{value:"session_completed"},"Session Completed"),_t.default.createElement("option",{value:"tag_added"},"Tag Added"),_t.default.createElement("option",{value:"bug_detected"},"Bug Detected"))),_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Conditions (JSON)"),_t.default.createElement("textarea",{value:y,onChange:I=>v(I.target.value),rows:4,placeholder:'{"event_type": "observation_created", "has_tag": "bug"}',style:{...fa,fontFamily:"monospace",resize:"vertical"}}))),_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Task Description (Claude Prompt)"),_t.default.createElement("textarea",{value:S,onChange:I=>b(I.target.value),rows:5,required:!0,placeholder:"Describe what Claude should do when this automation runs...",style:{...fa,resize:"vertical"}})),_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Project"),i.length>0?_t.default.createElement("select",{value:l,onChange:I=>c(I.target.value),style:fa},i.map(I=>_t.default.createElement("option",{key:I,value:I},I))):_t.default.createElement("input",{type:"text",value:l,onChange:I=>c(I.target.value),placeholder:"Project name",required:!0,style:fa})),_t.default.createElement("div",{style:{display:"flex",gap:"16px"}},_t.default.createElement("div",{style:{...Io,flex:1}},_t.default.createElement("label",{style:Do},"Model"),_t.default.createElement("select",{value:w,onChange:I=>C(I.target.value),style:fa},nne.map(I=>_t.default.createElement("option",{key:I.value,value:I.value},I.label)))),_t.default.createElement("div",{style:{...Io,flex:1}},_t.default.createElement("label",{style:Do},"Max Runtime (seconds)"),_t.default.createElement("input",{type:"number",value:M,onChange:I=>L(parseInt(I.target.value,10)||3600),min:60,max:86400,style:fa}))),_t.default.createElement("div",{style:Io},_t.default.createElement("label",{style:Do},"Working Directory (optional)"),_t.default.createElement("input",{type:"text",value:P,onChange:I=>T(I.target.value),placeholder:"Auto-detected from project if empty",style:fa})),_t.default.createElement("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px"}},_t.default.createElement("button",{type:"button",onClick:n,style:{padding:"8px 16px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"transparent",color:"var(--text-color, #e0e0e0)",cursor:"pointer",fontSize:"0.85rem"}},"Cancel"),_t.default.createElement("button",{type:"submit",style:{padding:"8px 16px",borderRadius:"6px",border:"none",background:"var(--accent-color, #6366f1)",color:"#fff",cursor:"pointer",fontSize:"0.85rem",fontWeight:600}},t?"Update Job":"Create Job")))}var Pn=mt(Ct(),1),$6={pending:{bg:"#fbbf2433",text:"#fbbf24"},running:{bg:"#3b82f633",text:"#3b82f6"},completed:{bg:"#10b98133",text:"#10b981"},failed:{bg:"#ef444433",text:"#ef4444"}};function rne(t){if(t===null)return"-";if(t<1e3)return`${t}ms`;let e=Math.floor(t/1e3);if(e<60)return`${e}s`;let n=Math.floor(e/60),i=e%60;return n<60?`${n}m ${i}s`:`${Math.floor(n/60)}h ${n%60}m`}function sne(t){return new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function J6({runs:t,jobNames:e,statusFilter:n,onStatusFilterChange:i}){let[r,s]=(0,Pn.useState)(null),o=n?t.filter(a=>a.status===n):t;return Pn.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}},Pn.default.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center"}},Pn.default.createElement("span",{style:{fontSize:"0.8rem",color:"var(--text-secondary, #888)"}},"Filter:"),["","pending","running","completed","failed"].map(a=>Pn.default.createElement("button",{key:a,type:"button",onClick:()=>i(a),style:{padding:"3px 10px",fontSize:"0.75rem",borderRadius:"4px",border:n===a?"1px solid var(--accent-color, #6366f1)":"1px solid var(--border-color, #333)",background:n===a?"var(--accent-color, #6366f1)":"transparent",color:n===a?"#fff":"var(--text-color, #e0e0e0)",cursor:"pointer"}},a||"All"))),o.length===0?Pn.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.9rem"}},"No runs found."):Pn.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"4px"}},Pn.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 0.7fr 0.8fr 1fr 0.8fr 0.6fr",gap:"8px",padding:"8px 12px",fontSize:"0.7rem",fontWeight:600,color:"var(--text-secondary, #888)",textTransform:"uppercase",letterSpacing:"0.05em"}},Pn.default.createElement("span",null,"Job"),Pn.default.createElement("span",null,"Status"),Pn.default.createElement("span",null,"Trigger"),Pn.default.createElement("span",null,"Started"),Pn.default.createElement("span",null,"Duration"),Pn.default.createElement("span",null,"Obs.")),o.map(a=>{let l=$6[a.status]||$6.pending,c=r===a.id;return Pn.default.createElement("div",{key:a.id},Pn.default.createElement("div",{onClick:()=>s(c?null:a.id),style:{display:"grid",gridTemplateColumns:"1.5fr 0.7fr 0.8fr 1fr 0.8fr 0.6fr",gap:"8px",padding:"10px 12px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",cursor:"pointer",fontSize:"0.8rem",alignItems:"center"}},Pn.default.createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e[a.job_id]||`Job #${a.job_id}`),Pn.default.createElement("span",{style:{display:"inline-block",padding:"2px 8px",borderRadius:"4px",background:l.bg,color:l.text,fontSize:"0.7rem",fontWeight:600,textAlign:"center"}},a.status),Pn.default.createElement("span",{style:{color:"var(--text-secondary, #888)"}},a.triggered_by),Pn.default.createElement("span",{style:{color:"var(--text-secondary, #888)"}},sne(a.started_at_epoch)),Pn.default.createElement("span",null,rne(a.duration_ms)),Pn.default.createElement("span",null,a.observations_created)),c&&Pn.default.createElement("div",{style:{padding:"12px 16px",margin:"4px 0 8px",borderRadius:"6px",border:"1px solid var(--border-color, #333)",background:"var(--card-bg, #16162a)",fontSize:"0.8rem"}},a.error_message&&Pn.default.createElement("div",{style:{marginBottom:"8px"}},Pn.default.createElement("div",{style:{fontWeight:600,color:"#ef4444",marginBottom:"4px"}},"Error"),Pn.default.createElement("div",{style:{padding:"8px",borderRadius:"4px",background:"#ef444411",fontFamily:"monospace",fontSize:"0.75rem",whiteSpace:"pre-wrap"}},a.error_message)),a.output_log&&Pn.default.createElement("div",null,Pn.default.createElement("div",{style:{fontWeight:600,marginBottom:"4px",color:"var(--text-secondary, #888)"}},"Output Log"),Pn.default.createElement("div",{style:{padding:"8px",borderRadius:"4px",background:"var(--code-bg, #0d0d1a)",fontFamily:"monospace",fontSize:"0.7rem",whiteSpace:"pre-wrap",maxHeight:"200px",overflow:"auto"}},a.output_log)),!a.error_message&&!a.output_log&&Pn.default.createElement("div",{style:{color:"var(--text-secondary, #888)",fontStyle:"italic"}},"No output recorded.")))})))}var Z6={cron:{bg:"#3b82f633",text:"#3b82f6"},webhook:{bg:"#10b98133",text:"#10b981"},trigger:{bg:"#f59e0b33",text:"#f59e0b"},"one-time":{bg:"#8b5cf633",text:"#8b5cf6"}};function one(t){return t?new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function Q6({currentProject:t}){let[e,n]=(0,Yt.useState)("jobs"),[i,r]=(0,Yt.useState)([]),[s,o]=(0,Yt.useState)([]),[a,l]=(0,Yt.useState)(!0),[c,u]=(0,Yt.useState)(!1),[d,p]=(0,Yt.useState)(null),[m,g]=(0,Yt.useState)([]),[_,y]=(0,Yt.useState)(""),v=(0,Yt.useCallback)(()=>{let T=t?`?project=${encodeURIComponent(t)}`:"";fetch(`/api/automation/jobs${T}`).then(A=>A.json()).then(A=>r(A.jobs||[])).catch(()=>{})},[t]),S=(0,Yt.useCallback)(()=>{let T=new URLSearchParams;_&&T.set("status",_);let A=T.toString()?`?${T.toString()}`:"";fetch(`/api/automation/runs${A}`).then(I=>I.json()).then(I=>o(I.runs||[])).catch(()=>{})},[_]),b=(0,Yt.useCallback)(()=>{fetch("/api/data/projects").then(T=>T.json()).then(T=>g(T.projects?.map(A=>A.project||A)||[])).catch(()=>{})},[]);(0,Yt.useEffect)(()=>{l(!0),Promise.all([v(),S(),b()]).finally(()=>l(!1))},[v,S,b]),(0,Yt.useEffect)(()=>{S()},[_,S]);let w=async T=>{let A=d?`/api/automation/jobs/${d.id}`:"/api/automation/jobs",I=d?"PUT":"POST";try{(await fetch(A,{method:I,headers:{"Content-Type":"application/json"},body:JSON.stringify(T)})).ok&&(u(!1),p(null),v())}catch{}},C=async T=>{try{await fetch(`/api/automation/jobs/${T}`,{method:"DELETE"}),v()}catch{}},M=async(T,A)=>{let I=A?"disable":"enable";try{await fetch(`/api/automation/jobs/${T}/${I}`,{method:"POST"}),v()}catch{}},L=async T=>{try{await fetch(`/api/automation/jobs/${T}/run`,{method:"POST"}),S()}catch{}},P=i.reduce((T,A)=>(T[A.id]=A.name,T),{});return a?Yt.default.createElement("div",{style:{padding:"2rem",opacity:.5}},"Loading automation..."):Yt.default.createElement("div",{style:{padding:"1.5rem",maxWidth:"1000px"}},Yt.default.createElement("h2",{style:{margin:"0 0 1rem",fontSize:"1.2rem",fontWeight:600}},"Automation"),Yt.default.createElement("div",{style:{display:"flex",gap:"0",marginBottom:"16px",borderBottom:"1px solid var(--border-color, #333)"}},["jobs","history"].map(T=>Yt.default.createElement("button",{key:T,type:"button",onClick:()=>n(T),style:{padding:"8px 20px",fontSize:"0.85rem",fontWeight:e===T?600:400,border:"none",borderBottom:e===T?"2px solid var(--accent-color, #6366f1)":"2px solid transparent",background:"transparent",color:e===T?"var(--text-color, #e0e0e0)":"var(--text-secondary, #888)",cursor:"pointer"}},T==="jobs"?"Jobs":"Run History"))),e==="jobs"&&Yt.default.createElement("div",null,c||d?Yt.default.createElement(K6,{job:d,onSave:w,onCancel:()=>{u(!1),p(null)},projects:m}):Yt.default.createElement(Yt.default.Fragment,null,Yt.default.createElement("button",{type:"button",onClick:()=>u(!0),style:{padding:"8px 16px",borderRadius:"6px",border:"none",background:"var(--accent-color, #6366f1)",color:"#fff",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,marginBottom:"16px"}},"+ Create New Job"),i.length===0?Yt.default.createElement("div",{style:{padding:"2rem",textAlign:"center",opacity:.5,fontSize:"0.9rem"}},"No automation jobs configured yet."):Yt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},i.map(T=>{let A=Z6[T.type]||Z6["one-time"];return Yt.default.createElement("div",{key:T.id,style:{padding:"14px 16px",borderRadius:"8px",border:"1px solid var(--border-color, #333)",display:"flex",alignItems:"center",gap:"12px"}},Yt.default.createElement("div",{onClick:()=>M(T.id,!!T.enabled),style:{width:"36px",height:"20px",borderRadius:"10px",background:T.enabled?"#10b981":"var(--border-color, #444)",cursor:"pointer",position:"relative",flexShrink:0,transition:"background 0.2s"}},Yt.default.createElement("div",{style:{width:"16px",height:"16px",borderRadius:"50%",background:"#fff",position:"absolute",top:"2px",left:T.enabled?"18px":"2px",transition:"left 0.2s"}})),Yt.default.createElement("div",{style:{flex:1,minWidth:0}},Yt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"}},Yt.default.createElement("span",{style:{fontWeight:600,fontSize:"0.9rem"}},T.name),Yt.default.createElement("span",{style:{padding:"2px 8px",borderRadius:"4px",background:A.bg,color:A.text,fontSize:"0.7rem",fontWeight:600}},T.type)),Yt.default.createElement("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary, #888)",display:"flex",gap:"16px"}},Yt.default.createElement("span",null,"Runs: ",T.total_runs," (",T.successful_runs," ok / ",T.failed_runs," fail)"),Yt.default.createElement("span",null,"Last: ",one(T.last_run_at_epoch)),T.cron_expression&&Yt.default.createElement("span",null,"Cron: ",T.cron_expression))),Yt.default.createElement("div",{style:{display:"flex",gap:"6px",flexShrink:0}},Yt.default.createElement("button",{type:"button",onClick:()=>L(T.id),title:"Run Now",style:{padding:"4px 10px",borderRadius:"4px",border:"1px solid var(--border-color, #333)",background:"transparent",color:"#10b981",cursor:"pointer",fontSize:"0.75rem"}},"Run"),Yt.default.createElement("button",{type:"button",onClick:()=>p(T),title:"Edit",style:{padding:"4px 10px",borderRadius:"4px",border:"1px solid var(--border-color, #333)",background:"transparent",color:"var(--text-color, #e0e0e0)",cursor:"pointer",fontSize:"0.75rem"}},"Edit"),Yt.default.createElement("button",{type:"button",onClick:()=>C(T.id),title:"Delete",style:{padding:"4px 10px",borderRadius:"4px",border:"1px solid var(--border-color, #333)",background:"transparent",color:"#ef4444",cursor:"pointer",fontSize:"0.75rem"}},"Delete")))})))),e==="history"&&Yt.default.createElement(J6,{runs:s,jobNames:P,statusFilter:_,onStatusFilterChange:y}))}var ft=mt(Ct(),1);u_();function am(){return am=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},am.apply(null,arguments)}var ane=Object.defineProperty,lne=(t,e,n)=>e in t?ane(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cne=(t,e,n)=>(lne(t,typeof e!="symbol"?e+"":e,n),n),Kw=class{constructor(){cne(this,"_listeners")}addEventListener(e,n){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let i=this._listeners[e.type];if(i!==void 0){e.target=this;let r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};Ou();var une=Object.defineProperty,hne=(t,e,n)=>e in t?une(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ut=(t,e,n)=>(hne(t,typeof e!="symbol"?e+"":e,n),n),$w=new Pa,e8=new _o,dne=Math.cos(70*(Math.PI/180)),t8=(t,e)=>(t%e+e)%e,q_=class extends Kw{constructor(e,n){super(),Ut(this,"object"),Ut(this,"domElement"),Ut(this,"enabled",!0),Ut(this,"target",new Y),Ut(this,"minDistance",0),Ut(this,"maxDistance",1/0),Ut(this,"minZoom",0),Ut(this,"maxZoom",1/0),Ut(this,"minPolarAngle",0),Ut(this,"maxPolarAngle",Math.PI),Ut(this,"minAzimuthAngle",-1/0),Ut(this,"maxAzimuthAngle",1/0),Ut(this,"enableDamping",!1),Ut(this,"dampingFactor",.05),Ut(this,"enableZoom",!0),Ut(this,"zoomSpeed",1),Ut(this,"enableRotate",!0),Ut(this,"rotateSpeed",1),Ut(this,"enablePan",!0),Ut(this,"panSpeed",1),Ut(this,"screenSpacePanning",!0),Ut(this,"keyPanSpeed",7),Ut(this,"zoomToCursor",!1),Ut(this,"autoRotate",!1),Ut(this,"autoRotateSpeed",2),Ut(this,"reverseOrbit",!1),Ut(this,"reverseHorizontalOrbit",!1),Ut(this,"reverseVerticalOrbit",!1),Ut(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ut(this,"mouseButtons",{LEFT:dc.ROTATE,MIDDLE:dc.DOLLY,RIGHT:dc.PAN}),Ut(this,"touches",{ONE:fc.ROTATE,TWO:fc.DOLLY_PAN}),Ut(this,"target0"),Ut(this,"position0"),Ut(this,"zoom0"),Ut(this,"_domElementKeyEvents",null),Ut(this,"getPolarAngle"),Ut(this,"getAzimuthalAngle"),Ut(this,"setPolarAngle"),Ut(this,"setAzimuthalAngle"),Ut(this,"getDistance"),Ut(this,"getZoomScale"),Ut(this,"listenToKeyEvents"),Ut(this,"stopListenToKeyEvents"),Ut(this,"saveState"),Ut(this,"reset"),Ut(this,"update"),Ut(this,"connect"),Ut(this,"dispose"),Ut(this,"dollyIn"),Ut(this,"dollyOut"),Ut(this,"getScale"),Ut(this,"setScale"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=Q=>{let ce=t8(Q,2*Math.PI),Ye=u.phi;Ye<0&&(Ye+=2*Math.PI),ce<0&&(ce+=2*Math.PI);let te=Math.abs(ce-Ye);2*Math.PI-te<te&&(ce<Ye?ce+=2*Math.PI:Ye+=2*Math.PI),d.phi=ce-Ye,i.update()},this.setAzimuthalAngle=Q=>{let ce=t8(Q,2*Math.PI),Ye=u.theta;Ye<0&&(Ye+=2*Math.PI),ce<0&&(ce+=2*Math.PI);let te=Math.abs(ce-Ye);2*Math.PI-te<te&&(ce<Ye?ce+=2*Math.PI:Ye+=2*Math.PI),d.theta=ce-Ye,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=Q=>{Q.addEventListener("keydown",ae),this._domElementKeyEvents=Q},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ae),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{let Q=new Y,ce=new Y(0,1,0),Ye=new Yi().setFromUnitVectors(e.up,ce),te=Ye.clone().invert(),we=new Y,Be=new Yi,it=2*Math.PI;return function(){let Se=i.object.position;Ye.setFromUnitVectors(e.up,ce),te.copy(Ye).invert(),Q.copy(Se).sub(i.target),Q.applyQuaternion(Ye),u.setFromVector3(Q),i.autoRotate&&l===a.NONE&&O(F()),i.enableDamping?(u.theta+=d.theta*i.dampingFactor,u.phi+=d.phi*i.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let Xe=i.minAzimuthAngle,Je=i.maxAzimuthAngle;isFinite(Xe)&&isFinite(Je)&&(Xe<-Math.PI?Xe+=it:Xe>Math.PI&&(Xe-=it),Je<-Math.PI?Je+=it:Je>Math.PI&&(Je-=it),Xe<=Je?u.theta=Math.max(Xe,Math.min(Je,u.theta)):u.theta=u.theta>(Xe+Je)/2?Math.max(Xe,u.theta):Math.min(Je,u.theta)),u.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,u.phi)),u.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(m,i.dampingFactor):i.target.add(m),i.zoomToCursor&&T||i.object.isOrthographicCamera?u.radius=q(u.radius):u.radius=q(u.radius*p),Q.setFromSpherical(u),Q.applyQuaternion(te),Se.copy(i.target).add(Q),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,m.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),m.set(0,0,0));let ot=!1;if(i.zoomToCursor&&T){let kt=null;if(i.object instanceof Zn&&i.object.isPerspectiveCamera){let un=Q.length();kt=q(un*p);let mn=un-kt;i.object.position.addScaledVector(L,mn),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){let un=new Y(P.x,P.y,0);un.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/p)),i.object.updateProjectionMatrix(),ot=!0;let mn=new Y(P.x,P.y,0);mn.unproject(i.object),i.object.position.sub(mn).add(un),i.object.updateMatrixWorld(),kt=Q.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;kt!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(kt).add(i.object.position):($w.origin.copy(i.object.position),$w.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot($w.direction))<dne?e.lookAt(i.target):(e8.setFromNormalAndCoplanarPoint(i.object.up,i.target),$w.intersectPlane(e8,i.target))))}else i.object instanceof js&&i.object.isOrthographicCamera&&(ot=p!==1,ot&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/p)),i.object.updateProjectionMatrix()));return p=1,T=!1,ot||we.distanceToSquared(i.object.position)>c||8*(1-Be.dot(i.object.quaternion))>c?(i.dispatchEvent(r),we.copy(i.object.position),Be.copy(i.object.quaternion),ot=!1,!0):!1}})(),this.connect=Q=>{i.domElement=Q,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Qe),i.domElement.addEventListener("pointerdown",Ne),i.domElement.addEventListener("pointercancel",R),i.domElement.addEventListener("wheel",he)},this.dispose=()=>{var Q,ce,Ye,te,we,Be;i.domElement&&(i.domElement.style.touchAction="auto"),(Q=i.domElement)==null||Q.removeEventListener("contextmenu",Qe),(ce=i.domElement)==null||ce.removeEventListener("pointerdown",Ne),(Ye=i.domElement)==null||Ye.removeEventListener("pointercancel",R),(te=i.domElement)==null||te.removeEventListener("wheel",he),(we=i.domElement)==null||we.ownerDocument.removeEventListener("pointermove",W),(Be=i.domElement)==null||Be.ownerDocument.removeEventListener("pointerup",R),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",ae)};let i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},l=a.NONE,c=1e-6,u=new rd,d=new rd,p=1,m=new Y,g=new We,_=new We,y=new We,v=new We,S=new We,b=new We,w=new We,C=new We,M=new We,L=new Y,P=new We,T=!1,A=[],I={};function F(){return 2*Math.PI/60/60*i.autoRotateSpeed}function B(){return Math.pow(.95,i.zoomSpeed)}function O(Q){i.reverseOrbit||i.reverseHorizontalOrbit?d.theta+=Q:d.theta-=Q}function z(Q){i.reverseOrbit||i.reverseVerticalOrbit?d.phi+=Q:d.phi-=Q}let U=(()=>{let Q=new Y;return function(Ye,te){Q.setFromMatrixColumn(te,0),Q.multiplyScalar(-Ye),m.add(Q)}})(),G=(()=>{let Q=new Y;return function(Ye,te){i.screenSpacePanning===!0?Q.setFromMatrixColumn(te,1):(Q.setFromMatrixColumn(te,0),Q.crossVectors(i.object.up,Q)),Q.multiplyScalar(Ye),m.add(Q)}})(),j=(()=>{let Q=new Y;return function(Ye,te){let we=i.domElement;if(we&&i.object instanceof Zn&&i.object.isPerspectiveCamera){let Be=i.object.position;Q.copy(Be).sub(i.target);let it=Q.length();it*=Math.tan(i.object.fov/2*Math.PI/180),U(2*Ye*it/we.clientHeight,i.object.matrix),G(2*te*it/we.clientHeight,i.object.matrix)}else we&&i.object instanceof js&&i.object.isOrthographicCamera?(U(Ye*(i.object.right-i.object.left)/i.object.zoom/we.clientWidth,i.object.matrix),G(te*(i.object.top-i.object.bottom)/i.object.zoom/we.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function J(Q){i.object instanceof Zn&&i.object.isPerspectiveCamera||i.object instanceof js&&i.object.isOrthographicCamera?p=Q:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function K(Q){J(p/Q)}function D(Q){J(p*Q)}function X(Q){if(!i.zoomToCursor||!i.domElement)return;T=!0;let ce=i.domElement.getBoundingClientRect(),Ye=Q.clientX-ce.left,te=Q.clientY-ce.top,we=ce.width,Be=ce.height;P.x=Ye/we*2-1,P.y=-(te/Be)*2+1,L.set(P.x,P.y,1).unproject(i.object).sub(i.object.position).normalize()}function q(Q){return Math.max(i.minDistance,Math.min(i.maxDistance,Q))}function ne(Q){g.set(Q.clientX,Q.clientY)}function re(Q){X(Q),w.set(Q.clientX,Q.clientY)}function $(Q){v.set(Q.clientX,Q.clientY)}function ie(Q){_.set(Q.clientX,Q.clientY),y.subVectors(_,g).multiplyScalar(i.rotateSpeed);let ce=i.domElement;ce&&(O(2*Math.PI*y.x/ce.clientHeight),z(2*Math.PI*y.y/ce.clientHeight)),g.copy(_),i.update()}function le(Q){C.set(Q.clientX,Q.clientY),M.subVectors(C,w),M.y>0?K(B()):M.y<0&&D(B()),w.copy(C),i.update()}function Ee(Q){S.set(Q.clientX,Q.clientY),b.subVectors(S,v).multiplyScalar(i.panSpeed),j(b.x,b.y),v.copy(S),i.update()}function ke(Q){X(Q),Q.deltaY<0?D(B()):Q.deltaY>0&&K(B()),i.update()}function Pe(Q){let ce=!1;switch(Q.code){case i.keys.UP:j(0,i.keyPanSpeed),ce=!0;break;case i.keys.BOTTOM:j(0,-i.keyPanSpeed),ce=!0;break;case i.keys.LEFT:j(i.keyPanSpeed,0),ce=!0;break;case i.keys.RIGHT:j(-i.keyPanSpeed,0),ce=!0;break}ce&&(Q.preventDefault(),i.update())}function Te(){if(A.length==1)g.set(A[0].pageX,A[0].pageY);else{let Q=.5*(A[0].pageX+A[1].pageX),ce=.5*(A[0].pageY+A[1].pageY);g.set(Q,ce)}}function De(){if(A.length==1)v.set(A[0].pageX,A[0].pageY);else{let Q=.5*(A[0].pageX+A[1].pageX),ce=.5*(A[0].pageY+A[1].pageY);v.set(Q,ce)}}function me(){let Q=A[0].pageX-A[1].pageX,ce=A[0].pageY-A[1].pageY,Ye=Math.sqrt(Q*Q+ce*ce);w.set(0,Ye)}function ve(){i.enableZoom&&me(),i.enablePan&&De()}function ge(){i.enableZoom&&me(),i.enableRotate&&Te()}function Ie(Q){if(A.length==1)_.set(Q.pageX,Q.pageY);else{let Ye=Ue(Q),te=.5*(Q.pageX+Ye.x),we=.5*(Q.pageY+Ye.y);_.set(te,we)}y.subVectors(_,g).multiplyScalar(i.rotateSpeed);let ce=i.domElement;ce&&(O(2*Math.PI*y.x/ce.clientHeight),z(2*Math.PI*y.y/ce.clientHeight)),g.copy(_)}function V(Q){if(A.length==1)S.set(Q.pageX,Q.pageY);else{let ce=Ue(Q),Ye=.5*(Q.pageX+ce.x),te=.5*(Q.pageY+ce.y);S.set(Ye,te)}b.subVectors(S,v).multiplyScalar(i.panSpeed),j(b.x,b.y),v.copy(S)}function Ge(Q){let ce=Ue(Q),Ye=Q.pageX-ce.x,te=Q.pageY-ce.y,we=Math.sqrt(Ye*Ye+te*te);C.set(0,we),M.set(0,Math.pow(C.y/w.y,i.zoomSpeed)),K(M.y),w.copy(C)}function Me(Q){i.enableZoom&&Ge(Q),i.enablePan&&V(Q)}function _e(Q){i.enableZoom&&Ge(Q),i.enableRotate&&Ie(Q)}function Ne(Q){var ce,Ye;i.enabled!==!1&&(A.length===0&&((ce=i.domElement)==null||ce.ownerDocument.addEventListener("pointermove",W),(Ye=i.domElement)==null||Ye.ownerDocument.addEventListener("pointerup",R)),ct(Q),Q.pointerType==="touch"?je(Q):Z(Q))}function W(Q){i.enabled!==!1&&(Q.pointerType==="touch"?ze(Q):fe(Q))}function R(Q){var ce,Ye,te;Ae(Q),A.length===0&&((ce=i.domElement)==null||ce.releasePointerCapture(Q.pointerId),(Ye=i.domElement)==null||Ye.ownerDocument.removeEventListener("pointermove",W),(te=i.domElement)==null||te.ownerDocument.removeEventListener("pointerup",R)),i.dispatchEvent(o),l=a.NONE}function Z(Q){let ce;switch(Q.button){case 0:ce=i.mouseButtons.LEFT;break;case 1:ce=i.mouseButtons.MIDDLE;break;case 2:ce=i.mouseButtons.RIGHT;break;default:ce=-1}switch(ce){case dc.DOLLY:if(i.enableZoom===!1)return;re(Q),l=a.DOLLY;break;case dc.ROTATE:if(Q.ctrlKey||Q.metaKey||Q.shiftKey){if(i.enablePan===!1)return;$(Q),l=a.PAN}else{if(i.enableRotate===!1)return;ne(Q),l=a.ROTATE}break;case dc.PAN:if(Q.ctrlKey||Q.metaKey||Q.shiftKey){if(i.enableRotate===!1)return;ne(Q),l=a.ROTATE}else{if(i.enablePan===!1)return;$(Q),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function fe(Q){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;ie(Q);break;case a.DOLLY:if(i.enableZoom===!1)return;le(Q);break;case a.PAN:if(i.enablePan===!1)return;Ee(Q);break}}function he(Q){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(Q.preventDefault(),i.dispatchEvent(s),ke(Q),i.dispatchEvent(o))}function ae(Q){i.enabled===!1||i.enablePan===!1||Pe(Q)}function je(Q){switch(Ve(Q),A.length){case 1:switch(i.touches.ONE){case fc.ROTATE:if(i.enableRotate===!1)return;Te(),l=a.TOUCH_ROTATE;break;case fc.PAN:if(i.enablePan===!1)return;De(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case fc.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;ve(),l=a.TOUCH_DOLLY_PAN;break;case fc.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ge(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function ze(Q){switch(Ve(Q),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;Ie(Q),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;V(Q),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Me(Q),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;_e(Q),i.update();break;default:l=a.NONE}}function Qe(Q){i.enabled!==!1&&Q.preventDefault()}function ct(Q){A.push(Q)}function Ae(Q){delete I[Q.pointerId];for(let ce=0;ce<A.length;ce++)if(A[ce].pointerId==Q.pointerId){A.splice(ce,1);return}}function Ve(Q){let ce=I[Q.pointerId];ce===void 0&&(ce=new We,I[Q.pointerId]=ce),ce.set(Q.pageX,Q.pageY)}function Ue(Q){let ce=Q.pointerId===A[0].pointerId?A[1]:A[0];return I[ce.pointerId]}this.dollyIn=(Q=B())=>{D(Q),i.update()},this.dollyOut=(Q=B())=>{K(Q),i.update()},this.getScale=()=>p,this.setScale=Q=>{J(Q),i.update()},this.getZoomScale=()=>B(),n!==void 0&&this.connect(n),this.update()}};var Zs=mt(Ct());Ou();function fne(){var t=Object.create(null);function e(r,s){var o=r.id,a=r.name,l=r.dependencies;l===void 0&&(l=[]);var c=r.init;c===void 0&&(c=function(){});var u=r.getTransferables;if(u===void 0&&(u=null),!t[o])try{l=l.map(function(p){return p&&p.isWorkerModule&&(e(p,function(m){if(m instanceof Error)throw m}),p=t[p.id].value),p}),c=i("<"+a+">.init",c),u&&(u=i("<"+a+">.getTransferables",u));var d=null;typeof c=="function"?d=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),t[o]={id:o,value:d,getTransferables:u},s(d)}catch(p){p&&p.noLog||console.error(p),s(p)}}function n(r,s){var o,a=r.id,l=r.args;(!t[a]||typeof t[a].value!="function")&&s(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var c=(o=t[a]).value.apply(o,l);c&&typeof c.then=="function"?c.then(u,function(d){return s(d instanceof Error?d:new Error(""+d))}):u(c)}catch(d){s(d)}function u(d){try{var p=t[a].getTransferables&&t[a].getTransferables(d);(!p||!Array.isArray(p)||!p.length)&&(p=void 0),s(d,p)}catch(m){console.error(m),s(m)}}}function i(r,s){var o=void 0;self.troikaDefine=function(l){return o=l};var a=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(l){console.error(l)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(r){var s=r.data,o=s.messageId,a=s.action,l=s.data;try{a==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof c=="function"}})}),a==="callModule"&&n(l,function(c,u){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:c},u||void 0)})}catch(c){postMessage({messageId:o,success:!1,error:c.stack})}})}function pne(t){var e=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,n);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var n=t.dependencies,i=t.init;n=Array.isArray(n)?n.map(function(s){return s&&(s=s.onMainThread||s,s._getInitResult&&(s=s._getInitResult())),s}):[];var r=Promise.all(n).then(function(s){return i.apply(null,s)});return e._getInitResult=function(){return r},r},e}var i8=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(n){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+n.message+"]")}return i8=function(){return t},t},mne=0,gne=0,aL=!1,Y_=Object.create(null),K_=Object.create(null),lL=Object.create(null);function Ld(t){if((!t||typeof t.init!="function")&&!aL)throw new Error("requires `options.init` function");var e=t.dependencies,n=t.init,i=t.getTransferables,r=t.workerId,s=pne(t);r==null&&(r="#default");var o="workerModule"+ ++mne,a=t.name||o,l=null;e=e&&e.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(aL=!0,u=Ld({workerId:r,name:"<"+a+"> function dependency: "+u.name,init:`function(){return (
`+Jw(u)+`
)}`}),aL=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function c(){for(var u=[],d=arguments.length;d--;)u[d]=arguments[d];if(!i8())return s.apply(void 0,u);if(!l){l=n8(r,"registerModule",c.workerModuleData);var p=function(){l=null,K_[r].delete(p)};(K_[r]||(K_[r]=new Set)).add(p)}return l.then(function(m){var g=m.isCallable;if(g)return n8(r,"callModule",{id:o,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return c.workerModuleData={isWorkerModule:!0,id:o,name:a,dependencies:e,init:Jw(n),getTransferables:i&&Jw(i)},c.onMainThread=s,c}function r8(t){K_[t]&&K_[t].forEach(function(e){e()}),Y_[t]&&(Y_[t].terminate(),delete Y_[t])}function Jw(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function vne(t){var e=Y_[t];if(!e){var n=Jw(fne);e=Y_[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+n+")()"],{type:"application/javascript"}))),e.onmessage=function(i){var r=i.data,s=r.messageId,o=lL[s];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete lL[s],o(r)}}return e}function n8(t,e,n){return new Promise(function(i,r){var s=++gne;lL[s]=function(o){o.success?i(o.result):r(new Error("Error in worker "+e+" call: "+o.error))},vne(t).postMessage({messageId:s,action:e,data:n})})}function cL(){var t=(function(e){function n(J,K,D,X,q,ne,re,$){var ie=1-re;$.x=ie*ie*J+2*ie*re*D+re*re*q,$.y=ie*ie*K+2*ie*re*X+re*re*ne}function i(J,K,D,X,q,ne,re,$,ie,le){var Ee=1-ie;le.x=Ee*Ee*Ee*J+3*Ee*Ee*ie*D+3*Ee*ie*ie*q+ie*ie*ie*re,le.y=Ee*Ee*Ee*K+3*Ee*Ee*ie*X+3*Ee*ie*ie*ne+ie*ie*ie*$}function r(J,K){for(var D=/([MLQCZ])([^MLQCZ]*)/g,X,q,ne,re,$;X=D.exec(J);){var ie=X[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(le){return parseFloat(le)});switch(X[1]){case"M":re=q=ie[0],$=ne=ie[1];break;case"L":(ie[0]!==re||ie[1]!==$)&&K("L",re,$,re=ie[0],$=ie[1]);break;case"Q":{K("Q",re,$,re=ie[2],$=ie[3],ie[0],ie[1]);break}case"C":{K("C",re,$,re=ie[4],$=ie[5],ie[0],ie[1],ie[2],ie[3]);break}case"Z":(re!==q||$!==ne)&&K("L",re,$,q,ne);break}}}function s(J,K,D){D===void 0&&(D=16);var X={x:0,y:0};r(J,function(q,ne,re,$,ie,le,Ee,ke,Pe){switch(q){case"L":K(ne,re,$,ie);break;case"Q":{for(var Te=ne,De=re,me=1;me<D;me++)n(ne,re,le,Ee,$,ie,me/(D-1),X),K(Te,De,X.x,X.y),Te=X.x,De=X.y;break}case"C":{for(var ve=ne,ge=re,Ie=1;Ie<D;Ie++)i(ne,re,le,Ee,ke,Pe,$,ie,Ie/(D-1),X),K(ve,ge,X.x,X.y),ve=X.x,ge=X.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(J,K){var D=J.getContext?J.getContext("webgl",c):J,X=l.get(D);if(!X){let Ee=function(ve){var ge=ne[ve];if(!ge&&(ge=ne[ve]=D.getExtension(ve),!ge))throw new Error(ve+" not supported");return ge},ke=function(ve,ge){var Ie=D.createShader(ge);return D.shaderSource(Ie,ve),D.compileShader(Ie),Ie},Pe=function(ve,ge,Ie,V){if(!re[ve]){var Ge={},Me={},_e=D.createProgram();D.attachShader(_e,ke(ge,D.VERTEX_SHADER)),D.attachShader(_e,ke(Ie,D.FRAGMENT_SHADER)),D.linkProgram(_e),re[ve]={program:_e,transaction:function(W){D.useProgram(_e),W({setUniform:function(Z,fe){for(var he=[],ae=arguments.length-2;ae-- >0;)he[ae]=arguments[ae+2];var je=Me[fe]||(Me[fe]=D.getUniformLocation(_e,fe));D["uniform"+Z].apply(D,[je].concat(he))},setAttribute:function(Z,fe,he,ae,je){var ze=Ge[Z];ze||(ze=Ge[Z]={buf:D.createBuffer(),loc:D.getAttribLocation(_e,Z),data:null}),D.bindBuffer(D.ARRAY_BUFFER,ze.buf),D.vertexAttribPointer(ze.loc,fe,D.FLOAT,!1,0,0),D.enableVertexAttribArray(ze.loc),q?D.vertexAttribDivisor(ze.loc,ae):Ee("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ze.loc,ae),je!==ze.data&&(D.bufferData(D.ARRAY_BUFFER,je,he),ze.data=je)}})}}}re[ve].transaction(V)},Te=function(ve,ge){ie++;try{D.activeTexture(D.TEXTURE0+ie);var Ie=$[ve];Ie||(Ie=$[ve]=D.createTexture(),D.bindTexture(D.TEXTURE_2D,Ie),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.NEAREST),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.NEAREST)),D.bindTexture(D.TEXTURE_2D,Ie),ge(Ie,ie)}finally{ie--}},De=function(ve,ge,Ie){var V=D.createFramebuffer();le.push(V),D.bindFramebuffer(D.FRAMEBUFFER,V),D.activeTexture(D.TEXTURE0+ge),D.bindTexture(D.TEXTURE_2D,ve),D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_2D,ve,0);try{Ie(V)}finally{D.deleteFramebuffer(V),D.bindFramebuffer(D.FRAMEBUFFER,le[--le.length-1]||null)}},me=function(){ne={},re={},$={},ie=-1,le.length=0};var q=typeof WebGL2RenderingContext<"u"&&D instanceof WebGL2RenderingContext,ne={},re={},$={},ie=-1,le=[];D.canvas.addEventListener("webglcontextlost",function(ve){me(),ve.preventDefault()},!1),l.set(D,X={gl:D,isWebGL2:q,getExtension:Ee,withProgram:Pe,withTexture:Te,withTextureFramebuffer:De,handleContextLoss:me})}K(X)}function d(J,K,D,X,q,ne,re,$){re===void 0&&(re=15),$===void 0&&($=null),u(J,function(ie){var le=ie.gl,Ee=ie.withProgram,ke=ie.withTexture;ke("copy",function(Pe,Te){le.texImage2D(le.TEXTURE_2D,0,le.RGBA,q,ne,0,le.RGBA,le.UNSIGNED_BYTE,K),Ee("copy",o,a,function(De){var me=De.setUniform,ve=De.setAttribute;ve("aUV",2,le.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),me("1i","image",Te),le.bindFramebuffer(le.FRAMEBUFFER,$||null),le.disable(le.BLEND),le.colorMask(re&8,re&4,re&2,re&1),le.viewport(D,X,q,ne),le.scissor(D,X,q,ne),le.drawArrays(le.TRIANGLES,0,3)})})})}function p(J,K,D){var X=J.width,q=J.height;u(J,function(ne){var re=ne.gl,$=new Uint8Array(X*q*4);re.readPixels(0,0,X,q,re.RGBA,re.UNSIGNED_BYTE,$),J.width=K,J.height=D,d(re,$,0,0,X,q)})}var m=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:d,resizeWebGLCanvasWithoutClearing:p});function g(J,K,D,X,q,ne){ne===void 0&&(ne=1);var re=new Uint8Array(J*K),$=X[2]-X[0],ie=X[3]-X[1],le=[];s(D,function(ve,ge,Ie,V){le.push({x1:ve,y1:ge,x2:Ie,y2:V,minX:Math.min(ve,Ie),minY:Math.min(ge,V),maxX:Math.max(ve,Ie),maxY:Math.max(ge,V)})}),le.sort(function(ve,ge){return ve.maxX-ge.maxX});for(var Ee=0;Ee<J;Ee++)for(var ke=0;ke<K;ke++){var Pe=De(X[0]+$*(Ee+.5)/J,X[1]+ie*(ke+.5)/K),Te=Math.pow(1-Math.abs(Pe)/q,ne)/2;Pe<0&&(Te=1-Te),Te=Math.max(0,Math.min(255,Math.round(Te*255))),re[ke*J+Ee]=Te}return re;function De(ve,ge){for(var Ie=1/0,V=1/0,Ge=le.length;Ge--;){var Me=le[Ge];if(Me.maxX+V<=ve)break;if(ve+V>Me.minX&&ge-V<Me.maxY&&ge+V>Me.minY){var _e=v(ve,ge,Me.x1,Me.y1,Me.x2,Me.y2);_e<Ie&&(Ie=_e,V=Math.sqrt(Ie))}}return me(ve,ge)&&(V=-V),V}function me(ve,ge){for(var Ie=0,V=le.length;V--;){var Ge=le[V];if(Ge.maxX<=ve)break;var Me=Ge.y1>ge!=Ge.y2>ge&&ve<(Ge.x2-Ge.x1)*(ge-Ge.y1)/(Ge.y2-Ge.y1)+Ge.x1;Me&&(Ie+=Ge.y1<Ge.y2?1:-1)}return Ie!==0}}function _(J,K,D,X,q,ne,re,$,ie,le){ne===void 0&&(ne=1),$===void 0&&($=0),ie===void 0&&(ie=0),le===void 0&&(le=0),y(J,K,D,X,q,ne,re,null,$,ie,le)}function y(J,K,D,X,q,ne,re,$,ie,le,Ee){ne===void 0&&(ne=1),ie===void 0&&(ie=0),le===void 0&&(le=0),Ee===void 0&&(Ee=0);for(var ke=g(J,K,D,X,q,ne),Pe=new Uint8Array(ke.length*4),Te=0;Te<ke.length;Te++)Pe[Te*4+Ee]=ke[Te];d(re,Pe,ie,le,J,K,1<<3-Ee,$)}function v(J,K,D,X,q,ne){var re=q-D,$=ne-X,ie=re*re+$*$,le=ie?Math.max(0,Math.min(1,((J-D)*re+(K-X)*$)/ie)):0,Ee=J-(D+le*re),ke=K-(X+le*$);return Ee*Ee+ke*ke}var S=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:_,generateIntoFramebuffer:y}),b="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",w="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",C="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",M=new Float32Array([0,0,2,0,0,2]),L=null,P=!1,T={},A=new WeakMap;function I(J){if(!P&&!z(J))throw new Error("WebGL generation not supported")}function F(J,K,D,X,q,ne,re){if(ne===void 0&&(ne=1),re===void 0&&(re=null),!re&&(re=L,!re)){var $=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!$)throw new Error("OffscreenCanvas or DOM canvas not supported");re=L=$.getContext("webgl",{depth:!1})}I(re);var ie=new Uint8Array(J*K*4);u(re,function(Pe){var Te=Pe.gl,De=Pe.withTexture,me=Pe.withTextureFramebuffer;De("readable",function(ve,ge){Te.texImage2D(Te.TEXTURE_2D,0,Te.RGBA,J,K,0,Te.RGBA,Te.UNSIGNED_BYTE,null),me(ve,ge,function(Ie){O(J,K,D,X,q,ne,Te,Ie,0,0,0),Te.readPixels(0,0,J,K,Te.RGBA,Te.UNSIGNED_BYTE,ie)})})});for(var le=new Uint8Array(J*K),Ee=0,ke=0;Ee<ie.length;Ee+=4)le[ke++]=ie[Ee];return le}function B(J,K,D,X,q,ne,re,$,ie,le){ne===void 0&&(ne=1),$===void 0&&($=0),ie===void 0&&(ie=0),le===void 0&&(le=0),O(J,K,D,X,q,ne,re,null,$,ie,le)}function O(J,K,D,X,q,ne,re,$,ie,le,Ee){ne===void 0&&(ne=1),ie===void 0&&(ie=0),le===void 0&&(le=0),Ee===void 0&&(Ee=0),I(re);var ke=[];s(D,function(Pe,Te,De,me){ke.push(Pe,Te,De,me)}),ke=new Float32Array(ke),u(re,function(Pe){var Te=Pe.gl,De=Pe.isWebGL2,me=Pe.getExtension,ve=Pe.withProgram,ge=Pe.withTexture,Ie=Pe.withTextureFramebuffer,V=Pe.handleContextLoss;if(ge("rawDistances",function(Ge,Me){(J!==Ge._lastWidth||K!==Ge._lastHeight)&&Te.texImage2D(Te.TEXTURE_2D,0,Te.RGBA,Ge._lastWidth=J,Ge._lastHeight=K,0,Te.RGBA,Te.UNSIGNED_BYTE,null),ve("main",b,w,function(_e){var Ne=_e.setAttribute,W=_e.setUniform,R=!De&&me("ANGLE_instanced_arrays"),Z=!De&&me("EXT_blend_minmax");Ne("aUV",2,Te.STATIC_DRAW,0,M),Ne("aLineSegment",4,Te.DYNAMIC_DRAW,1,ke),W.apply(void 0,["4f","uGlyphBounds"].concat(X)),W("1f","uMaxDistance",q),W("1f","uExponent",ne),Ie(Ge,Me,function(fe){Te.enable(Te.BLEND),Te.colorMask(!0,!0,!0,!0),Te.viewport(0,0,J,K),Te.scissor(0,0,J,K),Te.blendFunc(Te.ONE,Te.ONE),Te.blendEquationSeparate(Te.FUNC_ADD,De?Te.MAX:Z.MAX_EXT),Te.clear(Te.COLOR_BUFFER_BIT),De?Te.drawArraysInstanced(Te.TRIANGLES,0,3,ke.length/4):R.drawArraysInstancedANGLE(Te.TRIANGLES,0,3,ke.length/4)})}),ve("post",o,C,function(_e){_e.setAttribute("aUV",2,Te.STATIC_DRAW,0,M),_e.setUniform("1i","tex",Me),Te.bindFramebuffer(Te.FRAMEBUFFER,$),Te.disable(Te.BLEND),Te.colorMask(Ee===0,Ee===1,Ee===2,Ee===3),Te.viewport(ie,le,J,K),Te.scissor(ie,le,J,K),Te.drawArrays(Te.TRIANGLES,0,3)})}),Te.isContextLost())throw V(),new Error("webgl context lost")})}function z(J){var K=!J||J===L?T:J.canvas||J,D=A.get(K);if(D===void 0){P=!0;var X=null;try{var q=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],ne=F(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,J);D=ne&&q.length===ne.length&&ne.every(function(re,$){return re===q[$]}),D||(X="bad trial run results",console.info(q,ne))}catch(re){D=!1,X=re.message}X&&console.warn("WebGL SDF generation not supported:",X),P=!1,A.set(K,D)}return D}var U=Object.freeze({__proto__:null,generate:F,generateIntoCanvas:B,generateIntoFramebuffer:O,isSupported:z});function G(J,K,D,X,q,ne){q===void 0&&(q=Math.max(X[2]-X[0],X[3]-X[1])/2),ne===void 0&&(ne=1);try{return F.apply(U,arguments)}catch(re){return console.info("WebGL SDF generation failed, falling back to JS",re),g.apply(S,arguments)}}function j(J,K,D,X,q,ne,re,$,ie,le){q===void 0&&(q=Math.max(X[2]-X[0],X[3]-X[1])/2),ne===void 0&&(ne=1),$===void 0&&($=0),ie===void 0&&(ie=0),le===void 0&&(le=0);try{return B.apply(U,arguments)}catch(Ee){return console.info("WebGL SDF generation failed, falling back to JS",Ee),_.apply(S,arguments)}}return e.forEachPathCommand=r,e.generate=G,e.generateIntoCanvas=j,e.javascript=S,e.pathToLineSegments=s,e.webgl=U,e.webglUtils=m,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return t}function _ne(){var t=(function(e){var n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},i={},r={};i.L=1,r[1]="L",Object.keys(n).forEach(function(V,Ge){i[V]=1<<Ge+1,r[i[V]]=V}),Object.freeze(i);var s=i.LRI|i.RLI|i.FSI,o=i.L|i.R|i.AL,a=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,l=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,c=i.S|i.WS|i.B|s|i.PDI|l,u=null;function d(){if(!u){u=new Map;var V=function(Me){if(n.hasOwnProperty(Me)){var _e=0;n[Me].split(",").forEach(function(Ne){var W=Ne.split("+"),R=W[0],Z=W[1];R=parseInt(R,36),Z=Z?parseInt(Z,36):0,u.set(_e+=R,i[Me]);for(var fe=0;fe<Z;fe++)u.set(++_e,i[Me])})}};for(var Ge in n)V(Ge)}}function p(V){return d(),u.get(V.codePointAt(0))||i.L}function m(V){return r[p(V)]}var g={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function _(V,Ge){var Me=36,_e=0,Ne=new Map,W=Ge&&new Map,R;return V.split(",").forEach(function Z(fe){if(fe.indexOf("+")!==-1)for(var he=+fe;he--;)Z(R);else{R=fe;var ae=fe.split(">"),je=ae[0],ze=ae[1];je=String.fromCodePoint(_e+=parseInt(je,Me)),ze=String.fromCodePoint(_e+=parseInt(ze,Me)),Ne.set(je,ze),Ge&&W.set(ze,je)}}),{map:Ne,reverseMap:W}}var y,v,S;function b(){if(!y){var V=_(g.pairs,!0),Ge=V.map,Me=V.reverseMap;y=Ge,v=Me,S=_(g.canonical,!1).map}}function w(V){return b(),y.get(V)||null}function C(V){return b(),v.get(V)||null}function M(V){return b(),S.get(V)||null}var L=i.L,P=i.R,T=i.EN,A=i.ES,I=i.ET,F=i.AN,B=i.CS,O=i.B,z=i.S,U=i.ON,G=i.BN,j=i.NSM,J=i.AL,K=i.LRO,D=i.RLO,X=i.LRE,q=i.RLE,ne=i.PDF,re=i.LRI,$=i.RLI,ie=i.FSI,le=i.PDI;function Ee(V,Ge){for(var Me=125,_e=new Uint32Array(V.length),Ne=0;Ne<V.length;Ne++)_e[Ne]=p(V[Ne]);var W=new Map;function R(fr,us){var Ui=_e[fr];_e[fr]=us,W.set(Ui,W.get(Ui)-1),Ui&a&&W.set(a,W.get(a)-1),W.set(us,(W.get(us)||0)+1),us&a&&W.set(a,(W.get(a)||0)+1)}for(var Z=new Uint8Array(V.length),fe=new Map,he=[],ae=null,je=0;je<V.length;je++)ae||he.push(ae={start:je,end:V.length-1,level:Ge==="rtl"?1:Ge==="ltr"?0:Ud(je,!1)}),_e[je]&O&&(ae.end=je,ae=null);for(var ze=q|X|D|K|s|le|ne|O,Qe=function(fr){return fr+(fr&1?1:2)},ct=function(fr){return fr+(fr&1?2:1)},Ae=0;Ae<he.length;Ae++){ae=he[Ae];var Ve=[{_level:ae.level,_override:0,_isolate:0}],Ue=void 0,Q=0,ce=0,Ye=0;W.clear();for(var te=ae.start;te<=ae.end;te++){var we=_e[te];if(Ue=Ve[Ve.length-1],W.set(we,(W.get(we)||0)+1),we&a&&W.set(a,(W.get(a)||0)+1),we&ze)if(we&(q|X)){Z[te]=Ue._level;var Be=(we===q?ct:Qe)(Ue._level);Be<=Me&&!Q&&!ce?Ve.push({_level:Be,_override:0,_isolate:0}):Q||ce++}else if(we&(D|K)){Z[te]=Ue._level;var it=(we===D?ct:Qe)(Ue._level);it<=Me&&!Q&&!ce?Ve.push({_level:it,_override:we&D?P:L,_isolate:0}):Q||ce++}else if(we&s){we&ie&&(we=Ud(te+1,!0)===1?$:re),Z[te]=Ue._level,Ue._override&&R(te,Ue._override);var Fe=(we===$?ct:Qe)(Ue._level);Fe<=Me&&Q===0&&ce===0?(Ye++,Ve.push({_level:Fe,_override:0,_isolate:1,_isolInitIndex:te})):Q++}else if(we&le){if(Q>0)Q--;else if(Ye>0){for(ce=0;!Ve[Ve.length-1]._isolate;)Ve.pop();var Se=Ve[Ve.length-1]._isolInitIndex;Se!=null&&(fe.set(Se,te),fe.set(te,Se)),Ve.pop(),Ye--}Ue=Ve[Ve.length-1],Z[te]=Ue._level,Ue._override&&R(te,Ue._override)}else we&ne?(Q===0&&(ce>0?ce--:!Ue._isolate&&Ve.length>1&&(Ve.pop(),Ue=Ve[Ve.length-1])),Z[te]=Ue._level):we&O&&(Z[te]=ae.level);else Z[te]=Ue._level,Ue._override&&we!==G&&R(te,Ue._override)}for(var Xe=[],Je=null,ot=ae.start;ot<=ae.end;ot++){var kt=_e[ot];if(!(kt&l)){var un=Z[ot],mn=kt&s,qn=kt===le;Je&&un===Je._level?(Je._end=ot,Je._endsWithIsolInit=mn):Xe.push(Je={_start:ot,_end:ot,_level:un,_startsWithPDI:qn,_endsWithIsolInit:mn})}}for(var Zi=[],Mr=0;Mr<Xe.length;Mr++){var Yn=Xe[Mr];if(!Yn._startsWithPDI||Yn._startsWithPDI&&!fe.has(Yn._start)){for(var Oi=[Je=Yn],Qi=void 0;Je&&Je._endsWithIsolInit&&(Qi=fe.get(Je._end))!=null;)for(var Ti=Mr+1;Ti<Xe.length;Ti++)if(Xe[Ti]._start===Qi){Oi.push(Je=Xe[Ti]);break}for(var ni=[],os=0;os<Oi.length;os++)for(var Ar=Oi[os],Qs=Ar._start;Qs<=Ar._end;Qs++)ni.push(Qs);for(var Il=Z[ni[0]],No=ae.level,eo=ni[0]-1;eo>=0;eo--)if(!(_e[eo]&l)){No=Z[eo];break}var Ya=ni[ni.length-1],Pt=Z[Ya],se=ae.level;if(!(_e[Ya]&s)){for(var Ze=Ya+1;Ze<=ae.end;Ze++)if(!(_e[Ze]&l)){se=Z[Ze];break}}Zi.push({_seqIndices:ni,_sosType:Math.max(No,Il)%2?P:L,_eosType:Math.max(se,Pt)%2?P:L})}}for(var Et=0;Et<Zi.length;Et++){var Mn=Zi[Et],ht=Mn._seqIndices,H=Mn._sosType,oe=Mn._eosType,ye=Z[ht[0]]&1?P:L;if(W.get(j))for(var xe=0;xe<ht.length;xe++){var pe=ht[xe];if(_e[pe]&j){for(var $e=H,at=xe-1;at>=0;at--)if(!(_e[ht[at]]&l)){$e=_e[ht[at]];break}R(pe,$e&(s|le)?U:$e)}}if(W.get(T))for(var Ke=0;Ke<ht.length;Ke++){var tt=ht[Ke];if(_e[tt]&T)for(var xt=Ke-1;xt>=-1;xt--){var Tt=xt===-1?H:_e[ht[xt]];if(Tt&o){Tt===J&&R(tt,F);break}}}if(W.get(J))for(var St=0;St<ht.length;St++){var zt=ht[St];_e[zt]&J&&R(zt,P)}if(W.get(A)||W.get(B))for(var tn=1;tn<ht.length-1;tn++){var nn=ht[tn];if(_e[nn]&(A|B)){for(var wn=0,En=0,Dt=tn-1;Dt>=0&&(wn=_e[ht[Dt]],!!(wn&l));Dt--);for(var hn=tn+1;hn<ht.length&&(En=_e[ht[hn]],!!(En&l));hn++);wn===En&&(_e[nn]===A?wn===T:wn&(T|F))&&R(nn,wn)}}if(W.get(T))for(var jt=0;jt<ht.length;jt++){var Vn=ht[jt];if(_e[Vn]&T){for(var to=jt-1;to>=0&&_e[ht[to]]&(I|l);to--)R(ht[to],T);for(jt++;jt<ht.length&&_e[ht[jt]]&(I|l|T);jt++)_e[ht[jt]]!==T&&R(ht[jt],T)}}if(W.get(I)||W.get(A)||W.get(B))for(var Bi=0;Bi<ht.length;Bi++){var Ka=ht[Bi];if(_e[Ka]&(I|A|B)){R(Ka,U);for(var _n=Bi-1;_n>=0&&_e[ht[_n]]&l;_n--)R(ht[_n],U);for(var ci=Bi+1;ci<ht.length&&_e[ht[ci]]&l;ci++)R(ht[ci],U)}}if(W.get(T))for(var Mi=0,mi=H;Mi<ht.length;Mi++){var er=ht[Mi],Rl=_e[er];Rl&T?mi===L&&R(er,L):Rl&o&&(mi=Rl)}if(W.get(a)){var kr=P|T|F,Nd=kr|L,$a=[];{for(var Lc=[],Ja=0;Ja<ht.length;Ja++)if(_e[ht[Ja]]&a){var dn=V[ht[Ja]],hm=void 0;if(w(dn)!==null)if(Lc.length<63)Lc.push({char:dn,seqIndex:Ja});else break;else if((hm=C(dn))!==null)for(var Nl=Lc.length-1;Nl>=0;Nl--){var Od=Lc[Nl].char;if(Od===hm||Od===C(M(dn))||w(M(Od))===dn){$a.push([Lc[Nl].seqIndex,Ja]),Lc.length=Nl;break}}}$a.sort(function(fr,us){return fr[0]-us[0]})}for(var dm=0;dm<$a.length;dm++){for(var Z_=$a[dm],gi=Z_[0],Qu=Z_[1],Q_=!1,as=0,fm=gi+1;fm<Qu;fm++){var eh=ht[fm];if(_e[eh]&Nd){Q_=!0;var no=_e[eh]&kr?P:L;if(no===ye){as=no;break}}}if(Q_&&!as){as=H;for(var pm=gi-1;pm>=0;pm--){var ey=ht[pm];if(_e[ey]&Nd){var io=_e[ey]&kr?P:L;io!==ye?as=io:as=ye;break}}}if(as){if(_e[ht[gi]]=_e[ht[Qu]]=as,as!==ye){for(var ls=gi+1;ls<ht.length;ls++)if(!(_e[ht[ls]]&l)){p(V[ht[ls]])&j&&(_e[ht[ls]]=as);break}}if(as!==ye){for(var Za=Qu+1;Za<ht.length;Za++)if(!(_e[ht[Za]]&l)){p(V[ht[Za]])&j&&(_e[ht[Za]]=as);break}}}}for(var Oo=0;Oo<ht.length;Oo++)if(_e[ht[Oo]]&a){for(var mm=Oo,gm=Oo,Ps=H,th=Oo-1;th>=0;th--)if(_e[ht[th]]&l)mm=th;else{Ps=_e[ht[th]]&kr?P:L;break}for(var nh=oe,ih=Oo+1;ih<ht.length;ih++)if(_e[ht[ih]]&(a|l))gm=ih;else{nh=_e[ht[ih]]&kr?P:L;break}for(var cs=mm;cs<=gm;cs++)_e[ht[cs]]=Ps===nh?Ps:ye;Oo=gm}}}for(var dr=ae.start;dr<=ae.end;dr++){var Bd=Z[dr],pa=_e[dr];if(Bd&1?pa&(L|T|F)&&Z[dr]++:pa&P?Z[dr]++:pa&(F|T)&&(Z[dr]+=2),pa&l&&(Z[dr]=dr===0?ae.level:Z[dr-1]),dr===ae.end||p(V[dr])&(z|O))for(var Pc=dr;Pc>=0&&p(V[Pc])&c;Pc--)Z[Pc]=ae.level}}return{levels:Z,paragraphs:he};function Ud(fr,us){for(var Ui=fr;Ui<V.length;Ui++){var Fi=_e[Ui];if(Fi&(P|J))return 1;if(Fi&(O|L)||us&&Fi===le)return 0;if(Fi&s){var ro=ty(Ui);Ui=ro===-1?V.length:ro}}return 0}function ty(fr){for(var us=1,Ui=fr+1;Ui<V.length;Ui++){var Fi=_e[Ui];if(Fi&O)break;if(Fi&le){if(--us===0)return Ui}else Fi&s&&us++}return-1}}var ke="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Pe;function Te(){if(!Pe){var V=_(ke,!0),Ge=V.map,Me=V.reverseMap;Me.forEach(function(_e,Ne){Ge.set(Ne,_e)}),Pe=Ge}}function De(V){return Te(),Pe.get(V)||null}function me(V,Ge,Me,_e){var Ne=V.length;Me=Math.max(0,Me==null?0:+Me),_e=Math.min(Ne-1,_e==null?Ne-1:+_e);for(var W=new Map,R=Me;R<=_e;R++)if(Ge[R]&1){var Z=De(V[R]);Z!==null&&W.set(R,Z)}return W}function ve(V,Ge,Me,_e){var Ne=V.length;Me=Math.max(0,Me==null?0:+Me),_e=Math.min(Ne-1,_e==null?Ne-1:+_e);var W=[];return Ge.paragraphs.forEach(function(R){var Z=Math.max(Me,R.start),fe=Math.min(_e,R.end);if(Z<fe){for(var he=Ge.levels.slice(Z,fe+1),ae=fe;ae>=Z&&p(V[ae])&c;ae--)he[ae]=R.level;for(var je=R.level,ze=1/0,Qe=0;Qe<he.length;Qe++){var ct=he[Qe];ct>je&&(je=ct),ct<ze&&(ze=ct|1)}for(var Ae=je;Ae>=ze;Ae--)for(var Ve=0;Ve<he.length;Ve++)if(he[Ve]>=Ae){for(var Ue=Ve;Ve+1<he.length&&he[Ve+1]>=Ae;)Ve++;Ve>Ue&&W.push([Ue+Z,Ve+Z])}}}),W}function ge(V,Ge,Me,_e){var Ne=Ie(V,Ge,Me,_e),W=[].concat(V);return Ne.forEach(function(R,Z){W[Z]=(Ge.levels[R]&1?De(V[R]):null)||V[R]}),W.join("")}function Ie(V,Ge,Me,_e){for(var Ne=ve(V,Ge,Me,_e),W=[],R=0;R<V.length;R++)W[R]=R;return Ne.forEach(function(Z){for(var fe=Z[0],he=Z[1],ae=W.slice(fe,he+1),je=ae.length;je--;)W[he-je]=ae[je]}),W}return e.closingToOpeningBracket=C,e.getBidiCharType=p,e.getBidiCharTypeName=m,e.getCanonicalBracket=M,e.getEmbeddingLevels=Ee,e.getMirroredCharacter=De,e.getMirroredCharactersMap=me,e.getReorderSegments=ve,e.getReorderedIndices=Ie,e.getReorderedString=ge,e.openingToClosingBracket=w,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return t}var s8=_ne;Ou();var hL=/\bvoid\s+main\s*\(\s*\)\s*{/g;function uL(t){let e=/^[ \t]*#include +<([\w\d./]+)>/gm;function n(i,r){let s=Jt[r];return s?uL(s):i}return t.replace(e,n)}var zr=[];for(let t=0;t<256;t++)zr[t]=(t<16?"0":"")+t.toString(16);function yne(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(zr[t&255]+zr[t>>8&255]+zr[t>>16&255]+zr[t>>24&255]+"-"+zr[e&255]+zr[e>>8&255]+"-"+zr[e>>16&15|64]+zr[e>>24&255]+"-"+zr[n&63|128]+zr[n>>8&255]+"-"+zr[n>>16&255]+zr[n>>24&255]+zr[i&255]+zr[i>>8&255]+zr[i>>16&255]+zr[i>>24&255]).toUpperCase()}var Pd=Object.assign||function(){let t=arguments[0];for(let e=1,n=arguments.length;e<n;e++){let i=arguments[e];if(i)for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},xne=Date.now(),o8=new WeakMap,a8=new Map,Sne=1e10;function Zw(t,e){let n=Cne(e),i=o8.get(t);if(i||o8.set(t,i=Object.create(null)),i[n])return new i[n];let r=`_onBeforeCompile${n}`,s=function(c,u){t.onBeforeCompile.call(this,c,u);let d=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader,p=a8[d];if(!p){let m=bne(this,c,e,n);p=a8[d]=m}c.vertexShader=p.vertexShader,c.fragmentShader=p.fragmentShader,Pd(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-xne}}),this[r]&&this[r](c)},o=function(){return a(e.chained?t:t.clone())},a=function(c){let u=Object.create(c,l);return Object.defineProperty(u,"baseMaterial",{value:t}),Object.defineProperty(u,"id",{value:Sne++}),u.uuid=yne(),u.uniforms=Pd({},c.uniforms,e.uniforms),u.defines=Pd({},c.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",u.extensions=Pd({},c.extensions,e.extensions),u._listeners=void 0,u},l={constructor:{value:o},isDerivedMaterial:{value:!0},type:{get:()=>t.type,set:c=>{t.type=c}},isDerivedFrom:{writable:!0,configurable:!0,value:function(c){let u=this.baseMaterial;return c===u||u.isDerivedMaterial&&u.isDerivedFrom(c)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get(){return s},set(c){this[r]=c}},copy:{writable:!0,configurable:!0,value:function(c){return t.copy.call(this,c),!t.isShaderMaterial&&!t.isDerivedMaterial&&(Pd(this.extensions,c.extensions),Pd(this.defines,c.defines),Pd(this.uniforms,K0.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){let c=new t.constructor;return a(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=Zw(t.isDerivedMaterial?t.getDepthMaterial():new Cu({depthPacking:bb}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=Zw(t.isDerivedMaterial?t.getDistanceMaterial():new Tu,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){let{_depthMaterial:c,_distanceMaterial:u}=this;c&&c.dispose(),u&&u.dispose(),t.dispose.call(this)}}};return i[n]=o,new o}function bne(t,{vertexShader:e,fragmentShader:n},i,r){let{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:d,fragmentColorTransform:p,customRewriter:m,timeUniform:g}=i;if(s=s||"",o=o||"",a=a||"",c=c||"",u=u||"",d=d||"",(l||m)&&(e=uL(e)),(p||m)&&(n=n.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),n=uL(n)),m){let _=m({vertexShader:e,fragmentShader:n});e=_.vertexShader,n=_.fragmentShader}if(p){let _=[];n=n.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,y=>(_.push(y),"")),d=`${p}
${_.join(`
`)}
${d}`}if(g){let _=`
uniform float ${g};
`;s=_+s,c=_+c}return l&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,s=`${s}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,o=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(_,y,v,S)=>/\battribute\s+vec[23]\s+$/.test(S.substr(0,v))?y:`troika_${y}_${r}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=l8(e,r,s,o,a),n=l8(n,r,c,u,d),{vertexShader:e,fragmentShader:n}}function l8(t,e,n,i,r){return(i||r||n)&&(t=t.replace(hL,`
${n}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${i}
  troikaOrigMain${e}();
  ${r}
}`),t}function wne(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}var Ene=0,c8=new Map;function Cne(t){let e=JSON.stringify(t,wne),n=c8.get(e);return n==null&&c8.set(e,n=++Ene),n}function Tne(){return typeof window>"u"&&(self.window=self),(function(t){var e={parse:function(r){var s=e._bin,o=new Uint8Array(r);if(s.readASCII(o,0,4)=="ttcf"){var a=4;s.readUshort(o,a),a+=2,s.readUshort(o,a),a+=2;var l=s.readUint(o,a);a+=4;for(var c=[],u=0;u<l;u++){var d=s.readUint(o,a);a+=4,c.push(e._readFont(o,d))}return c}return[e._readFont(o,0)]},_readFont:function(r,s){var o=e._bin,a=s;o.readFixed(r,s),s+=4;var l=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:r,_offset:a},d={},p=0;p<l;p++){var m=o.readASCII(r,s,4);s+=4,o.readUint(r,s),s+=4;var g=o.readUint(r,s);s+=4;var _=o.readUint(r,s);s+=4,d[m]={offset:g,length:_}}for(p=0;p<c.length;p++){var y=c[p];d[y]&&(u[y.trim()]=e[y.trim()].parse(r,d[y].offset,d[y].length,u))}return u},_tabOffset:function(r,s,o){for(var a=e._bin,l=a.readUshort(r,o+4),c=o+12,u=0;u<l;u++){var d=a.readASCII(r,c,4);c+=4,a.readUint(r,c),c+=4;var p=a.readUint(r,c);if(c+=4,a.readUint(r,c),c+=4,d==s)return p}return 0}};e._bin={readFixed:function(r,s){return(r[s]<<8|r[s+1])+(r[s+2]<<8|r[s+3])/65540},readF2dot14:function(r,s){return e._bin.readShort(r,s)/16384},readInt:function(r,s){return e._bin._view(r).getInt32(s)},readInt8:function(r,s){return e._bin._view(r).getInt8(s)},readShort:function(r,s){return e._bin._view(r).getInt16(s)},readUshort:function(r,s){return e._bin._view(r).getUint16(s)},readUshorts:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(e._bin.readUshort(r,s+2*l));return a},readUint:function(r,s){return e._bin._view(r).getUint32(s)},readUint64:function(r,s){return 4294967296*e._bin.readUint(r,s)+e._bin.readUint(r,s+4)},readASCII:function(r,s,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(r[s+l]);return a},readUnicode:function(r,s,o){for(var a="",l=0;l<o;l++){var c=r[s++]<<8|r[s++];a+=String.fromCharCode(c)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,s,o){var a=e._bin._tdec;return a&&s==0&&o==r.length?a.decode(r):e._bin.readASCII(r,s,o)},readBytes:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(r[s+l]);return a},readASCIIArray:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(String.fromCharCode(r[s+l]));return a},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,s,o,a,l){var c=e._bin,u={},d=s;c.readFixed(r,s),s+=4;var p=c.readUshort(r,s);s+=2;var m=c.readUshort(r,s);s+=2;var g=c.readUshort(r,s);return s+=2,u.scriptList=e._lctf.readScriptList(r,d+p),u.featureList=e._lctf.readFeatureList(r,d+m),u.lookupList=e._lctf.readLookupList(r,d+g,l),u},e._lctf.readLookupList=function(r,s,o){var a=e._bin,l=s,c=[],u=a.readUshort(r,s);s+=2;for(var d=0;d<u;d++){var p=a.readUshort(r,s);s+=2;var m=e._lctf.readLookupTable(r,l+p,o);c.push(m)}return c},e._lctf.readLookupTable=function(r,s,o){var a=e._bin,l=s,c={tabs:[]};c.ltype=a.readUshort(r,s),s+=2,c.flag=a.readUshort(r,s),s+=2;var u=a.readUshort(r,s);s+=2;for(var d=c.ltype,p=0;p<u;p++){var m=a.readUshort(r,s);s+=2;var g=o(r,d,l+m,c);c.tabs.push(g)}return c},e._lctf.numOfOnes=function(r){for(var s=0,o=0;o<32;o++)(r>>>o&1)!=0&&s++;return s},e._lctf.readClassDef=function(r,s){var o=e._bin,a=[],l=o.readUshort(r,s);if(s+=2,l==1){var c=o.readUshort(r,s);s+=2;var u=o.readUshort(r,s);s+=2;for(var d=0;d<u;d++)a.push(c+d),a.push(c+d),a.push(o.readUshort(r,s)),s+=2}if(l==2){var p=o.readUshort(r,s);for(s+=2,d=0;d<p;d++)a.push(o.readUshort(r,s)),s+=2,a.push(o.readUshort(r,s)),s+=2,a.push(o.readUshort(r,s)),s+=2}return a},e._lctf.getInterval=function(r,s){for(var o=0;o<r.length;o+=3){var a=r[o],l=r[o+1];if(r[o+2],a<=s&&s<=l)return o}return-1},e._lctf.readCoverage=function(r,s){var o=e._bin,a={};a.fmt=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);return s+=2,a.fmt==1&&(a.tab=o.readUshorts(r,s,l)),a.fmt==2&&(a.tab=o.readUshorts(r,s,3*l)),a},e._lctf.coverageIndex=function(r,s){var o=r.tab;if(r.fmt==1)return o.indexOf(s);if(r.fmt==2){var a=e._lctf.getInterval(o,s);if(a!=-1)return o[a+2]+(s-o[a])}return-1},e._lctf.readFeatureList=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var d=o.readASCII(r,s,4);s+=4;var p=o.readUshort(r,s);s+=2;var m=e._lctf.readFeatureTable(r,a+p);m.tag=d.trim(),l.push(m)}return l},e._lctf.readFeatureTable=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2,c>0&&(l.featureParams=a+c);var u=o.readUshort(r,s);s+=2,l.tab=[];for(var d=0;d<u;d++)l.tab.push(o.readUshort(r,s+2*d));return l},e._lctf.readScriptList=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var d=o.readASCII(r,s,4);s+=4;var p=o.readUshort(r,s);s+=2,l[d.trim()]=e._lctf.readScriptTable(r,a+p)}return l},e._lctf.readScriptTable=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2,c>0&&(l.default=e._lctf.readLangSysTable(r,a+c));var u=o.readUshort(r,s);s+=2;for(var d=0;d<u;d++){var p=o.readASCII(r,s,4);s+=4;var m=o.readUshort(r,s);s+=2,l[p.trim()]=e._lctf.readLangSysTable(r,a+m)}return l},e._lctf.readLangSysTable=function(r,s){var o=e._bin,a={};o.readUshort(r,s),s+=2,a.reqFeature=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);return s+=2,a.features=o.readUshorts(r,s,l),a},e.CFF={},e.CFF.parse=function(r,s,o){var a=e._bin;(r=new Uint8Array(r.buffer,s,o))[s=0],r[++s],r[++s],r[++s],s++;var l=[];s=e.CFF.readIndex(r,s,l);for(var c=[],u=0;u<l.length-1;u++)c.push(a.readASCII(r,s+l[u],l[u+1]-l[u]));s+=l[l.length-1];var d=[];s=e.CFF.readIndex(r,s,d);var p=[];for(u=0;u<d.length-1;u++)p.push(e.CFF.readDict(r,s+d[u],s+d[u+1]));s+=d[d.length-1];var m=p[0],g=[];s=e.CFF.readIndex(r,s,g);var _=[];for(u=0;u<g.length-1;u++)_.push(a.readASCII(r,s+g[u],g[u+1]-g[u]));if(s+=g[g.length-1],e.CFF.readSubrs(r,s,m),m.CharStrings){s=m.CharStrings,g=[],s=e.CFF.readIndex(r,s,g);var y=[];for(u=0;u<g.length-1;u++)y.push(a.readBytes(r,s+g[u],g[u+1]-g[u]));m.CharStrings=y}if(m.ROS){s=m.FDArray;var v=[];for(s=e.CFF.readIndex(r,s,v),m.FDArray=[],u=0;u<v.length-1;u++){var S=e.CFF.readDict(r,s+v[u],s+v[u+1]);e.CFF._readFDict(r,S,_),m.FDArray.push(S)}s+=v[v.length-1],s=m.FDSelect,m.FDSelect=[];var b=r[s];if(s++,b!=3)throw b;var w=a.readUshort(r,s);for(s+=2,u=0;u<w+1;u++)m.FDSelect.push(a.readUshort(r,s),r[s+2]),s+=3}return m.Encoding&&(m.Encoding=e.CFF.readEncoding(r,m.Encoding,m.CharStrings.length)),m.charset&&(m.charset=e.CFF.readCharset(r,m.charset,m.CharStrings.length)),e.CFF._readFDict(r,m,_),m},e.CFF._readFDict=function(r,s,o){var a;for(var l in s.Private&&(a=s.Private[1],s.Private=e.CFF.readDict(r,a,a+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(r,a+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(s[l]=o[s[l]-426+35])},e.CFF.readSubrs=function(r,s,o){var a=e._bin,l=[];s=e.CFF.readIndex(r,s,l);var c,u=l.length;c=u<1240?107:u<33900?1131:32768,o.Bias=c,o.Subrs=[];for(var d=0;d<l.length-1;d++)o.Subrs.push(a.readBytes(r,s+l[d],l[d+1]-l[d]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,s){for(var o=0;o<r.charset.length;o++)if(r.charset[o]==s)return o;return-1},e.CFF.glyphBySE=function(r,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[s])},e.CFF.readEncoding=function(r,s,o){e._bin;var a=[".notdef"],l=r[s];if(s++,l!=0)throw"error: unknown encoding format: "+l;var c=r[s];s++;for(var u=0;u<c;u++)a.push(r[s+u]);return a},e.CFF.readCharset=function(r,s,o){var a=e._bin,l=[".notdef"],c=r[s];if(s++,c==0)for(var u=0;u<o;u++){var d=a.readUshort(r,s);s+=2,l.push(d)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<o;){d=a.readUshort(r,s),s+=2;var p=0;for(c==1?(p=r[s],s++):(p=a.readUshort(r,s),s+=2),u=0;u<=p;u++)l.push(d),d++}}return l},e.CFF.readIndex=function(r,s,o){var a=e._bin,l=a.readUshort(r,s)+1,c=r[s+=2];if(s++,c==1)for(var u=0;u<l;u++)o.push(r[s+u]);else if(c==2)for(u=0;u<l;u++)o.push(a.readUshort(r,s+2*u));else if(c==3)for(u=0;u<l;u++)o.push(16777215&a.readUint(r,s+3*u-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(s+=l*c)-1},e.CFF.getCharString=function(r,s,o){var a=e._bin,l=r[s],c=r[s+1];r[s+2],r[s+3],r[s+4];var u=1,d=null,p=null;l<=20&&(d=l,u=1),l==12&&(d=100*l+c,u=2),21<=l&&l<=27&&(d=l,u=1),l==28&&(p=a.readShort(r,s+1),u=3),29<=l&&l<=31&&(d=l,u=1),32<=l&&l<=246&&(p=l-139,u=1),247<=l&&l<=250&&(p=256*(l-247)+c+108,u=2),251<=l&&l<=254&&(p=256*-(l-251)-c-108,u=2),l==255&&(p=a.readInt(r,s+1)/65535,u=5),o.val=p??"o"+d,o.size=u},e.CFF.readCharString=function(r,s,o){for(var a=s+o,l=e._bin,c=[];s<a;){var u=r[s],d=r[s+1];r[s+2],r[s+3],r[s+4];var p=1,m=null,g=null;u<=20&&(m=u,p=1),u==12&&(m=100*u+d,p=2),u!=19&&u!=20||(m=u,p=2),21<=u&&u<=27&&(m=u,p=1),u==28&&(g=l.readShort(r,s+1),p=3),29<=u&&u<=31&&(m=u,p=1),32<=u&&u<=246&&(g=u-139,p=1),247<=u&&u<=250&&(g=256*(u-247)+d+108,p=2),251<=u&&u<=254&&(g=256*-(u-251)-d-108,p=2),u==255&&(g=l.readInt(r,s+1)/65535,p=5),c.push(g??"o"+m),s+=p}return c},e.CFF.readDict=function(r,s,o){for(var a=e._bin,l={},c=[];s<o;){var u=r[s],d=r[s+1];r[s+2],r[s+3],r[s+4];var p=1,m=null,g=null;if(u==28&&(g=a.readShort(r,s+1),p=3),u==29&&(g=a.readInt(r,s+1),p=5),32<=u&&u<=246&&(g=u-139,p=1),247<=u&&u<=250&&(g=256*(u-247)+d+108,p=2),251<=u&&u<=254&&(g=256*-(u-251)-d-108,p=2),u==255)throw g=a.readInt(r,s+1)/65535,p=5,"unknown number";if(u==30){var _=[];for(p=1;;){var y=r[s+p];p++;var v=y>>4,S=15&y;if(v!=15&&_.push(v),S!=15&&_.push(S),S==15)break}for(var b="",w=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],C=0;C<_.length;C++)b+=w[_[C]];g=parseFloat(b)}u<=21&&(m=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],p=1,u==12&&(m=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][d],p=2)),m!=null?(l[m]=c.length==1?c[0]:c,c=[]):c.push(g),s+=p}return l},e.cmap={},e.cmap.parse=function(r,s,o){r=new Uint8Array(r.buffer,s,o),s=0;var a=e._bin,l={};a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2;var u=[];l.tables=[];for(var d=0;d<c;d++){var p=a.readUshort(r,s);s+=2;var m=a.readUshort(r,s);s+=2;var g=a.readUint(r,s);s+=4;var _="p"+p+"e"+m,y=u.indexOf(g);if(y==-1){var v;y=l.tables.length,u.push(g);var S=a.readUshort(r,g);S==0?v=e.cmap.parse0(r,g):S==4?v=e.cmap.parse4(r,g):S==6?v=e.cmap.parse6(r,g):S==12?v=e.cmap.parse12(r,g):console.debug("unknown format: "+S,p,m,g),l.tables.push(v)}if(l[_]!=null)throw"multiple tables for one platform+encoding";l[_]=y}return l},e.cmap.parse0=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,a.map=[];for(var c=0;c<l-6;c++)a.map.push(r[s+c]);return a},e.cmap.parse4=function(r,s){var o=e._bin,a=s,l={};l.format=o.readUshort(r,s),s+=2;var c=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2;var u=o.readUshort(r,s);s+=2;var d=u/2;l.searchRange=o.readUshort(r,s),s+=2,l.entrySelector=o.readUshort(r,s),s+=2,l.rangeShift=o.readUshort(r,s),s+=2,l.endCount=o.readUshorts(r,s,d),s+=2*d,s+=2,l.startCount=o.readUshorts(r,s,d),s+=2*d,l.idDelta=[];for(var p=0;p<d;p++)l.idDelta.push(o.readShort(r,s)),s+=2;for(l.idRangeOffset=o.readUshorts(r,s,d),s+=2*d,l.glyphIdArray=[];s<a+c;)l.glyphIdArray.push(o.readUshort(r,s)),s+=2;return l},e.cmap.parse6=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,a.firstCode=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2,a.glyphIdArray=[];for(var c=0;c<l;c++)a.glyphIdArray.push(o.readUshort(r,s)),s+=2;return a},e.cmap.parse12=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2,s+=2,o.readUint(r,s),s+=4,o.readUint(r,s),s+=4;var l=o.readUint(r,s);s+=4,a.groups=[];for(var c=0;c<l;c++){var u=s+12*c,d=o.readUint(r,u+0),p=o.readUint(r,u+4),m=o.readUint(r,u+8);a.groups.push([d,p,m])}return a},e.glyf={},e.glyf.parse=function(r,s,o,a){for(var l=[],c=0;c<a.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(r,s){var o=e._bin,a=r._data,l=e._tabOffset(a,"glyf",r._offset)+r.loca[s];if(r.loca[s]==r.loca[s+1])return null;var c={};if(c.noc=o.readShort(a,l),l+=2,c.xMin=o.readShort(a,l),l+=2,c.yMin=o.readShort(a,l),l+=2,c.xMax=o.readShort(a,l),l+=2,c.yMax=o.readShort(a,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var u=0;u<c.noc;u++)c.endPts.push(o.readUshort(a,l)),l+=2;var d=o.readUshort(a,l);if(l+=2,a.length-l<d)return null;c.instructions=o.readBytes(a,l,d),l+=d;var p=c.endPts[c.noc-1]+1;for(c.flags=[],u=0;u<p;u++){var m=a[l];if(l++,c.flags.push(m),(8&m)!=0){var g=a[l];l++;for(var _=0;_<g;_++)c.flags.push(m),u++}}for(c.xs=[],u=0;u<p;u++){var y=(2&c.flags[u])!=0,v=(16&c.flags[u])!=0;y?(c.xs.push(v?a[l]:-a[l]),l++):v?c.xs.push(0):(c.xs.push(o.readShort(a,l)),l+=2)}for(c.ys=[],u=0;u<p;u++)y=(4&c.flags[u])!=0,v=(32&c.flags[u])!=0,y?(c.ys.push(v?a[l]:-a[l]),l++):v?c.ys.push(0):(c.ys.push(o.readShort(a,l)),l+=2);var S=0,b=0;for(u=0;u<p;u++)S+=c.xs[u],b+=c.ys[u],c.xs[u]=S,c.ys[u]=b}else{var w;c.parts=[];do{w=o.readUshort(a,l),l+=2;var C={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(C),C.glyphIndex=o.readUshort(a,l),l+=2,1&w){var M=o.readShort(a,l);l+=2;var L=o.readShort(a,l);l+=2}else M=o.readInt8(a,l),l++,L=o.readInt8(a,l),l++;2&w?(C.m.tx=M,C.m.ty=L):(C.p1=M,C.p2=L),8&w?(C.m.a=C.m.d=o.readF2dot14(a,l),l+=2):64&w?(C.m.a=o.readF2dot14(a,l),l+=2,C.m.d=o.readF2dot14(a,l),l+=2):128&w&&(C.m.a=o.readF2dot14(a,l),l+=2,C.m.b=o.readF2dot14(a,l),l+=2,C.m.c=o.readF2dot14(a,l),l+=2,C.m.d=o.readF2dot14(a,l),l+=2)}while(32&w);if(256&w){var P=o.readUshort(a,l);for(l+=2,c.instr=[],u=0;u<P;u++)c.instr.push(a[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(r,s,o,a){var l=s;s+=4;var c=e._bin.readUshort(r,s);return{glyphClassDef:c===0?null:e._lctf.readClassDef(r,l+c)}},e.GPOS={},e.GPOS.parse=function(r,s,o,a){return e._lctf.parse(r,s,o,a,e.GPOS.subt)},e.GPOS.subt=function(r,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(r,o),o+=2,s==1||s==2||s==3||s==7||s==8&&u.fmt<=2){var d=l.readUshort(r,o);o+=2,u.coverage=e._lctf.readCoverage(r,d+c)}if(s==1&&u.fmt==1){var p=l.readUshort(r,o);o+=2,p!=0&&(u.pos=e.GPOS.readValueRecord(r,o,p))}else if(s==2&&u.fmt>=1&&u.fmt<=2){p=l.readUshort(r,o),o+=2;var m=l.readUshort(r,o);o+=2;var g=e._lctf.numOfOnes(p),_=e._lctf.numOfOnes(m);if(u.fmt==1){u.pairsets=[];var y=l.readUshort(r,o);o+=2;for(var v=0;v<y;v++){var S=c+l.readUshort(r,o);o+=2;var b=l.readUshort(r,S);S+=2;for(var w=[],C=0;C<b;C++){var M=l.readUshort(r,S);S+=2,p!=0&&(F=e.GPOS.readValueRecord(r,S,p),S+=2*g),m!=0&&(B=e.GPOS.readValueRecord(r,S,m),S+=2*_),w.push({gid2:M,val1:F,val2:B})}u.pairsets.push(w)}}if(u.fmt==2){var L=l.readUshort(r,o);o+=2;var P=l.readUshort(r,o);o+=2;var T=l.readUshort(r,o);o+=2;var A=l.readUshort(r,o);for(o+=2,u.classDef1=e._lctf.readClassDef(r,c+L),u.classDef2=e._lctf.readClassDef(r,c+P),u.matrix=[],v=0;v<T;v++){var I=[];for(C=0;C<A;C++){var F=null,B=null;p!=0&&(F=e.GPOS.readValueRecord(r,o,p),o+=2*g),m!=0&&(B=e.GPOS.readValueRecord(r,o,m),o+=2*_),I.push({val1:F,val2:B})}u.matrix.push(I)}}}else if(s==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(r,l.readUshort(r,o)+c),u.baseCoverage=e._lctf.readCoverage(r,l.readUshort(r,o+2)+c),u.markClassCount=l.readUshort(r,o+4),u.markArray=e.GPOS.readMarkArray(r,l.readUshort(r,o+6)+c),u.baseArray=e.GPOS.readBaseArray(r,l.readUshort(r,o+8)+c,u.markClassCount);else if(s==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(r,l.readUshort(r,o)+c),u.mark2Coverage=e._lctf.readCoverage(r,l.readUshort(r,o+2)+c),u.markClassCount=l.readUshort(r,o+4),u.mark1Array=e.GPOS.readMarkArray(r,l.readUshort(r,o+6)+c),u.mark2Array=e.GPOS.readBaseArray(r,l.readUshort(r,o+8)+c,u.markClassCount);else{if(s==9&&u.fmt==1){var O=l.readUshort(r,o);o+=2;var z=l.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=O;else if(a.ltype!=O)throw"invalid extension substitution";return e.GPOS.subt(r,a.ltype,c+z)}console.debug("unsupported GPOS table LookupType",s,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(r,s,o){var a=e._bin,l=[];return l.push(1&o?a.readShort(r,s):0),s+=1&o?2:0,l.push(2&o?a.readShort(r,s):0),s+=2&o?2:0,l.push(4&o?a.readShort(r,s):0),s+=4&o?2:0,l.push(8&o?a.readShort(r,s):0),s+=8&o?2:0,l},e.GPOS.readBaseArray=function(r,s,o){var a=e._bin,l=[],c=s,u=a.readUshort(r,s);s+=2;for(var d=0;d<u;d++){for(var p=[],m=0;m<o;m++)p.push(e.GPOS.readAnchorRecord(r,c+a.readUshort(r,s))),s+=2;l.push(p)}return l},e.GPOS.readMarkArray=function(r,s){var o=e._bin,a=[],l=s,c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var d=e.GPOS.readAnchorRecord(r,o.readUshort(r,s+2)+l);d.markClass=o.readUshort(r,s),a.push(d),s+=4}return a},e.GPOS.readAnchorRecord=function(r,s){var o=e._bin,a={};return a.fmt=o.readUshort(r,s),a.x=o.readShort(r,s+2),a.y=o.readShort(r,s+4),a},e.GSUB={},e.GSUB.parse=function(r,s,o,a){return e._lctf.parse(r,s,o,a,e.GSUB.subt)},e.GSUB.subt=function(r,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(r,o),o+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&u.fmt<=2||s==6&&u.fmt<=2){var d=l.readUshort(r,o);o+=2,u.coverage=e._lctf.readCoverage(r,c+d)}if(s==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=l.readShort(r,o),o+=2;else if(u.fmt==2){var p=l.readUshort(r,o);o+=2,u.newg=l.readUshorts(r,o,p),o+=2*u.newg.length}}else if(s==2&&u.fmt==1){p=l.readUshort(r,o),o+=2,u.seqs=[];for(var m=0;m<p;m++){var g=l.readUshort(r,o)+c;o+=2;var _=l.readUshort(r,g);u.seqs.push(l.readUshorts(r,g+2,_))}}else if(s==4)for(u.vals=[],p=l.readUshort(r,o),o+=2,m=0;m<p;m++){var y=l.readUshort(r,o);o+=2,u.vals.push(e.GSUB.readLigatureSet(r,c+y))}else if(s==5&&u.fmt==2){if(u.fmt==2){var v=l.readUshort(r,o);o+=2,u.cDef=e._lctf.readClassDef(r,c+v),u.scset=[];var S=l.readUshort(r,o);for(o+=2,m=0;m<S;m++){var b=l.readUshort(r,o);o+=2,u.scset.push(b==0?null:e.GSUB.readSubClassSet(r,c+b))}}}else if(s==6&&u.fmt==3){if(u.fmt==3){for(m=0;m<3;m++){p=l.readUshort(r,o),o+=2;for(var w=[],C=0;C<p;C++)w.push(e._lctf.readCoverage(r,c+l.readUshort(r,o+2*C)));o+=2*p,m==0&&(u.backCvg=w),m==1&&(u.inptCvg=w),m==2&&(u.ahedCvg=w)}p=l.readUshort(r,o),o+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(r,o,p)}}else{if(s==7&&u.fmt==1){var M=l.readUshort(r,o);o+=2;var L=l.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=M;else if(a.ltype!=M)throw"invalid extension substitution";return e.GSUB.subt(r,a.ltype,c+L)}console.debug("unsupported GSUB table LookupType",s,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(r,s){var o=e._bin.readUshort,a=s,l=[],c=o(r,s);s+=2;for(var u=0;u<c;u++){var d=o(r,s);s+=2,l.push(e.GSUB.readSubClassRule(r,a+d))}return l},e.GSUB.readSubClassRule=function(r,s){var o=e._bin.readUshort,a={},l=o(r,s),c=o(r,s+=2);s+=2,a.input=[];for(var u=0;u<l-1;u++)a.input.push(o(r,s)),s+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(r,s,c),a},e.GSUB.readSubstLookupRecords=function(r,s,o){for(var a=e._bin.readUshort,l=[],c=0;c<o;c++)l.push(a(r,s),a(r,s+2)),s+=4;return l},e.GSUB.readChainSubClassSet=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var d=o.readUshort(r,s);s+=2,l.push(e.GSUB.readChainSubClassRule(r,a+d))}return l},e.GSUB.readChainSubClassRule=function(r,s){for(var o=e._bin,a={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var u=o.readUshort(r,s);s+=2,c==1&&u--,a[l[c]]=o.readUshorts(r,s,u),s+=2*a[l[c]].length}return u=o.readUshort(r,s),s+=2,a.subst=o.readUshorts(r,s,2*u),s+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var d=o.readUshort(r,s);s+=2,l.push(e.GSUB.readLigature(r,a+d))}return l},e.GSUB.readLigature=function(r,s){var o=e._bin,a={chain:[]};a.nglyph=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2;for(var c=0;c<l-1;c++)a.chain.push(o.readUshort(r,s)),s+=2;return a},e.head={},e.head.parse=function(r,s,o){var a=e._bin,l={};return a.readFixed(r,s),s+=4,l.fontRevision=a.readFixed(r,s),s+=4,a.readUint(r,s),s+=4,a.readUint(r,s),s+=4,l.flags=a.readUshort(r,s),s+=2,l.unitsPerEm=a.readUshort(r,s),s+=2,l.created=a.readUint64(r,s),s+=8,l.modified=a.readUint64(r,s),s+=8,l.xMin=a.readShort(r,s),s+=2,l.yMin=a.readShort(r,s),s+=2,l.xMax=a.readShort(r,s),s+=2,l.yMax=a.readShort(r,s),s+=2,l.macStyle=a.readUshort(r,s),s+=2,l.lowestRecPPEM=a.readUshort(r,s),s+=2,l.fontDirectionHint=a.readShort(r,s),s+=2,l.indexToLocFormat=a.readShort(r,s),s+=2,l.glyphDataFormat=a.readShort(r,s),s+=2,l},e.hhea={},e.hhea.parse=function(r,s,o){var a=e._bin,l={};return a.readFixed(r,s),s+=4,l.ascender=a.readShort(r,s),s+=2,l.descender=a.readShort(r,s),s+=2,l.lineGap=a.readShort(r,s),s+=2,l.advanceWidthMax=a.readUshort(r,s),s+=2,l.minLeftSideBearing=a.readShort(r,s),s+=2,l.minRightSideBearing=a.readShort(r,s),s+=2,l.xMaxExtent=a.readShort(r,s),s+=2,l.caretSlopeRise=a.readShort(r,s),s+=2,l.caretSlopeRun=a.readShort(r,s),s+=2,l.caretOffset=a.readShort(r,s),s+=2,s+=8,l.metricDataFormat=a.readShort(r,s),s+=2,l.numberOfHMetrics=a.readUshort(r,s),s+=2,l},e.hmtx={},e.hmtx.parse=function(r,s,o,a){for(var l=e._bin,c={aWidth:[],lsBearing:[]},u=0,d=0,p=0;p<a.maxp.numGlyphs;p++)p<a.hhea.numberOfHMetrics&&(u=l.readUshort(r,s),s+=2,d=l.readShort(r,s),s+=2),c.aWidth.push(u),c.lsBearing.push(d);return c},e.kern={},e.kern.parse=function(r,s,o,a){var l=e._bin,c=l.readUshort(r,s);if(s+=2,c==1)return e.kern.parseV1(r,s-2,o,a);var u=l.readUshort(r,s);s+=2;for(var d={glyph1:[],rval:[]},p=0;p<u;p++){s+=2,o=l.readUshort(r,s),s+=2;var m=l.readUshort(r,s);s+=2;var g=m>>>8;if((g&=15)!=0)throw"unknown kern table format: "+g;s=e.kern.readFormat0(r,s,d)}return d},e.kern.parseV1=function(r,s,o,a){var l=e._bin;l.readFixed(r,s),s+=4;var c=l.readUint(r,s);s+=4;for(var u={glyph1:[],rval:[]},d=0;d<c;d++){l.readUint(r,s),s+=4;var p=l.readUshort(r,s);s+=2,l.readUshort(r,s),s+=2;var m=p>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;s=e.kern.readFormat0(r,s,u)}return u},e.kern.readFormat0=function(r,s,o){var a=e._bin,l=-1,c=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2;for(var u=0;u<c;u++){var d=a.readUshort(r,s);s+=2;var p=a.readUshort(r,s);s+=2;var m=a.readShort(r,s);s+=2,d!=l&&(o.glyph1.push(d),o.rval.push({glyph2:[],vals:[]}));var g=o.rval[o.rval.length-1];g.glyph2.push(p),g.vals.push(m),l=d}return s},e.loca={},e.loca.parse=function(r,s,o,a){var l=e._bin,c=[],u=a.head.indexToLocFormat,d=a.maxp.numGlyphs+1;if(u==0)for(var p=0;p<d;p++)c.push(l.readUshort(r,s+(p<<1))<<1);if(u==1)for(p=0;p<d;p++)c.push(l.readUint(r,s+(p<<2)));return c},e.maxp={},e.maxp.parse=function(r,s,o){var a=e._bin,l={},c=a.readUint(r,s);return s+=4,l.numGlyphs=a.readUshort(r,s),s+=2,c==65536&&(l.maxPoints=a.readUshort(r,s),s+=2,l.maxContours=a.readUshort(r,s),s+=2,l.maxCompositePoints=a.readUshort(r,s),s+=2,l.maxCompositeContours=a.readUshort(r,s),s+=2,l.maxZones=a.readUshort(r,s),s+=2,l.maxTwilightPoints=a.readUshort(r,s),s+=2,l.maxStorage=a.readUshort(r,s),s+=2,l.maxFunctionDefs=a.readUshort(r,s),s+=2,l.maxInstructionDefs=a.readUshort(r,s),s+=2,l.maxStackElements=a.readUshort(r,s),s+=2,l.maxSizeOfInstructions=a.readUshort(r,s),s+=2,l.maxComponentElements=a.readUshort(r,s),s+=2,l.maxComponentDepth=a.readUshort(r,s),s+=2),l},e.name={},e.name.parse=function(r,s,o){var a=e._bin,l={};a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2,a.readUshort(r,s);for(var u,d=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],p=s+=2,m=0;m<c;m++){var g=a.readUshort(r,s);s+=2;var _=a.readUshort(r,s);s+=2;var y=a.readUshort(r,s);s+=2;var v=a.readUshort(r,s);s+=2;var S=a.readUshort(r,s);s+=2;var b=a.readUshort(r,s);s+=2;var w,C=d[v],M=p+12*c+b;if(g==0)w=a.readUnicode(r,M,S/2);else if(g==3&&_==0)w=a.readUnicode(r,M,S/2);else if(_==0)w=a.readASCII(r,M,S);else if(_==1)w=a.readUnicode(r,M,S/2);else if(_==3)w=a.readUnicode(r,M,S/2);else{if(g!=1)throw"unknown encoding "+_+", platformID: "+g;w=a.readASCII(r,M,S),console.debug("reading unknown MAC encoding "+_+" as ASCII")}var L="p"+g+","+y.toString(16);l[L]==null&&(l[L]={}),l[L][C!==void 0?C:v]=w,l[L]._lang=y}for(var P in l)if(l[P].postScriptName!=null&&l[P]._lang==1033)return l[P];for(var P in l)if(l[P].postScriptName!=null&&l[P]._lang==0)return l[P];for(var P in l)if(l[P].postScriptName!=null&&l[P]._lang==3084)return l[P];for(var P in l)if(l[P].postScriptName!=null)return l[P];for(var P in l){u=P;break}return console.debug("returning name table with languageID "+l[u]._lang),l[u]},e["OS/2"]={},e["OS/2"].parse=function(r,s,o){var a=e._bin.readUshort(r,s);s+=2;var l={};if(a==0)e["OS/2"].version0(r,s,l);else if(a==1)e["OS/2"].version1(r,s,l);else if(a==2||a==3||a==4)e["OS/2"].version2(r,s,l);else{if(a!=5)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(r,s,l)}return l},e["OS/2"].version0=function(r,s,o){var a=e._bin;return o.xAvgCharWidth=a.readShort(r,s),s+=2,o.usWeightClass=a.readUshort(r,s),s+=2,o.usWidthClass=a.readUshort(r,s),s+=2,o.fsType=a.readUshort(r,s),s+=2,o.ySubscriptXSize=a.readShort(r,s),s+=2,o.ySubscriptYSize=a.readShort(r,s),s+=2,o.ySubscriptXOffset=a.readShort(r,s),s+=2,o.ySubscriptYOffset=a.readShort(r,s),s+=2,o.ySuperscriptXSize=a.readShort(r,s),s+=2,o.ySuperscriptYSize=a.readShort(r,s),s+=2,o.ySuperscriptXOffset=a.readShort(r,s),s+=2,o.ySuperscriptYOffset=a.readShort(r,s),s+=2,o.yStrikeoutSize=a.readShort(r,s),s+=2,o.yStrikeoutPosition=a.readShort(r,s),s+=2,o.sFamilyClass=a.readShort(r,s),s+=2,o.panose=a.readBytes(r,s,10),s+=10,o.ulUnicodeRange1=a.readUint(r,s),s+=4,o.ulUnicodeRange2=a.readUint(r,s),s+=4,o.ulUnicodeRange3=a.readUint(r,s),s+=4,o.ulUnicodeRange4=a.readUint(r,s),s+=4,o.achVendID=[a.readInt8(r,s),a.readInt8(r,s+1),a.readInt8(r,s+2),a.readInt8(r,s+3)],s+=4,o.fsSelection=a.readUshort(r,s),s+=2,o.usFirstCharIndex=a.readUshort(r,s),s+=2,o.usLastCharIndex=a.readUshort(r,s),s+=2,o.sTypoAscender=a.readShort(r,s),s+=2,o.sTypoDescender=a.readShort(r,s),s+=2,o.sTypoLineGap=a.readShort(r,s),s+=2,o.usWinAscent=a.readUshort(r,s),s+=2,o.usWinDescent=a.readUshort(r,s),s+=2},e["OS/2"].version1=function(r,s,o){var a=e._bin;return s=e["OS/2"].version0(r,s,o),o.ulCodePageRange1=a.readUint(r,s),s+=4,o.ulCodePageRange2=a.readUint(r,s),s+=4},e["OS/2"].version2=function(r,s,o){var a=e._bin;return s=e["OS/2"].version1(r,s,o),o.sxHeight=a.readShort(r,s),s+=2,o.sCapHeight=a.readShort(r,s),s+=2,o.usDefault=a.readUshort(r,s),s+=2,o.usBreak=a.readUshort(r,s),s+=2,o.usMaxContext=a.readUshort(r,s),s+=2},e["OS/2"].version5=function(r,s,o){var a=e._bin;return s=e["OS/2"].version2(r,s,o),o.usLowerOpticalPointSize=a.readUshort(r,s),s+=2,o.usUpperOpticalPointSize=a.readUshort(r,s),s+=2},e.post={},e.post.parse=function(r,s,o){var a=e._bin,l={};return l.version=a.readFixed(r,s),s+=4,l.italicAngle=a.readFixed(r,s),s+=4,l.underlinePosition=a.readShort(r,s),s+=2,l.underlineThickness=a.readShort(r,s),s+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,s){var o=r.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var l=o.tables[a];if(l.format==0)return s>=l.map.length?0:l.map[s];if(l.format==4){for(var c=-1,u=0;u<l.endCount.length;u++)if(s<=l.endCount[u]){c=u;break}return c==-1||l.startCount[c]>s?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[s-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:s+l.idDelta[c])}if(l.format==12){if(s>l.groups[l.groups.length-1][1])return 0;for(u=0;u<l.groups.length;u++){var d=l.groups[u];if(d[0]<=s&&s<=d[1])return d[2]+(s-d[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(r,s){var o={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[s]){var a=r.SVG.entries[s];return a==null?o:(typeof a=="string"&&(a=e.SVG.toPath(a),r.SVG.entries[s]=a),a)}if(r.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},c=r.CFF,u=r.CFF.Private;if(c.ROS){for(var d=0;c.FDSelect[d+2]<=s;)d+=2;u=c.FDArray[c.FDSelect[d+1]].Private}e.U._drawCFF(r.CFF.CharStrings[s],l,c,u,o)}else r.glyf&&e.U._drawGlyf(s,r,o);return o},e.U._drawGlyf=function(r,s,o){var a=s.glyf[r];a==null&&(a=s.glyf[r]=e.glyf._parseGlyf(s,r)),a!=null&&(a.noc>-1?e.U._simpleGlyph(a,o):e.U._compoGlyph(a,s,o))},e.U._simpleGlyph=function(r,s){for(var o=0;o<r.noc;o++){for(var a=o==0?0:r.endPts[o-1]+1,l=r.endPts[o],c=a;c<=l;c++){var u=c==a?l:c-1,d=c==l?a:c+1,p=1&r.flags[c],m=1&r.flags[u],g=1&r.flags[d],_=r.xs[c],y=r.ys[c];if(c==a)if(p){if(!m){e.U.P.moveTo(s,_,y);continue}e.U.P.moveTo(s,r.xs[u],r.ys[u])}else m?e.U.P.moveTo(s,r.xs[u],r.ys[u]):e.U.P.moveTo(s,(r.xs[u]+_)/2,(r.ys[u]+y)/2);p?m&&e.U.P.lineTo(s,_,y):g?e.U.P.qcurveTo(s,_,y,r.xs[d],r.ys[d]):e.U.P.qcurveTo(s,_,y,(_+r.xs[d])/2,(y+r.ys[d])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(r,s,o){for(var a=0;a<r.parts.length;a++){var l={cmds:[],crds:[]},c=r.parts[a];e.U._drawGlyf(c.glyphIndex,s,l);for(var u=c.m,d=0;d<l.crds.length;d+=2){var p=l.crds[d],m=l.crds[d+1];o.crds.push(p*u.a+m*u.b+u.tx),o.crds.push(p*u.c+m*u.d+u.ty)}for(d=0;d<l.cmds.length;d++)o.cmds.push(l.cmds[d])}},e.U._getGlyphClass=function(r,s){var o=e._lctf.getInterval(s,r);return o==-1?0:s[o+2]},e.U._applySubs=function(r,s,o,a){for(var l=r.length-s-1,c=0;c<o.tabs.length;c++)if(o.tabs[c]!=null){var u,d=o.tabs[c];if(!d.coverage||(u=e._lctf.coverageIndex(d.coverage,r[s]))!=-1){if(o.ltype==1)r[s],d.fmt==1?r[s]=r[s]+d.delta:r[s]=d.newg[u];else if(o.ltype==4)for(var p=d.vals[u],m=0;m<p.length;m++){var g=p[m],_=g.chain.length;if(!(_>l)){for(var y=!0,v=0,S=0;S<_;S++){for(;r[s+v+(1+S)]==-1;)v++;g.chain[S]!=r[s+v+(1+S)]&&(y=!1)}if(y){for(r[s]=g.nglyph,S=0;S<_+v;S++)r[s+S+1]=-1;break}}}else if(o.ltype==5&&d.fmt==2)for(var b=e._lctf.getInterval(d.cDef,r[s]),w=d.cDef[b+2],C=d.scset[w],M=0;M<C.length;M++){var L=C[M],P=L.input;if(!(P.length>l)){for(y=!0,S=0;S<P.length;S++){var T=e._lctf.getInterval(d.cDef,r[s+1+S]);if(b==-1&&d.cDef[T+2]!=P[S]){y=!1;break}}if(y){var A=L.substLookupRecords;for(m=0;m<A.length;m+=2)A[m],A[m+1]}}}else if(o.ltype==6&&d.fmt==3){if(!e.U._glsCovered(r,d.backCvg,s-d.backCvg.length)||!e.U._glsCovered(r,d.inptCvg,s)||!e.U._glsCovered(r,d.ahedCvg,s+d.inptCvg.length))continue;var I=d.lookupRec;for(M=0;M<I.length;M+=2){b=I[M];var F=a[I[M+1]];e.U._applySubs(r,s+b,F,a)}}}}},e.U._glsCovered=function(r,s,o){for(var a=0;a<s.length;a++)if(e._lctf.coverageIndex(s[a],r[o+a])==-1)return!1;return!0},e.U.glyphsToPath=function(r,s,o){for(var a={cmds:[],crds:[]},l=0,c=0;c<s.length;c++){var u=s[c];if(u!=-1){for(var d=c<s.length-1&&s[c+1]!=-1?s[c+1]:0,p=e.U.glyphToPath(r,u),m=0;m<p.crds.length;m+=2)a.crds.push(p.crds[m]+l),a.crds.push(p.crds[m+1]);for(o&&a.cmds.push(o),m=0;m<p.cmds.length;m++)a.cmds.push(p.cmds[m]);o&&a.cmds.push("X"),l+=r.hmtx.aWidth[u],c<s.length-1&&(l+=e.U.getPairAdjustment(r,u,d))}}return a},e.U.P={},e.U.P.moveTo=function(r,s,o){r.cmds.push("M"),r.crds.push(s,o)},e.U.P.lineTo=function(r,s,o){r.cmds.push("L"),r.crds.push(s,o)},e.U.P.curveTo=function(r,s,o,a,l,c,u){r.cmds.push("C"),r.crds.push(s,o,a,l,c,u)},e.U.P.qcurveTo=function(r,s,o,a,l){r.cmds.push("Q"),r.crds.push(s,o,a,l)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,s,o,a,l){for(var c=s.stack,u=s.nStems,d=s.haveWidth,p=s.width,m=s.open,g=0,_=s.x,y=s.y,v=0,S=0,b=0,w=0,C=0,M=0,L=0,P=0,T=0,A=0,I={val:0,size:0};g<r.length;){e.CFF.getCharString(r,g,I);var F=I.val;if(g+=I.size,F=="o1"||F=="o18")c.length%2!=0&&!d&&(p=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,d=!0;else if(F=="o3"||F=="o23")c.length%2!=0&&!d&&(p=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,d=!0;else if(F=="o4")c.length>1&&!d&&(p=c.shift()+a.nominalWidthX,d=!0),m&&e.U.P.closePath(l),y+=c.pop(),e.U.P.moveTo(l,_,y),m=!0;else if(F=="o5")for(;c.length>0;)_+=c.shift(),y+=c.shift(),e.U.P.lineTo(l,_,y);else if(F=="o6"||F=="o7")for(var B=c.length,O=F=="o6",z=0;z<B;z++){var U=c.shift();O?_+=U:y+=U,O=!O,e.U.P.lineTo(l,_,y)}else if(F=="o8"||F=="o24"){B=c.length;for(var G=0;G+6<=B;)v=_+c.shift(),S=y+c.shift(),b=v+c.shift(),w=S+c.shift(),_=b+c.shift(),y=w+c.shift(),e.U.P.curveTo(l,v,S,b,w,_,y),G+=6;F=="o24"&&(_+=c.shift(),y+=c.shift(),e.U.P.lineTo(l,_,y))}else{if(F=="o11")break;if(F=="o1234"||F=="o1235"||F=="o1236"||F=="o1237")F=="o1234"&&(S=y,b=(v=_+c.shift())+c.shift(),A=w=S+c.shift(),M=w,P=y,_=(L=(C=(T=b+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,v,S,b,w,T,A),e.U.P.curveTo(l,C,M,L,P,_,y)),F=="o1235"&&(v=_+c.shift(),S=y+c.shift(),b=v+c.shift(),w=S+c.shift(),T=b+c.shift(),A=w+c.shift(),C=T+c.shift(),M=A+c.shift(),L=C+c.shift(),P=M+c.shift(),_=L+c.shift(),y=P+c.shift(),c.shift(),e.U.P.curveTo(l,v,S,b,w,T,A),e.U.P.curveTo(l,C,M,L,P,_,y)),F=="o1236"&&(v=_+c.shift(),S=y+c.shift(),b=v+c.shift(),A=w=S+c.shift(),M=w,L=(C=(T=b+c.shift())+c.shift())+c.shift(),P=M+c.shift(),_=L+c.shift(),e.U.P.curveTo(l,v,S,b,w,T,A),e.U.P.curveTo(l,C,M,L,P,_,y)),F=="o1237"&&(v=_+c.shift(),S=y+c.shift(),b=v+c.shift(),w=S+c.shift(),T=b+c.shift(),A=w+c.shift(),C=T+c.shift(),M=A+c.shift(),L=C+c.shift(),P=M+c.shift(),Math.abs(L-_)>Math.abs(P-y)?_=L+c.shift():y=P+c.shift(),e.U.P.curveTo(l,v,S,b,w,T,A),e.U.P.curveTo(l,C,M,L,P,_,y));else if(F=="o14"){if(c.length>0&&!d&&(p=c.shift()+o.nominalWidthX,d=!0),c.length==4){var j=c.shift(),J=c.shift(),K=c.shift(),D=c.shift(),X=e.CFF.glyphBySE(o,K),q=e.CFF.glyphBySE(o,D);e.U._drawCFF(o.CharStrings[X],s,o,a,l),s.x=j,s.y=J,e.U._drawCFF(o.CharStrings[q],s,o,a,l)}m&&(e.U.P.closePath(l),m=!1)}else if(F=="o19"||F=="o20")c.length%2!=0&&!d&&(p=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,d=!0,g+=u+7>>3;else if(F=="o21")c.length>2&&!d&&(p=c.shift()+a.nominalWidthX,d=!0),y+=c.pop(),_+=c.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,_,y),m=!0;else if(F=="o22")c.length>1&&!d&&(p=c.shift()+a.nominalWidthX,d=!0),_+=c.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,_,y),m=!0;else if(F=="o25"){for(;c.length>6;)_+=c.shift(),y+=c.shift(),e.U.P.lineTo(l,_,y);v=_+c.shift(),S=y+c.shift(),b=v+c.shift(),w=S+c.shift(),_=b+c.shift(),y=w+c.shift(),e.U.P.curveTo(l,v,S,b,w,_,y)}else if(F=="o26")for(c.length%2&&(_+=c.shift());c.length>0;)v=_,S=y+c.shift(),_=b=v+c.shift(),y=(w=S+c.shift())+c.shift(),e.U.P.curveTo(l,v,S,b,w,_,y);else if(F=="o27")for(c.length%2&&(y+=c.shift());c.length>0;)S=y,b=(v=_+c.shift())+c.shift(),w=S+c.shift(),_=b+c.shift(),y=w,e.U.P.curveTo(l,v,S,b,w,_,y);else if(F=="o10"||F=="o29"){var ne=F=="o10"?a:o;if(c.length==0)console.debug("error: empty stack");else{var re=c.pop(),$=ne.Subrs[re+ne.Bias];s.x=_,s.y=y,s.nStems=u,s.haveWidth=d,s.width=p,s.open=m,e.U._drawCFF($,s,o,a,l),_=s.x,y=s.y,u=s.nStems,d=s.haveWidth,p=s.width,m=s.open}}else if(F=="o30"||F=="o31"){var ie=c.length,le=(G=0,F=="o31");for(G+=ie-(B=-3&ie);G<B;)le?(S=y,b=(v=_+c.shift())+c.shift(),y=(w=S+c.shift())+c.shift(),B-G==5?(_=b+c.shift(),G++):_=b,le=!1):(v=_,S=y+c.shift(),b=v+c.shift(),w=S+c.shift(),_=b+c.shift(),B-G==5?(y=w+c.shift(),G++):y=w,le=!0),e.U.P.curveTo(l,v,S,b,w,_,y),G+=4}else{if((F+"").charAt(0)=="o")throw console.debug("Unknown operation: "+F,r),F;c.push(F)}}}s.x=_,s.y=y,s.nStems=u,s.haveWidth=d,s.width=p,s.open=m};var n=e,i={Typr:n};return t.Typr=n,t.default=i,Object.defineProperty(t,"__esModule",{value:!0}),t})({}).Typr}function Mne(){return(function(t){var e=Uint8Array,n=Uint16Array,i=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(F,B){for(var O=new n(31),z=0;z<31;++z)O[z]=B+=1<<F[z-1];var U=new i(O[30]);for(z=1;z<30;++z)for(var G=O[z];G<O[z+1];++G)U[G]=G-O[z]<<5|z;return[O,U]},l=a(r,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var d=a(s,0)[0],p=new n(32768),m=0;m<32768;++m){var g=(43690&m)>>>1|(21845&m)<<1;g=(61680&(g=(52428&g)>>>2|(13107&g)<<2))>>>4|(3855&g)<<4,p[m]=((65280&g)>>>8|(255&g)<<8)>>>1}var _=function(F,B,O){for(var z=F.length,U=0,G=new n(B);U<z;++U)++G[F[U]-1];var j,J=new n(B);for(U=0;U<B;++U)J[U]=J[U-1]+G[U-1]<<1;if(O){j=new n(1<<B);var K=15-B;for(U=0;U<z;++U)if(F[U])for(var D=U<<4|F[U],X=B-F[U],q=J[F[U]-1]++<<X,ne=q|(1<<X)-1;q<=ne;++q)j[p[q]>>>K]=D}else for(j=new n(z),U=0;U<z;++U)F[U]&&(j[U]=p[J[F[U]-1]++]>>>15-F[U]);return j},y=new e(288);for(m=0;m<144;++m)y[m]=8;for(m=144;m<256;++m)y[m]=9;for(m=256;m<280;++m)y[m]=7;for(m=280;m<288;++m)y[m]=8;var v=new e(32);for(m=0;m<32;++m)v[m]=5;var S=_(y,9,1),b=_(v,5,1),w=function(F){for(var B=F[0],O=1;O<F.length;++O)F[O]>B&&(B=F[O]);return B},C=function(F,B,O){var z=B/8|0;return(F[z]|F[z+1]<<8)>>(7&B)&O},M=function(F,B){var O=B/8|0;return(F[O]|F[O+1]<<8|F[O+2]<<16)>>(7&B)},L=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],P=function(F,B,O){var z=new Error(B||L[F]);if(z.code=F,Error.captureStackTrace&&Error.captureStackTrace(z,P),!O)throw z;return z},T=function(F,B,O){var z=F.length;if(!z||O&&!O.l&&z<5)return B||new e(0);var U=!B||O,G=!O||O.i;O||(O={}),B||(B=new e(3*z));var j,J=function(Ue){var Q=B.length;if(Ue>Q){var ce=new e(Math.max(2*Q,Ue));ce.set(B),B=ce}},K=O.f||0,D=O.p||0,X=O.b||0,q=O.l,ne=O.d,re=O.m,$=O.n,ie=8*z;do{if(!q){O.f=K=C(F,D,1);var le=C(F,D+1,3);if(D+=3,!le){var Ee=F[(Me=((j=D)/8|0)+(7&j&&1)+4)-4]|F[Me-3]<<8,ke=Me+Ee;if(ke>z){G&&P(0);break}U&&J(X+Ee),B.set(F.subarray(Me,ke),X),O.b=X+=Ee,O.p=D=8*ke;continue}if(le==1)q=S,ne=b,re=9,$=5;else if(le==2){var Pe=C(F,D,31)+257,Te=C(F,D+10,15)+4,De=Pe+C(F,D+5,31)+1;D+=14;for(var me=new e(De),ve=new e(19),ge=0;ge<Te;++ge)ve[o[ge]]=C(F,D+3*ge,7);D+=3*Te;var Ie=w(ve),V=(1<<Ie)-1,Ge=_(ve,Ie,1);for(ge=0;ge<De;){var Me,_e=Ge[C(F,D,V)];if(D+=15&_e,(Me=_e>>>4)<16)me[ge++]=Me;else{var Ne=0,W=0;for(Me==16?(W=3+C(F,D,3),D+=2,Ne=me[ge-1]):Me==17?(W=3+C(F,D,7),D+=3):Me==18&&(W=11+C(F,D,127),D+=7);W--;)me[ge++]=Ne}}var R=me.subarray(0,Pe),Z=me.subarray(Pe);re=w(R),$=w(Z),q=_(R,re,1),ne=_(Z,$,1)}else P(1);if(D>ie){G&&P(0);break}}U&&J(X+131072);for(var fe=(1<<re)-1,he=(1<<$)-1,ae=D;;ae=D){var je=(Ne=q[M(F,D)&fe])>>>4;if((D+=15&Ne)>ie){G&&P(0);break}if(Ne||P(2),je<256)B[X++]=je;else{if(je==256){ae=D,q=null;break}var ze=je-254;if(je>264){var Qe=r[ge=je-257];ze=C(F,D,(1<<Qe)-1)+c[ge],D+=Qe}var ct=ne[M(F,D)&he],Ae=ct>>>4;if(ct||P(3),D+=15&ct,Z=d[Ae],Ae>3&&(Qe=s[Ae],Z+=M(F,D)&(1<<Qe)-1,D+=Qe),D>ie){G&&P(0);break}U&&J(X+131072);for(var Ve=X+ze;X<Ve;X+=4)B[X]=B[X-Z],B[X+1]=B[X+1-Z],B[X+2]=B[X+2-Z],B[X+3]=B[X+3-Z];X=Ve}}O.l=q,O.p=ae,O.b=X,q&&(K=1,O.m=re,O.d=ne,O.n=$)}while(!K);return X==B.length?B:(function(Ue,Q,ce){(Q==null||Q<0)&&(Q=0),(ce==null||ce>Ue.length)&&(ce=Ue.length);var Ye=new(Ue instanceof n?n:Ue instanceof i?i:e)(ce-Q);return Ye.set(Ue.subarray(Q,ce)),Ye})(B,0,X)},A=new e(0),I=typeof TextDecoder<"u"&&new TextDecoder;try{I.decode(A,{stream:!0})}catch{}return t.convert_streams=function(F){var B=new DataView(F),O=0;function z(){var Pe=B.getUint16(O);return O+=2,Pe}function U(){var Pe=B.getUint32(O);return O+=4,Pe}function G(Pe){Ee.setUint16(ke,Pe),ke+=2}function j(Pe){Ee.setUint32(ke,Pe),ke+=4}for(var J={signature:U(),flavor:U(),length:U(),numTables:z(),reserved:z(),totalSfntSize:U(),majorVersion:z(),minorVersion:z(),metaOffset:U(),metaLength:U(),metaOrigLength:U(),privOffset:U(),privLength:U()},K=0;Math.pow(2,K)<=J.numTables;)K++;K--;for(var D=16*Math.pow(2,K),X=16*J.numTables-D,q=12,ne=[],re=0;re<J.numTables;re++)ne.push({tag:U(),offset:U(),compLength:U(),origLength:U(),origChecksum:U()}),q+=16;var $,ie=new Uint8Array(12+16*ne.length+ne.reduce((function(Pe,Te){return Pe+Te.origLength+4}),0)),le=ie.buffer,Ee=new DataView(le),ke=0;return j(J.flavor),G(J.numTables),G(D),G(K),G(X),ne.forEach((function(Pe){j(Pe.tag),j(Pe.origChecksum),j(q),j(Pe.origLength),Pe.outOffset=q,(q+=Pe.origLength)%4!=0&&(q+=4-q%4)})),ne.forEach((function(Pe){var Te,De=F.slice(Pe.offset,Pe.offset+Pe.compLength);if(Pe.compLength!=Pe.origLength){var me=new Uint8Array(Pe.origLength);Te=new Uint8Array(De,2),T(Te,me)}else me=new Uint8Array(De);ie.set(me,Pe.outOffset);var ve=0;(q=Pe.outOffset+Pe.origLength)%4!=0&&(ve=4-q%4),ie.set(new Uint8Array(ve).buffer,Pe.outOffset+Pe.origLength),$=q+ve})),le.slice(0,$)},Object.defineProperty(t,"__esModule",{value:!0}),t})({}).convert_streams}function Ane(t,e){let n={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,s=2,o=4,a=8,l=16,c=32,u;function d(L){if(!u){let P={R:s,L:r,D:o,C:l,U:c,T:a};u=new Map;for(let T in i){let A=0;i[T].split(",").forEach(I=>{let[F,B]=I.split("+");F=parseInt(F,36),B=B?parseInt(B,36):0,u.set(A+=F,P[T]);for(let O=B;O--;)u.set(++A,P[T])})}}return u.get(L)||c}let p=1,m=2,g=3,_=4,y=[null,"isol","init","fina","medi"];function v(L){let P=new Uint8Array(L.length),T=c,A=p,I=-1;for(let F=0;F<L.length;F++){let B=L.codePointAt(F),O=d(B)|0,z=p;O&a||(T&(r|o|l)?O&(s|o|l)?(z=g,(A===p||A===g)&&P[I]++):O&(r|c)&&(A===m||A===_)&&P[I]--:T&(s|c)&&(A===m||A===_)&&P[I]--,A=P[F]=z,T=O,I=F,B>65535&&F++)}return P}function S(L,P){let T=[];for(let I=0;I<P.length;I++){let F=P.codePointAt(I);F>65535&&I++,T.push(t.U.codeToGlyph(L,F))}let A=L.GSUB;if(A){let{lookupList:I,featureList:F}=A,B,O=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,z=[];F.forEach(U=>{if(O.test(U.tag))for(let G=0;G<U.tab.length;G++){if(z[U.tab[G]])continue;z[U.tab[G]]=!0;let j=I[U.tab[G]],J=/^(isol|init|fina|medi)$/.test(U.tag);J&&!B&&(B=v(P));for(let K=0;K<T.length;K++)(!B||!J||y[B[K]]===U.tag)&&t.U._applySubs(T,K,j,I)}})}return T}function b(L,P){let T=new Int16Array(P.length*3),A=0;for(;A<P.length;A++){let O=P[A];if(O===-1)continue;T[A*3+2]=L.hmtx.aWidth[O];let z=L.GPOS;if(z){let U=z.lookupList;for(let G=0;G<U.length;G++){let j=U[G];for(let J=0;J<j.tabs.length;J++){let K=j.tabs[J];if(j.ltype===1){if(t._lctf.coverageIndex(K.coverage,O)!==-1&&K.pos){B(K.pos,A);break}}else if(j.ltype===2){let D=null,X=I();if(X!==-1){let q=t._lctf.coverageIndex(K.coverage,P[X]);if(q!==-1){if(K.fmt===1){let ne=K.pairsets[q];for(let re=0;re<ne.length;re++)ne[re].gid2===O&&(D=ne[re])}else if(K.fmt===2){let ne=t.U._getGlyphClass(P[X],K.classDef1),re=t.U._getGlyphClass(O,K.classDef2);D=K.matrix[ne][re]}if(D){D.val1&&B(D.val1,X),D.val2&&B(D.val2,A);break}}}}else if(j.ltype===4){let D=t._lctf.coverageIndex(K.markCoverage,O);if(D!==-1){let X=I(F),q=X===-1?-1:t._lctf.coverageIndex(K.baseCoverage,P[X]);if(q!==-1){let ne=K.markArray[D],re=K.baseArray[q][ne.markClass];T[A*3]=re.x-ne.x+T[X*3]-T[X*3+2],T[A*3+1]=re.y-ne.y+T[X*3+1];break}}}else if(j.ltype===6){let D=t._lctf.coverageIndex(K.mark1Coverage,O);if(D!==-1){let X=I();if(X!==-1){let q=P[X];if(w(L,q)===3){let ne=t._lctf.coverageIndex(K.mark2Coverage,q);if(ne!==-1){let re=K.mark1Array[D],$=K.mark2Array[ne][re.markClass];T[A*3]=$.x-re.x+T[X*3]-T[X*3+2],T[A*3+1]=$.y-re.y+T[X*3+1];break}}}}}}}}else if(L.kern&&!L.cff){let U=I();if(U!==-1){let G=L.kern.glyph1.indexOf(P[U]);if(G!==-1){let j=L.kern.rval[G].glyph2.indexOf(O);j!==-1&&(T[U*3+2]+=L.kern.rval[G].vals[j])}}}}return T;function I(O){for(let z=A-1;z>=0;z--)if(P[z]!==-1&&(!O||O(P[z])))return z;return-1}function F(O){return w(L,O)===1}function B(O,z){for(let U=0;U<3;U++)T[z*3+U]+=O[U]||0}}function w(L,P){let T=L.GDEF&&L.GDEF.glyphClassDef;return T?t.U._getGlyphClass(P,T):0}function C(...L){for(let P=0;P<L.length;P++)if(typeof L[P]=="number")return L[P]}function M(L){let P=Object.create(null),T=L["OS/2"],A=L.hhea,I=L.head.unitsPerEm,F=C(T&&T.sTypoAscender,A&&A.ascender,I),B={unitsPerEm:I,ascender:F,descender:C(T&&T.sTypoDescender,A&&A.descender,0),capHeight:C(T&&T.sCapHeight,F),xHeight:C(T&&T.sxHeight,F),lineGap:C(T&&T.sTypoLineGap,A&&A.lineGap),supportsCodePoint(O){return t.U.codeToGlyph(L,O)>0},forEachGlyph(O,z,U,G){let j=0,J=1/B.unitsPerEm*z,K=S(L,O),D=0,X=b(L,K);return K.forEach((q,ne)=>{if(q!==-1){let re=P[q];if(!re){let{cmds:$,crds:ie}=t.U.glyphToPath(L,q),le="",Ee=0;for(let me=0,ve=$.length;me<ve;me++){let ge=n[$[me]];le+=$[me];for(let Ie=1;Ie<=ge;Ie++)le+=(Ie>1?",":"")+ie[Ee++]}let ke,Pe,Te,De;if(ie.length){ke=Pe=1/0,Te=De=-1/0;for(let me=0,ve=ie.length;me<ve;me+=2){let ge=ie[me],Ie=ie[me+1];ge<ke&&(ke=ge),Ie<Pe&&(Pe=Ie),ge>Te&&(Te=ge),Ie>De&&(De=Ie)}}else ke=Te=Pe=De=0;re=P[q]={index:q,advanceWidth:L.hmtx.aWidth[q],xMin:ke,yMin:Pe,xMax:Te,yMax:De,path:le}}G.call(null,re,j+X[ne*3]*J,X[ne*3+1]*J,D),j+=X[ne*3+2]*J,U&&(j+=U*z)}D+=O.codePointAt(D)>65535?2:1}),j}};return B}return function(P){let T=new Uint8Array(P,0,4),A=t._bin.readASCII(T,0,4);if(A==="wOFF")P=e(P);else if(A==="wOF2")throw new Error("woff2 fonts not supported");return M(t.parse(P)[0])}}var kne=Ld({name:"Typr Font Parser",dependencies:[Tne,Mne,Ane],init(t,e,n){let i=t(),r=e();return n(i,r)}});function Lne(){return(function(t){var e=function(){this.buckets=new Map};e.prototype.add=function(b){var w=b>>5;this.buckets.set(w,(this.buckets.get(w)||0)|1<<(31&b))},e.prototype.has=function(b){var w=this.buckets.get(b>>5);return w!==void 0&&(w&1<<(31&b))!=0},e.prototype.serialize=function(){var b=[];return this.buckets.forEach((function(w,C){b.push((+C).toString(36)+":"+w.toString(36))})),b.join(",")},e.prototype.deserialize=function(b){var w=this;this.buckets.clear(),b.split(",").forEach((function(C){var M=C.split(":");w.buckets.set(parseInt(M[0],36),parseInt(M[1],36))}))};var n=Math.pow(2,8),i=n-1,r=~i;function s(b){var w=(function(M){return M&r})(b).toString(16),C=(function(M){return(M&r)+n-1})(b).toString(16);return"codepoint-index/plane"+(b>>16)+"/"+w+"-"+C+".json"}function o(b,w){var C=b&i,M=w.codePointAt(C/6|0);return((M=(M||48)-48)&1<<C%6)!=0}function a(b,w){var C;(C=b,C.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(M){return M.split("-").map((function(L){return parseInt(L.trim(),16)}))}))).forEach((function(M){var L=M[0],P=M[1];P===void 0&&(P=L),w(L,P)}))}function l(b,w){a(b,(function(C,M){for(var L=C;L<=M;L++)w(L)}))}var c={},u={},d=new WeakMap,p="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function m(b){var w=d.get(b);return w||(w=new e,l(b.ranges,(function(C){return w.add(C)})),d.set(b,w)),w}var g,_=new Map;function y(b,w,C){return b[w]?w:b[C]?C:(function(M){for(var L in M)return L})(b)}function v(b,w){var C=w;if(!b.includes(C)){C=1/0;for(var M=0;M<b.length;M++)Math.abs(b[M]-w)<Math.abs(C-w)&&(C=b[M])}return C}function S(b){return g||(g=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(w){g.add(w)}))),g.has(b)}return t.CodePointSet=e,t.clearCache=function(){c={},u={}},t.getFontsForString=function(b,w){w===void 0&&(w={});var C,M=w.lang;M===void 0&&(M=/\p{Script=Hangul}/u.test(C=b)?"ko":/\p{Script=Hiragana}|\p{Script=Katakana}/u.test(C)?"ja":"en");var L=w.category;L===void 0&&(L="sans-serif");var P=w.style;P===void 0&&(P="normal");var T=w.weight;T===void 0&&(T=400);var A=(w.dataUrl||p).replace(/\/$/g,""),I=new Map,F=new Uint8Array(b.length),B={},O={},z=new Array(b.length),U=new Map,G=!1;function j(D){var X=_.get(D);return X||(X=fetch(A+"/"+D).then((function(q){if(!q.ok)throw new Error(q.statusText);return q.json().then((function(ne){if(!Array.isArray(ne)||ne[0]!==1)throw new Error("Incorrect schema version; need 1, got "+ne[0]);return ne[1]}))})).catch((function(q){if(A!==p)return G||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+A+'", trying default CDN. '+q.message),G=!0),A=p,_.delete(D),j(D);throw q})),_.set(D,X)),X}for(var J=function(D){var X=b.codePointAt(D),q=s(X);z[D]=q,c[q]||U.has(q)||U.set(q,j(q).then((function(ne){c[q]=ne}))),X>65535&&(D++,K=D)},K=0;K<b.length;K++)J(K);return Promise.all(U.values()).then((function(){U.clear();for(var D=function(q){var ne=b.codePointAt(q),re=null,$=c[z[q]],ie=void 0;for(var le in $){var Ee=O[le];if(Ee===void 0&&(Ee=O[le]=new RegExp(le).test(M||"en")),Ee){for(var ke in ie=le,$[le])if(o(ne,$[le][ke])){re=ke;break}break}}if(!re){e:for(var Pe in $)if(Pe!==ie){for(var Te in $[Pe])if(o(ne,$[Pe][Te])){re=Te;break e}}}re||(console.debug("No font coverage for U+"+ne.toString(16)),re="latin"),z[q]=re,u[re]||U.has(re)||U.set(re,j("font-meta/"+re+".json").then((function(De){u[re]=De}))),ne>65535&&(q++,X=q)},X=0;X<b.length;X++)D(X);return Promise.all(U.values())})).then((function(){for(var D,X=null,q=0;q<b.length;q++){var ne=b.codePointAt(q);if(X&&(S(ne)||m(X).has(ne)))F[q]=F[q-1];else{X=u[z[q]];var re=B[X.id];if(!re){var $=X.typeforms,ie=y($,L,"sans-serif"),le=y($[ie],P,"normal"),Ee=v((D=$[ie])===null||D===void 0?void 0:D[le],T);re=B[X.id]=A+"/font-files/"+X.id+"/"+ie+"."+le+"."+Ee+".woff"}var ke=I.get(re);ke==null&&(ke=I.size,I.set(re,ke)),F[q]=ke}ne>65535&&(q++,F[q]=F[q-1])}return{fontUrls:Array.from(I.keys()),chars:F}}))},Object.defineProperty(t,"__esModule",{value:!0}),t})({})}function Pne(t,e){let n=Object.create(null),i=Object.create(null);function r(o,a){let l=c=>{console.error(`Failure loading font ${o}`,c)};try{let c=new XMLHttpRequest;c.open("get",o,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{let u=t(c.response);u.src=o,a(u)}catch(u){l(u)}},c.onerror=l,c.send()}catch(c){l(c)}}function s(o,a){let l=n[o];l?a(l):i[o]?i[o].push(a):(i[o]=[a],r(o,c=>{c.src=o,n[o]=c,i[o].forEach(u=>u(c)),delete i[o]}))}return function(o,a,{lang:l,fonts:c=[],style:u="normal",weight:d="normal",unicodeFontsURL:p}={}){let m=new Uint8Array(o.length),g=[];o.length||S();let _=new Map,y=[];if(u!=="italic"&&(u="normal"),typeof d!="number"&&(d=d==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(w=>!w.lang||w.lang.test(l)).reverse(),c.length){let L=0;(function P(T=0){for(let A=T,I=o.length;A<I;A++){let F=o.codePointAt(A);if(L===1&&g[m[A-1]].supportsCodePoint(F)||A>0&&/\s/.test(o[A]))m[A]=m[A-1],L===2&&(y[y.length-1][1]=A);else for(let B=m[A],O=c.length;B<=O;B++)if(B===O){let z=L===2?y[y.length-1]:y[y.length]=[A,A];z[1]=A,L=2}else{m[A]=B;let{src:z,unicodeRange:U}=c[B];if(!U||b(F,U)){let G=n[z];if(!G){s(z,()=>{P(A)});return}if(G.supportsCodePoint(F)){let j=_.get(G);typeof j!="number"&&(j=g.length,g.push(G),_.set(G,j)),m[A]=j,L=1;break}}}F>65535&&A+1<I&&(m[A+1]=m[A],A++,L===2&&(y[y.length-1][1]=A))}v()})()}else y.push([0,o.length-1]),v();function v(){if(y.length){let w=y.map(C=>o.substring(C[0],C[1]+1)).join(`
`);e.getFontsForString(w,{lang:l||void 0,style:u,weight:d,dataUrl:p}).then(({fontUrls:C,chars:M})=>{let L=g.length,P=0;y.forEach(A=>{for(let I=0,F=A[1]-A[0];I<=F;I++)m[A[0]+I]=M[P++]+L;P++});let T=0;C.forEach((A,I)=>{s(A,F=>{g[I+L]=F,++T===C.length&&S()})})})}else S()}function S(){a({chars:m,fonts:g})}function b(w,C){for(let M=0;M<C.length;M++){let[L,P=L]=C[M];if(L<=w&&w<=P)return!0}return!1}}}var Dne=Ld({name:"FontResolver",dependencies:[Pne,kne,Lne],init(t,e,n){return t(e,n())}});function Ine(t,e){let i=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",s=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:g,lang:_,fonts:y,style:v,weight:S,preResolvedFonts:b,unicodeFontsURL:w},C){let M=({chars:L,fonts:P})=>{let T,A,I=[];for(let F=0;F<L.length;F++)L[F]!==A?(A=L[F],I.push(T={start:F,end:F,fontObj:P[L[F]]})):T.end=F;C(I)};b?M(b):t(g,M,{lang:_,fonts:y,style:v,weight:S,unicodeFontsURL:w})}function a({text:g="",font:_,lang:y,sdfGlyphSize:v=64,fontSize:S=400,fontWeight:b=1,fontStyle:w="normal",letterSpacing:C=0,lineHeight:M="normal",maxWidth:L=1/0,direction:P,textAlign:T="left",textIndent:A=0,whiteSpace:I="normal",overflowWrap:F="normal",anchorX:B=0,anchorY:O=0,metricsOnly:z=!1,unicodeFontsURL:U,preResolvedFonts:G=null,includeCaretPositions:j=!1,chunkedBoundsSize:J=8192,colorRanges:K=null},D){let X=d(),q={fontLoad:0,typesetting:0};g.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),g=g.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),S=+S,C=+C,L=+L,M=M||"normal",A=+A,o({text:g,lang:y,style:w,weight:b,fonts:typeof _=="string"?[{src:_}]:_,unicodeFontsURL:U,preResolvedFonts:G},ne=>{q.fontLoad=d()-X;let re=isFinite(L),$=null,ie=null,le=null,Ee=null,ke=null,Pe=null,Te=null,De=null,me=0,ve=0,ge=I!=="nowrap",Ie=new Map,V=d(),Ge=A,Me=0,_e=new p,Ne=[_e];ne.forEach(he=>{let{fontObj:ae}=he,{ascender:je,descender:ze,unitsPerEm:Qe,lineGap:ct,capHeight:Ae,xHeight:Ve}=ae,Ue=Ie.get(ae);if(!Ue){let we=S/Qe,Be=M==="normal"?(je-ze+ct)*we:M*S,it=(Be-(je-ze)*we)/2,Fe=Math.min(Be,(je-ze)*we),Se=(je+ze)/2*we+Fe/2;Ue={index:Ie.size,src:ae.src,fontObj:ae,fontSizeMult:we,unitsPerEm:Qe,ascender:je*we,descender:ze*we,capHeight:Ae*we,xHeight:Ve*we,lineHeight:Be,baseline:-it-je*we,caretTop:Se,caretBottom:Se-Fe},Ie.set(ae,Ue)}let{fontSizeMult:Q}=Ue,ce=g.slice(he.start,he.end+1),Ye,te;ae.forEachGlyph(ce,S,C,(we,Be,it,Fe)=>{Be+=Me,Fe+=he.start,Ye=Be,te=we;let Se=g.charAt(Fe),Xe=we.advanceWidth*Q,Je=_e.count,ot;if("isEmpty"in we||(we.isWhitespace=!!Se&&new RegExp(r).test(Se),we.canBreakAfter=!!Se&&s.test(Se),we.isEmpty=we.xMin===we.xMax||we.yMin===we.yMax||i.test(Se)),!we.isWhitespace&&!we.isEmpty&&ve++,ge&&re&&!we.isWhitespace&&Be+Xe+Ge>L&&Je){if(_e.glyphAt(Je-1).glyphObj.canBreakAfter)ot=new p,Ge=-Be;else for(let un=Je;un--;)if(un===0&&F==="break-word"){ot=new p,Ge=-Be;break}else if(_e.glyphAt(un).glyphObj.canBreakAfter){ot=_e.splitAt(un+1);let mn=ot.glyphAt(0).x;Ge-=mn;for(let qn=ot.count;qn--;)ot.glyphAt(qn).x-=mn;break}ot&&(_e.isSoftWrapped=!0,_e=ot,Ne.push(_e),me=L)}let kt=_e.glyphAt(_e.count);kt.glyphObj=we,kt.x=Be+Ge,kt.y=it,kt.width=Xe,kt.charIndex=Fe,kt.fontData=Ue,Se===`
`&&(_e=new p,Ne.push(_e),Ge=-(Be+Xe+C*S)+A)}),Me=Ye+te.advanceWidth*Q+C*S});let W=0;Ne.forEach(he=>{let ae=!0;for(let je=he.count;je--;){let ze=he.glyphAt(je);ae&&!ze.glyphObj.isWhitespace&&(he.width=ze.x+ze.width,he.width>me&&(me=he.width),ae=!1);let{lineHeight:Qe,capHeight:ct,xHeight:Ae,baseline:Ve}=ze.fontData;Qe>he.lineHeight&&(he.lineHeight=Qe);let Ue=Ve-he.baseline;Ue<0&&(he.baseline+=Ue,he.cap+=Ue,he.ex+=Ue),he.cap=Math.max(he.cap,he.baseline+ct),he.ex=Math.max(he.ex,he.baseline+Ae)}he.baseline-=W,he.cap-=W,he.ex-=W,W+=he.lineHeight});let R=0,Z=0;if(B&&(typeof B=="number"?R=-B:typeof B=="string"&&(R=-me*(B==="left"?0:B==="center"?.5:B==="right"?1:c(B)))),O&&(typeof O=="number"?Z=-O:typeof O=="string"&&(Z=O==="top"?0:O==="top-baseline"?-Ne[0].baseline:O==="top-cap"?-Ne[0].cap:O==="top-ex"?-Ne[0].ex:O==="middle"?W/2:O==="bottom"?W:O==="bottom-baseline"?-Ne[Ne.length-1].baseline:c(O)*W)),!z){let he=e.getEmbeddingLevels(g,P);$=new Uint16Array(ve),ie=new Uint8Array(ve),le=new Float32Array(ve*2),Ee={},Te=[1/0,1/0,-1/0,-1/0],De=[],j&&(Pe=new Float32Array(g.length*4)),K&&(ke=new Uint8Array(ve*3));let ae=0,je=-1,ze=-1,Qe,ct;if(Ne.forEach((Ae,Ve)=>{let{count:Ue,width:Q}=Ae;if(Ue>0){let ce=0;for(let Fe=Ue;Fe--&&Ae.glyphAt(Fe).glyphObj.isWhitespace;)ce++;let Ye=0,te=0;if(T==="center")Ye=(me-Q)/2;else if(T==="right")Ye=me-Q;else if(T==="justify"&&Ae.isSoftWrapped){let Fe=0;for(let Se=Ue-ce;Se--;)Ae.glyphAt(Se).glyphObj.isWhitespace&&Fe++;te=(me-Q)/Fe}if(te||Ye){let Fe=0;for(let Se=0;Se<Ue;Se++){let Xe=Ae.glyphAt(Se),Je=Xe.glyphObj;Xe.x+=Ye+Fe,te!==0&&Je.isWhitespace&&Se<Ue-ce&&(Fe+=te,Xe.width+=te)}}let we=e.getReorderSegments(g,he,Ae.glyphAt(0).charIndex,Ae.glyphAt(Ae.count-1).charIndex);for(let Fe=0;Fe<we.length;Fe++){let[Se,Xe]=we[Fe],Je=1/0,ot=-1/0;for(let kt=0;kt<Ue;kt++)if(Ae.glyphAt(kt).charIndex>=Se){let un=kt,mn=kt;for(;mn<Ue;mn++){let qn=Ae.glyphAt(mn);if(qn.charIndex>Xe)break;mn<Ue-ce&&(Je=Math.min(Je,qn.x),ot=Math.max(ot,qn.x+qn.width))}for(let qn=un;qn<mn;qn++){let Zi=Ae.glyphAt(qn);Zi.x=ot-(Zi.x+Zi.width-Je)}break}}let Be,it=Fe=>Be=Fe;for(let Fe=0;Fe<Ue;Fe++){let Se=Ae.glyphAt(Fe);Be=Se.glyphObj;let Xe=Be.index,Je=he.levels[Se.charIndex]&1;if(Je){let ot=e.getMirroredCharacter(g[Se.charIndex]);ot&&Se.fontData.fontObj.forEachGlyph(ot,0,0,it)}if(j){let{charIndex:ot,fontData:kt}=Se,un=Se.x+R,mn=Se.x+Se.width+R;Pe[ot*4]=Je?mn:un,Pe[ot*4+1]=Je?un:mn,Pe[ot*4+2]=Ae.baseline+kt.caretBottom+Z,Pe[ot*4+3]=Ae.baseline+kt.caretTop+Z;let qn=ot-je;qn>1&&u(Pe,je,qn),je=ot}if(K){let{charIndex:ot}=Se;for(;ot>ze;)ze++,K.hasOwnProperty(ze)&&(ct=K[ze])}if(!Be.isWhitespace&&!Be.isEmpty){let ot=ae++,{fontSizeMult:kt,src:un,index:mn}=Se.fontData,qn=Ee[un]||(Ee[un]={});qn[Xe]||(qn[Xe]={path:Be.path,pathBounds:[Be.xMin,Be.yMin,Be.xMax,Be.yMax]});let Zi=Se.x+R,Mr=Se.y+Ae.baseline+Z;le[ot*2]=Zi,le[ot*2+1]=Mr;let Yn=Zi+Be.xMin*kt,Oi=Mr+Be.yMin*kt,Qi=Zi+Be.xMax*kt,Ti=Mr+Be.yMax*kt;Yn<Te[0]&&(Te[0]=Yn),Oi<Te[1]&&(Te[1]=Oi),Qi>Te[2]&&(Te[2]=Qi),Ti>Te[3]&&(Te[3]=Ti),ot%J===0&&(Qe={start:ot,end:ot,rect:[1/0,1/0,-1/0,-1/0]},De.push(Qe)),Qe.end++;let ni=Qe.rect;if(Yn<ni[0]&&(ni[0]=Yn),Oi<ni[1]&&(ni[1]=Oi),Qi>ni[2]&&(ni[2]=Qi),Ti>ni[3]&&(ni[3]=Ti),$[ot]=Xe,ie[ot]=mn,K){let os=ot*3;ke[os]=ct>>16&255,ke[os+1]=ct>>8&255,ke[os+2]=ct&255}}}}}),Pe){let Ae=g.length-je;Ae>1&&u(Pe,je,Ae)}}let fe=[];Ie.forEach(({index:he,src:ae,unitsPerEm:je,ascender:ze,descender:Qe,lineHeight:ct,capHeight:Ae,xHeight:Ve})=>{fe[he]={src:ae,unitsPerEm:je,ascender:ze,descender:Qe,lineHeight:ct,capHeight:Ae,xHeight:Ve}}),q.typesetting=d()-V,D({glyphIds:$,glyphFontIndices:ie,glyphPositions:le,glyphData:Ee,fontData:fe,caretPositions:Pe,glyphColors:ke,chunkedBounds:De,fontSize:S,topBaseline:Z+Ne[0].baseline,blockBounds:[R,Z-W,R+me,Z],visibleBounds:Te,timings:q})})}function l(g,_){a({...g,metricsOnly:!0},y=>{let[v,S,b,w]=y.blockBounds;_({width:b-v,height:w-S})})}function c(g){let _=g.match(/^([\d.]+)%$/),y=_?parseFloat(_[1]):NaN;return isNaN(y)?0:y/100}function u(g,_,y){let v=g[_*4],S=g[_*4+1],b=g[_*4+2],w=g[_*4+3],C=(S-v)/y;for(let M=0;M<y;M++){let L=(_+M)*4;g[L]=v+C*M,g[L+1]=v+C*(M+1),g[L+2]=b,g[L+3]=w}}function d(){return(self.performance||Date).now()}function p(){this.data=[]}let m=["glyphObj","x","y","width","charIndex","fontData"];return p.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/m.length)},glyphAt(g){let _=p.flyweight;return _.data=this.data,_.index=g,_},splitAt(g){let _=new p;return _.data=this.data.splice(g*m.length),_}},p.flyweight=m.reduce((g,_,y,v)=>(Object.defineProperty(g,_,{get(){return this.data[this.index*m.length+y]},set(S){this.data[this.index*m.length+y]=S}}),g),{data:null,index:0}),{typeset:a,measure:l}}var Id=()=>(self.performance||Date).now(),nE=cL(),u8;function Rne(t,e,n,i,r,s,o,a,l,c,u=!0){return u?One(t,e,n,i,r,s,o,a,l,c).then(null,d=>(u8||(console.warn("WebGL SDF generation failed, falling back to JS",d),u8=!0),d8(t,e,n,i,r,s,o,a,l,c))):d8(t,e,n,i,r,s,o,a,l,c)}var tE=[],Nne=5,pL=0;function x8(){let t=Id();for(;tE.length&&Id()-t<Nne;)tE.shift()();pL=tE.length?setTimeout(x8,0):0}var One=(...t)=>new Promise((e,n)=>{tE.push(()=>{let i=Id();try{nE.webgl.generateIntoCanvas(...t),e({timing:Id()-i})}catch(r){n(r)}}),pL||(pL=setTimeout(x8,0))}),Bne=4,Une=2e3,h8={},Fne=0;function d8(t,e,n,i,r,s,o,a,l,c){let u="TroikaTextSDFGenerator_JS_"+Fne++%Bne,d=h8[u];return d||(d=h8[u]={workerModule:Ld({name:u,workerId:u,dependencies:[cL,Id],init(p,m){let g=p().javascript.generate;return function(..._){let y=m();return{textureData:g(..._),timing:m()-y}}},getTransferables(p){return[p.textureData.buffer]}}),requests:0,idleTimer:null}),d.requests++,clearTimeout(d.idleTimer),d.workerModule(t,e,n,i,r,s).then(({textureData:p,timing:m})=>{let g=Id(),_=new Uint8Array(p.length*4);for(let y=0;y<p.length;y++)_[y*4+c]=p[y];return nE.webglUtils.renderImageData(o,_,a,l,t,e,1<<3-c),m+=Id()-g,--d.requests===0&&(d.idleTimer=setTimeout(()=>{r8(u)},Une)),{timing:m}})}function zne(t){t._warm||(nE.webgl.isSupported(t),t._warm=!0)}var Hne=nE.webglUtils.resizeWebGLCanvasWithoutClearing,Dd={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},Wne=new dt,Vne=!1;function lm(){return(self.performance||Date).now()}var f8=Object.create(null);function S8(t,e){Vne=!0,t=jne({},t);let n=lm(),{defaultFontURL:i}=Dd,r=[];if(i&&r.push({label:"default",src:p8(i)}),t.font&&r.push({label:"user",src:p8(t.font)}),t.font=r,t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||Dd.sdfGlyphSize,t.unicodeFontsURL=t.unicodeFontsURL||Dd.unicodeFontsURL,t.colorRanges!=null){let m={};for(let g in t.colorRanges)if(t.colorRanges.hasOwnProperty(g)){let _=t.colorRanges[g];typeof _!="number"&&(_=Wne.set(_).getHex()),m[g]=_}t.colorRanges=m}Object.freeze(t);let{textureWidth:s,sdfExponent:o}=Dd,{sdfGlyphSize:a}=t,l=s/a*4,c=f8[a];if(!c){let m=document.createElement("canvas");m.width=s,m.height=a*256/l,c=f8[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:m,sdfTexture:new bi(m,void 0,void 0,void 0,Un,Un),contextLost:!1,glyphsByFont:new Map},c.sdfTexture.generateMipmaps=!1,Gne(c)}let{sdfTexture:u,sdfCanvas:d}=c;(Dd.useWorker?C8:qne)(t).then(m=>{let{glyphIds:g,glyphFontIndices:_,fontData:y,glyphPositions:v,fontSize:S,timings:b}=m,w=[],C=new Float32Array(g.length*4),M=0,L=0,P=lm(),T=y.map(O=>{let z=c.glyphsByFont.get(O.src);return z||c.glyphsByFont.set(O.src,z=new Map),z});g.forEach((O,z)=>{let U=_[z],{src:G,unitsPerEm:j}=y[U],J=T[U].get(O);if(!J){let{path:ne,pathBounds:re}=m.glyphData[G][O],$=Math.max(re[2]-re[0],re[3]-re[1])/a*(Dd.sdfMargin*a+.5),ie=c.glyphCount++,le=[re[0]-$,re[1]-$,re[2]+$,re[3]+$];T[U].set(O,J={path:ne,atlasIndex:ie,sdfViewBox:le}),w.push(J)}let{sdfViewBox:K}=J,D=v[L++],X=v[L++],q=S/j;C[M++]=D+K[0]*q,C[M++]=X+K[1]*q,C[M++]=D+K[2]*q,C[M++]=X+K[3]*q,g[z]=J.atlasIndex}),b.quads=(b.quads||0)+(lm()-P);let A=lm();b.sdf={};let I=d.height,F=Math.ceil(c.glyphCount/l),B=Math.pow(2,Math.ceil(Math.log2(F*a)));B>I&&(console.info(`Increasing SDF texture size ${I}->${B}`),Hne(d,s,B),u.dispose()),Promise.all(w.map(O=>b8(O,c,t.gpuAccelerateSDF).then(({timing:z})=>{b.sdf[O.atlasIndex]=z}))).then(()=>{w.length&&!c.contextLost&&(E8(c),u.needsUpdate=!0),b.sdfTotal=lm()-A,b.total=lm()-n,e(Object.freeze({parameters:t,sdfTexture:u,sdfGlyphSize:a,sdfExponent:o,glyphBounds:C,glyphAtlasIndices:g,glyphColors:m.glyphColors,caretPositions:m.caretPositions,chunkedBounds:m.chunkedBounds,ascender:m.ascender,descender:m.descender,lineHeight:m.lineHeight,capHeight:m.capHeight,xHeight:m.xHeight,topBaseline:m.topBaseline,blockBounds:m.blockBounds,visibleBounds:m.visibleBounds,timings:m.timings}))})}),Promise.resolve().then(()=>{c.contextLost||zne(d)})}function b8({path:t,atlasIndex:e,sdfViewBox:n},{sdfGlyphSize:i,sdfCanvas:r,contextLost:s},o){if(s)return Promise.resolve({timing:-1});let{textureWidth:a,sdfExponent:l}=Dd,c=Math.max(n[2]-n[0],n[3]-n[1]),u=Math.floor(e/4),d=u%(a/i)*i,p=Math.floor(u/(a/i))*i,m=e%4;return Rne(i,i,t,n,c,l,r,d,p,m,o)}function Gne(t){let e=t.sdfCanvas;e.addEventListener("webglcontextlost",n=>{console.log("Context Lost",n),n.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",n=>{console.log("Context Restored",n),t.contextLost=!1;let i=[];t.glyphsByFont.forEach(r=>{r.forEach(s=>{i.push(b8(s,t,!0))})}),Promise.all(i).then(()=>{E8(t),t.sdfTexture.needsUpdate=!0})})}function w8({font:t,characters:e,sdfGlyphSize:n},i){let r=Array.isArray(e)?e.join(`
`):""+e;S8({font:t,sdfGlyphSize:n,text:r},i)}function jne(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var Qw;function p8(t){return Qw||(Qw=typeof document>"u"?{}:document.createElement("a")),Qw.href=t,Qw.href}function E8(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");let{sdfCanvas:e,sdfTexture:n}=t,{width:i,height:r}=e,s=t.sdfCanvas.getContext("webgl"),o=n.image.data;(!o||o.length!==i*r*4)&&(o=new Uint8Array(i*r*4),n.image={width:i,height:r,data:o},n.flipY=!1,n.isDataTexture=!0),s.readPixels(0,0,i,r,s.RGBA,s.UNSIGNED_BYTE,o)}}var Xne=Ld({name:"Typesetter",dependencies:[Ine,Dne,s8],init(t,e,n){return t(e,n())}}),C8=Ld({name:"Typesetter",dependencies:[Xne],init(t){return function(e){return new Promise(n=>{t.typeset(e,n)})}},getTransferables(t){let e=[];for(let n in t)t[n]&&t[n].buffer&&e.push(t[n].buffer);return e}}),qne=C8.onMainThread;var m8={};function Yne(t){let e=m8[t];return e||(e=m8[t]=new Na(1,1,t,t).translate(.5,.5,0)),e}var Kne="aTroikaGlyphBounds",g8="aTroikaGlyphIndex",$ne="aTroikaGlyphColor",mL=class extends nd{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Di,this.boundingBox=new Pi}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let n=Yne(e);["position","normal","uv"].forEach(i=>{this.attributes[i]=n.attributes[i].clone()}),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,n,i,r,s){this.updateAttributeData(Kne,e,4),this.updateAttributeData(g8,n,1),this.updateAttributeData($ne,s,3),this._blockBounds=i,this._chunkedBounds=r,this.instanceCount=n.length,this._updateBounds()}_updateBounds(){let e=this._blockBounds;if(e){let{curveRadius:n,boundingBox:i}=this;if(n){let{PI:r,floor:s,min:o,max:a,sin:l,cos:c}=Math,u=r/2,d=r*2,p=Math.abs(n),m=e[0]/p,g=e[2]/p,_=s((m+u)/d)!==s((g+u)/d)?-p:o(l(m)*p,l(g)*p),y=s((m-u)/d)!==s((g-u)/d)?p:a(l(m)*p,l(g)*p),v=s((m+r)/d)!==s((g+r)/d)?p*2:a(p-c(m)*p,p-c(g)*p);i.min.set(_,e[1],n<0?-v:0),i.max.set(y,e[3],n<0?0:v)}else i.min.set(e[0],e[1],0),i.max.set(e[2],e[3],0);i.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let n=this.getAttribute(g8).count,i=this._chunkedBounds;if(i)for(let r=i.length;r--;){n=i[r].end;let s=i[r].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=n}updateAttributeData(e,n,i){let r=this.getAttribute(e);n?r&&r.array.length===n.length?(r.array.set(n),r.needsUpdate=!0):(this.setAttribute(e,new Ia(n,i)),delete this._maxInstanceCount,this.dispose()):r&&this.deleteAttribute(e)}},Jne=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Zne=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Qne=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,eie=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function tie(t){let e=Zw(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new We},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Rn(0,0,0,0)},uTroikaClipRect:{value:new Rn(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new We},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new dt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Xt},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Jne,vertexTransform:Zne,fragmentDefs:Qne,fragmentColorTransform:eie,customRewriter({vertexShader:n,fragmentShader:i}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(i)&&(i=i.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(n)||(n=n.replace(hL,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:n,fragmentShader:i}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}var gL=new So({color:16777215,side:ts,transparent:!0}),v8=8421504,_8=new Ft,eE=new Y,dL=new Y,$_=[],nie=new Y,fL="+x+y";function y8(t){return Array.isArray(t)?t[0]:t}var T8=()=>{let t=new zn(new Na(1,1),gL);return T8=()=>t,t},M8=()=>{let t=new zn(new Na(1,1,32,1),gL);return M8=()=>t,t},iie={type:"syncstart"},rie={type:"synccomplete"},A8=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],sie=A8.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail"),J_=class extends zn{constructor(){let e=new mL;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=v8,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=fL,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(iie),S8({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},n=>{this._isSyncing=!1,this._textRenderInfo=n,this.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);let i=this._queuedSyncs;i&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{i.forEach(r=>r&&r())})),this.dispatchEvent(rie),e&&e()})))}onBeforeRender(e,n,i,r,s,o){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return tie(e)}get material(){let e=this._derivedMaterial,n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=gL.clone());if((!e||!e.isDerivedFrom(n))&&(e=this._derivedMaterial=this.createDerivedMaterial(n),n.addEventListener("dispose",function i(){n.removeEventListener("dispose",i),e.dispose()})),this.hasOutline()){let i=e._outlineMtl;return i||(i=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),i.isTextOutlineMaterial=!0,i.depthWrite=!1,i.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),i.dispose()})),[i,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return y8(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return y8(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){let n=e.isTextOutlineMaterial,i=e.uniforms,r=this.textRenderInfo;if(r){let{sdfTexture:a,blockBounds:l}=r;i.uTroikaSDFTexture.value=a,i.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),i.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,i.uTroikaSDFExponent.value=r.sdfExponent,i.uTroikaTotalBounds.value.fromArray(l),i.uTroikaUseGlyphColors.value=!n&&!!r.glyphColors;let c=0,u=0,d=0,p,m,g,_=0,y=0;if(n){let{outlineWidth:S,outlineOffsetX:b,outlineOffsetY:w,outlineBlur:C,outlineOpacity:M}=this;c=this._parsePercent(S)||0,u=Math.max(0,this._parsePercent(C)||0),p=M,_=this._parsePercent(b)||0,y=this._parsePercent(w)||0}else d=Math.max(0,this._parsePercent(this.strokeWidth)||0),d&&(g=this.strokeColor,i.uTroikaStrokeColor.value.set(g??v8),m=this.strokeOpacity,m==null&&(m=1)),p=this.fillOpacity;i.uTroikaEdgeOffset.value=c,i.uTroikaPositionOffset.value.set(_,y),i.uTroikaBlurRadius.value=u,i.uTroikaStrokeWidth.value=d,i.uTroikaStrokeOpacity.value=m,i.uTroikaFillOpacity.value=p??1,i.uTroikaCurveRadius.value=this.curveRadius||0;let v=this.clipRect;if(v&&Array.isArray(v)&&v.length===4)i.uTroikaClipRect.value.fromArray(v);else{let S=(this.fontSize||.1)*100;i.uTroikaClipRect.value.set(l[0]-S,l[1]-S,l[2]+S,l[3]+S)}this.geometry.applyClipRect(i.uTroikaClipRect.value)}i.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;let s=n?this.outlineColor||0:this.color;if(s==null)delete e.color;else{let a=e.hasOwnProperty("color")?e.color:e.color=new dt;(s!==a._input||typeof s=="object")&&a.set(a._input=s)}let o=this.orientation||fL;if(o!==e._orientation){let a=i.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let l=o!==fL&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,u,d,p]=l;eE.set(0,0,0)[u]=c==="-"?1:-1,dL.set(0,0,0)[p]=d==="-"?-1:1,_8.lookAt(nie,eE.cross(dL),dL),a.setFromMatrix4(_8)}else a.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let n=e.match(/^(-?[\d.]+)%$/),i=n?parseFloat(n[1]):NaN;e=(isNaN(i)?0:i/100)*this.fontSize}return e}localPositionToTextCoords(e,n=new We){n.copy(e);let i=this.curveRadius;return i&&(n.x=Math.atan2(e.x,Math.abs(i)-Math.abs(e.z))*Math.abs(i)),n}worldPositionToTextCoords(e,n=new We){return eE.copy(e),this.localPositionToTextCoords(this.worldToLocal(eE),n)}raycast(e,n){let{textRenderInfo:i,curveRadius:r}=this;if(i){let s=i.blockBounds,o=r?M8():T8(),a=o.geometry,{position:l,uv:c}=a.attributes;for(let u=0;u<c.count;u++){let d=s[0]+c.getX(u)*(s[2]-s[0]),p=s[1]+c.getY(u)*(s[3]-s[1]),m=0;r&&(m=r-Math.cos(d/r)*r,d=Math.sin(d/r)*r),l.setXYZ(u,d,p,m)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,$_.length=0,o.raycast(e,$_);for(let u=0;u<$_.length;u++)$_[u].object=this,n.push($_[u])}}copy(e){let n=this.geometry;return super.copy(e),this.geometry=n,sie.forEach(i=>{this[i]=e[i]}),this}clone(){return new this.constructor().copy(this)}};A8.forEach(t=>{let e="_private_"+t;Object.defineProperty(J_.prototype,t,{get(){return this[e]},set(n){n!==this[e]&&(this[e]=n,this._needsSync=!0)}})});var Bce=new Pi,Uce=new dt;u_();SA();var vL=Zs.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:n="middle",font:i,fontSize:r=1,children:s,characters:o,onSync:a,...l},c)=>{let u=ia(({invalidate:g})=>g),[d]=Zs.useState(()=>new J_),[p,m]=Zs.useMemo(()=>{let g=[],_="";return Zs.Children.forEach(s,y=>{typeof y=="string"||typeof y=="number"?_+=y:g.push(y)}),[g,_]},[s]);return kb(()=>new Promise(g=>w8({font:i,characters:o},g)),["troika-text",i,o]),Zs.useLayoutEffect(()=>{d.sync(()=>{u(),a&&a(d)})}),Zs.useEffect(()=>()=>d.dispose(),[d]),Zs.createElement("primitive",am({object:d,ref:c,font:i,text:m,anchorX:e,anchorY:n,fontSize:r,sdfGlyphSize:t},l),p)});u_();var Dl=mt(Ct());var _L=Dl.forwardRef(({makeDefault:t,camera:e,regress:n,domElement:i,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},u)=>{let d=ia(M=>M.invalidate),p=ia(M=>M.camera),m=ia(M=>M.gl),g=ia(M=>M.events),_=ia(M=>M.setEvents),y=ia(M=>M.set),v=ia(M=>M.get),S=ia(M=>M.performance),b=e||p,w=i||g.connected||m.domElement,C=Dl.useMemo(()=>new q_(b),[b]);return _c(()=>{C.enabled&&C.update()},-1),Dl.useEffect(()=>(s&&C.connect(s===!0?w:s),C.connect(w),()=>{C.dispose()}),[s,w,n,C,d]),Dl.useEffect(()=>{let M=T=>{d(),n&&S.regress(),o&&o(T)},L=T=>{a&&a(T)},P=T=>{l&&l(T)};return C.addEventListener("change",M),C.addEventListener("start",L),C.addEventListener("end",P),()=>{C.removeEventListener("start",L),C.removeEventListener("end",P),C.removeEventListener("change",M)}},[o,a,l,C,d,_]),Dl.useEffect(()=>{if(t){let M=v().controls;return y({controls:C}),()=>y({controls:M})}},[t,C]),Dl.createElement("primitive",am({ref:u,object:C,enableDamping:r},c))});Ou();var Rd={file:"#4fc3f7",observation:"#81c784",session:"#ffb74d",project:"#e57373",tag:"#ba68c8"},oie=[{type:"file",label:"File",color:Rd.file},{type:"observation",label:"Observation",color:Rd.observation},{type:"session",label:"Session",color:Rd.session},{type:"project",label:"Project",color:Rd.project},{type:"tag",label:"Tag",color:Rd.tag}],aie=50,lie=.02,cie=5,yL=.92,uie=.01;function k8(t){let e=new Map,n=Math.max(t.length*.5,10);return t.forEach((i,r)=>{let s=Math.acos(-1+2*r/Math.max(t.length,1)),o=Math.sqrt(t.length*Math.PI)*s;e.set(i.id,{x:n*Math.cos(o)*Math.sin(s)+(Math.random()-.5)*2,y:n*Math.sin(o)*Math.sin(s)+(Math.random()-.5)*2,z:n*Math.cos(s)+(Math.random()-.5)*2,vx:0,vy:0,vz:0})}),e}function hie({node:t,position:e,connectionCount:n,isSelected:i,onClick:r}){let s=(0,ft.useRef)(null),o=Rd[t.type]||"#ffffff",a=.3+Math.min(n*.1,.7),l=i?a*1.3:a;return ft.default.createElement("group",{position:e},ft.default.createElement("mesh",{ref:s,onClick:c=>{c.stopPropagation(),r()}},ft.default.createElement("sphereGeometry",{args:[l,16,16]}),ft.default.createElement("meshStandardMaterial",{color:o,emissive:i?o:"#000000",emissiveIntensity:i?.5:0})),ft.default.createElement(vL,{position:[0,l+.4,0],fontSize:.35,color:"#c9d1d9",anchorX:"center",anchorY:"bottom",maxWidth:6},t.label.length>20?t.label.slice(0,18)+"...":t.label))}function die({edges:t,positions:e}){let n=(0,ft.useMemo)(()=>{let i=[];for(let s of t){let o=e.get(s.source),a=e.get(s.target);!o||!a||(i.push(o.x,o.y,o.z),i.push(a.x,a.y,a.z))}let r=new Wt;return r.setAttribute("position",new bt(i,3)),r},[t,e]);return ft.default.createElement("lineSegments",{geometry:n},ft.default.createElement("lineBasicMaterial",{color:"#30363d",opacity:.4,transparent:!0}))}function fie({graphData:t,selectedNodeId:e,onSelectNode:n}){let i=(0,ft.useRef)({positions:k8(t.nodes),settled:!1}),[r,s]=(0,ft.useState)(0),o=(0,ft.useMemo)(()=>{let c=new Map;for(let u of t.edges)c.has(u.source)||c.set(u.source,new Set),c.has(u.target)||c.set(u.target,new Set),c.get(u.source).add(u.target),c.get(u.target).add(u.source);return c},[t.edges]),a=(0,ft.useMemo)(()=>{let c=new Map;for(let[u,d]of o)c.set(u,d.size);return c},[o]);(0,ft.useEffect)(()=>{i.current={positions:k8(t.nodes),settled:!1}},[t.nodes]),_c(()=>{let c=i.current;if(c.settled)return;let u=c.positions,d=[...u.keys()],p=0;for(let m=0;m<d.length;m++){let g=u.get(d[m]);for(let _=m+1;_<d.length;_++){let y=u.get(d[_]),v=g.x-y.x,S=g.y-y.y,b=g.z-y.z,w=v*v+S*S+b*b+.01,C=aie/w,M=Math.sqrt(w),L=v/M*C,P=S/M*C,T=b/M*C;g.vx+=L,g.vy+=P,g.vz+=T,y.vx-=L,y.vy-=P,y.vz-=T}}for(let m of t.edges){let g=u.get(m.source),_=u.get(m.target);if(!g||!_)continue;let y=_.x-g.x,v=_.y-g.y,S=_.z-g.z,b=Math.sqrt(y*y+v*v+S*S)+.01,w=b-cie,C=lie*w,M=y/b*C,L=v/b*C,P=S/b*C;g.vx+=M,g.vy+=L,g.vz+=P,_.vx-=M,_.vy-=L,_.vz-=P}for(let m of d){let g=u.get(m);g.vx*=yL,g.vy*=yL,g.vz*=yL,g.x+=g.vx,g.y+=g.vy,g.z+=g.vz;let _=Math.sqrt(g.vx*g.vx+g.vy*g.vy+g.vz*g.vz);p=Math.max(p,_)}p<uie&&(c.settled=!0),s(m=>m+1)});let l=i.current.positions;return ft.default.createElement(ft.default.Fragment,null,ft.default.createElement("ambientLight",{intensity:.6}),ft.default.createElement("pointLight",{position:[20,20,20],intensity:.8}),ft.default.createElement(die,{edges:t.edges,positions:l}),t.nodes.map(c=>{let u=l.get(c.id);return u?ft.default.createElement(hie,{key:c.id,node:c,position:[u.x,u.y,u.z],connectionCount:a.get(c.id)||0,isSelected:e===c.id,onClick:()=>n(e===c.id?null:c.id)}):null}),ft.default.createElement(_L,{enableDamping:!0,dampingFactor:.1}))}function L8({currentProject:t,projects:e,onProjectChange:n}){let[i,r]=(0,ft.useState)(null),[s,o]=(0,ft.useState)(!0),[a,l]=(0,ft.useState)(null),[c,u]=(0,ft.useState)(null),[d,p]=(0,ft.useState)(t||""),m=(0,ft.useMemo)(()=>!c||!i?null:i.nodes.find(y=>y.id===c)||null,[c,i]),g=(0,ft.useMemo)(()=>!c||!i?[]:i.edges.filter(y=>y.source===c||y.target===c),[c,i]),_=(0,ft.useCallback)(async()=>{o(!0),l(null);try{let y=new URLSearchParams;d&&y.set("project",d),y.set("limit","150");let v=await fetch(`/api/graph?${y.toString()}`);if(!v.ok)throw new Error(`Failed to fetch: ${v.status}`);let S=await v.json();r(S)}catch(y){l(y.message)}finally{o(!1)}},[d]);return(0,ft.useEffect)(()=>{_()},[_]),(0,ft.useEffect)(()=>{t!==void 0&&p(t)},[t]),ft.default.createElement("div",{style:Tn.container},ft.default.createElement("div",{style:Tn.controlsBar},ft.default.createElement("div",{style:Tn.controlsLeft},ft.default.createElement("h2",{style:Tn.heading},"Knowledge Graph"),e&&e.length>0&&ft.default.createElement("select",{style:Tn.projectSelect,value:d,onChange:y=>{p(y.target.value),n&&n(y.target.value)}},ft.default.createElement("option",{value:""},"All Projects"),e.map(y=>ft.default.createElement("option",{key:y,value:y},y.split("/").pop()))),ft.default.createElement("button",{style:Tn.refreshBtn,onClick:_},"Refresh")),ft.default.createElement("div",{style:Tn.legend},oie.map(y=>ft.default.createElement("div",{key:y.type,style:Tn.legendItem},ft.default.createElement("div",{style:{...Tn.legendDot,backgroundColor:y.color}}),ft.default.createElement("span",{style:Tn.legendLabel},y.label))))),ft.default.createElement("div",{style:Tn.graphArea},s&&ft.default.createElement("div",{style:Tn.overlay},ft.default.createElement("span",{style:Tn.overlayText},"Loading graph data...")),a&&ft.default.createElement("div",{style:Tn.overlay},ft.default.createElement("span",{style:Tn.errorText},"Error: ",a)),i&&i.nodes.length===0&&!s&&ft.default.createElement("div",{style:Tn.overlay},ft.default.createElement("span",{style:Tn.overlayText},"No data to display. Try a different project or add more observations.")),i&&i.nodes.length>0&&ft.default.createElement(Yb,{camera:{position:[0,0,30],fov:60},style:{background:"#0d1117"},onPointerMissed:()=>u(null)},ft.default.createElement(fie,{graphData:i,selectedNodeId:c,onSelectNode:u})),m&&ft.default.createElement("div",{style:Tn.detailPanel},ft.default.createElement("div",{style:Tn.detailHeader},ft.default.createElement("div",{style:{...Tn.detailTypeBadge,backgroundColor:Rd[m.type]||"#666"}},m.type),ft.default.createElement("button",{style:Tn.detailClose,onClick:()=>u(null)},ft.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},ft.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ft.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})))),ft.default.createElement("div",{style:Tn.detailTitle},m.label),m.metadata&&Object.keys(m.metadata).length>0&&ft.default.createElement("div",{style:Tn.detailMeta},Object.entries(m.metadata).map(([y,v])=>ft.default.createElement("div",{key:y,style:Tn.detailMetaRow},ft.default.createElement("span",{style:Tn.detailMetaKey},y,":"),ft.default.createElement("span",{style:Tn.detailMetaValue},String(v))))),ft.default.createElement("div",{style:Tn.detailEdges},ft.default.createElement("div",{style:Tn.detailEdgesTitle},"Connections (",g.length,")"),g.slice(0,10).map((y,v)=>{let S=y.source===c?y.target:y.source,b=i?.nodes.find(w=>w.id===S);return ft.default.createElement("div",{key:v,style:Tn.detailEdgeRow},ft.default.createElement("span",{style:Tn.detailEdgeType},y.type),ft.default.createElement("span",{style:Tn.detailEdgeTarget,onClick:()=>u(S)},b?.label||S))}),g.length>10&&ft.default.createElement("div",{style:Tn.detailEdgeMore},"+",g.length-10," more"))),i&&ft.default.createElement("div",{style:Tn.stats},i.nodes.length," nodes, ",i.edges.length," edges")))}var Tn={container:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},controlsBar:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",background:"#161b22",borderBottom:"1px solid #30363d",flexWrap:"wrap",gap:"8px"},controlsLeft:{display:"flex",alignItems:"center",gap:"12px"},heading:{margin:0,fontSize:"16px",fontWeight:600,color:"#c9d1d9"},projectSelect:{background:"#21262d",border:"1px solid #30363d",borderRadius:"6px",color:"#c9d1d9",padding:"4px 8px",fontSize:"13px",cursor:"pointer"},refreshBtn:{background:"#21262d",border:"1px solid #30363d",borderRadius:"6px",color:"#c9d1d9",padding:"4px 12px",fontSize:"13px",cursor:"pointer"},legend:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap"},legendItem:{display:"flex",alignItems:"center",gap:"4px"},legendDot:{width:"10px",height:"10px",borderRadius:"50%"},legendLabel:{color:"#8b949e",fontSize:"12px"},graphArea:{flex:1,position:"relative",minHeight:0},overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0d1117",zIndex:10},overlayText:{color:"#8b949e",fontSize:"14px"},errorText:{color:"#f85149",fontSize:"14px"},detailPanel:{position:"absolute",top:"12px",right:"12px",width:"280px",background:"#161b22",border:"1px solid #30363d",borderRadius:"8px",padding:"12px",zIndex:20,maxHeight:"calc(100% - 24px)",overflowY:"auto"},detailHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},detailTypeBadge:{padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:600,color:"#0d1117",textTransform:"uppercase"},detailClose:{background:"none",border:"none",color:"#8b949e",cursor:"pointer",padding:"4px",display:"flex"},detailTitle:{color:"#c9d1d9",fontSize:"14px",fontWeight:600,marginBottom:"8px",wordBreak:"break-all"},detailMeta:{marginBottom:"12px",padding:"8px",background:"#0d1117",borderRadius:"4px"},detailMetaRow:{display:"flex",gap:"8px",marginBottom:"4px",fontSize:"12px"},detailMetaKey:{color:"#8b949e",flexShrink:0},detailMetaValue:{color:"#c9d1d9",wordBreak:"break-all"},detailEdges:{borderTop:"1px solid #30363d",paddingTop:"8px"},detailEdgesTitle:{color:"#8b949e",fontSize:"12px",fontWeight:600,marginBottom:"6px"},detailEdgeRow:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"4px",fontSize:"12px"},detailEdgeType:{color:"#8b949e",background:"#21262d",padding:"1px 4px",borderRadius:"3px",fontSize:"10px",flexShrink:0},detailEdgeTarget:{color:"#58a6ff",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},detailEdgeMore:{color:"#8b949e",fontSize:"11px",marginTop:"4px"},stats:{position:"absolute",bottom:"12px",left:"12px",color:"#484f58",fontSize:"12px",zIndex:5}};var Ro=mt(Ct(),1);var qa={OBSERVATIONS:"/api/observations",SUMMARIES:"/api/summaries",PROMPTS:"/api/prompts",SETTINGS:"/api/settings",STATS:"/api/stats",PROCESSING_STATUS:"/api/processing-status",STREAM:"/stream"};var iE={SSE_RECONNECT_DELAY_MS:3e3,STATS_REFRESH_INTERVAL_MS:1e4,SAVE_STATUS_DISPLAY_DURATION_MS:3e3};function P8(){let[t,e]=(0,Ro.useState)([]),[n,i]=(0,Ro.useState)([]),[r,s]=(0,Ro.useState)([]),[o,a]=(0,Ro.useState)([]),[l,c]=(0,Ro.useState)(!1),[u,d]=(0,Ro.useState)(!1),[p,m]=(0,Ro.useState)(0),g=(0,Ro.useRef)(null),_=(0,Ro.useRef)();return(0,Ro.useEffect)(()=>{let y=()=>{g.current&&g.current.close();let v=new EventSource(qa.STREAM);g.current=v,v.onopen=()=>{console.log("[SSE] Connected"),c(!0),_.current&&clearTimeout(_.current)},v.onerror=S=>{console.error("[SSE] Connection error:",S),c(!1),v.close(),_.current=setTimeout(()=>{_.current=void 0,console.log("[SSE] Attempting to reconnect..."),y()},iE.SSE_RECONNECT_DELAY_MS)},v.onmessage=S=>{let b=JSON.parse(S.data);switch(b.type){case"initial_load":console.log("[SSE] Initial load:",{projects:b.projects?.length||0}),a(b.projects||[]);break;case"new_observation":b.observation&&(console.log("[SSE] New observation:",b.observation.id),e(w=>[b.observation,...w]));break;case"new_summary":if(b.summary){let w=b.summary;console.log("[SSE] New summary:",w.id),i(C=>[w,...C])}break;case"new_prompt":if(b.prompt){let w=b.prompt;console.log("[SSE] New prompt:",w.id),s(C=>[w,...C])}break;case"processing_status":typeof b.isProcessing=="boolean"&&(console.log("[SSE] Processing status:",b.isProcessing,"Queue depth:",b.queueDepth),d(b.isProcessing),m(b.queueDepth||0));break}}};return y(),()=>{g.current&&g.current.close(),_.current&&clearTimeout(_.current)}},[]),{observations:t,summaries:n,prompts:r,projects:o,isProcessing:u,queueDepth:p,isConnected:l}}var cm=mt(Ct(),1);var li={ULTRABRAIN_MODEL:"claude-haiku-4-5",ULTRABRAIN_CONTEXT_OBSERVATIONS:"50",ULTRABRAIN_WORKER_PORT:"37777",ULTRABRAIN_WORKER_HOST:"127.0.0.1",ULTRABRAIN_PROVIDER:"groq",ULTRABRAIN_GEMINI_API_KEY:"",ULTRABRAIN_GEMINI_MODEL:"gemini-2.5-flash-lite",ULTRABRAIN_OPENROUTER_API_KEY:"",ULTRABRAIN_OPENROUTER_MODEL:"deepseek/deepseek-r1-0528:free",ULTRABRAIN_OPENROUTER_SITE_URL:"",ULTRABRAIN_OPENROUTER_APP_NAME:"ultrabrain",ULTRABRAIN_GROQ_API_KEY:"",ULTRABRAIN_GROQ_MODEL:"openai/gpt-oss-120b",ULTRABRAIN_GEMINI_RATE_LIMITING_ENABLED:"true",ULTRABRAIN_CONTEXT_SHOW_READ_TOKENS:"true",ULTRABRAIN_CONTEXT_SHOW_WORK_TOKENS:"true",ULTRABRAIN_CONTEXT_SHOW_SAVINGS_AMOUNT:"true",ULTRABRAIN_CONTEXT_SHOW_SAVINGS_PERCENT:"true",ULTRABRAIN_CONTEXT_OBSERVATION_TYPES:"bugfix,feature,refactor,discovery,decision,change",ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS:"how-it-works,why-it-exists,what-changed,problem-solution,gotcha,pattern,trade-off",ULTRABRAIN_CONTEXT_FULL_COUNT:"5",ULTRABRAIN_CONTEXT_FULL_FIELD:"narrative",ULTRABRAIN_CONTEXT_SESSION_COUNT:"10",ULTRABRAIN_CONTEXT_SHOW_LAST_SUMMARY:"true",ULTRABRAIN_CONTEXT_SHOW_LAST_MESSAGE:"false",ULTRABRAIN_EXCLUDED_PROJECTS:"",ULTRABRAIN_FOLDER_MD_EXCLUDE:"[]"};function D8(){let[t,e]=(0,cm.useState)(li),[n,i]=(0,cm.useState)(!1),[r,s]=(0,cm.useState)("");return(0,cm.useEffect)(()=>{fetch(qa.SETTINGS).then(a=>a.json()).then(a=>{e({ULTRABRAIN_MODEL:a.ULTRABRAIN_MODEL||li.ULTRABRAIN_MODEL,ULTRABRAIN_CONTEXT_OBSERVATIONS:a.ULTRABRAIN_CONTEXT_OBSERVATIONS||li.ULTRABRAIN_CONTEXT_OBSERVATIONS,ULTRABRAIN_WORKER_PORT:a.ULTRABRAIN_WORKER_PORT||li.ULTRABRAIN_WORKER_PORT,ULTRABRAIN_WORKER_HOST:a.ULTRABRAIN_WORKER_HOST||li.ULTRABRAIN_WORKER_HOST,ULTRABRAIN_PROVIDER:a.ULTRABRAIN_PROVIDER||li.ULTRABRAIN_PROVIDER,ULTRABRAIN_GEMINI_API_KEY:a.ULTRABRAIN_GEMINI_API_KEY||li.ULTRABRAIN_GEMINI_API_KEY,ULTRABRAIN_GEMINI_MODEL:a.ULTRABRAIN_GEMINI_MODEL||li.ULTRABRAIN_GEMINI_MODEL,ULTRABRAIN_GEMINI_RATE_LIMITING_ENABLED:a.ULTRABRAIN_GEMINI_RATE_LIMITING_ENABLED||li.ULTRABRAIN_GEMINI_RATE_LIMITING_ENABLED,ULTRABRAIN_OPENROUTER_API_KEY:a.ULTRABRAIN_OPENROUTER_API_KEY||li.ULTRABRAIN_OPENROUTER_API_KEY,ULTRABRAIN_OPENROUTER_MODEL:a.ULTRABRAIN_OPENROUTER_MODEL||li.ULTRABRAIN_OPENROUTER_MODEL,ULTRABRAIN_OPENROUTER_SITE_URL:a.ULTRABRAIN_OPENROUTER_SITE_URL||li.ULTRABRAIN_OPENROUTER_SITE_URL,ULTRABRAIN_OPENROUTER_APP_NAME:a.ULTRABRAIN_OPENROUTER_APP_NAME||li.ULTRABRAIN_OPENROUTER_APP_NAME,ULTRABRAIN_CONTEXT_SHOW_READ_TOKENS:a.ULTRABRAIN_CONTEXT_SHOW_READ_TOKENS||li.ULTRABRAIN_CONTEXT_SHOW_READ_TOKENS,ULTRABRAIN_CONTEXT_SHOW_WORK_TOKENS:a.ULTRABRAIN_CONTEXT_SHOW_WORK_TOKENS||li.ULTRABRAIN_CONTEXT_SHOW_WORK_TOKENS,ULTRABRAIN_CONTEXT_SHOW_SAVINGS_AMOUNT:a.ULTRABRAIN_CONTEXT_SHOW_SAVINGS_AMOUNT||li.ULTRABRAIN_CONTEXT_SHOW_SAVINGS_AMOUNT,ULTRABRAIN_CONTEXT_SHOW_SAVINGS_PERCENT:a.ULTRABRAIN_CONTEXT_SHOW_SAVINGS_PERCENT||li.ULTRABRAIN_CONTEXT_SHOW_SAVINGS_PERCENT,ULTRABRAIN_CONTEXT_OBSERVATION_TYPES:a.ULTRABRAIN_CONTEXT_OBSERVATION_TYPES||li.ULTRABRAIN_CONTEXT_OBSERVATION_TYPES,ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS:a.ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS||li.ULTRABRAIN_CONTEXT_OBSERVATION_CONCEPTS,ULTRABRAIN_CONTEXT_FULL_COUNT:a.ULTRABRAIN_CONTEXT_FULL_COUNT||li.ULTRABRAIN_CONTEXT_FULL_COUNT,ULTRABRAIN_CONTEXT_FULL_FIELD:a.ULTRABRAIN_CONTEXT_FULL_FIELD||li.ULTRABRAIN_CONTEXT_FULL_FIELD,ULTRABRAIN_CONTEXT_SESSION_COUNT:a.ULTRABRAIN_CONTEXT_SESSION_COUNT||li.ULTRABRAIN_CONTEXT_SESSION_COUNT,ULTRABRAIN_CONTEXT_SHOW_LAST_SUMMARY:a.ULTRABRAIN_CONTEXT_SHOW_LAST_SUMMARY||li.ULTRABRAIN_CONTEXT_SHOW_LAST_SUMMARY,ULTRABRAIN_CONTEXT_SHOW_LAST_MESSAGE:a.ULTRABRAIN_CONTEXT_SHOW_LAST_MESSAGE||li.ULTRABRAIN_CONTEXT_SHOW_LAST_MESSAGE})}).catch(a=>{console.error("Failed to load settings:",a)})},[]),{settings:t,saveSettings:async a=>{i(!0),s("Saving...");let c=await(await fetch(qa.SETTINGS,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();c.success?(e(a),s("\u2713 Saved"),setTimeout(()=>s(""),iE.SAVE_STATUS_DISPLAY_DURATION_MS)):s(`\u2717 Error: ${c.error}`),i(!1)},isSaving:n,saveStatus:r}}var um=mt(Ct(),1);function I8(){let[t,e]=(0,um.useState)({}),n=(0,um.useCallback)(async()=>{try{let r=await(await fetch(qa.STATS)).json();e(r)}catch(i){console.error("Failed to load stats:",i)}},[]);return(0,um.useEffect)(()=>{n()},[n]),{stats:t,refreshStats:n}}var Zu=mt(Ct(),1);function xL(t,e,n){let[i,r]=(0,Zu.useState)({isLoading:!1,hasMore:!0}),s=(0,Zu.useRef)(0),o=(0,Zu.useRef)(n),a=(0,Zu.useRef)(i),l=(0,Zu.useCallback)(async()=>{let c=o.current!==n;if(c){s.current=0,o.current=n;let m={isLoading:!1,hasMore:!0};r(m),a.current=m}if(!c&&(a.current.isLoading||!a.current.hasMore))return[];r(m=>({...m,isLoading:!0}));let u=new URLSearchParams({offset:s.current.toString(),limit:h_.PAGINATION_PAGE_SIZE.toString()});n&&u.append("project",n);let d=await fetch(`${t}?${u}`);if(!d.ok)throw new Error(`Failed to load ${e}: ${d.statusText}`);let p=await d.json();return r(m=>({...m,isLoading:!1,hasMore:p.hasMore})),s.current+=h_.PAGINATION_PAGE_SIZE,p.items},[n,t,e]);return{...i,loadMore:l}}function R8(t){let e=xL(qa.OBSERVATIONS,"observations",t),n=xL(qa.SUMMARIES,"summaries",t),i=xL(qa.PROMPTS,"prompts",t);return{observations:e,summaries:n,prompts:i}}var N8=mt(Ct(),1);function O8(){(0,N8.useEffect)(()=>{document.documentElement.setAttribute("data-theme","dark")},[])}function rE(t,e){let n=new Set;return[...t,...e].filter(i=>n.has(i.id)?!1:(n.add(i.id),!0))}function B8(){let[t,e]=(0,Ot.useState)(""),[n,i]=(0,Ot.useState)(!1),[r,s]=(0,Ot.useState)(!1),[o,a]=(0,Ot.useState)([]),[l,c]=(0,Ot.useState)([]),[u,d]=(0,Ot.useState)([]),[p,m]=(0,Ot.useState)(()=>{try{let $=localStorage.getItem("ub-sidebar-open");return $?JSON.parse($):!1}catch{return!1}}),[g,_]=(0,Ot.useState)("projects"),[y,v]=(0,Ot.useState)(""),{observations:S,summaries:b,prompts:w,projects:C,isProcessing:M,queueDepth:L,isConnected:P}=P8(),{settings:T,saveSettings:A,isSaving:I,saveStatus:F}=D8(),{stats:B,refreshStats:O}=I8();O8();let z=R8(t);(0,Ot.useEffect)(()=>{!y&&C.length>0&&v(C[0])},[C,y]);let U=(0,Ot.useMemo)(()=>t?o:rE(S,o),[S,o,t]),G=(0,Ot.useMemo)(()=>t?l:rE(b,l),[b,l,t]),j=(0,Ot.useMemo)(()=>t?u:rE(w,u),[w,u,t]),J=(0,Ot.useCallback)(()=>{i($=>!$)},[]),K=(0,Ot.useCallback)(()=>{s($=>!$)},[]),D=(0,Ot.useCallback)(async()=>{try{let[$,ie,le]=await Promise.all([z.observations.loadMore(),z.summaries.loadMore(),z.prompts.loadMore()]);$.length>0&&a(Ee=>[...Ee,...$]),ie.length>0&&c(Ee=>[...Ee,...ie]),le.length>0&&d(Ee=>[...Ee,...le])}catch($){console.error("Failed to load more data:",$)}},[t,z.observations,z.summaries,z.prompts]);(0,Ot.useEffect)(()=>{a([]),c([]),d([]),D()},[t]);let X=(0,Ot.useCallback)($=>{e($),_("feed")},[]),q=(0,Ot.useCallback)($=>{_($)},[]),ne=(0,Ot.useCallback)(()=>{m($=>!$)},[]);return Ot.default.createElement(Ot.default.Fragment,null,Ot.default.createElement(VU,{isOpen:p,onToggle:ne,currentView:g,onViewChange:q}),Ot.default.createElement("div",{className:`main-content-wrapper ${p?"sidebar-open":""}`},Ot.default.createElement(OU,{isConnected:P,isProcessing:M,queueDepth:L,onContextPreviewToggle:J}),(()=>{switch(g){case"projects":return Ot.default.createElement(GU,{onSelectProject:X});case"claude-desktop":return Ot.default.createElement(qU,{projects:C});case"pm-overview":return Ot.default.createElement(WF,{currentProject:y,projects:C,onNavigate:q,onProjectChange:v});case"pm-bugs":return Ot.default.createElement(VF,{currentProject:y});case"pm-todos":return Ot.default.createElement(GF,{currentProject:y});case"pm-ideas":return Ot.default.createElement(jF,{currentProject:y});case"pm-learnings":return Ot.default.createElement(XF,{currentProject:y});case"pm-tags":return Ot.default.createElement(qF,null);case"kanban":return Ot.default.createElement(XU,{currentProject:y,projects:C});case"current-state":return Ot.default.createElement(KF,{currentProject:y});case"claude-md":return Ot.default.createElement(t5,{currentProject:y,projects:C,onProjectChange:v});case"loop":return Ot.default.createElement(i5,{currentProject:y,projects:C,onProjectChange:v});case"teams":return Ot.default.createElement(s5,{currentProject:y,projects:C,onProjectChange:v});case"terminal":return Ot.default.createElement(z6,null);case"automation":return Ot.default.createElement(Q6,null);case"analytics":return Ot.default.createElement(X6,{currentProject:y,projects:C,onProjectChange:v});case"graph":return Ot.default.createElement(L8,{currentProject:y,projects:C,onProjectChange:v});default:return Ot.default.createElement(WU,{observations:U,summaries:G,prompts:j,onLoadMore:D,isLoading:z.observations.isLoading||z.summaries.isLoading||z.prompts.isLoading,hasMore:z.observations.hasMore||z.summaries.hasMore||z.prompts.hasMore,projects:C,currentFilter:t,onFilterChange:e})}})()),Ot.default.createElement(zF,{isOpen:n,onClose:J,settings:T,onSave:A,isSaving:I,saveStatus:F}),Ot.default.createElement("button",{className:"console-toggle-btn",onClick:K,title:"Toggle Terminal"},Ot.default.createElement("span",{className:"terminal-prefix"},">_"),Ot.default.createElement("span",null,"Terminal"),Ot.default.createElement("span",{className:"terminal-cursor"})),Ot.default.createElement(HF,{isOpen:r,onClose:K}))}var kc=mt(Ct(),1),sE=class extends kc.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("[ErrorBoundary] Caught error:",e,n),this.setState({error:e,errorInfo:n})}render(){return this.state.hasError?kc.default.createElement("div",{style:{padding:"20px",color:"#ff6b6b",backgroundColor:"#1a1a1a",minHeight:"100vh"}},kc.default.createElement("h1",{style:{fontSize:"24px",marginBottom:"10px"}},"Something went wrong"),kc.default.createElement("p",{style:{marginBottom:"10px",color:"#8b949e"}},"The application encountered an error. Please refresh the page to try again."),this.state.error&&kc.default.createElement("details",{style:{marginTop:"20px",color:"#8b949e"}},kc.default.createElement("summary",{style:{cursor:"pointer",marginBottom:"10px"}},"Error details"),kc.default.createElement("pre",{style:{backgroundColor:"#0d1117",padding:"10px",borderRadius:"6px",overflow:"auto"}},this.state.error.toString(),this.state.errorInfo&&`

`+this.state.errorInfo.componentStack))):this.props.children}};var F8=document.getElementById("root");if(!F8)throw new Error("Root element not found");var pie=(0,U8.createRoot)(F8);pie.render(SL.default.createElement(sE,null,SL.default.createElement(B8,null)));})();
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
scheduler/cjs/scheduler.production.min.js:
scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

three/build/three.core.js:
three/build/three.module.js:
  (**
   * @license
   * Copyright 2010-2025 Three.js Authors
   * SPDX-License-Identifier: MIT
   *)

react-reconciler/cjs/react-reconciler-constants.production.min.js:
  (**
   * @license React
   * react-reconciler-constants.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-reconciler/cjs/react-reconciler.production.min.js:
  (**
   * @license React
   * react-reconciler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

dompurify/dist/purify.es.mjs:
  (*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE *)

@xterm/xterm/lib/xterm.mjs:
@xterm/addon-fit/lib/addon-fit.mjs:
@xterm/addon-web-links/lib/addon-web-links.mjs:
@xterm/addon-search/lib/addon-search.mjs:
  (**
   * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
   * @license MIT
   *
   * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
   * @license MIT
   *
   * Originally forked from (with the author's permission):
   *   Fabrice Bellard's javascript vt100 for jslinux:
   *   http://bellard.org/jslinux/
   *   Copyright (c) 2011 Fabrice Bellard
   *)

troika-three-text/dist/troika-three-text.esm.js:
  (*!
  Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
  Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
  *)
  (*!
  Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
  (https://github.com/101arrowz/fflate) for use in Troika text rendering. 
  Original licenses apply: 
  - fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
  - woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
  *)
  (*!
  Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
  for use in Troika text rendering. 
  Original MIT license applies
  *)
*/
